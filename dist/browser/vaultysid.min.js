/*! For license information please see vaultysid.min.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,()=>(()=>{var e={11:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.Hash=t.nextTick=t.swap32IfBE=t.byteSwapIfBE=t.swap8IfBE=t.isLE=void 0,t.isBytes=i,t.anumber=s,t.abytes=o,t.ahash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");s(e.outputLen),s(e.blockLen)},t.aexists=function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},t.aoutput=function(e,t){o(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)},t.u8=function(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},t.u32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))},t.clean=function(...e){for(let t=0;t<e.length;t++)e[t].fill(0)},t.createView=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},t.rotr=function(e,t){return e<<32-t|e>>>t},t.rotl=function(e,t){return e<<t|e>>>32-t>>>0},t.byteSwap=a,t.byteSwap32=c,t.bytesToHex=function(e){if(o(e),f)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=u[e[r]];return t},t.hexToBytes=function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(f)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=l(e.charCodeAt(i)),s=l(e.charCodeAt(i+1));if(void 0===r||void 0===s){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+s}return n},t.asyncLoop=async function(e,r,n){let i=Date.now();for(let s=0;s<e;s++){n(s);const e=Date.now()-i;e>=0&&e<r||(await(0,t.nextTick)(),i+=e)}},t.utf8ToBytes=d,t.bytesToUtf8=function(e){return(new TextDecoder).decode(e)},t.toBytes=p,t.kdfInputToBytes=function(e){return"string"==typeof e&&(e=d(e)),o(e),e},t.concatBytes=function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];o(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r},t.checkOpts=function(e,t){if(void 0!==t&&"[object Object]"!=={}.toString.call(t))throw new Error("options should be object or undefined");return Object.assign(e,t)},t.createHasher=y,t.createOptHasher=g,t.createXOFer=m,t.randomBytes=function(e=32){if(n.crypto&&"function"==typeof n.crypto.getRandomValues)return n.crypto.getRandomValues(new Uint8Array(e));if(n.crypto&&"function"==typeof n.crypto.randomBytes)return Uint8Array.from(n.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")};const n=r(9517);function i(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function s(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function o(e,...t){if(!i(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function c(e){for(let t=0;t<e.length;t++)e[t]=a(e[t]);return e}t.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],t.swap8IfBE=t.isLE?e=>e:e=>a(e),t.byteSwapIfBE=t.swap8IfBE,t.swap32IfBE=t.isLE?e=>e:c;const f=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),u=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),h={_0:48,_9:57,A:65,F:70,a:97,f:102};function l(e){return e>=h._0&&e<=h._9?e-h._0:e>=h.A&&e<=h.F?e-(h.A-10):e>=h.a&&e<=h.f?e-(h.a-10):void 0}function d(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function p(e){return"string"==typeof e&&(e=d(e)),o(e),e}function y(e){const t=t=>e().update(p(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function g(e){const t=(t,r)=>e(r).update(p(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}function m(e){const t=(t,r)=>e(r).update(p(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}t.nextTick=async()=>{},t.Hash=class{},t.wrapConstructor=y,t.wrapConstructorWithOpts=g,t.wrapXOFConstructorWithOpts=m},110:(e,t,r)=>{"use strict";var n,i=r(8704).F,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(e){e()}function f(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var u,h=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var l=t.map(function(e,i){var s=i<t.length-1;return function(e,t,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;e.on("close",function(){a=!0}),void 0===n&&(n=r(2862)),n(e,{readable:t,writable:i},function(e){if(e)return s(e);a=!0,s()});var c=!1;return function(t){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void s(t||new o("pipe"))}}(e,s,i>0,function(e){u||(u=e),e&&l.forEach(c),s||(l.forEach(c),h(u))})});return t.reduce(f)}},212:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=r(4686),o=n(r(4406)),a=r(2655),c=r(6761),f=n(r(7264));class u extends f.default{constructor(){super(),this.authType="DilithiumVerificationKey2025"}static async createFromEntropy(e){const t=new u;var r;t.entropy=e,t.capability="private",t.seed=(r=e,(0,i.hash)("sha512",r)),t.signer=(0,c.generateDilithiumKeyPair)(t.seed.slice(0,32));const n=o.default.box.keyPair.fromSecretKey(t.seed.slice(32,64));return t.cypher={publicKey:s.Buffer.from(n.publicKey),secretKey:s.Buffer.from(n.secretKey)},t}static generate(){return u.createFromEntropy((0,i.randomBytes)(32))}getSecret(){return s.Buffer.from((0,a.encode)({v:this.version,s:this.seed}))}get id(){return s.Buffer.from((0,a.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,a.decode)(e),r=new u;r.version=t.v??0,r.capability="private",r.seed=s.Buffer.from(t.s),r.signer=(0,c.generateDilithiumKeyPair)(r.seed.slice(0,32));const n=r.seed.slice(32,64),i=o.default.box.keyPair.fromSecretKey(n);return r.cypher={publicKey:s.Buffer.from(i.publicKey),secretKey:s.Buffer.from(i.secretKey)},r}static instantiate(e){const t=new u;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?s.Buffer.from(e.signer.publicKey.data):s.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?s.Buffer.from(e.cypher.publicKey.data):s.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,a.decode)(e),r=new u;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}getSigner(){return this.signer.secretKey,Promise.resolve({sign:e=>Promise.resolve((0,c.signDilithium)(e,this.signer.secretKey))})}verify(e,t,r){return(0,c.verifyDilithium)(e,t,this.signer.publicKey)}}t.default=u},347:(e,t,r)=>{var n=r(4686).Buffer,i=r(8558),s=r(5727),o=r(6141),a=r(6192),c=r(4635),f=n.from&&n.from!==Uint8Array.from?n.from([0]):new n([0]),u=function(e,t){e._corked?e.once("uncork",t):t()},h=function(e,t){return function(r){r?function(e,t){e._autoDestroy&&e.destroy(t)}(e,"premature close"===r.message?null:r):t&&!e._ended&&e.end()}},l=function(){},d=function(e,t,r){if(!(this instanceof d))return new d(e,t,r);s.Duplex.call(this,r),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!r||!1!==r.autoDestroy,this._forwardDestroy=!r||!1!==r.destroy,this._forwardEnd=!r||!1!==r.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,e&&this.setWritable(e),t&&this.setReadable(t)};a(d,s.Duplex),d.obj=function(e,t,r){return r||(r={}),r.objectMode=!0,r.highWaterMark=16,new d(e,t,r)},d.prototype.cork=function(){1===++this._corked&&this.emit("cork")},d.prototype.uncork=function(){this._corked&&0===--this._corked&&this.emit("uncork")},d.prototype.setWritable=function(e){if(this._unwrite&&this._unwrite(),this.destroyed)e&&e.destroy&&e.destroy();else if(null!==e&&!1!==e){var t=this,r=o(e,{writable:!0,readable:!1},h(this,this._forwardEnd)),n=function(){var e=t._ondrain;t._ondrain=null,e&&e()};this._unwrite&&i.nextTick(n),this._writable=e,this._writable.on("drain",n),this._unwrite=function(){t._writable.removeListener("drain",n),r()},this.uncork()}else this.end()},d.prototype.setReadable=function(e){if(this._unread&&this._unread(),this.destroyed)e&&e.destroy&&e.destroy();else{if(null===e||!1===e)return this.push(null),void this.resume();var t,r=this,n=o(e,{writable:!1,readable:!0},h(this)),i=function(){r._forward()},a=function(){r.push(null)};this._drained=!0,this._readable=e,this._readable2=e._readableState?e:(t=e,new s.Readable({objectMode:!0,highWaterMark:16}).wrap(t)),this._readable2.on("readable",i),this._readable2.on("end",a),this._unread=function(){r._readable2.removeListener("readable",i),r._readable2.removeListener("end",a),n()},this._forward()}},d.prototype._read=function(){this._drained=!0,this._forward()},d.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var e;for(this._forwarding=!0;this._drained&&null!==(e=c(this._readable2));)this.destroyed||(this._drained=this.push(e));this._forwarding=!1}},d.prototype.destroy=function(e,t){if(t||(t=l),this.destroyed)return t(null);this.destroyed=!0;var r=this;i.nextTick(function(){r._destroy(e),t(null)})},d.prototype._destroy=function(e){if(e){var t=this._ondrain;this._ondrain=null,t?t(e):this.emit("error",e)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},d.prototype._write=function(e,t,r){if(!this.destroyed)return this._corked?u(this,this._write.bind(this,e,t,r)):e===f?this._finish(r):this._writable?void(!1===this._writable.write(e)?this._ondrain=r:this.destroyed||r()):r()},d.prototype._finish=function(e){var t=this;this.emit("preend"),u(this,function(){var r,n;n=function(){!1===t._writableState.prefinished&&(t._writableState.prefinished=!0),t.emit("prefinish"),u(t,e)},(r=t._forwardEnd&&t._writable)?r._writableState&&r._writableState.finished?n():r._writableState?r.end(n):(r.end(),n()):n()})},d.prototype.end=function(e,t,r){return"function"==typeof e?this.end(null,null,e):"function"==typeof t?this.end(e,null,t):(this._ended=!0,e&&this.write(e),this._writableState.ending||this._writableState.destroyed||this.write(f),s.Writable.prototype.end.call(this,r))},e.exports=d},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XOF256=t.XOF128=t.genCrystals=void 0;const n=r(5391),i=r(6215);function s(e,t=8){const r=e.toString(2).padStart(8,"0").slice(-t).padStart(7,"0").split("").reverse().join("");return Number.parseInt(r,2)}t.genCrystals=e=>{const{newPoly:t,N:r,Q:n,F:o,ROOT_OF_UNITY:a,brvBits:c,isKyber:f}=e,u=(e,t=n)=>{const r=e%t|0;return 0|(r>=0?r:t+r)},h=function(){const e=t(r);for(let t=0;t<r;t++){const r=s(t,c),i=BigInt(a)**BigInt(r)%BigInt(n);e[t]=0|Number(i)}return e}(),l=f?128:r,d=f?1:0,p={encode:e=>{for(let t=1,n=128;n>d;n>>=1)for(let i=0;i<r;i+=2*n){const r=h[t++];for(let t=i;t<i+n;t++){const i=u(r*e[t+n]);e[t+n]=0|u(e[t]-i),e[t]=0|u(e[t]+i)}}return e},decode:e=>{for(let t=l-1,n=1+d;n<l+d;n<<=1)for(let i=0;i<r;i+=2*n){const r=h[t--];for(let t=i;t<i+n;t++){const i=e[t];e[t]=u(i+e[t+n]),e[t+n]=u(r*(e[t+n]-i))}}for(let t=0;t<e.length;t++)e[t]=u(o*e[t]);return e}};return{mod:u,smod:(e,t=n)=>{const r=0|u(e,t);return 0|(r>t>>1?r-t:r)},nttZetas:h,NTT:p,bitsCoder:(e,n)=>{const s=(0,i.getMask)(e),o=e*(r/8);return{bytesLen:o,encode:t=>{const r=new Uint8Array(o);for(let o=0,a=0,c=0,f=0;o<t.length;o++)for(a|=(n.encode(t[o])&s)<<c,c+=e;c>=8;c-=8,a>>=8)r[f++]=a&(0,i.getMask)(c);return r},decode:i=>{const o=t(r);for(let t=0,r=0,a=0,c=0;t<i.length;t++)for(r|=i[t]<<a,a+=8;a>=e;a-=e,r>>=e)o[c++]=n.decode(r&s);return o}}}}};const o=e=>(t,r)=>{r||(r=e.blockLen);const n=new Uint8Array(t.length+2);n.set(t);const i=t.length,s=new Uint8Array(r);let o=e.create({}),a=0,c=0;return{stats:()=>({calls:a,xofs:c}),get:(t,r)=>(n[i+0]=t,n[i+1]=r,o.destroy(),o=e.create({}).update(n),a++,()=>(c++,o.xofInto(s))),clean:()=>{o.destroy(),s.fill(0),n.fill(0)}}};t.XOF128=o(n.shake128),t.XOF256=o(n.shake256)},407:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.negateCt=a,t.normalizeZ=function(e,t,r){const n="pz"===t?e=>e.pz:e=>e.ez,s=(0,i.FpInvertBatch)(e.Fp,r.map(n));return r.map((e,t)=>e.toAffine(s[t])).map(e.fromAffine)},t.wNAF=function(e,t){return{constTimeNegate:a,hasPrecomputes:e=>1!==y(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>s;)r&o&&(n=n.add(i)),i=i.double(),r>>=o;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=f(r,t),s=[];let o=e,a=o;for(let e=0;e<n;e++){a=o,s.push(a);for(let e=1;e<i;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(r,n,i){let s=e.ZERO,o=e.BASE;const c=f(r,t);for(let e=0;e<c.windows;e++){const{nextN:t,offset:r,isZero:f,isNeg:h,isNegF:l,offsetF:d}=u(i,e,c);i=t,f?o=o.add(a(l,n[d])):s=s.add(a(h,n[r]))}return g(i),{p:s,f:o}},wNAFUnsafe(r,n,i,o=e.ZERO){const a=f(r,t);for(let e=0;e<a.windows&&i!==s;e++){const{nextN:t,offset:r,isZero:s,isNeg:c}=u(i,e,a);if(i=t,!s){const e=n[r];o=o.add(c?e.negate():e)}}return g(i),o},getPrecomputes(e,t,r){let n=d.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),d.set(t,n))),n},wNAFCached(e,t,r){const n=y(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=y(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){c(r,t),p.set(e,r),d.delete(e)}}},t.mulEndoUnsafe=function(e,t,r,n){let i=t,a=e.ZERO,c=e.ZERO;for(;r>s||n>s;)r&o&&(a=a.add(i)),n&o&&(c=c.add(i)),i=i.double(),r>>=o,n>>=o;return{p1:a,p2:c}},t.pippenger=function(e,t,r,i){h(r,e),l(i,t);const s=r.length,o=i.length;if(s!==o)throw new Error("arrays of points and scalars must have equal length");const a=e.ZERO,c=(0,n.bitLen)(BigInt(s));let f=1;c>12?f=c-3:c>4?f=c-2:c>0&&(f=2);const u=(0,n.bitMask)(f),d=new Array(Number(u)+1).fill(a);let p=a;for(let e=Math.floor((t.BITS-1)/f)*f;e>=0;e-=f){d.fill(a);for(let t=0;t<o;t++){const n=i[t],s=Number(n>>BigInt(e)&u);d[s]=d[s].add(r[t])}let t=a;for(let e=d.length-1,r=a;e>0;e--)r=r.add(d[e]),t=t.add(r);if(p=p.add(t),0!==e)for(let e=0;e<f;e++)p=p.double()}return p},t.precomputeMSMUnsafe=function(e,t,r,i){c(i,t.BITS),h(r,e);const s=e.ZERO,o=2**i-1,a=Math.ceil(t.BITS/i),f=(0,n.bitMask)(i),u=r.map(e=>{const t=[];for(let r=0,n=e;r<o;r++)t.push(n),n=n.add(e);return t});return e=>{if(l(e,t),e.length>r.length)throw new Error("array of scalars must be smaller than array of points");let n=s;for(let t=0;t<a;t++){if(n!==s)for(let e=0;e<i;e++)n=n.double();const r=BigInt(a*i-(t+1)*i);for(let t=0;t<e.length;t++){const i=e[t],s=Number(i>>r&f);s&&(n=n.add(u[t][s-1]))}}return n}},t.validateBasic=function(e){return(0,i.validateField)(e.Fp),(0,n.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,i.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})},t._createCurveFields=function(e,t,r={}){if(!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const r=t[e];if(!("bigint"==typeof r&&r>s))throw new Error(`CURVE.${e} must be positive bigint`)}const n=m(t.p,r.Fp),i=m(t.n,r.Fn),o=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const e of o)if(!n.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}};const n=r(6376),i=r(7342),s=BigInt(0),o=BigInt(1);function a(e,t){const r=t.negate();return e?r:t}function c(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function f(e,t){c(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:(0,n.bitMask)(e),maxNumber:r,shiftBy:BigInt(e)}}function u(e,t,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:a}=r;let c=Number(e&i),f=e>>a;c>n&&(c-=s,f+=o);const u=t*n;return{nextN:f,offset:u+Math.abs(c)-1,isZero:0===c,isNeg:c<0,isNegF:t%2!=0,offsetF:u}}function h(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})}function l(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}const d=new WeakMap,p=new WeakMap;function y(e){return p.get(e)||1}function g(e){if(e!==s)throw new Error("invalid wNAF")}function m(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,i.validateField)(t),t}return(0,i.Field)(e)}},568:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.isBufferOrUint8Array=function(e){return e instanceof n||e instanceof Uint8Array},t.chunkBuffer=function(e,t){if(void 0===e)return e;let r=e instanceof n?e:n.from(e);const i=[];for(;r.length>t;){const e=r.slice(0,t);r=r.slice(t),i.push(e)}return r.length&&i.push(r),i},t.chunkString=function(e,t){const r=[];for(;e.length>t;){const n=e.substr(0,t);e=e.substr(t),r.push(n)}return e.length&&r.push(e),r}},790:(e,t)=>{"use strict";t.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},t.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36,SET:258},t.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},t.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},t.SYMS={NULL:Symbol.for("github.com/hildjj/node-cbor/null"),UNDEFINED:Symbol.for("github.com/hildjj/node-cbor/undef"),PARENT:Symbol.for("github.com/hildjj/node-cbor/parent"),BREAK:Symbol.for("github.com/hildjj/node-cbor/break"),STREAM:Symbol.for("github.com/hildjj/node-cbor/stream")},t.SHIFT32=4294967296,t.BI={MINUS_ONE:BigInt(-1),NEG_MAX:BigInt(-1)-BigInt(Number.MAX_SAFE_INTEGER),MAXINT32:BigInt("0xffffffff"),MAXINT64:BigInt("0xffffffffffffffff"),SHIFT32:BigInt(t.SHIFT32)}},896:(e,t,r)=>{e.exports=i;var n=r(9784).EventEmitter;function i(){n.call(this)}r(6192)(i,n),i.Readable=r(4324),i.Writable=r(6868),i.Duplex=r(5606),i.Transform=r(4914),i.PassThrough=r(9648),i.finished=r(2862),i.pipeline=r(110),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",s),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",c));var o=!1;function a(){o||(o=!0,e.end())}function c(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function f(e){if(u(),0===n.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",i),e.removeListener("drain",s),r.removeListener("end",a),r.removeListener("close",c),r.removeListener("error",f),e.removeListener("error",f),r.removeListener("end",u),r.removeListener("close",u),e.removeListener("close",u)}return r.on("error",f),e.on("error",f),r.on("end",u),r.on("close",u),e.on("close",u),e.emit("pipe",r),e}},931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageType=void 0;const n=r(2655),i=r(4072);var s;!function(e){e[e.ENCRYPTION=0]="ENCRYPTION",e[e.ATTACHED_SIGNING=1]="ATTACHED_SIGNING",e[e.DETACHED_SIGNING=2]="DETACHED_SIGNING",e[e.SIGNCRYPTION=3]="SIGNCRYPTION"}(s||(t.MessageType=s={})),t.default=class{static decode1(e,t=!1){const r=t?e:(0,n.decode)(e),s=i.sha512.create().update(r).digest(),o=(0,n.decode)(r);if(!(o instanceof Array)||o.length<3)throw new Error("Invalid data");const[a,c,f]=o;if("saltpack"!==a)throw new Error("Invalid data");if(!(c instanceof Array)||2!==c.length)throw new Error("Invalid data");if(2!==c[0])throw new Error("Unsupported version");if(0!==c[1])throw new Error("Unsupported version");if("number"!=typeof f)throw new Error("Invalid data");return[s,o]}}},1163:(e,t,r)=>{"use strict";const n=r(790),i=r(8590),s=Symbol("INTERNAL_JSON");function o(e,t){if(i.isBufferish(e))e.toJSON=t;else if(Array.isArray(e))for(const r of e)o(r,t);else if(e&&"object"==typeof e&&(!(e instanceof p)||e.tag<21||e.tag>23))for(const r of Object.values(e))o(r,t)}function a(){return i.base64(this)}function c(){return i.base64url(this)}function f(){return this.toString("hex")}const u={0:e=>new Date(e),1:e=>new Date(1e3*e),2:e=>i.bufferToBigInt(e),3:e=>n.BI.MINUS_ONE-i.bufferToBigInt(e),21:(e,t)=>(i.isBufferish(e)?t[s]=c:o(e,c),t),22:(e,t)=>(i.isBufferish(e)?t[s]=a:o(e,a),t),23:(e,t)=>(i.isBufferish(e)?t[s]=f:o(e,f),t),32:e=>new URL(e),33:(e,t)=>{if(!e.match(/^[a-zA-Z0-9_-]+$/))throw new Error("Invalid base64url characters");const r=e.length%4;if(1===r)throw new Error("Invalid base64url length");if(2===r){if(-1==="AQgw".indexOf(e[e.length-1]))throw new Error("Invalid base64 padding")}else if(3===r&&-1==="AEIMQUYcgkosw048".indexOf(e[e.length-1]))throw new Error("Invalid base64 padding");return t},34:(e,t)=>{const r=e.match(/^[a-zA-Z0-9+/]+(?<padding>={0,2})$/);if(!r)throw new Error("Invalid base64 characters");if(e.length%4!=0)throw new Error("Invalid base64 length");if("="===r.groups.padding){if(-1==="AQgw".indexOf(e[e.length-2]))throw new Error("Invalid base64 padding")}else if("=="===r.groups.padding&&-1==="AEIMQUYcgkosw048".indexOf(e[e.length-3]))throw new Error("Invalid base64 padding");return t},35:e=>new RegExp(e),258:e=>new Set(e)},h={64:Uint8Array,65:Uint16Array,66:Uint32Array,68:Uint8ClampedArray,69:Uint16Array,70:Uint32Array,72:Int8Array,73:Int16Array,74:Int32Array,77:Int16Array,78:Int32Array,81:Float32Array,82:Float64Array,85:Float32Array,86:Float64Array};function l(e,t){if(!i.isBufferish(e))throw new TypeError("val not a buffer");const{tag:r}=t,n=h[r];if(!n)throw new Error(`Invalid typed array tag: ${r}`);const s=2**(((16&r)>>4)+(3&r));return!(4&r)!==i.isBigEndian()&&s>1&&function(e,t,r,n){const i=new DataView(e),[s,o]={2:[i.getUint16,i.setUint16],4:[i.getUint32,i.setUint32],8:[i.getBigUint64,i.setBigUint64]}[t],a=r+n;for(let e=r;e<a;e+=t)o.call(i,e,s.call(i,e,!0))}(e.buffer,s,e.byteOffset,e.byteLength),new n(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}"undefined"!=typeof BigUint64Array&&(h[67]=BigUint64Array,h[71]=BigUint64Array),"undefined"!=typeof BigInt64Array&&(h[75]=BigInt64Array,h[79]=BigInt64Array);for(const e of Object.keys(h))u[e]=l;let d={};class p{constructor(e,t,r){if(this.tag=e,this.value=t,this.err=r,"number"!=typeof this.tag)throw new Error(`Invalid tag type (${typeof this.tag})`);if(this.tag<0||(0|this.tag)!==this.tag)throw new Error(`Tag must be a positive integer: ${this.tag}`)}toJSON(){if(this[s])return this[s].call(this.value);const e={tag:this.tag,value:this.value};return this.err&&(e.err=this.err),e}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){let t=null==e?void 0:e[this.tag];if(null===t)return this;if("function"!=typeof t&&(t=p.TAGS[this.tag],"function"!=typeof t))return this;try{return t.call(this,this.value,this)}catch(e){return e&&e.message&&e.message.length>0?this.err=e.message:this.err=e,this}}static get TAGS(){return d}static set TAGS(e){d=e}static reset(){p.TAGS={...u}}}p.INTERNAL_JSON=s,p.reset(),e.exports=p},1164:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DER=t.DERErr=void 0,t._legacyHelperEquat=p,t._legacyHelperNormPriv=y,t.weierstrassN=g,t.weierstrassPoints=function(e){const{CURVE:t,curveOpts:r}=w(e);return function(e,t){const{Fp:r,Fn:n}=t;const s=p(r,e.a,e.b),o=y(n,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:o,weierstrassEquation:s,isWithinCurveOrder:function(e){return(0,i.inRange)(e,u,n.ORDER)}})}(e,g(t,r))},t.ecdsa=b,t.weierstrass=function(e){const{CURVE:t,curveOpts:r,ecdsaOpts:n}=function(e){const{CURVE:t,curveOpts:r}=w(e);return{CURVE:t,curveOpts:r,ecdsaOpts:{hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}(e);return function(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}(e,b(g(t,r),n,r))},t.SWUFpSqrtRatio=_,t.mapToCurveSimpleSWU=function(e,t){(0,o.validateField)(e);const{A:r,B:n,Z:i}=t;if(!e.isValid(r)||!e.isValid(n)||!e.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const s=_(e,i);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return t=>{let a,c,f,u,h,l,d,p;a=e.sqr(t),a=e.mul(a,i),c=e.sqr(a),c=e.add(c,a),f=e.add(c,e.ONE),f=e.mul(f,n),u=e.cmov(i,e.neg(c),!e.eql(c,e.ZERO)),u=e.mul(u,r),c=e.sqr(f),l=e.sqr(u),h=e.mul(l,r),c=e.add(c,h),c=e.mul(c,f),l=e.mul(l,u),h=e.mul(l,n),c=e.add(c,h),d=e.mul(a,f);const{isValid:y,value:g}=s(c,l);p=e.mul(a,t),p=e.mul(p,g),d=e.cmov(d,f,y),p=e.cmov(p,g,y);const m=e.isOdd(t)===e.isOdd(p);p=e.cmov(e.neg(p),p,m);const b=(0,o.FpInvertBatch)(e,[u],!0)[0];return d=e.mul(d,b),{x:d,y:p}}};const n=r(3835),i=r(6376),s=r(407),o=r(7342);function a(e){void 0!==e.lowS&&(0,i.abool)("lowS",e.lowS),void 0!==e.prehash&&(0,i.abool)("prehash",e.prehash)}class c extends Error{constructor(e=""){super(e)}}t.DERErr=c,t.DER={Err:c,_tlv:{encode:(e,r)=>{const{Err:n}=t.DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&r.length)throw new n("tlv.encode: unpadded data");const s=r.length/2,o=(0,i.numberToHexUnpadded)(s);if(o.length/2&128)throw new n("tlv.encode: long form length too big");const a=s>127?(0,i.numberToHexUnpadded)(o.length/2|128):"";return(0,i.numberToHexUnpadded)(e)+a+o+r},decode(e,r){const{Err:n}=t.DER;let i=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(r.length<2||r[i++]!==e)throw new n("tlv.decode: wrong tlv");const s=r[i++];let o=0;if(128&s){const e=127&s;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const t=r.subarray(i,i+e);if(t.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===t[0])throw new n("tlv.decode(long): zero leftmost byte");for(const e of t)o=o<<8|e;if(i+=e,o<128)throw new n("tlv.decode(long): not minimal encoding")}else o=s;const a=r.subarray(i,i+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:r.subarray(i+o)}}},_int:{encode(e){const{Err:r}=t.DER;if(e<f)throw new r("integer: negative integers are not allowed");let n=(0,i.numberToHexUnpadded)(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new r("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:r}=t.DER;if(128&e[0])throw new r("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new r("invalid signature integer: unnecessary leading zero");return(0,i.bytesToNumberBE)(e)}},toSig(e){const{Err:r,_int:n,_tlv:s}=t.DER,o=(0,i.ensureBytes)("signature",e),{v:a,l:c}=s.decode(48,o);if(c.length)throw new r("invalid signature: left bytes after parsing");const{v:f,l:u}=s.decode(2,a),{v:h,l}=s.decode(2,u);if(l.length)throw new r("invalid signature: left bytes after parsing");return{r:n.decode(f),s:n.decode(h)}},hexFromSig(e){const{_tlv:r,_int:n}=t.DER,i=r.encode(2,n.encode(e.r))+r.encode(2,n.encode(e.s));return r.encode(48,i)}};const f=BigInt(0),u=BigInt(1),h=BigInt(2),l=BigInt(3),d=BigInt(4);function p(e,t,r){return function(n){const i=e.sqr(n),s=e.mul(i,n);return e.add(e.add(s,e.mul(n,t)),r)}}function y(e,t,r){const{BYTES:n}=e;return function(s){let o;if("bigint"==typeof s)o=s;else{let r=(0,i.ensureBytes)("private key",s);if(t){if(!t.includes(2*r.length))throw new Error("invalid private key");const e=new Uint8Array(n);e.set(r,e.length-r.length),r=e}try{o=e.fromBytes(r)}catch(e){throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof s}`)}}if(r&&(o=e.create(o)),!e.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}}function g(e,t={}){const{Fp:r,Fn:n}=(0,s._createCurveFields)("weierstrass",e,t),{h:o,n:a}=e;(0,i._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=t;if(c&&(!r.is0(e.a)||"bigint"!=typeof c.beta||"function"!=typeof c.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function h(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const g=t.toBytes||function(e,t,n){const{x:s,y:o}=t.toAffine(),a=r.toBytes(s);if((0,i.abool)("isCompressed",n),n){h();const e=!r.isOdd(o);return(0,i.concatBytes)(m(e),a)}return(0,i.concatBytes)(Uint8Array.of(4),a,r.toBytes(o))},b=t.fromBytes||function(e){(0,i.abytes)(e);const t=r.BYTES,n=t+1,s=2*t+1,o=e.length,a=e[0],c=e.subarray(1);if(o!==n||2!==a&&3!==a){if(o===s&&4===a){const e=r.fromBytes(c.subarray(0*t,1*t)),n=r.fromBytes(c.subarray(1*t,2*t));if(!_(e,n))throw new Error("bad point: is not on curve");return{x:e,y:n}}throw new Error(`bad point: got length ${o}, expected compressed=${n} or uncompressed=${s}`)}{const e=r.fromBytes(c);if(!r.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=w(e);let n;try{n=r.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}return h(),!(1&~a)!==r.isOdd(n)&&(n=r.neg(n)),{x:e,y:n}}},w=p(r,e.a,e.b);function _(e,t){const n=r.sqr(t),i=w(e);return r.eql(n,i)}if(!_(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const v=r.mul(r.pow(e.a,l),d),E=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(v,E)))throw new Error("bad curve params: a or b");function S(e,t,n=!1){if(!r.isValid(t)||n&&r.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function B(e){if(!(e instanceof T))throw new Error("ProjectivePoint expected")}const A=(0,i.memoized)((e,t)=>{const{px:n,py:i,pz:s}=e;if(r.eql(s,r.ONE))return{x:n,y:i};const o=e.is0();null==t&&(t=o?r.ONE:r.inv(s));const a=r.mul(n,t),c=r.mul(i,t),f=r.mul(s,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(f,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}}),I=(0,i.memoized)(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not field elements");if(!_(n,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function x(e,t,n,i,o){return n=new T(r.mul(n.px,e),n.py,n.pz),t=(0,s.negateCt)(i,t),n=(0,s.negateCt)(o,n),t.add(n)}class T{constructor(e,t,r){this.px=S("x",e),this.py=S("y",t,!0),this.pz=S("z",r),Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof T)throw new Error("projective point not allowed");return r.is0(t)&&r.is0(n)?T.ZERO:new T(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){return(0,s.normalizeZ)(T,"pz",e)}static fromBytes(e){return(0,i.abytes)(e),T.fromHex(e)}static fromHex(e){const t=T.fromAffine(b((0,i.ensureBytes)("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){const r=y(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return T.BASE.multiply(r(e))}static msm(e,t){return(0,s.pippenger)(T,n,e,t)}precompute(e=8,t=!0){return k.setWindowSize(this,e),t||this.multiply(l),this}_setWindowSize(e){this.precompute(e)}assertValidity(){I(this)}hasEvenY(){const{y:e}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){B(e);const{px:t,py:n,pz:i}=this,{px:s,py:o,pz:a}=e,c=r.eql(r.mul(t,a),r.mul(s,i)),f=r.eql(r.mul(n,a),r.mul(o,i));return c&&f}negate(){return new T(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,l),{px:s,py:o,pz:a}=this;let c=r.ZERO,f=r.ZERO,u=r.ZERO,h=r.mul(s,s),d=r.mul(o,o),p=r.mul(a,a),y=r.mul(s,o);return y=r.add(y,y),u=r.mul(s,a),u=r.add(u,u),c=r.mul(t,u),f=r.mul(i,p),f=r.add(c,f),c=r.sub(d,f),f=r.add(d,f),f=r.mul(c,f),c=r.mul(y,c),u=r.mul(i,u),p=r.mul(t,p),y=r.sub(h,p),y=r.mul(t,y),y=r.add(y,u),u=r.add(h,h),h=r.add(u,h),h=r.add(h,p),h=r.mul(h,y),f=r.add(f,h),p=r.mul(o,a),p=r.add(p,p),h=r.mul(p,y),c=r.sub(c,h),u=r.mul(p,d),u=r.add(u,u),u=r.add(u,u),new T(c,f,u)}add(t){B(t);const{px:n,py:i,pz:s}=this,{px:o,py:a,pz:c}=t;let f=r.ZERO,u=r.ZERO,h=r.ZERO;const d=e.a,p=r.mul(e.b,l);let y=r.mul(n,o),g=r.mul(i,a),m=r.mul(s,c),b=r.add(n,i),w=r.add(o,a);b=r.mul(b,w),w=r.add(y,g),b=r.sub(b,w),w=r.add(n,s);let _=r.add(o,c);return w=r.mul(w,_),_=r.add(y,m),w=r.sub(w,_),_=r.add(i,s),f=r.add(a,c),_=r.mul(_,f),f=r.add(g,m),_=r.sub(_,f),h=r.mul(d,w),f=r.mul(p,m),h=r.add(f,h),f=r.sub(g,h),h=r.add(g,h),u=r.mul(f,h),g=r.add(y,y),g=r.add(g,y),m=r.mul(d,m),w=r.mul(p,w),g=r.add(g,m),m=r.sub(y,m),m=r.mul(d,m),w=r.add(w,m),y=r.mul(g,w),u=r.add(u,y),y=r.mul(_,w),f=r.mul(b,f),f=r.sub(f,y),y=r.mul(b,g),h=r.mul(_,h),h=r.add(h,y),new T(f,u,h)}subtract(e){return this.add(e.negate())}is0(){return this.equals(T.ZERO)}multiply(e){const{endo:r}=t;if(!n.isValidNot0(e))throw new Error("invalid scalar: out of range");let i,s;const o=e=>k.wNAFCached(this,e,T.normalizeZ);if(r){const{k1neg:t,k1:n,k2neg:a,k2:c}=r.splitScalar(e),{p:f,f:u}=o(n),{p:h,f:l}=o(c);s=u.add(l),i=x(r.beta,f,h,t,a)}else{const{p:t,f:r}=o(e);i=t,s=r}return T.normalizeZ([i,s])[0]}multiplyUnsafe(e){const{endo:r}=t,i=this;if(!n.isValid(e))throw new Error("invalid scalar: out of range");if(e===f||i.is0())return T.ZERO;if(e===u)return i;if(k.hasPrecomputes(this))return this.multiply(e);if(r){const{k1neg:t,k1:n,k2neg:o,k2:a}=r.splitScalar(e),{p1:c,p2:f}=(0,s.mulEndoUnsafe)(T,i,n,a);return x(r.beta,c,f,t,o)}return k.wNAFCachedUnsafe(i,e)}multiplyAndAddUnsafe(e,t,r){const n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(e){return A(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return o===u||(e?e(T,this):k.wNAFCachedUnsafe(this,a).is0())}clearCofactor(){const{clearCofactor:e}=t;return o===u?this:e?e(T,this):this.multiplyUnsafe(o)}toBytes(e=!0){return(0,i.abool)("isCompressed",e),this.assertValidity(),g(T,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return(0,i.bytesToHex)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}T.BASE=new T(e.Gx,e.Gy,r.ONE),T.ZERO=new T(r.ZERO,r.ONE,r.ZERO),T.Fp=r,T.Fn=n;const O=n.BITS,k=(0,s.wNAF)(T,t.endo?Math.ceil(O/2):O);return T}function m(e){return Uint8Array.of(e?2:3)}function b(e,r,s={}){(0,i._validateObject)(r,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const c=r.randomBytes||i.randomBytes,l=r.hmac||((e,...t)=>(0,n.hmac)(r.hash,e,(0,i.concatBytes)(...t))),{Fp:d,Fn:p}=e,{ORDER:g,BITS:b}=p;function w(e){return e>g>>u}function _(e,t){if(!p.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..CURVE.n`)}class v{constructor(e,t,r){_("r",e),_("s",t),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){const t=p.BYTES,r=(0,i.ensureBytes)("compactSignature",e,2*t);return new v(p.fromBytes(r.subarray(0,t)),p.fromBytes(r.subarray(t,2*t)))}static fromDER(e){const{r,s:n}=t.DER.toSig((0,i.ensureBytes)("DER",e));return new v(r,n)}assertValidity(){}addRecoveryBit(e){return new v(this.r,this.s,e)}recoverPublicKey(t){const r=d.ORDER,{r:n,s,recovery:o}=this;if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");if(g*h<r&&o>1)throw new Error("recovery id is ambiguous for h>1 curve");const a=2===o||3===o?n+g:n;if(!d.isValid(a))throw new Error("recovery id 2 or 3 invalid");const c=d.toBytes(a),f=e.fromHex((0,i.concatBytes)(m(!(1&o)),c)),u=p.inv(a),l=I((0,i.ensureBytes)("msgHash",t)),y=p.create(-l*u),b=p.create(s*u),w=e.BASE.multiplyUnsafe(y).add(f.multiplyUnsafe(b));if(w.is0())throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new v(this.r,p.neg(this.s),this.recovery):this}toBytes(e){if("compact"===e)return(0,i.concatBytes)(p.toBytes(this.r),p.toBytes(this.s));if("der"===e)return(0,i.hexToBytes)(t.DER.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,i.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,i.bytesToHex)(this.toBytes("compact"))}}const E=y(p,s.allowedPrivateKeyLengths,s.wrapPrivateKey),S={isValidPrivateKey(e){try{return E(e),!0}catch(e){return!1}},normPrivateKeyToScalar:E,randomPrivateKey:()=>{const e=g;return(0,o.mapHashToField)(c((0,o.getMinHashLength)(e)),e)},precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)};function B(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const r=(0,i.ensureBytes)("key",t).length,n=d.BYTES,o=n+1,a=2*n+1;return s.allowedPrivateKeyLengths||p.BYTES===o?void 0:r===o||r===a}const A=r.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=(0,i.bytesToNumberBE)(e),r=8*e.length-b;return r>0?t>>BigInt(r):t},I=r.bits2int_modN||function(e){return p.create(A(e))},x=(0,i.bitMask)(b);function T(e){return(0,i.aInRange)("num < 2^"+b,e,f,x),p.toBytes(e)}const O={lowS:r.lowS,prehash:!1},k={lowS:r.lowS,prehash:!1};return e.BASE.precompute(8),Object.freeze({getPublicKey:function(t,r=!0){return e.fromPrivateKey(t).toBytes(r)},getSharedSecret:function(t,r,n=!0){if(!0===B(t))throw new Error("first arg must be private key");if(!1===B(r))throw new Error("second arg must be public key");return e.fromHex(r).multiply(E(t)).toBytes(n)},sign:function(t,n,s=O){const{seed:o,k2sig:h}=function(t,n,s=O){if(["recovered","canonical"].some(e=>e in s))throw new Error("sign() legacy options not supported");const{hash:o}=r;let{lowS:h,prehash:l,extraEntropy:y}=s;null==h&&(h=!0),t=(0,i.ensureBytes)("msgHash",t),a(s),l&&(t=(0,i.ensureBytes)("prehashed msgHash",o(t)));const g=I(t),m=E(n),b=[T(m),T(g)];if(null!=y&&!1!==y){const e=!0===y?c(d.BYTES):y;b.push((0,i.ensureBytes)("extraEntropy",e))}const _=(0,i.concatBytes)(...b),S=g;return{seed:_,k2sig:function(t){const r=A(t);if(!p.isValidNot0(r))return;const n=p.inv(r),i=e.BASE.multiply(r).toAffine(),s=p.create(i.x);if(s===f)return;const o=p.create(n*p.create(S+s*m));if(o===f)return;let a=(i.x===s?0:2)|Number(i.y&u),c=o;return h&&w(o)&&(c=function(e){return w(e)?p.neg(e):e}(o),a^=1),new v(s,c,a)}}}(t,n,s);return(0,i.createHmacDrbg)(r.hash.outputLen,p.BYTES,l)(o,h)},verify:function(n,s,o,c=k){const f=n;s=(0,i.ensureBytes)("msgHash",s),o=(0,i.ensureBytes)("publicKey",o),a(c);const{lowS:u,prehash:h,format:l}=c;if("strict"in c)throw new Error("options.strict was renamed to lowS");if(void 0!==l&&!["compact","der","js"].includes(l))throw new Error('format must be "compact", "der" or "js"');const d="string"==typeof f||(0,i.isBytes)(f),y=!d&&!l&&"object"==typeof f&&null!==f&&"bigint"==typeof f.r&&"bigint"==typeof f.s;if(!d&&!y)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let g,m;try{if(y){if(void 0!==l&&"js"!==l)throw new Error("invalid format");g=new v(f.r,f.s)}if(d){try{"compact"!==l&&(g=v.fromDER(f))}catch(e){if(!(e instanceof t.DER.Err))throw e}g||"der"===l||(g=v.fromCompact(f))}m=e.fromHex(o)}catch(e){return!1}if(!g)return!1;if(u&&g.hasHighS())return!1;h&&(s=r.hash(s));const{r:b,s:w}=g,_=I(s),E=p.inv(w),S=p.create(_*E),B=p.create(b*E),A=e.BASE.multiplyUnsafe(S).add(m.multiplyUnsafe(B));return!A.is0()&&p.create(A.x)===b},utils:S,Point:e,Signature:v})}function w(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:(0,o.Field)(t.n,e.nBitLength),allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}function _(e,t){const r=e.ORDER;let n=f;for(let e=r-u;e%h===f;e/=h)n+=u;const i=n,s=h<<i-u-u,o=s*h,a=(r-u)/o,c=(a-u)/h,p=o-u,y=s,g=e.pow(t,a),m=e.pow(t,(a+u)/h);let b=(t,r)=>{let n=g,s=e.pow(r,p),o=e.sqr(s);o=e.mul(o,r);let a=e.mul(t,o);a=e.pow(a,c),a=e.mul(a,s),s=e.mul(a,r),o=e.mul(a,t);let f=e.mul(o,s);a=e.pow(f,y);let l=e.eql(a,e.ONE);s=e.mul(o,m),a=e.mul(f,n),o=e.cmov(s,o,l),f=e.cmov(a,f,l);for(let t=i;t>u;t--){let r=t-h;r=h<<r-u;let i=e.pow(f,r);const a=e.eql(i,e.ONE);s=e.mul(o,n),n=e.mul(n,n),i=e.mul(f,n),o=e.cmov(s,o,a),f=e.cmov(i,f,a)}return{isValid:l,value:o}};if(e.ORDER%d===l){const r=(e.ORDER-l)/d,n=e.sqrt(e.neg(t));b=(t,i)=>{let s=e.sqr(i);const o=e.mul(t,i);s=e.mul(s,o);let a=e.pow(s,r);a=e.mul(a,o);const c=e.mul(a,n),f=e.mul(e.sqr(a),i),u=e.eql(f,t);return{isValid:u,value:e.cmov(c,a,u)}}}return b}},1167:(e,t,r)=>{"use strict";const n=r(9995),i=r(9055),s=r(5775),o=r(3271),a=r(9109),c=r(1163),f=r(5713),u=r(3105);e.exports={Commented:n,Diagnose:i,Decoder:s,Encoder:o,Simple:a,Tagged:c,Map:f,SharedValueEncoder:u,comment:n.comment,decodeAll:s.decodeAll,decodeFirst:s.decodeFirst,decodeAllSync:s.decodeAllSync,decodeFirstSync:s.decodeFirstSync,diagnose:i.diagnose,encode:o.encode,encodeCanonical:o.encodeCanonical,encodeOne:o.encodeOne,encodeAsync:o.encodeAsync,decode:s.decodeFirstSync,leveldb:{decode:s.decodeFirstSync,encode:o.encode,buffer:!0,name:"cbor"},reset(){o.reset(),c.reset()}}},1220:()=>{},1348:(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return!1}catch(e){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},1440:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp256r1=t.p256=void 0;const n=r(2355);t.p256=n.p256,t.secp256r1=n.p256,t.hashToCurve=n.p256_hasher.hashToCurve,t.encodeToCurve=n.p256_hasher.encodeToCurve},1449:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=n(r(1167)),o=n(r(4406)),a=r(7165),c=r(2655),f=n(r(7961)),u=r(4686),h=r(6761),l=n(r(7264)),d={usb:1,nfc:2,ble:4,internal:8,hybrid:16,"smart-card":32},p=e=>e.length<=65535?u.Buffer.from([197,e.length>>8,255&e.length,...e]):u.Buffer.from([198,e.length>>24&255,e.length>>16&255,e.length>>8&255,255&e.length,...e]),y=e=>{const t=u.Buffer.from([131,161,118,e.version]),r=u.Buffer.concat([u.Buffer.from([161,101]),p(e.cypher.publicKey)]),n=u.Buffer.concat([u.Buffer.from([161,99]),p(e.ckey)]);return u.Buffer.concat([t,n,r])},g=e=>Object.keys(d).filter(t=>e&&d[t]),m=e=>{const t=s.default.decode(e).get(1);return 1===t?"Ed25519VerificationKey2020":2===t?"P256VerificationKey2020":"Unknown"},b=e=>{const t=s.default.decode(e);let r=u.Buffer.from([]);return-7==t.get(3)?r=u.Buffer.concat([u.Buffer.from("04","hex"),t.get(-2),t.get(-3)]):-8==t.get(3)?r=t.get(-2):t.get(3)==h.PQ_COSE_ALG.DILITHIUM2&&(r=t.get(-101)),{publicKey:r}};class w extends l.default{constructor(){super(),this._transports=0,this.encType="X25519KeyAgreementKey2019",this.webAuthn=(0,a.getWebAuthnProvider)()}get transports(){return g(this._transports)}static async createFromAttestation(e){const t=new w;t.ckey=f.default.getCOSEPublicKey(e),t.authType=m(t.ckey),t.fid=u.Buffer.from(e.id,"base64");const r=e.response,n=r.getTransports?r.getTransports():["usb"];t._transports=(e=>e.reduceRight((e,t)=>e+(d[t]?d[t]:0),0))(n),t.signer=b(t.ckey);const s=(0,i.randomBytes)(32),a=(c=s,(0,i.hash)("sha512",c));var c;const h=o.default.box.keyPair.fromSecretKey(a.slice(0,32));return t.cypher={publicKey:u.Buffer.from(h.publicKey),secretKey:u.Buffer.from(h.secretKey)},t.entropy=s,t}get id(){return 0==this.version?y(this):u.Buffer.from((0,c.encode)({v:this.version,c:this.ckey,e:this.cypher.publicKey}))}get id_v0(){return y(this)}getSecret(){return u.Buffer.from((0,c.encode)({v:this.version,f:this.fid,t:this._transports,c:this.ckey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,c.decode)(e),r=new w;r.version=t.v??0,r.capability="private",r.fid="string"==typeof t.f?u.Buffer.from(t.f,"base64"):t.f,r._transports=t.t?t.t:15,r.ckey=t.c,r.authType=m(r.ckey),r.signer=b(t.c);const n=o.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:u.Buffer.from(n.publicKey),secretKey:u.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new w;return t.version=e.version??0,t.fid="string"==typeof e.fid?u.Buffer.from(e.fid,"base64"):e.fid,t._transports=e.t?e.t:15,t.ckey=e.ckey.data?u.Buffer.from(e.ckey.data):u.Buffer.from(e.ckey),t.signer=b(t.ckey),t.authType=m(t.ckey),t.cypher={publicKey:e.cypher.publicKey.data?u.Buffer.from(e.cypher.publicKey.data):u.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,c.decode)(e),r=new w;return r.version=t.v??0,r.capability="public",r.fid="string"==typeof t.f?u.Buffer.from(t.f,"base64"):t.f,r.ckey=t.c,r.signer=b(t.c),r.authType=m(r.ckey),r.cypher={publicKey:t.e},r}async getSigner(){return{sign:async e=>{if(!navigator.credentials)return null;try{await(window?.CredentialUserInteractionRequest())}catch(e){}const t={challenge:(0,i.hash)("sha256",e),userVerification:"preferred",allowCredentials:[{type:"public-key",id:this.fid,transports:g(this._transports)}]},{response:r}=await this.webAuthn.get(t),n=r,s={s:u.Buffer.from(n.signature),c:u.Buffer.from(n.clientDataJSON),a:u.Buffer.from(n.authenticatorData)};return u.Buffer.from((0,c.encode)(s))}}}verify(e,t,r=!1){const n=u.Buffer.from(t),s=(0,c.decode)(n),o={signature:s.s,clientDataJSON:s.c,authenticatorData:s.a,userHandle:u.Buffer.from([]).buffer};return(0,i.hash)("sha256",e).toString("base64")===f.default.extractChallenge(o.clientDataJSON)&&f.default.simpleVerify(this.ckey,o,r)}verifyCredentials(e,t=!1){if(e.id!==this.fid.toString("base64"))return!1;const r=e.response;var n;return u.Buffer.from(r.authenticatorData.slice(0,32)).toString("hex")===(n=u.Buffer.from(e.id,"base64"),(0,i.hash)("sha256",n)).toString("hex")&&f.default.simpleVerify(this.ckey,r,t)}async createRevocationCertificate(){return null}}t.default=w},1661:(e,t,r)=>{var n=r(5709);function i(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function s(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}e.exports=n(i),e.exports.strict=n(s),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return s(this)},configurable:!0})})},1866:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyMaterial=h,t.getKey=l,t.decrypt=async function(e,t){if(!e.encryptInfo)return e.data;try{const r=await h(t),n=f.Buffer.from(e.encryptInfo.salt,"base64"),i=f.Buffer.from(e.encryptInfo.iv,"base64"),s=await l(r,n),o=a.createDecipheriv("aes-256-gcm",s,i),c=16,u=e.data.subarray(0,e.data.length-c),d=e.data.subarray(e.data.length-c);return o.setAuthTag(d),f.Buffer.concat([o.update(u),o.final()])}catch(e){return console.error("Decryption error:",e),null}},t.encrypt=async function(e,t){if(!e)return;const r=(0,u.randomBytes)(16),n=(0,u.randomBytes)(12),i=await h(e),s=await l(i,r),o=a.createCipheriv("aes-256-gcm",s,n),d=f.Buffer.concat([o.update(t),o.final()]),p=o.getAuthTag(),y=f.Buffer.concat([d,p]);return{version:1,encryptInfo:{...c.encryptInfo,iv:n.toString("base64"),salt:r.toString("base64")},data:y}};const a=o(r(4203)),c=r(5617),f=r(4686),u=r(5598);function h(e){const t=f.Buffer.from(e,"utf-8");return Promise.resolve(a.createSecretKey(t))}function l(e,t){return new Promise(r=>{const n=a.pbkdf2Sync(e.export(),t,c.encryptInfo.ITERATIONS,c.encryptInfo.DERIVED_KEY_LENGTH/8,c.encryptInfo.HASH.replace("-","").toLowerCase());r(f.Buffer.from(n))})}},1883:(e,t,r)=>{"use strict";const n=r(896),i=r(6899);class s extends n.Transform{constructor(e){super(e),this._writableState.objectMode=!1,this._readableState.objectMode=!0,this.bs=new i,this.__restart()}_transform(e,t,r){for(this.bs.write(e);this.bs.length>=this.__needed;){let e=null;const t=null===this.__needed?void 0:this.bs.read(this.__needed);try{e=this.__parser.next(t)}catch(e){return r(e)}this.__needed&&(this.__fresh=!1),e.done?(this.push(e.value),this.__restart()):this.__needed=e.value||1/0}return r()}*_parse(){throw new Error("Must be implemented in subclass")}__restart(){this.__needed=null,this.__parser=this._parse(),this.__fresh=!0}_flush(e){e(this.__fresh?null:new Error("unexpected end of input"))}}e.exports=s},2114:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(2655),s=r(5598),o=n(r(5550)),a=r(4686),c=-2,f=-1,u=(e,t)=>a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii"),a.Buffer.from([160+t.length]),a.Buffer.from(t,"ascii")]),h=(e,t)=>{const r=a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii")]);let n;return n=t.length<=65535?a.Buffer.from([197,t.length>>8&255,255&t.length]):a.Buffer.from([198,t.length>>24&255,t.length>>16&255,t.length>>8&255,255&t.length]),a.Buffer.concat([r,n,t])},l=(e,t)=>{const r=a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii")]);let n;if(t>=0&&t<=127)n=a.Buffer.from([t]);else if(t<0&&t>=-32)n=a.Buffer.from([t]);else if(t>0&&t<=255)n=a.Buffer.from([204,t]);else if(t>=-128&&t<=127)n=a.Buffer.from([208,t]);else if(t>0&&t<=65535)n=a.Buffer.from([205,t>>>8,t]);else if(t>=-32768&&t<=32767)n=a.Buffer.from([209,t>>>8,t]);else if(t>0&&t<=4294967295)n=a.Buffer.from([206,t>>>24,t>>>16,t>>>8,t]);else if(t>=-2147483648&&t<=2147483647)n=a.Buffer.from([210,t>>>24,t>>>16,t>>>8,t]);else if(t>0&&t<=0xffffffffffffffffn){const e=t/2**32,r=t%2**32;n=a.Buffer.from([211,e>>>24,e>>>16,e>>>8,e,r>>>24,r>>>16,r>>>8,r])}else n=a.Buffer.from([0]);return a.Buffer.concat([r,n])},d=e=>{const t=(0,i.decode)(e),r={state:c,error:""};t.version||(t.version=0);const n={...t,...r};try{if(n.timestamp&&n.protocol&&n.service)if(n.pk2||!n.pk1||n.sign1||n.sign2||16!==n.nonce?.length){if(!n.sign1&&32===n.nonce?.length&&n.pk1&&n.pk2&&n.sign2){n.state=1;const e=o.default.fromId(n.pk2),t=p(n);e.verifyChallenge(t,n.sign2,!0)||e.verifyChallenge_v0(t,n.sign2,!0,n.pk2)||(n.state=c,n.error="[STEP1] failed the verification of pk2")}else if(n.sign1&&32===n.nonce?.length&&n.pk1&&n.pk2&&n.sign2){n.state=2;const e=o.default.fromId(n.pk1),r=o.default.fromId(n.pk2);e.version===t.version&&r.version===t.version||(n.state=c,n.error="[COMPLETE] pk1 and pk2 are using different serialization version");const i=p(n);r.verifyChallenge(i,n.sign2,!0)||r.verifyChallenge_v0(i,n.sign2,!0,n.pk2)||(n.state=c,n.error="[COMPLETE] failed the verification of pk2"),e.verifyChallenge(i,n.sign1,!0)||e.verifyChallenge_v0(i,n.sign1,!0,n.pk1)||(n.state=c,n.error="[COMPLETE] failed the verification of pk1")}}else n.state=0;else n.state=c,n.error="[ERROR] Challenge is missing values"}catch(e){n.error="["+n.state+" -> ERROR] "+e,n.state=c}return n},p=e=>{const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:c,nonce:f,metadata:d}=e,p={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:c,nonce:f,metadata:d};return 0===t?(({version:e,protocol:t,service:r,timestamp:n,pk1:i,pk2:s,nonce:o,metadata:c})=>a.Buffer.concat([a.Buffer.from([135]),u("protocol",t),u("service",r),l("timestamp",n),h("pk1",i),h("pk2",s),h("nonce",o),a.Buffer.from([168]),a.Buffer.from("metadata","ascii"),a.Buffer.from([128])]))(p):a.Buffer.from((0,i.encode)(p))},y=(e,t,r=Date.now())=>e.timestamp>r-t&&e.timestamp<r+t;class g{constructor(e,t=6e4){this.version=0,this.state=f,this.vaultysId=o.default.fromSecret(e.getSecret()),this.liveliness=t}static async verifyCertificate(e){return 2===d(e).state}static async fromCertificate(e,t){const r=d(e);if(r.version||(r.version=0),0===r.state){const e=new g(o.default.fromId(r.pk1).toVersion(r.version),t);e.challenge=r,e.mykey=r.pk1,e.state=0}else if(1===r.state){const e=new g(o.default.fromId(r.pk2).toVersion(r.version),t);return e.challenge=r,e.mykey=r.pk2,e.hisKey=r.pk1,e.state=1,e}}async setChallenge(e){if(this.state!==f)throw this.state=c,new Error("Challenger already initialised, can't reset the state");if(this.challenge=d(e),this.version=this.challenge.version,!y(this.challenge,this.liveliness))throw this.state=c,this.challenge.error="challenge timestamp failed the liveliness at first signature",new Error(this.challenge.error);if(this.challenge.state===c)throw this.state=c,new Error(this.challenge.error);if(0===this.challenge.state){this.mykey=this.vaultysId.id,this.challenge.pk2=this.mykey,this.hisKey=this.challenge.pk1,this.challenge.nonce=a.Buffer.concat([this.challenge.nonce||new Uint8Array,(0,s.randomBytes)(16)]);const e=this.getUnsignedChallenge();if(!e)throw new Error("Error processing Challenge");this.challenge.sign2=await this.vaultysId.signChallenge(e)||void 0,this.challenge.state=this.state=1}else{if(2!==this.challenge.state)throw new Error("Challenge is from a protocol already launched, this is completely unsafe");if(this.mykey=this.vaultysId.id,!this.challenge.pk1?.equals(this.mykey)&&!this.challenge.pk1?.equals(this.mykey))throw this.state=c,new Error("Can't link the vaultys id to this challenge");this.state=2}}getContext(){return{protocol:this.challenge?.protocol,service:this.challenge?.service,metadata:this.challenge?.metadata}}createChallenge(e,t,r=0,n){if(this.version=r,this.state!=f)throw this.state=c,new Error("Challenger already initialised, can't reset the state");this.mykey=this.vaultysId.toVersion(r).id,this.challenge={version:r,protocol:e,service:t,metadata:n?{pk1:n}:{},timestamp:Date.now(),pk1:this.mykey,nonce:(0,s.randomBytes)(16),state:0},this.state=0}getCertificate(){return this.challenge&&(e=>{if(0==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,nonce:c,metadata:f}=e,u={version:t,protocol:r,service:n,timestamp:s,pk1:o,nonce:c,metadata:f},h=(0,i.encode)(u);return a.Buffer.from(h)}if(1==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:c,nonce:f,sign2:u,metadata:h}=e,l={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:c,nonce:f,sign2:u,metadata:h},d=(0,i.encode)(l);return a.Buffer.from(d)}if(2==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:c,nonce:f,sign1:u,sign2:h,metadata:l}=e,d={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:c,nonce:f,sign1:u,sign2:h,metadata:l},p=(0,i.encode)(d);return a.Buffer.from(p)}return null})(this.challenge)||a.Buffer.from([])}getUnsignedChallenge(){return p(this.challenge)}getContactDid(){return this.hisKey?o.default.fromId(this.hisKey).did:null}getContactId(){if(this.isComplete())return o.default.fromId(this.hisKey,this.getCertificate()||void 0);throw new Error("The challenge is not COMPLETE, it is unsafe to get the Contact ID before")}static fromString(e,t){const r=new g(e);return r.setChallenge(t),r}hasFailed(){return this.state==c}isComplete(){return 2==this.state}async init(e){if(this.state!==f)throw new Error("Can't init INITIALISED challenge");const t=d(e);if(this.version=t.version=t.version?1:0,this.vaultysId.toVersion(this.version),0===t.state){if(t.pk2?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=c,new Error("challenge is not corresponding to the right id");return this.challenge=t,this.version=t.version,this.mykey=this.challenge.pk2=this.vaultysId.id,this.hisKey=this.challenge.pk1,void(this.challenge.state=this.state=0)}if(1===t.state){if(t.pk2?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=c,new Error("challenge is not corresponding to the right id");return this.challenge=t,this.version=t.version,this.mykey=this.challenge.pk2,this.hisKey=this.challenge.pk1,void(this.state=this.challenge.state=1)}}async update(e,t){if(this.state===c)throw new Error("Can't update errorneous challenge");if(2===this.state)throw new Error("Can't update COMPLETE challenge");{const r=d(e);if(!r)throw this.state=c,new Error("Can't read the new incoming challenge");if(r.state===c)throw this.state=c,new Error(r.error);if(!y(r,this.liveliness))throw this.state=c,new Error("challenge timestamp failed the liveliness");if(this.version=r.version,this.vaultysId.toVersion(this.version),this.state===f&&0===r.state){if(r.metadata.pk2)throw this.state=c,new Error("Metadata is malformed: pk2 is already set");this.challenge=r,this.mykey=this.challenge.pk2=this.vaultysId.id,this.hisKey=this.challenge.pk1,t&&(this.challenge.metadata.pk2=t),this.challenge.nonce=a.Buffer.concat([this.challenge.nonce,(0,s.randomBytes)(16)]);const e=this.getUnsignedChallenge();return this.challenge.sign2=await this.vaultysId.signChallenge(e),void(this.challenge.state=this.state=1)}if(this.state===f&&1===r.state){if(r.pk1?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=c,new Error("challenge is not corresponding to the right id");const e=p(r);return r.sign1=await this.vaultysId.signChallenge(e),this.challenge=r,this.mykey=this.challenge.pk1,this.hisKey=this.challenge.pk2,void(this.state=this.challenge.state=2)}if(this.state===f&&2===r.state)return void console.log("COMPLETE case?!!");if(r.protocol!==this.challenge.protocol||r.service!==this.challenge.service)throw this.state=c,new Error(`The challenge was expecting protocol '${this.challenge.protocol}' and service '${this.challenge.service}', received '${r.protocol}' and '${r.service}'`);if(0===this.state&&1===r.state){if(!r.nonce?.subarray(0,16).equals(this.challenge.nonce.subarray(0,16)))throw this.state=c,new Error("Nonce has been tampered with");if(r.timestamp!==this.challenge?.timestamp)throw this.state=c,new Error("Timestamp has been tampered with");if(!this.mykey?.equals(r.pk1))throw this.state=c,new Error(`The challenge has been tampered with. Received pk1 = '${r.pk1}', expected pk1 = '${this.mykey}'`);const e=p(r);if(!e)throw this.state=c,new Error("Error processing Challenge");r.sign1=await this.vaultysId.signChallenge(e),this.challenge=r,this.hisKey=r.pk2,this.state=this.challenge.state=2}else{if(1!==this.state||2!==r.state){const e=`The challenge is in an expected state. Received state = '${r.state}', expected state = '${this.state+1}'`;throw this.state=c,new Error(e)}if(r.protocol!==this.challenge.protocol||r.service!==this.challenge.service)throw this.state=c,new Error(`The challenge was expecting protocol '${this.challenge.protocol}' and service '${this.challenge.service}', received '${r.protocol}' and '${r.service}'`);if(!r.nonce?.subarray(16,32).equals(this.challenge.nonce.subarray(16,32)))throw this.state=c,new Error("Nonce has been tampered with");if(r.timestamp!==this.challenge?.timestamp)throw this.state=c,new Error("Timestamp has been tampered with");if(!this.mykey.equals(r.pk2))throw this.state=c,new Error("The challenge pk2 has been tampered with");this.challenge=r,this.state=2}}}}g.deserializeCertificate=d,g.serializeCertificate_v0=({version:e,protocol:t,service:r,timestamp:n,pk1:i,pk2:s,nonce:o,sign1:c,sign2:f,metadata:d})=>a.Buffer.concat([a.Buffer.from([137]),u("protocol",t),u("service",r),l("timestamp",n),h("pk1",i),h("pk2",s),h("nonce",o),h("sign1",c),h("sign2",f),a.Buffer.from([168]),a.Buffer.from("metadata","ascii"),a.Buffer.from([128])]),g.serializeCertificate=p,t.default=g},2355:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p521_hasher=t.secp521r1=t.p521=t.p384_hasher=t.secp384r1=t.p384=t.p256_hasher=t.secp256r1=t.p256=void 0;const n=r(4072),i=r(5397),s=r(2844),o=r(7342),a=r(1164),c={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},f={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},u={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},h=(0,o.Field)(c.p),l=(0,o.Field)(f.p),d=(0,o.Field)(u.p);function p(e,t){const r=(0,a.mapToCurveSimpleSWU)(e,t);return e=>r(e[0])}t.p256=(0,i.createCurve)({...c,Fp:h,lowS:!1},n.sha256),t.secp256r1=t.p256,t.p256_hasher=(0,s.createHasher)(t.p256.Point,p(h,{A:c.a,B:c.b,Z:h.create(BigInt("-10"))}),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:c.p,m:1,k:128,expand:"xmd",hash:n.sha256}),t.p384=(0,i.createCurve)({...f,Fp:l,lowS:!1},n.sha384),t.secp384r1=t.p384,t.p384_hasher=(0,s.createHasher)(t.p384.Point,p(l,{A:f.a,B:f.b,Z:l.create(BigInt("-12"))}),{DST:"P384_XMD:SHA-384_SSWU_RO_",encodeDST:"P384_XMD:SHA-384_SSWU_NU_",p:f.p,m:1,k:192,expand:"xmd",hash:n.sha384}),t.p521=(0,i.createCurve)({...u,Fp:d,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},n.sha512),t.secp521r1=t.p521,t.p521_hasher=(0,s.createHasher)(t.p521.Point,p(d,{A:u.a,B:u.b,Z:d.create(BigInt("-4"))}),{DST:"P521_XMD:SHA-512_SSWU_RO_",encodeDST:"P521_XMD:SHA-512_SSWU_NU_",p:u.p,m:1,k:256,expand:"xmd",hash:n.sha512})},2404:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ml_dsa87=t.ml_dsa65=t.ml_dsa44=t.PARAMS=void 0;const n=r(5391),i=r(360),s=r(6215),o=256,a=8380417,c=0|Math.floor(95232),f=0|Math.floor(261888);t.PARAMS={2:{K:4,L:4,D:13,GAMMA1:2**17,GAMMA2:c,TAU:39,ETA:2,OMEGA:80},3:{K:6,L:5,D:13,GAMMA1:2**19,GAMMA2:f,TAU:49,ETA:4,OMEGA:55},5:{K:8,L:7,D:13,GAMMA1:2**19,GAMMA2:f,TAU:60,ETA:2,OMEGA:75}};const u=e=>new Int32Array(e),{mod:h,smod:l,NTT:d,bitsCoder:p}=(0,i.genCrystals)({N:o,Q:a,F:8347681,ROOT_OF_UNITY:1753,newPoly:u,isKyber:!1,brvBits:8}),y=e=>e,g=(e,t=y,r=y)=>p(e,{encode:e=>t(r(e)),decode:e=>r(t(e))}),m=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=h(e[r]+t[r]);return e},b=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=h(e[r]-t[r]);return e},w=e=>{for(let t=0;t<o;t++)e[t]<<=13;return e},_=(e,t)=>{for(let r=0;r<o;r++)if(Math.abs(l(e[r]))>=t)return!0;return!1},v=(e,t)=>{const r=u(o);for(let n=0;n<e.length;n++)r[n]=h(e[n]*t[n]);return r};function E(e){const t=u(o);for(let r=0;r<o;){const n=e();if(n.length%3)throw new Error("RejNTTPoly: unaligned block");for(let e=0;r<o&&e<=n.length-3;e+=3){const i=8388607&(n[e+0]|n[e+1]<<8|n[e+2]<<16);i<a&&(t[r++]=i)}}return t}function S(e){const{K:t,L:r,GAMMA1:i,GAMMA2:p,TAU:y,ETA:S,OMEGA:B}=e,{CRH_BYTES:A,TR_BYTES:I,C_TILDE_BYTES:x,XOF128:T,XOF256:O}=e;if(![2,4].includes(S))throw new Error("Wrong ETA");if(![1<<17,1<<19].includes(i))throw new Error("Wrong GAMMA1");if(![c,f].includes(p))throw new Error("Wrong GAMMA2");const k=y*S,U=e=>{const t=h(e),r=0|l(t,2*p);return t-r===a-1?{r1:0,r0:r-1|0}:{r1:0|Math.floor((t-r)/(2*p)),r0:r}},M=e=>U(e).r1,R=e=>U(e).r0,P=(e,t)=>e<=p||e>a-p||e===a-p&&0===t?0:1,C=(e,t)=>{const r=Math.floor((a-1)/(2*p)),{r1:n,r0:i}=U(t);return 1===e?i>0?0|h(n+1,r):0|h(n-1,r):0|n},L=e=>{const t=h(e),r=0|l(t,8192);return{r1:0|Math.floor((t-r)/8192),r0:r}},D={bytesLen:B+t,encode:e=>{if(!1===e)throw new Error("hint.encode: hint is false");const r=new Uint8Array(B+t);for(let n=0,i=0;n<t;n++){for(let t=0;t<o;t++)0!==e[n][t]&&(r[i++]=t);r[B+n]=i}return r},decode:e=>{const r=[];let n=0;for(let i=0;i<t;i++){const t=u(o);if(e[B+i]<n||e[B+i]>B)return!1;for(let r=n;r<e[B+i];r++){if(r>n&&e[r]<=e[r-1])return!1;t[e[r]]=1}n=e[B+i],r.push(t)}for(let t=n;t<B;t++)if(0!==e[t])return!1;return r}},N=g(2===S?3:4,e=>S-e,e=>{if(!(-S<=e&&e<=S))throw new Error(`malformed key s1/s3 ${e} outside of ETA range [${-S}, ${S}]`);return e}),K=g(13,e=>4096-e),H=g(10),F=g(i===1<<17?18:20,e=>l(i-e)),j=g(p===c?6:4),G=(0,s.vecCoder)(j,t),V=(0,s.splitCoder)(32,(0,s.vecCoder)(H,t)),Y=(0,s.splitCoder)(32,32,I,(0,s.vecCoder)(N,r),(0,s.vecCoder)(N,t),(0,s.vecCoder)(K,t)),q=(0,s.splitCoder)(x,(0,s.vecCoder)(F,r),D),z=2===S?e=>e<15&&2-e%5:e=>e<9&&4-e;function W(e){const t=u(o);for(let r=0;r<o;){const n=e();for(let e=0;r<o&&e<n.length;e+=1){const i=z(15&n[e]),s=z(n[e]>>4&15);!1!==i&&(t[r++]=i),r<o&&!1!==s&&(t[r++]=s)}}return t}const $=e=>{const t=u(o),r=n.shake256.create({}).update(e),i=new Uint8Array(n.shake256.blockLen);r.xofInto(i);const s=i.slice(0,8);for(let e=o-y,a=8,c=0,f=0;e<o;e++){let o=e+1;for(;o>e;)o=i[a++],a<n.shake256.blockLen||(r.xofInto(i),a=0);t[e]=t[o],t[o]=1-((s[c]>>f++&1)<<1),f>=8&&(c++,f=0)}return t},X=e=>{const t=u(o),r=u(o);for(let n=0;n<e.length;n++){const{r0:i,r1:s}=L(e[n]);t[n]=i,r[n]=s}return{r0:t,r1:r}},Z=(e,t)=>{for(let r=0;r<o;r++)e[r]=C(t[r],e[r]);return e},J=(e,t)=>{const r=u(o);let n=0;for(let i=0;i<o;i++){const s=P(e[i],t[i]);r[i]=s,n+=s}return{v:r,cnt:n}},Q=(0,s.splitCoder)(32,64,32),ee={signRandBytes:32,keygen:e=>{const i=new Uint8Array(34),a=void 0===e;a&&(e=(0,s.randomBytes)(32)),(0,s.ensureBytes)(e,32),i.set(e),a&&e.fill(0),i[32]=t,i[33]=r;const[c,f,h]=Q.decode((0,n.shake256)(i,{dkLen:Q.bytesLen})),l=O(f),p=[];for(let e=0;e<r;e++)p.push(W(l.get(255&e,e>>8&255)));const y=[];for(let e=r;e<r+t;e++)y.push(W(l.get(255&e,e>>8&255)));const g=p.map(e=>d.encode(e.slice())),b=[],w=[],_=T(c),S=u(o);for(let e=0;e<t;e++){S.fill(0);for(let t=0;t<r;t++){const r=E(_.get(t,e));m(S,v(r,g[t]))}d.decode(S);const{r0:t,r1:n}=X(m(S,y[e]));b.push(t),w.push(n)}const B=V.encode([c,w]),A=(0,n.shake256)(B,{dkLen:I}),x=Y.encode([c,h,A,p,y,b]);return _.clean(),l.clean(),(0,s.cleanBytes)(c,f,h,p,y,g,S,b,w,A,i),{publicKey:B,secretKey:x}},sign:(e,a,c,f=!1)=>{const[h,l,y,g,w,S]=Y.decode(e),I=[],U=T(h);for(let e=0;e<t;e++){const t=[];for(let n=0;n<r;n++)t.push(E(U.get(n,e)));I.push(t)}U.clean();for(let e=0;e<r;e++)d.encode(g[e]);for(let e=0;e<t;e++)d.encode(w[e]),d.encode(S[e]);const P=f?a:n.shake256.create({dkLen:A}).update(y).update(a).digest(),C=c||new Uint8Array(32);(0,s.ensureBytes)(C);const L=n.shake256.create({dkLen:A}).update(l).update(C).update(P).digest();(0,s.ensureBytes)(L,A);const D=O(L,F.bytesLen);e:for(let e=0;;){const a=[];for(let t=0;t<r;t++,e++)a.push(F.decode(D.get(255&e,e>>8)()));const c=a.map(e=>d.encode(e.slice())),f=[];for(let e=0;e<t;e++){const t=u(o);for(let n=0;n<r;n++)m(t,v(I[e][n],c[n]));d.decode(t),f.push(t)}const h=f.map(e=>e.map(M)),l=n.shake256.create({dkLen:x}).update(P).update(G.encode(h)).digest(),y=d.encode($(l)),E=g.map(e=>v(e,y));for(let e=0;e<r;e++)if(m(d.decode(E[e]),a[e]),_(E[e],i-k))continue e;let A=0;const T=[];for(let e=0;e<t;e++){const t=d.decode(v(w[e],y)),r=b(f[e],t).map(R);if(_(r,p-k))continue e;const n=d.decode(v(S[e],y));if(_(n,p))continue e;m(r,n);const i=J(r,h[e]);T.push(i.v),A+=i.cnt}if(A>B)continue;D.clean();const O=q.encode([l,E,T]);return(0,s.cleanBytes)(l,E,T,y,h,f,c,a,L,P,g,w,S,...I),O}throw new Error("Unreachable code path reached, report this error")},verify:(e,a,c,f=!1)=>{const[h,l]=V.decode(e),p=(0,n.shake256)(e,{dkLen:I});if(c.length!==q.bytesLen)return!1;const[y,g,S]=q.decode(c);if(!1===S)return!1;for(let e=0;e<r;e++)if(_(g[e],i-k))return!1;const O=f?a:n.shake256.create({dkLen:A}).update(p).update(a).digest(),U=d.encode($(y)),M=g.map(e=>e.slice());for(let e=0;e<r;e++)d.encode(M[e]);const R=[],P=T(h);for(let e=0;e<t;e++){const t=v(d.encode(w(l[e])),U),n=u(o);for(let t=0;t<r;t++){const r=E(P.get(t,e));m(n,v(r,M[t]))}const i=d.decode(b(n,t));R.push(Z(i,S[e]))}P.clean();const C=n.shake256.create({dkLen:x}).update(O).update(G.encode(R)).digest();for(const e of S)if(!(e.reduce((e,t)=>e+t,0)<=B))return!1;for(const e of g)if(_(e,i-k))return!1;return(0,s.equalBytes)(y,C)}};return{internal:ee,keygen:ee.keygen,signRandBytes:ee.signRandBytes,sign:(e,t,r=s.EMPTY,n)=>{const i=(0,s.getMessage)(t,r),o=ee.sign(e,i,n);return i.fill(0),o},verify:(e,t,r,n=s.EMPTY)=>ee.verify(e,(0,s.getMessage)(t,n),r),prehash:e=>({sign:(t,r,n=s.EMPTY,i)=>{const o=(0,s.getMessagePrehash)(e,r,n),a=ee.sign(t,o,i);return o.fill(0),a},verify:(t,r,n,i=s.EMPTY)=>ee.verify(t,(0,s.getMessagePrehash)(e,r,i),n)})}}t.ml_dsa44=S({...t.PARAMS[2],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:32,XOF128:i.XOF128,XOF256:i.XOF256}),t.ml_dsa65=S({...t.PARAMS[3],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:48,XOF128:i.XOF128,XOF256:i.XOF256}),t.ml_dsa87=S({...t.PARAMS[5],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:64,XOF128:i.XOF128,XOF256:i.XOF256})},2655:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DecodeError:()=>a,Decoder:()=>P,EXT_TIMESTAMP:()=>h,Encoder:()=>E,ExtData:()=>o,ExtensionCodec:()=>_,decode:()=>C,decodeArrayStream:()=>K,decodeAsync:()=>N,decodeMulti:()=>L,decodeMultiStream:()=>H,decodeTimestampExtension:()=>b,decodeTimestampToTimeSpec:()=>m,encode:()=>S,encodeDateToTimeSpec:()=>y,encodeTimeSpecToTimestamp:()=>p,encodeTimestampExtension:()=>g});const n=new TextEncoder;function i(e,t,r){let n=t;const i=n+r,s=[];let o="";for(;n<i;){const t=e[n++];if(128&t)if(192==(224&t)){const r=63&e[n++];s.push((31&t)<<6|r)}else if(224==(240&t)){const r=63&e[n++],i=63&e[n++];s.push((31&t)<<12|r<<6|i)}else if(240==(248&t)){let r=(7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];r>65535&&(r-=65536,s.push(r>>>10&1023|55296),r=56320|1023&r),s.push(r)}else s.push(t);else s.push(t);s.length>=4096&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}const s=new TextDecoder;class o{constructor(e,t){this.type=e,this.data=t}}class a extends Error{constructor(e){super(e);const t=Object.create(a.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:a.name})}}const c=4294967295;function f(e,t,r){const n=Math.floor(r/4294967296),i=r;e.setUint32(t,n),e.setUint32(t+4,i)}function u(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}const h=-1,l=4294967295,d=17179869183;function p({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=d){if(0===t&&e<=l){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}{const r=e/4294967296,n=4294967295&e,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,t<<2|3&r),s.setUint32(4,n),i}}{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,t),f(n,4,e),r}}function y(e){const t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),i=Math.floor(n/1e9);return{sec:r+i,nsec:n-1e9*i}}function g(e){return e instanceof Date?p(y(e)):null}function m(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const e=t.getUint32(0);return{sec:4294967296*(3&e)+t.getUint32(4),nsec:e>>>2}}case 12:return{sec:u(t,4),nsec:t.getUint32(0)};default:throw new a(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}function b(e){const t=m(e);return new Date(1e3*t.sec+t.nsec/1e6)}const w={type:h,encode:g,decode:b};class _{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(w)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{const n=-1-e;this.builtInEncoders[n]=t,this.builtInDecoders[n]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){const n=this.builtInEncoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new o(-1-r,i)}}for(let r=0;r<this.encoders.length;r++){const n=this.encoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new o(r,i)}}return e instanceof o?e:null}decode(e,t,r){const n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new o(t,e)}}function v(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):function(e){return e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}(e)?new Uint8Array(e):Uint8Array.from(e)}_.defaultCodec=new _;class E{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??_.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??100,this.initialBufferSize=e?.initialBufferSize??2048,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new E({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){const t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){!1===e?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error(`Too long string: ${e} bytes in UTF-8`);this.writeU8(219),this.writeU32(e)}}encodeString(e){const t=function(e){const t=e.length;let r=0,n=0;for(;n<t;){let i=e.charCodeAt(n++);if(4294967168&i)if(4294965248&i){if(i>=55296&&i<=56319&&n<t){const t=e.charCodeAt(n);56320==(64512&t)&&(++n,i=((1023&i)<<10)+(1023&t)+65536)}r+=4294901760&i?4:3}else r+=2;else r++}return r}(e);var r,i,s;this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),r=e,i=this.bytes,s=this.pos,r.length>50?function(e,t,r){n.encodeInto(e,t.subarray(r))}(r,i,s):function(e,t,r){const n=e.length;let i=r,s=0;for(;s<n;){let r=e.charCodeAt(s++);if(4294967168&r){if(4294965248&r){if(r>=55296&&r<=56319&&s<n){const t=e.charCodeAt(s);56320==(64512&t)&&(++s,r=((1023&r)<<10)+(1023&t)+65536)}4294901760&r?(t[i++]=r>>18&7|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128):(t[i++]=r>>12&15|224,t[i++]=r>>6&63|128)}else t[i++]=r>>6&31|192;t[i++]=63&r|128}else t[i++]=r}}(r,i,s),this.pos+=t}encodeObject(e,t){const r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`);this.encodeMap(e,t)}}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large binary: ${t}`);this.writeU8(198),this.writeU32(t)}const r=v(e);this.writeU8a(r)}encodeArray(e,t){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error(`Too large array: ${r}`);this.writeU8(221),this.writeU32(r)}for(const r of e)this.doEncode(r,t+1)}countWithoutUndefined(e,t){let r=0;for(const n of t)void 0!==e[n]&&r++;return r}encodeMap(e,t){const r=Object.keys(e);this.sortKeys&&r.sort();const n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error(`Too large map object: ${n}`);this.writeU8(223),this.writeU32(n)}for(const n of r){const r=e[n];this.ignoreUndefined&&void 0===r||(this.encodeString(n),this.doEncode(r,t+1))}}encodeExtension(e){if("function"==typeof e.data){const t=e.data(this.pos+6),r=t.length;if(r>=4294967296)throw new Error(`Too large extension object: ${r}`);return this.writeU8(201),this.writeU32(r),this.writeI8(e.type),void this.writeU8a(t)}const t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large extension object: ${t}`);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),function(e,t,r){const n=r/4294967296,i=r;e.setUint32(t,n),e.setUint32(t+4,i)}(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),f(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function S(e,t){return new E(t).encodeSharedRef(e)}function B(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}const A="array",I="map_key",x="map_value",T=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new a("The type of key must be string or number but "+typeof e)};class O{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=A,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=I,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===A){const t=e;t.size=0,t.array=void 0,t.position=0,t.type=void 0}if(e.type===I||e.type===x){const t=e;t.size=0,t.map=void 0,t.readCount=0,t.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const k=new DataView(new ArrayBuffer(0)),U=new Uint8Array(k.buffer);try{k.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const M=new RangeError("Insufficient data"),R=new class{constructor(e=16,t=16){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let e=0;e<this.maxKeyLength;e++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){const n=this.caches[r-1];e:for(const i of n){const n=i.bytes;for(let i=0;i<r;i++)if(n[i]!==e[t+i])continue e;return i.str}return null}store(e,t){const r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)}decode(e,t,r){const n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;const s=i(e,t,r),o=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(o,s),s}};class P{constructor(e){this.totalPos=0,this.pos=0,this.view=k,this.bytes=U,this.headByte=-1,this.stack=new O,this.entered=!1,this.extensionCodec=e?.extensionCodec??_.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??c,this.maxBinLength=e?.maxBinLength??c,this.maxArrayLength=e?.maxArrayLength??c,this.maxMapLength=e?.maxMapLength??c,this.maxExtLength=e?.maxExtLength??c,this.keyDecoder=void 0!==e?.keyDecoder?e.keyDecoder:R,this.mapKeyConverter=e?.mapKeyConverter??T}clone(){return new P({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){const t=v(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){const t=this.bytes.subarray(this.pos),r=v(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:r}=this;return new RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){const t=this.clone();return void(yield*t.decodeMulti(e))}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let t,r=!1;for await(const n of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(n);try{t=this.doDecodeSync(),r=!0}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return t}const{headByte:n,pos:i,totalPos:s}=this;throw new RangeError(`Insufficient data in parsing ${B(n)} at ${s} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){const r=this.clone();return void(yield*r.decodeMultiAsync(e,t))}try{this.entered=!0;let r=t,n=-1;for await(const i of e){if(t&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(n=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),0!==--n;);}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const r=e-128;if(0!==r){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){const r=e-144;if(0!==r){this.pushArrayState(r),this.complete();continue e}t=[]}else{const r=e-160;t=this.decodeString(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){const e=this.lookU8();t=this.decodeString(e,1)}else if(218===e){const e=this.lookU16();t=this.decodeString(e,2)}else if(219===e){const e=this.lookU32();t=this.decodeString(e,4)}else if(220===e){const e=this.readU16();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(221===e){const e=this.readU32();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(222===e){const e=this.readU16();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(223===e){const e=this.readU32();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(196===e){const e=this.lookU8();t=this.decodeBinary(e,1)}else if(197===e){const e=this.lookU16();t=this.decodeBinary(e,2)}else if(198===e){const e=this.lookU32();t=this.decodeBinary(e,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){const e=this.lookU8();t=this.decodeExtension(e,1)}else if(200===e){const e=this.lookU16();t=this.decodeExtension(e,2)}else{if(201!==e)throw new a(`Unrecognized type byte: ${B(e)}`);{const e=this.lookU32();t=this.decodeExtension(e,4)}}this.complete();const r=this.stack;for(;r.length>0;){const e=r.top();if(e.type===A){if(e.array[e.position]=t,e.position++,e.position!==e.size)continue e;t=e.array,r.release(e)}else{if(e.type===I){if("__proto__"===t)throw new a("The key __proto__ is not allowed");e.key=this.mapKeyConverter(t),e.type=x;continue e}if(e.map[e.key]=t,e.readCount++,e.readCount!==e.size){e.key=null,e.type=I;continue e}t=e.map,r.release(e)}}return t}}readHeadByte(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new a(`Unrecognized array type byte: ${B(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new a(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new a(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){if(e>this.maxStrLength)throw new a(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw M;const r=this.pos+t;let n;return n=this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?this.keyDecoder.decode(this.bytes,r,e):function(e,t,r){return r>200?function(e,t,r){const n=e.subarray(t,t+r);return s.decode(n)}(e,t,r):i(e,t,r)}(this.bytes,r,e),this.pos+=t+e,n}stateIsMapKey(){return this.stack.length>0&&this.stack.top().type===I}decodeBinary(e,t){if(e>this.maxBinLength)throw new a(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw M;const r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n}decodeExtension(e,t){if(e>this.maxExtLength)throw new a(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=(t=this.view,r=this.pos,4294967296*t.getUint32(r)+t.getUint32(r+4));var t,r;return this.pos+=8,e}readI64(){const e=u(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function C(e,t){return new P(t).decode(e)}function L(e,t){return new P(t).decodeMulti(e)}function D(e){return null!=e[Symbol.asyncIterator]?e:async function*(e){const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)return;yield r}}finally{t.releaseLock()}}(e)}async function N(e,t){const r=D(e);return new P(t).decodeAsync(r)}function K(e,t){const r=D(e);return new P(t).decodeArrayStream(r)}function H(e,t){const r=D(e);return new P(t).decodeStream(r)}},2739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5598),i=e=>{return t=(0,n.hash)("sha256",(0,n.fromHex)(e.replaceAll(" ",""))).toString("hex"),t.match(/.{1,4}/g)?.map(e=>parseInt(e,16).toString(2).padStart(16,"0"))||[];var t},s=(e,t)=>{const r=[];for(let n=0;n<16;n++){let i="";for(let r=0;r<16;r++){let s=0;for(let t=n-1;t<n+2;t++)for(let i=r-1;i<r+2;i++)t>-1&&t<16&&i>-1&&i<16&&(t==n&&i==r||"1"!=e[t][i]||s++);let o=!1;(3==s||2==s&&"1"==e[n][r])&&(o=!0),i+=o?"1":"O",t&&o&&t[n][r]++}r.push(i)}return r},o=(e,t=1)=>"hsl("+(240*(1-e)+t)+", 100%, 50%)",a=(e,t=2,r)=>{let n=1e3,i=0;const s=JSON.parse(JSON.stringify(e));for(let e=0;e<8;e++)for(let t=0;t<8;t++){s[e][t]=s[15-e][t]=s[e][15-t]=s[15-e][15-t]=s[e][t]+s[15-e][t]+s[e][15-t]+s[15-e][15-t];const r=s[e][t];r<n&&(n=r),r>i&&(i=r)}for(let e=0;e<16;e++)for(let a=0;a<16;a++){r.fillStyle=o(Math.floor((s[e][a]-n)*t/i)/t,i*i);let c=0+10*a,f=0+10*e;r.fillRect(c,f,10,10)}};t.default={renderFingerprint:(e,t,r=32)=>{let n=i(e.replaceAll(" ","")),o=n?.map(e=>e.split("").map(e=>parseInt(e)));const c=t.getContext("2d");if(c&&o){for(let e=0;e<r;e++)n=s(n,o);return a(o,3,c),t}},animateFingerprint:async(e,t,r=32,n=500)=>{let o=i(e.replaceAll(" ","")),c=o?.map(e=>e.split("").map(e=>parseInt(e)));const f=t.getContext("2d");if(f&&c){for(let e=0;e<r;e++)o=s(o,c),a(c,3,f),await new Promise(e=>setTimeout(e,n));return a(c,3,f),t}}}},2810:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Ed25519Manager=t.Fido2PRFManager=t.Fido2Manager=t.DilithiumManager=t.HybridManager=void 0;const i=n(r(212));t.DilithiumManager=i.default;const s=n(r(7603));t.HybridManager=s.default;const o=n(r(1449));t.Fido2Manager=o.default;const a=n(r(9463));t.Fido2PRFManager=a.default;const c=n(r(8676));t.Ed25519Manager=c.default;const f=n(r(3616));t.default=f.default},2844:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expand_message_xmd=f,t.expand_message_xof=u,t.hash_to_field=h,t.isogenyMap=function(e,t){const r=t.map(e=>Array.from(e).reverse());return(t,n)=>{const[s,o,a,c]=r.map(r=>r.reduce((r,n)=>e.add(e.mul(r,t),n))),[f,u]=(0,i.FpInvertBatch)(e,[o,c],!0);return t=e.mul(s,f),n=e.mul(n,e.mul(a,u)),{x:t,y:n}}},t.createHasher=function(e,t,r){if("function"!=typeof t)throw new Error("mapToCurve() must be defined");function n(r){return e.fromAffine(t(r))}function i(t){const r=t.clearCofactor();return r.equals(e.ZERO)?e.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(e,t){const s=r.DST?r.DST:{},o=h(e,2,Object.assign({},r,s,t)),a=n(o[0]),c=n(o[1]);return i(a.add(c))},encodeToCurve(e,t){const s=r.encodeDST?r.encodeDST:{};return i(n(h(e,1,Object.assign({},r,s,t))[0]))},mapToCurve(e){if(!Array.isArray(e))throw new Error("expected array of bigints");for(const t of e)if("bigint"!=typeof t)throw new Error("expected array of bigints");return i(n(e))}}};const n=r(6376),i=r(7342),s=n.bytesToNumberBE;function o(e,t){if(c(e),c(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=255&e,e>>>=8;return new Uint8Array(r)}function a(e,t){const r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}function c(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function f(e,t,r,i){(0,n.abytes)(e),(0,n.abytes)(t),c(r),t.length>255&&(t=i((0,n.concatBytes)((0,n.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));const{outputLen:s,blockLen:f}=i,u=Math.ceil(r/s);if(r>65535||u>255)throw new Error("expand_message_xmd: invalid lenInBytes");const h=(0,n.concatBytes)(t,o(t.length,1)),l=o(0,f),d=o(r,2),p=new Array(u),y=i((0,n.concatBytes)(l,e,d,o(0,1),h));p[0]=i((0,n.concatBytes)(y,o(1,1),h));for(let e=1;e<=u;e++){const t=[a(y,p[e-1]),o(e+1,1),h];p[e]=i((0,n.concatBytes)(...t))}return(0,n.concatBytes)(...p).slice(0,r)}function u(e,t,r,i,s){if((0,n.abytes)(e),(0,n.abytes)(t),c(r),t.length>255){const e=Math.ceil(2*i/8);t=s.create({dkLen:e}).update((0,n.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:r}).update(e).update(o(r,2)).update(t).update(o(t.length,1)).digest()}function h(e,t,r){(0,n._validateObject)(r,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:o,k:a,m:h,hash:l,expand:d,DST:p}=r;if(!(0,n.isBytes)(p)&&"string"!=typeof p)throw new Error("DST must be string or uint8array");if(!(0,n.isHash)(r.hash))throw new Error("expected valid hash");(0,n.abytes)(e),c(t);const y="string"==typeof p?(0,n.utf8ToBytes)(p):p,g=o.toString(2).length,m=Math.ceil((g+a)/8),b=t*h*m;let w;if("xmd"===d)w=f(e,y,b,l);else if("xof"===d)w=u(e,y,b,a,l);else{if("_internal_pass"!==d)throw new Error('expand must be "xmd" or "xof"');w=e}const _=new Array(t);for(let e=0;e<t;e++){const t=new Array(h);for(let r=0;r<h;r++){const n=m*(r+e*h),a=w.subarray(n,n+m);t[r]=(0,i.mod)(s(a),o)}_[e]=t}return _}},2862:(e,t,r)=>{"use strict";var n=r(8704).F.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(s||i);var o=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,c=function(){t.writable||u()},f=t._writableState&&t._writableState.finished,u=function(){a=!1,f=!0,o||s.call(t)},h=t._readableState&&t._readableState.endEmitted,l=function(){o=!1,h=!0,a||s.call(t)},d=function(e){s.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),s.call(t,e)):a&&!f?(t._writableState&&t._writableState.ended||(e=new n),s.call(t,e)):void 0},y=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",p),t.req?y():t.on("request",y)):a&&!t._writableState&&(t.on("end",c),t.on("close",c)),t.on("end",l),t.on("finish",u),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",u),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",u),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",u),t.removeListener("end",l),t.removeListener("error",d),t.removeListener("close",p)}}},3051:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.SymmetricKeyRecipient=void 0;const i=r(4406),s=r(568),o=r(3835),a=r(4072);t.SymmetricKeyRecipient=class{constructor(e,t){this.recipient_identifier=e,this.key=t}};class c{constructor(e,t,r){if(!(0,s.isBufferOrUint8Array)(e)||32!==e.length)throw new TypeError("recipient_identifier must be a 32 byte Uint8Array");if(!(0,s.isBufferOrUint8Array)(t)||48!==t.length)throw new TypeError("payload_key_box must be a 48 byte Uint8Array");if("bigint"!=typeof r)throw new TypeError("index must be a bigint");this.recipient_identifier=e,this.encrypted_payload_key=t,this.index=r,this.recipient_index=c.generateRecipientIndex(r)}static create(e,t,r,n){"number"==typeof n&&(n=BigInt(n));const s=this.generateRecipientIndex(n),{shared_symmetric_key:o,recipient_identifier:a}=this.generateRecipientIdentifierForSender(e,t,s);return new this(a,(0,i.secretbox)(Uint8Array.from(r),Uint8Array.from(s),Uint8Array.from(o)),n)}static createSymmetric(e,t,r,s,c){"number"==typeof c&&(c=BigInt(c));const f=n.from((0,o.hmac)(a.sha512,this.HMAC_KEY_SYMMETRIC,n.concat([r,e])).slice(0,32)),u=this.generateRecipientIndex(c);return new this(t,(0,i.secretbox)(Uint8Array.from(s),Uint8Array.from(u),Uint8Array.from(f)),c)}static from(e,t,r){return"number"==typeof r&&(r=BigInt(r)),new this(e,t,r)}static generateRecipientIndex(e){const t=n.alloc(8);return t.writeBigUInt64BE(e),n.concat([this.PAYLOAD_KEY_BOX_NONCE_PREFIX_V2,t])}decryptPayloadKey(e){return i.secretbox.open(Uint8Array.from(this.encrypted_payload_key),Uint8Array.from(this.recipient_index),Uint8Array.from(e))}static generateRecipientIdentifierForSender(e,t,r){const s=n.from((0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(this.SHARED_KEY_NONCE),Uint8Array.from(e),Uint8Array.from(t))).slice(-32);return{shared_symmetric_key:s,recipient_identifier:n.from((0,o.hmac)(a.sha512,this.HMAC_KEY,n.concat([s,r])).slice(0,32))}}static generateRecipientIdentifierForRecipient(e,t,r){const s=n.from((0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(this.SHARED_KEY_NONCE),Uint8Array.from(e),Uint8Array.from(t))).slice(-32);return{shared_symmetric_key:s,recipient_identifier:n.from((0,o.hmac)(a.sha512,this.HMAC_KEY,n.concat([s,r])).slice(0,32))}}}c.SHARED_KEY_NONCE=n.from("saltpack_derived_sboxkey"),c.HMAC_KEY=n.from("saltpack signcryption box key identifier"),c.HMAC_KEY_SYMMETRIC=n.from("saltpack signcryption derived symmetric key"),c.PAYLOAD_KEY_BOX_NONCE_PREFIX_V2=n.from("saltpack_recipsb"),t.default=c},3061:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryChannel=void 0,t.pipeChannels=function(e,t){let r=!0;return(async()=>{try{for(await e.start(),await t.start(),console.log("pipe1to2");r;)try{const n=await e.receive();if(console.log("pipe1to2",n),!r||0===n.length)break;t.send(n)}catch(e){r&&console.error("Error in pipe1to2:",e);break}}catch(e){console.error("Fatal error in pipe1to2:",e)}})(),(async()=>{try{for(;r;){console.log("pipe2to1");try{const n=await t.receive();if(console.log("pipe2to1",n),!r||0===n.length)break;e.send(n)}catch(e){r&&console.error("Error in pipe2to1:",e);break}}}catch(e){console.error("Fatal error in pipe2to1:",e)}})(),async()=>{r=!1,await Promise.all([e.close(),t.close()])}},t.unpipeChannels=async function(e,t){await Promise.all([e.close(),t.close()])},t.StreamChannel=function(e){const t=()=>new s.Stream.Writable({write:(t,r,n)=>{e.send(t),n()}}),r=async r=>new Promise(n=>{const i=t();r.pipe(i).once("finish",()=>{e.send(o.Buffer.from("EOF","utf-8")),i.end(),n()})}),n=()=>{let t,r;const n=new s.Stream.Readable({read(){t=e=>this.push(e)}});return(async t=>{let r=await e.receive();for(;r;){if(t(r),"EOF"===r.toString("utf-8"))return;r=await e.receive()}})(e=>{3===e.length&&"EOF"===e.toString("utf-8")&&t&&(r&&t(r),t(null),n.destroy()),r=r?o.Buffer.concat([r,e]):e,t&&(!t(r)&&(t=null),r=null)}),n};return{getReadStream:n,getWriteStream:t,upload:r,uploadData:async e=>{const t=s.Readable.from(e);await r(t)},download:async e=>{const t=n(),r=new Promise(e=>t.on("end",()=>{e()}));t.pipe(e),await r},downloadData:async()=>{const e=n(),t=[],r=new Promise(r=>e.on("end",()=>{r(o.Buffer.concat(t))})),i=new s.Stream.Writable({write:(e,r,n)=>{t.push(e),n()}});return e.pipe(i),r}}},t.convertWebWritableStreamToNodeWritable=function(e){const t=e.getWriter();return new s.Writable({async write(e,r,n){try{await t.write(e),t.releaseLock(),n()}catch(e){n()}},async final(t){try{const r=e.getWriter();await r.close(),r.releaseLock(),t()}catch(e){t()}},async destroy(t,r){try{const n=e.getWriter();await n.abort(t),n.releaseLock(),r(t)}catch(e){r(null)}}})},t.convertWebReadableStreamToNodeReadable=function(e){const t=e.getReader();return new s.Readable({async read(){try{for(;;){const{done:e,value:r}=await t.read();if(e){this.push(null);break}this.push(o.Buffer.from(r))}}catch(e){this.destroy()}}})};const i=n(r(4015)),s=r(896),o=r(4686);class a{constructor(){this.messageQueue=[],this.waitingResolvers=[],this.connected=!1,this.connectedCallbacks=[],this.closed=!1}setChannel(e,t){this.name=t,this.otherend=e}static createBidirectionnal(){const e=new a,t=new a;return e.setChannel(t),t.setChannel(e),e}onConnected(e){this.connected?e():this.connectedCallbacks.push(e)}static createEncryptedBidirectionnal(e=i.default.generateKey()){const t=i.default.encryptChannel(new a,e),r=i.default.encryptChannel(new a,e);return t.setChannel(r),r.setChannel(t),t}getConnectionString(){return"vaultys://memory"}fromConnectionString(e){return"vaultys://memory"===e?new a:null}setLogger(e){this.logger=e}setInjector(e){this.injector=e}async start(){this.connected=!0,this.connectedCallbacks.forEach(e=>e()),this.connectedCallbacks=[]}async send(e){if(this.closed)throw new Error("Cannot send on closed channel");if(!this.otherend)throw new Error("No other end connected to this channel");this.logger&&this.logger(e);let t=e;this.injector&&(t=await this.injector(e)),this.connected||await this.start(),this.otherend.deliverMessage(t)}deliverMessage(e){this.waitingResolvers.length>0?this.waitingResolvers.shift()(e):this.messageQueue.push(e)}async receive(){if(this.closed)throw new Error("Cannot receive on closed channel");return this.messageQueue.length>0?this.messageQueue.shift():new Promise(e=>{this.waitingResolvers.push(e)})}async close(){for(this.closed=!0;this.waitingResolvers.length>0;)this.waitingResolvers.shift()(o.Buffer.alloc(0));this.messageQueue=[]}}t.MemoryChannel=a},3105:(e,t,r)=>{"use strict";const n=r(3271),i=r(5706),{Buffer:s}=r(4686);class o extends n{constructor(e){super(e),this.valueSharing=new i}_pushObject(e,t){if(null!==e){const t=this.valueSharing.check(e);switch(t){case i.FIRST:this._pushTag(28);break;case i.NEVER:break;default:return this._pushTag(29)&&this._pushIntNum(t)}}return super._pushObject(e,t)}stopRecording(){this.valueSharing.stop()}clearRecording(){this.valueSharing.clear()}static encode(...e){const t=new o;t.on("data",()=>{});for(const r of e)t.pushAny(r);return t.stopRecording(),t.removeAllListeners("data"),t._encodeAll(e)}static encodeCanonical(...e){throw new Error("Cannot encode canonically in a SharedValueEncoder, which serializes objects multiple times.")}static encodeOne(e,t){const r=new o(t);return r.on("data",()=>{}),r.pushAny(e),r.stopRecording(),r.removeAllListeners("data"),r._encodeAll([e])}static encodeAsync(e,t){return new Promise((r,n)=>{const i=[],a=new o(t);a.on("data",()=>{}),a.on("error",n),a.on("finish",()=>r(s.concat(i))),a.pushAny(e),a.stopRecording(),a.removeAllListeners("data"),a.on("data",e=>i.push(e)),a.pushAny(e),a.end()})}}e.exports=o},3127:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.platformCrypto=void 0;const n=r(4048),i=r(9071),s=r(9495);t.platformCrypto=n.isNode?i.NodeCrypto:s.BrowserCrypto},3144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.edwards=h,t.eddsa=l,t.twistedEdwards=function(e){const{CURVE:t,curveOpts:r,eddsaOpts:n}=function(e){const t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:(0,s.Field)(t.n,e.nBitLength,!0),uvRatio:e.uvRatio},eddsaOpts:{hash:e.hash,randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve}}}(e);return function(e,t){return Object.assign({},t,{ExtendedPoint:t.Point,CURVE:e})}(e,l(h(t,r),n))};const n=r(6376),i=r(407),s=r(7342),o=BigInt(0),a=BigInt(1),c=BigInt(2),f=BigInt(8),u={zip215:!0};function h(e,t={}){const{Fp:r,Fn:s}=(0,i._createCurveFields)("edwards",e,t),{h:u,n:h}=e;(0,n._validateObject)(t,{},{uvRatio:"function"});const l=c<<BigInt(8*s.BYTES)-a,d=e=>r.create(e),p=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(r.div(e,t))}}catch(e){return{isValid:!1,value:o}}});if(!function(e,t,r,n){const i=e.sqr(r),s=e.sqr(n),o=e.add(e.mul(t.a,i),s),a=e.add(e.ONE,e.mul(t.d,e.mul(i,s)));return e.eql(o,a)}(r,e,e.Gx,e.Gy))throw new Error("bad curve params: generator point");function y(e,t,r=!1){const i=r?a:o;return(0,n.aInRange)("coordinate "+e,t,i,l),t}function g(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}const m=(0,n.memoized)((e,t)=>{const{ex:n,ey:i,ez:s}=e,c=e.is0();null==t&&(t=c?f:r.inv(s));const u=d(n*t),h=d(i*t),l=d(s*t);if(c)return{x:o,y:a};if(l!==a)throw new Error("invZ was invalid");return{x:u,y:h}}),b=(0,n.memoized)(t=>{const{a:r,d:n}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:s,ez:o,et:a}=t,c=d(i*i),f=d(s*s),u=d(o*o),h=d(u*u),l=d(c*r);if(d(u*d(l+f))!==d(h+d(n*d(c*f))))throw new Error("bad point: equation left != right (1)");if(d(i*s)!==d(o*a))throw new Error("bad point: equation left != right (2)");return!0});class w{constructor(e,t,r,n){this.ex=y("x",e),this.ey=y("y",t),this.ez=y("z",r,!0),this.et=y("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return y("x",t),y("y",r),new w(t,r,a,d(t*r))}static normalizeZ(e){return(0,i.normalizeZ)(w,"ez",e)}static msm(e,t){return(0,i.pippenger)(w,s,e,t)}_setWindowSize(e){this.precompute(e)}precompute(e=8,t=!0){return _.setWindowSize(this,e),t||this.multiply(c),this}assertValidity(){b(this)}equals(e){g(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:s,ez:o}=e,a=d(t*o),c=d(i*n),f=d(r*o),u=d(s*n);return a===c&&f===u}is0(){return this.equals(w.ZERO)}negate(){return new w(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,s=d(r*r),o=d(n*n),a=d(c*d(i*i)),f=d(t*s),u=r+n,h=d(d(u*u)-s-o),l=f+o,p=l-a,y=f-o,g=d(h*p),m=d(l*y),b=d(h*y),_=d(p*l);return new w(g,m,_,b)}add(t){g(t);const{a:r,d:n}=e,{ex:i,ey:s,ez:o,et:a}=this,{ex:c,ey:f,ez:u,et:h}=t,l=d(i*c),p=d(s*f),y=d(a*n*h),m=d(o*u),b=d((i+s)*(c+f)-l-p),_=m-y,v=m+y,E=d(p-r*l),S=d(b*_),B=d(v*E),A=d(b*E),I=d(_*v);return new w(S,B,I,A)}subtract(e){return this.add(e.negate())}multiply(e){const t=e;(0,n.aInRange)("scalar",t,a,h);const{p:r,f:i}=_.wNAFCached(this,t,w.normalizeZ);return w.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=w.ZERO){const r=e;return(0,n.aInRange)("scalar",r,o,h),r===o?w.ZERO:this.is0()||r===a?this:_.wNAFCachedUnsafe(this,r,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return _.wNAFCachedUnsafe(this,h).is0()}toAffine(e){return m(this,e)}clearCofactor(){return u===a?this:this.multiplyUnsafe(u)}static fromBytes(e,t=!1){return(0,n.abytes)(e),this.fromHex(e,t)}static fromHex(t,i=!1){const{d:s,a:c}=e,f=r.BYTES;t=(0,n.ensureBytes)("pointHex",t,f),(0,n.abool)("zip215",i);const u=t.slice(),h=t[f-1];u[f-1]=-129&h;const y=(0,n.bytesToNumberLE)(u),g=i?l:r.ORDER;(0,n.aInRange)("pointHex.y",y,o,g);const m=d(y*y),b=d(m-a),_=d(s*m-c);let{isValid:v,value:E}=p(b,_);if(!v)throw new Error("Point.fromHex: invalid y coordinate");const S=(E&a)===a,B=!!(128&h);if(!i&&E===o&&B)throw new Error("Point.fromHex: x=0 and x_0=1");return B!==S&&(E=d(-E)),w.fromAffine({x:E,y})}static fromPrivateScalar(e){return w.BASE.multiply(e)}toBytes(){const{x:e,y:t}=this.toAffine(),i=(0,n.numberToBytesLE)(t,r.BYTES);return i[i.length-1]|=e&a?128:0,i}toRawBytes(){return this.toBytes()}toHex(){return(0,n.bytesToHex)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}w.BASE=new w(e.Gx,e.Gy,a,d(e.Gx*e.Gy)),w.ZERO=new w(o,a,a,o),w.Fp=r,w.Fn=s;const _=(0,i.wNAF)(w,8*s.BYTES);return w}function l(e,t){(0,n._validateObject)(t,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r,hash:i}=t,{BASE:s,Fp:a,Fn:c}=e,f=c.ORDER,h=t.randomBytes||n.randomBytes,l=t.adjustScalarBytes||(e=>e),d=t.domain||((e,t,r)=>{if((0,n.abool)("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function p(e){return c.create(e)}function y(e){return p((0,n.bytesToNumberLE)(e))}function g(e){const{head:t,prefix:r,scalar:o}=function(e){const t=a.BYTES;e=(0,n.ensureBytes)("private key",e,t);const r=(0,n.ensureBytes)("hashed private key",i(e),2*t),s=l(r.slice(0,t));return{head:s,prefix:r.slice(t,2*t),scalar:y(s)}}(e),c=s.multiply(o),f=c.toBytes();return{head:t,prefix:r,scalar:o,point:c,pointBytes:f}}function m(e=Uint8Array.of(),...t){const s=(0,n.concatBytes)(...t);return y(i(d(s,(0,n.ensureBytes)("context",e),!!r)))}const b=u;return s.precompute(8),{getPublicKey:function(e){return g(e).pointBytes},sign:function(e,t,i={}){e=(0,n.ensureBytes)("message",e),r&&(e=r(e));const{prefix:c,scalar:u,pointBytes:h}=g(t),l=m(i.context,c,e),d=s.multiply(l).toBytes(),y=p(l+m(i.context,d,h,e)*u);(0,n.aInRange)("signature.s",y,o,f);const b=a.BYTES,w=(0,n.concatBytes)(d,(0,n.numberToBytesLE)(y,b));return(0,n.ensureBytes)("result",w,2*b)},verify:function(t,i,o,c=b){const{context:f,zip215:u}=c,h=a.BYTES;t=(0,n.ensureBytes)("signature",t,2*h),i=(0,n.ensureBytes)("message",i),o=(0,n.ensureBytes)("publicKey",o,h),void 0!==u&&(0,n.abool)("zip215",u),r&&(i=r(i));const l=(0,n.bytesToNumberLE)(t.slice(h,2*h));let d,p,y;try{d=e.fromHex(o,u),p=e.fromHex(t.slice(0,h),u),y=s.multiplyUnsafe(l)}catch(e){return!1}if(!u&&d.isSmallOrder())return!1;const g=m(f,p.toBytes(),d.toBytes(),i);return p.add(d.multiplyUnsafe(g)).subtract(y).clearCofactor().is0()},utils:{getExtendedPublicKey:g,randomPrivateKey:()=>h(a.BYTES),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},Point:e}}},3170:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pinEncryptInfo=void 0,t.getKeyMaterial=s,t.getKey=o,t.decrypt=async function(e,t){if(!e.encryptInfo)return e.data;try{const r=await s(t),n=await o(r,i.Buffer.from(e.encryptInfo.salt,"base64")),a=await window.crypto.subtle.decrypt({name:e.encryptInfo.DERIVED_KEY_TYPE,iv:i.Buffer.from(e.encryptInfo.iv,"base64")},n,e.data);return i.Buffer.from(a)}catch(e){return console.error(e),null}},t.encrypt=async function(e,t){if(!e)return;const r=window.crypto.getRandomValues(new Uint8Array(16)),o=window.crypto.getRandomValues(new Uint8Array(12)),a=await s(e),c=await window.crypto.subtle.deriveKey({name:n.encryptInfo.ALG,salt:r,iterations:n.encryptInfo.ITERATIONS,hash:n.encryptInfo.HASH},a,{name:n.encryptInfo.DERIVED_KEY_TYPE,length:n.encryptInfo.DERIVED_KEY_LENGTH},!0,["encrypt","decrypt"]),f=await window.crypto.subtle.encrypt({name:n.encryptInfo.DERIVED_KEY_TYPE,iv:o},c,t);return{version:1,encryptInfo:{...n.encryptInfo,iv:i.Buffer.from(o).toString("base64"),salt:i.Buffer.from(r).toString("base64")},data:i.Buffer.from(f)}};const n=r(5617),i=r(4686);function s(e){const t=new TextEncoder;return window.crypto.subtle.importKey("raw",t.encode(e),n.encryptInfo.ALG,!1,["deriveBits","deriveKey"])}function o(e,t){return window.crypto.subtle.deriveKey({name:n.encryptInfo.ALG,salt:t,iterations:n.encryptInfo.ITERATIONS,hash:n.encryptInfo.HASH},e,{name:n.encryptInfo.DERIVED_KEY_TYPE,length:n.encryptInfo.DERIVED_KEY_LENGTH},!0,["encrypt","decrypt"])}t.pinEncryptInfo={ALG:"PBKDF2",ITERATIONS:1e5,DERIVED_KEY_TYPE:"AES-GCM",DERIVED_KEY_LENGTH:256,HASH:"SHA-256",SALT_LENGTH:16,IV_LENGTH:12}},3271:(e,t,r)=>{"use strict";const n=r(896),i=r(6899),s=r(8590),o=r(790),{MT:a,NUMBYTES:c,SHIFT32:f,SIMPLE:u,SYMS:h,TAG:l,BI:d}=o,{Buffer:p}=r(4686),y=a.SIMPLE_FLOAT<<5|c.TWO,g=a.SIMPLE_FLOAT<<5|c.FOUR,m=a.SIMPLE_FLOAT<<5|c.EIGHT,b=a.SIMPLE_FLOAT<<5|u.TRUE,w=a.SIMPLE_FLOAT<<5|u.FALSE,_=a.SIMPLE_FLOAT<<5|u.UNDEFINED,v=a.SIMPLE_FLOAT<<5|u.NULL,E=p.from([255]),S=p.from("f97e00","hex"),B=p.from("f9fc00","hex"),A=p.from("f97c00","hex"),I=p.from("f98000","hex"),x={};let T={};class O extends n.Transform{constructor(e={}){const{canonical:t=!1,encodeUndefined:r,disallowUndefinedKeys:n=!1,dateType:i="number",collapseBigIntegers:s=!1,detectLoops:o=!1,omitUndefinedProperties:a=!1,genTypes:c=[],...f}=e;if(super({...f,readableObjectMode:!1,writableObjectMode:!0}),this.canonical=t,this.encodeUndefined=r,this.disallowUndefinedKeys=n,this.dateType=function(e){if(!e)return"number";switch(e.toLowerCase()){case"number":return"number";case"float":return"float";case"int":case"integer":return"int";case"string":return"string"}throw new TypeError(`dateType invalid, got "${e}"`)}(i),this.collapseBigIntegers=!!this.canonical||s,this.detectLoops=void 0,"boolean"==typeof o)o&&(this.detectLoops=new WeakSet);else{if(!(o instanceof WeakSet))throw new TypeError("detectLoops must be boolean or WeakSet");this.detectLoops=o}if(this.omitUndefinedProperties=a,this.semanticTypes={...O.SEMANTIC_TYPES},Array.isArray(c))for(let e=0,t=c.length;e<t;e+=2)this.addSemanticType(c[e],c[e+1]);else for(const[e,t]of Object.entries(c))this.addSemanticType(e,t)}_transform(e,t,r){r(!1===this.pushAny(e)?new Error("Push Error"):void 0)}_flush(e){e()}_pushUInt8(e){const t=p.allocUnsafe(1);return t.writeUInt8(e,0),this.push(t)}_pushUInt16BE(e){const t=p.allocUnsafe(2);return t.writeUInt16BE(e,0),this.push(t)}_pushUInt32BE(e){const t=p.allocUnsafe(4);return t.writeUInt32BE(e,0),this.push(t)}_pushFloatBE(e){const t=p.allocUnsafe(4);return t.writeFloatBE(e,0),this.push(t)}_pushDoubleBE(e){const t=p.allocUnsafe(8);return t.writeDoubleBE(e,0),this.push(t)}_pushNaN(){return this.push(S)}_pushInfinity(e){const t=e<0?B:A;return this.push(t)}_pushFloat(e){if(this.canonical){const t=p.allocUnsafe(2);if(s.writeHalf(t,e))return this._pushUInt8(y)&&this.push(t)}return Math.fround(e)===e?this._pushUInt8(g)&&this._pushFloatBE(e):this._pushUInt8(m)&&this._pushDoubleBE(e)}_pushInt(e,t,r){const n=t<<5;if(e<24)return this._pushUInt8(n|e);if(e<=255)return this._pushUInt8(n|c.ONE)&&this._pushUInt8(e);if(e<=65535)return this._pushUInt8(n|c.TWO)&&this._pushUInt16BE(e);if(e<=4294967295)return this._pushUInt8(n|c.FOUR)&&this._pushUInt32BE(e);let i=Number.MAX_SAFE_INTEGER;return t===a.NEG_INT&&i--,e<=i?this._pushUInt8(n|c.EIGHT)&&this._pushUInt32BE(Math.floor(e/f))&&this._pushUInt32BE(e%f):t===a.NEG_INT?this._pushFloat(r):this._pushFloat(e)}_pushIntNum(e){return Object.is(e,-0)?this.push(I):e<0?this._pushInt(-e-1,a.NEG_INT,e):this._pushInt(e,a.POS_INT)}_pushNumber(e){return isNaN(e)?this._pushNaN():isFinite(e)?Math.round(e)===e?this._pushIntNum(e):this._pushFloat(e):this._pushInfinity(e)}_pushString(e){const t=p.byteLength(e,"utf8");return this._pushInt(t,a.UTF8_STRING)&&this.push(e,"utf8")}_pushBoolean(e){return this._pushUInt8(e?b:w)}_pushUndefined(e){switch(typeof this.encodeUndefined){case"undefined":return this._pushUInt8(_);case"function":return this.pushAny(this.encodeUndefined(e));case"object":{const e=s.bufferishToBuffer(this.encodeUndefined);if(e)return this.push(e)}}return this.pushAny(this.encodeUndefined)}_pushNull(e){return this._pushUInt8(v)}_pushTag(e){return this._pushInt(e,a.TAG)}_pushJSBigint(e){let t=a.POS_INT,r=l.POS_BIGINT;if(e<0&&(e=-e+d.MINUS_ONE,t=a.NEG_INT,r=l.NEG_BIGINT),this.collapseBigIntegers&&e<=d.MAXINT64)return e<=4294967295?this._pushInt(Number(e),t):this._pushUInt8(t<<5|c.EIGHT)&&this._pushUInt32BE(Number(e/d.SHIFT32))&&this._pushUInt32BE(Number(e%d.SHIFT32));let n=e.toString(16);n.length%2&&(n=`0${n}`);const i=p.from(n,"hex");return this._pushTag(r)&&O._pushBuffer(this,i)}_pushObject(e,t){if(!e)return this._pushNull(e);if(!(t={indefinite:!1,skipTypes:!1,...t}).indefinite&&this.detectLoops){if(this.detectLoops.has(e))throw new Error("Loop detected while CBOR encoding.\nCall removeLoopDetectors before resuming.");this.detectLoops.add(e)}if(!t.skipTypes){const t=e.encodeCBOR;if("function"==typeof t)return t.call(e,this);const r=this.semanticTypes[e.constructor.name];if(r)return r.call(e,this,e)}const r=Object.keys(e).filter(t=>{const r=typeof e[t];return"function"!==r&&(!this.omitUndefinedProperties||"undefined"!==r)}),n={};if(this.canonical&&r.sort((e,t)=>{const r=n[e]||(n[e]=O.encode(e)),i=n[t]||(n[t]=O.encode(t));return r.compare(i)}),t.indefinite){if(!this._pushUInt8(a.MAP<<5|c.INDEFINITE))return!1}else if(!this._pushInt(r.length,a.MAP))return!1;let i=null;for(let t=0,s=r.length;t<s;t++){const s=r[t];if(this.canonical&&(i=n[s])){if(!this.push(i))return!1}else if(!this._pushString(s))return!1;if(!this.pushAny(e[s]))return!1}if(t.indefinite){if(!this.push(E))return!1}else this.detectLoops&&this.detectLoops.delete(e);return!0}_encodeAll(e){const t=new i({highWaterMark:this.readableHighWaterMark});this.pipe(t);for(const t of e)this.pushAny(t);return this.end(),t.read()}addSemanticType(e,t){const r="string"==typeof e?e:e.name,n=this.semanticTypes[r];if(t){if("function"!=typeof t)throw new TypeError("fun must be of type function");this.semanticTypes[r]=t}else n&&delete this.semanticTypes[r];return n}pushAny(e){switch(typeof e){case"number":return this._pushNumber(e);case"bigint":return this._pushJSBigint(e);case"string":return this._pushString(e);case"boolean":return this._pushBoolean(e);case"undefined":return this._pushUndefined(e);case"object":return this._pushObject(e);case"symbol":switch(e){case h.NULL:return this._pushNull(null);case h.UNDEFINED:return this._pushUndefined(void 0);default:throw new TypeError(`Unknown symbol: ${e.toString()}`)}default:throw new TypeError(`Unknown type: ${typeof e}, ${"function"==typeof e.toString?e.toString():""}`)}}static pushArray(e,t,r){r={indefinite:!1,...r};const n=t.length;if(r.indefinite){if(!e._pushUInt8(a.ARRAY<<5|c.INDEFINITE))return!1}else if(!e._pushInt(n,a.ARRAY))return!1;for(let r=0;r<n;r++)if(!e.pushAny(t[r]))return!1;return!(r.indefinite&&!e.push(E))}removeLoopDetectors(){return!!this.detectLoops&&(this.detectLoops=new WeakSet,!0)}static _pushDate(e,t){switch(e.dateType){case"string":return e._pushTag(l.DATE_STRING)&&e._pushString(t.toISOString());case"int":return e._pushTag(l.DATE_EPOCH)&&e._pushIntNum(Math.round(t.getTime()/1e3));case"float":return e._pushTag(l.DATE_EPOCH)&&e._pushFloat(t.getTime()/1e3);default:return e._pushTag(l.DATE_EPOCH)&&e.pushAny(t.getTime()/1e3)}}static _pushBuffer(e,t){return e._pushInt(t.length,a.BYTE_STRING)&&e.push(t)}static _pushNoFilter(e,t){return O._pushBuffer(e,t.slice())}static _pushRegexp(e,t){return e._pushTag(l.REGEXP)&&e.pushAny(t.source)}static _pushSet(e,t){if(!e._pushTag(l.SET))return!1;if(!e._pushInt(t.size,a.ARRAY))return!1;for(const r of t)if(!e.pushAny(r))return!1;return!0}static _pushURL(e,t){return e._pushTag(l.URI)&&e.pushAny(t.toString())}static _pushBoxed(e,t){return e.pushAny(t.valueOf())}static _pushMap(e,t,r){r={indefinite:!1,...r};let n=[...t.entries()];if(e.omitUndefinedProperties&&(n=n.filter(([e,t])=>void 0!==t)),r.indefinite){if(!e._pushUInt8(a.MAP<<5|c.INDEFINITE))return!1}else if(!e._pushInt(n.length,a.MAP))return!1;if(e.canonical){const t=new O({genTypes:e.semanticTypes,canonical:e.canonical,detectLoops:Boolean(e.detectLoops),dateType:e.dateType,disallowUndefinedKeys:e.disallowUndefinedKeys,collapseBigIntegers:e.collapseBigIntegers}),r=new i({highWaterMark:e.readableHighWaterMark});t.pipe(r),n.sort(([e],[n])=>{t.pushAny(e);const i=r.read();t.pushAny(n);const s=r.read();return i.compare(s)});for(const[t,r]of n){if(e.disallowUndefinedKeys&&void 0===t)throw new Error("Invalid Map key: undefined");if(!e.pushAny(t)||!e.pushAny(r))return!1}}else for(const[t,r]of n){if(e.disallowUndefinedKeys&&void 0===t)throw new Error("Invalid Map key: undefined");if(!e.pushAny(t)||!e.pushAny(r))return!1}return!(r.indefinite&&!e.push(E))}static _pushTypedArray(e,t){let r=64,n=t.BYTES_PER_ELEMENT;const{name:i}=t.constructor;return i.startsWith("Float")?(r|=16,n/=2):i.includes("U")||(r|=8),(i.includes("Clamped")||1!==n&&!s.isBigEndian())&&(r|=4),r|={1:0,2:1,4:2,8:3}[n],!!e._pushTag(r)&&O._pushBuffer(e,p.from(t.buffer,t.byteOffset,t.byteLength))}static _pushArrayBuffer(e,t){return O._pushBuffer(e,p.from(t))}static encodeIndefinite(e,t,r={}){if(null==t){if(null==this)throw new Error("No object to encode");t=this}const{chunkSize:n=4096}=r;let i=!0;const o=typeof t;let f=null;if("string"===o){i=i&&e._pushUInt8(a.UTF8_STRING<<5|c.INDEFINITE);let r=0;for(;r<t.length;){const s=r+n;i=i&&e._pushString(t.slice(r,s)),r=s}i=i&&e.push(E)}else if(f=s.bufferishToBuffer(t)){i=i&&e._pushUInt8(a.BYTE_STRING<<5|c.INDEFINITE);let t=0;for(;t<f.length;){const r=t+n;i=i&&O._pushBuffer(e,f.slice(t,r)),t=r}i=i&&e.push(E)}else if(Array.isArray(t))i=i&&O.pushArray(e,t,{indefinite:!0});else if(t instanceof Map)i=i&&O._pushMap(e,t,{indefinite:!0});else{if("object"!==o)throw new Error("Invalid indefinite encoding");i=i&&e._pushObject(t,{indefinite:!0,skipTypes:!0})}return i}static encode(...e){return(new O)._encodeAll(e)}static encodeCanonical(...e){return new O({canonical:!0})._encodeAll(e)}static encodeOne(e,t){return new O(t)._encodeAll([e])}static encodeAsync(e,t){return new Promise((r,n)=>{const i=[],s=new O(t);s.on("data",e=>i.push(e)),s.on("error",n),s.on("finish",()=>r(p.concat(i))),s.pushAny(e),s.end()})}static get SEMANTIC_TYPES(){return T}static set SEMANTIC_TYPES(e){T=e}static reset(){O.SEMANTIC_TYPES={...x}}}Object.assign(x,{Array:O.pushArray,Date:O._pushDate,Buffer:O._pushBuffer,[p.name]:O._pushBuffer,Map:O._pushMap,NoFilter:O._pushNoFilter,[i.name]:O._pushNoFilter,RegExp:O._pushRegexp,Set:O._pushSet,ArrayBuffer:O._pushArrayBuffer,Uint8ClampedArray:O._pushTypedArray,Uint8Array:O._pushTypedArray,Uint16Array:O._pushTypedArray,Uint32Array:O._pushTypedArray,Int8Array:O._pushTypedArray,Int16Array:O._pushTypedArray,Int32Array:O._pushTypedArray,Float32Array:O._pushTypedArray,Float64Array:O._pushTypedArray,URL:O._pushURL,Boolean:O._pushBoxed,Number:O._pushBoxed,String:O._pushBoxed}),"undefined"!=typeof BigUint64Array&&(x[BigUint64Array.name]=O._pushTypedArray),"undefined"!=typeof BigInt64Array&&(x[BigInt64Array.name]=O._pushTypedArray),O.reset(),e.exports=O},3274:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CryptoChannel=t.GameOfLifeIcon=t.KeyManager=t.IdManager=t.LocalStorage=t.convertWebWritableStreamToNodeWritable=t.convertWebReadableStreamToNodeReadable=t.StreamChannel=t.MemoryStorage=t.MemoryChannel=t.Challenger=t.VaultysId=t.Buffer=t.crypto=void 0;const c=a(r(2114));t.Challenger=c.default;const f=a(r(5079));t.IdManager=f.default;const u=a(r(2810));t.KeyManager=u.default;const h=a(r(5550));t.VaultysId=h.default;const l=r(3061);Object.defineProperty(t,"MemoryChannel",{enumerable:!0,get:function(){return l.MemoryChannel}}),Object.defineProperty(t,"StreamChannel",{enumerable:!0,get:function(){return l.StreamChannel}}),Object.defineProperty(t,"convertWebReadableStreamToNodeReadable",{enumerable:!0,get:function(){return l.convertWebReadableStreamToNodeReadable}}),Object.defineProperty(t,"convertWebWritableStreamToNodeWritable",{enumerable:!0,get:function(){return l.convertWebWritableStreamToNodeWritable}});const d=r(3903);Object.defineProperty(t,"MemoryStorage",{enumerable:!0,get:function(){return d.MemoryStorage}}),Object.defineProperty(t,"LocalStorage",{enumerable:!0,get:function(){return d.LocalStorage}});const p=a(r(2739));t.GameOfLifeIcon=p.default;const y=a(r(4015));t.CryptoChannel=y.default;const g=o(r(5598));t.crypto=g;const m=g.Buffer;t.Buffer=m,void 0===Symbol.dispose&&(Symbol.dispose=Symbol("Symbol.dispose"))},3321:function(e,t,r){"use strict";var n=r(4686).Buffer,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DearmorStream=t.ArmorStream=t.MessageType=t.debug=void 0,t.armor=function(e,t){const r=Object.assign({},p,t);"number"==typeof r.message_type&&(r.message_type=d(r.message_type));const n=(0,o.chunkBuffer)(e,r.block_size);let i="";for(const e of n)i+=v(e,r.alphabet,r.shift);if(r.raw)return(0,o.chunkString)(i,43).join(" ");const s=(0,o.chunkString)(i,15),a=(0,c.default)(s,200).map(e=>e.join(" ")).join("\n"),f=r.app_name?" "+r.app_name:"";return"BEGIN"+f+" SALTPACK "+r.message_type+". "+a+(". END"+f+" SALTPACK "+r.message_type+".")},t.dearmor=function(e,t){var r;const i=Object.assign({},p,t);let s,a,c,f=null,l=null;if(!i.raw){if([s,e,a,l]=e.split(".",4),l=n.from(l),!(c=s.match(u)))throw new Error("Invalid header");if(f={message_type:c[3],app_name:null!==(r=c[2])&&void 0!==r?r:null},!(c=a.match(h)))throw new Error("Invalid footer");if(f.message_type!==c[3]||f.app_name!=c[2])throw new Error("Footer doesn't match header")}e=e.replace(/[>\n\r\t ]/g,"");const d=(0,o.chunkString)(e,i.char_block_size).map(e=>E(e,i.alphabet,i.shift)),y=n.concat(d);return Object.assign(y,{remaining:l,header_info:f})},t.encodeBlock=v,t.decodeBlock=E,t.efficientCharsSizes=function(e,t=50){const r=[];let n=0;for(let i=1;i<t;i++){const t=m(e,i),s=t/i;s>n&&(r.push([i,t,s]),n=s)}return r};const s=r(931),o=r(568),a=r(896),c=i(r(9399));t.debug=!1;const f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",u=/^[>\n\r\t ]*BEGIN[>\n\r\t ]+(([a-zA-Z0-9]+)[>\n\r\t ]+)?SALTPACK[>\n\r\t ]+(MESSAGE|ENCRYPTED[>\n\r\t ]+MESSAGE|SIGNED[>\n\r\t ]+MESSAGE|DETACHED[>\n\r\t ]+SIGNATURE)[>\n\r\t ]*$/,h=/^[>\n\r\t ]*END[>\n\r\t ]+(([a-zA-Z0-9]+)[>\n\r\t ]+)?SALTPACK[>\n\r\t ]+(MESSAGE|ENCRYPTED[>\n\r\t ]+MESSAGE|SIGNED[>\n\r\t ]+MESSAGE|DETACHED[>\n\r\t ]+SIGNATURE)[>\n\r\t ]*$/;var l;function d(e){switch(e){case s.MessageType.ENCRYPTION:return l.ENCRYPTED_MESSAGE;case s.MessageType.ATTACHED_SIGNING:return l.SIGNED_MESSAGE;case s.MessageType.DETACHED_SIGNING:return l.DETACHED_SIGNATURE;case s.MessageType.SIGNCRYPTION:return l.ENCRYPTED_MESSAGE;default:return"MESSAGE"}}!function(e){e.ENCRYPTED_MESSAGE="ENCRYPTED MESSAGE",e.SIGNED_MESSAGE="SIGNED MESSAGE",e.DETACHED_SIGNATURE="DETACHED SIGNATURE"}(l||(t.MessageType=l={}));const p={alphabet:f,block_size:32,char_block_size:43,raw:!1,shift:!1,message_type:"MESSAGE",app_name:null};function y(e,t){const r=e.indexOf(t);if(-1===r)throw new Error("Could not find "+t+" in alphabet "+e);return r}function g(e,t){return Math.ceil(8*t/Math.log2(e))}function m(e,t){return Math.floor(Math.log2(e)/8*t)}function b(e,t,r){return Math.floor(Math.log2(e)*t)-8*r}class w extends a.Transform{constructor(e){super(),this.in_buffer=n.alloc(0),this.out_buffer="",this.words=0,this.i=0,this.armor_options=Object.assign({},p,e),"number"==typeof this.armor_options.message_type&&(this.armor_options.message_type=d(this.armor_options.message_type));const t=this.armor_options.app_name?" "+this.armor_options.app_name:"";this.armor_header="BEGIN"+t+" SALTPACK "+this.armor_options.message_type+". ",this.armor_footer=". END"+t+" SALTPACK "+this.armor_options.message_type+".",this.armor_options.raw||this.push(this.armor_header)}_transform(e,r,i){for(t.debug&&console.log("Processing chunk #%d: %O",this.i++,e),this.in_buffer=n.concat([this.in_buffer,e]);this.in_buffer.length>this.armor_options.block_size;){const e=this.in_buffer.slice(0,this.armor_options.block_size);this.in_buffer=this.in_buffer.slice(this.armor_options.block_size),this.out_buffer+=v(e,this.armor_options.alphabet,this.armor_options.shift)}if(this.armor_options.raw)for(;this.out_buffer.length>43;)this.push(this.out_buffer.substr(0,43)+" "),this.out_buffer=this.out_buffer.substr(43);else for(;this.out_buffer.length>15;){const e=this.out_buffer.substr(0,15);this.out_buffer=this.out_buffer.substr(15),this.words++,this.words>=200?(this.push(e+"\n"),this.words=0):this.push(e+" ")}i()}_flush(e){if(this.in_buffer.length>0&&(this.out_buffer+=v(this.in_buffer,this.armor_options.alphabet,this.armor_options.shift),this.in_buffer=n.alloc(0)),this.armor_options.raw)for(;this.out_buffer.length>43;)this.push(this.out_buffer.substr(0,43)+" "),this.out_buffer=this.out_buffer.substr(43);else for(;this.out_buffer.length>15;){const e=this.out_buffer.substr(0,15);this.out_buffer=this.out_buffer.substr(15),this.words++,this.words>=200?(this.push(e+"\n"),this.words=0):this.push(e+" ")}this.push(this.out_buffer),this.armor_options.raw||this.push(this.armor_footer),e()}}t.ArmorStream=w;class _ extends a.Transform{get header(){if(this.armor_options.raw)throw new Error("Header isn't available when decoding raw armored data");if(!this.armor_header)throw new Error("Header hasn't been decoded yet");return this.armor_header}get footer(){if(this.armor_options.raw)throw new Error("Footer isn't available when decoding raw armored data");if(!this.armor_footer)throw new Error("Footer hasn't been decoded yet");return this.armor_footer}get info(){if(this.armor_options.raw)throw new Error("Header isn't available when decoding raw armored data");if(!this.armor_header_info)throw new Error("Header hasn't been decoded yet");return this.armor_header_info}constructor(e){super(),this.in_buffer=n.alloc(0),this.out_buffer="",this.armor_header_info=null,this.armor_header=null,this.armor_footer=null,this.words=0,this.i=0,this.armor_options=Object.assign({},p,e)}_transform(e,r,i){var s;if(t.debug&&console.log("Processing chunk #%d: %O",this.i++,e),!this.armor_options.raw&&null===this.armor_header){this.in_buffer=n.concat([this.in_buffer,e]);const r=this.in_buffer.indexOf(".");if(-1===r)return i();this.armor_header=this.in_buffer.slice(0,r).toString(),e=this.in_buffer.slice(r+1);const o=this.armor_header.match(u);if(!o){const e=new Error("Invalid header");throw i(e),e}this.armor_header_info={message_type:o[3],app_name:null!==(s=o[2])&&void 0!==s?s:null},t.debug&&console.log("Read header: %s",this.armor_header)}if(!this.armor_options.raw&&null!==this.armor_footer){this.armor_footer+=e.toString();const t=this.armor_footer.indexOf(".");if(-1!==t)return this.armor_footer=this.armor_footer.substr(0,t),i()}if(!this.armor_options.raw&&null===this.armor_footer){const t=e.indexOf(".");if(-1!==t){this.armor_footer=e.slice(t+1).toString(),e=e.slice(0,t),this.out_buffer=e.toString().replace(/[>\n\r\t ]/g,"");const r=this.armor_footer.indexOf(".");return-1!==r?(this.armor_footer=this.armor_footer.substr(0,r),i()):i()}}if(this.armor_options.raw||null===this.armor_footer)for(this.out_buffer+=e.toString().replace(/[>\n\r\t ]/g,"");this.out_buffer.length>this.armor_options.char_block_size;){const e=this.out_buffer.substr(0,this.armor_options.char_block_size);this.out_buffer=this.out_buffer.substr(this.armor_options.char_block_size),this.push(E(e,this.armor_options.alphabet,this.armor_options.shift))}i()}_flush(e){for(var r;this.out_buffer.length>this.armor_options.char_block_size;){const e=this.out_buffer.substr(0,this.armor_options.char_block_size);this.out_buffer=this.out_buffer.substr(this.armor_options.char_block_size),this.push(E(e,this.armor_options.alphabet,this.armor_options.shift))}if(this.out_buffer.length>0&&(this.push(E(this.out_buffer,this.armor_options.alphabet,this.armor_options.shift)),this.out_buffer=""),!this.armor_options.raw&&null===this.armor_footer){const t=new Error("Input stream doesn't contain a valid header and footer");throw e(t),t}if(!this.armor_options.raw){const e=null===(r=this.armor_footer)||void 0===r?void 0:r.match(h);if(!e)throw new Error("Invalid footer");if(this.armor_header_info.message_type!==e[3]||this.armor_header_info.app_name!=e[2])throw new Error("Footer doesn't match header");t.debug&&console.log("Read footer: %s",this.armor_footer)}e()}}function v(e,t=f,r=!1){const n=g(t.length,e.length),i=b(t.length,n,e.length);let s=BigInt("0x"+e.toString("hex"));r&&(s<<=BigInt(i));const o=BigInt(t.length),a=[];for(let e=0;e<n;e++){const e=parseInt((s%o).toString());a.unshift(e),s/=o}return a.map(e=>t[e]).join("")}function E(e,t=f,r=!1){const i=m(t.length,e.length),s=g(t.length,i);if(e.length!==s)throw new TypeError("Illegal block size "+e.length+", expected "+s);const o=b(t.length,e.length,i);let a=BigInt(y(t,e[0]));for(let r=1;r<e.length;r++)a*=BigInt(t.length),a+=BigInt(y(t,e[r]));return r&&(a>>=BigInt(o)),n.from(a.toString(16).padStart(2*i,"0").slice(0,2*i),"hex")}t.DearmorStream=_},3474:function(e,t,r){"use strict";var n=r(4686).Buffer,i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VerifyStream=t.SignStream=t.CHUNK_LENGTH=void 0,t.sign=function(e,r){const i=(0,f.chunkBuffer)(e,t.CHUNK_LENGTH),s=a.default.create(r.publicKey,!0),o=[];for(const e in i){const t=i[e],n=i.length===parseInt(e)+1,a=c.default.create(s,r.secretKey,t,BigInt(e),n);o.push(a)}return n.concat([s.encoded,n.concat(o.map(e=>e.encoded))])},t.verify=function(e,t){return i(this,void 0,void 0,function*(){var r,i,o,f;const l=new u.Readable;l.push(e),l.push(null);const d=[];try{for(var p,y=!0,g=s((0,h.decodeMultiStream)(l));!(r=(p=yield g.next()).done);y=!0){f=p.value,y=!1;const e=f;d.push(e)}}catch(e){i={error:e}}finally{try{y||r||!(o=g.return)||(yield o.call(g))}finally{if(i)throw i.error}}const m=d.shift(),b=a.default.decode(m,!0);if(t&&!n.from(b.public_key).equals(t))throw new Error("Sender public key doesn't match");let w=n.alloc(0);for(const e in d){const t=d[e],r=d.length===parseInt(e)+1,i=c.default.decode(t,!0);if(i.verify(b,b.public_key,BigInt(e)),i.final&&!r)throw new Error("Found payload with invalid final flag, message extended?");if(!i.final&&r)throw new Error("Found payload with invalid final flag, message truncated?");w=n.concat([w,i.data])}if(!d.length)throw new Error("No signed payloads, message truncated?");return Object.assign(w,{public_key:new Uint8Array(b.public_key)})})},t.signDetached=function(e,t){const r=a.default.create(t.publicKey,!1);return n.concat([r.encoded,(0,h.encode)(r.signDetached(n.from(e),t.secretKey))])},t.verifyDetached=function(e,t,r){return i(this,void 0,void 0,function*(){var i,o,c,f;const l=new u.Readable;l.push(e),l.push(null);const d=[];try{for(var p,y=!0,g=s((0,h.decodeMultiStream)(l));!(i=(p=yield g.next()).done);y=!0){f=p.value,y=!1;const e=f;d.push(e)}}catch(e){o={error:e}}finally{try{y||i||!(c=g.return)||(yield c.call(g))}finally{if(o)throw o.error}}const[m,b]=d,w=a.default.decode(m,!0);if(r&&!n.from(w.public_key).equals(r))throw new Error("Sender public key doesn't match");return w.verifyDetached(b,n.from(t),w.public_key),{public_key:new Uint8Array(w.public_key)}})};const a=o(r(7981)),c=o(r(6760)),f=r(568),u=r(896),h=r(2655);t.CHUNK_LENGTH=1048576;class l extends u.Transform{constructor(e){super(),this.keypair=e,this.in_buffer=n.alloc(0),this.payload_index=BigInt(0),this.header=a.default.create(e.publicKey,!0),this.push(this.header.encoded)}_transform(e,r,i){for(this.in_buffer=n.concat([this.in_buffer,e]);this.in_buffer.length>t.CHUNK_LENGTH;){const e=this.in_buffer.slice(0,t.CHUNK_LENGTH);this.in_buffer=this.in_buffer.slice(t.CHUNK_LENGTH);const r=c.default.create(this.header,this.keypair.secretKey,e,this.payload_index,!1);this.push(r.encoded),this.payload_index++}i()}_flush(e){for(;this.in_buffer.length>=t.CHUNK_LENGTH;){const e=this.in_buffer.slice(0,t.CHUNK_LENGTH);this.in_buffer=this.in_buffer.slice(t.CHUNK_LENGTH);const r=!this.in_buffer.length,n=c.default.create(this.header,this.keypair.secretKey,e,this.payload_index,r);this.push(n.encoded),this.payload_index++}if(this.in_buffer.length){const e=this.in_buffer;this.in_buffer=n.alloc(0);const t=!this.in_buffer.length,r=c.default.create(this.header,this.keypair.secretKey,e,this.payload_index,t);this.push(r.encoded),this.payload_index++}e()}}t.SignStream=l;class d extends u.Transform{constructor(e){super(),this.decoder=new h.Decoder,this.header_data=null,this.last_payload=null,this.payload_index=BigInt(-1),this.i=0,this._public_key=null!=e?e:null}get header(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data}get public_key(){return this.header.public_key}_transform(e,t,r){this.decoder.appendBuffer(e);try{let e;for(;e=this.decoder.doDecodeSync();){const t=n.from(this.decoder.bytes).slice(this.decoder.pos);this.decoder.setBuffer(t),this._handleMessage(e)}}catch(e){}r()}_handleMessage(e){if(this.header_data){if(this.payload_index++,this.last_payload){if(this.last_payload.final)throw new Error("Found payload with invalid final flag, message extended?");this.push(this.last_payload.data)}const t=c.default.decode(e,!0);t.verify(this.header,this.header.public_key,this.payload_index),this.last_payload=t}else{const t=a.default.decode(e,!0);if(this._public_key&&!n.from(t.public_key).equals(this._public_key))throw new Error("Sender public key doesn't match");this.header_data=t,t.public_key=new Uint8Array(t.public_key)}}_flush(e){try{if(this.last_payload){if(!this.last_payload.final)throw new Error("Found payload with invalid final flag, message truncated?");this.push(this.last_payload.data)}if(!this.last_payload)throw new Error("No signed payloads, message truncated?")}catch(t){return e(t)}e()}}t.VerifyStream=d},3548:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(4406),s=r(2655),o=r(3835),a=r(4072);class c{constructor(e,t,r){this.final=e,this.authenticators=t,this.payload_secretbox=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data}static create(e,t,r,s,c=!1){const f=n.alloc(8);f.writeBigUInt64BE(s);const u=n.concat([this.PAYLOAD_NONCE_PREFIX,f]),h=(0,i.secretbox)(Uint8Array.from(r),Uint8Array.from(u),Uint8Array.from(t)),l=this.generateAuthenticatorHash(e.hash,h,u,c);return new this(c,e.recipients.map((e,t)=>{if(!e.mac_key)throw new Error("Recipient #"+t+" doesn't have a MAC key set");return n.from((0,o.hmac)(a.sha512,e.mac_key,l).slice(0,32))}),h)}static generateAuthenticatorHash(e,t,r,i){return n.from(a.sha512.create().update(e).update(r).update(i?"":"\0").update(t).digest())}encode(){return c.encodePayload(this.final,this.authenticators,this.payload_secretbox)}static encodePayload(e,t,r){const i=[e,t,r];return n.from((0,s.encode)(i))}static decode(e,t=!1){const r=t?e:(0,s.decode)(e);if(r.length<3)throw new Error("Invalid data");const[n,i,o]=r;return new this(n,i,o)}decrypt(e,t,r,s){if(!t.mac_key)throw new Error("Recipient doesn't have a MAC key set");const f=this.authenticators[t.index],u=n.alloc(8);u.writeBigUInt64BE(s);const h=n.concat([c.PAYLOAD_NONCE_PREFIX,u]),l=c.generateAuthenticatorHash(e.hash,this.payload_secretbox,h,this.final),d=n.from((0,o.hmac)(a.sha512,t.mac_key,l).slice(0,32));if(!f||!d.equals(f))throw new Error("Invalid authenticator");const p=i.secretbox.open(Uint8Array.from(this.payload_secretbox),Uint8Array.from(h),Uint8Array.from(r));if(!p)throw new Error("Failed to decrypt data");return p}}c.PAYLOAD_NONCE_PREFIX=n.from("saltpack_ploadsb"),t.default=c},3616:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){}static createFromEntropy(e,t){throw new Error("Method must be implemented by concrete class")}static generate(){throw new Error("Method must be implemented by concrete class")}static fromSecret(e){throw new Error("Method must be implemented by concrete class")}static instantiate(e){throw new Error("Method must be implemented by concrete class")}static fromId(e){throw new Error("Method must be implemented by concrete class")}async sign(e){return"public"==this.capability?null:(await this.getSigner()).sign(e)}static async diffieHellman(e,t){return await e.performDiffieHellman(t)}static encrypt(e,t){throw new Error("Method must be implemented by concrete class")}}},3835:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hmac=t.HMAC=void 0;const n=r(11);class i extends n.Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,n.ahash)(e);const r=(0,n.toBytes)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),(0,n.clean)(s)}update(e){return(0,n.aexists)(this),this.iHash.update(e),this}digestInto(e){(0,n.aexists)(this),(0,n.abytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}t.HMAC=i,t.hmac=(e,t,r)=>new i(e,t).update(r).digest(),t.hmac.create=(e,t)=>new i(e,t)},3842:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toBig=t.shrSL=t.shrSH=t.rotrSL=t.rotrSH=t.rotrBL=t.rotrBH=t.rotr32L=t.rotr32H=t.rotlSL=t.rotlSH=t.rotlBL=t.rotlBH=t.add5L=t.add5H=t.add4L=t.add4H=t.add3L=t.add3H=void 0,t.add=w,t.fromBig=i,t.split=s;const r=BigInt(2**32-1),n=BigInt(32);function i(e,t=!1){return t?{h:Number(e&r),l:Number(e>>n&r)}:{h:0|Number(e>>n&r),l:0|Number(e&r)}}function s(e,t=!1){const r=e.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:a}=i(e[o],t);[n[o],s[o]]=[r,a]}return[n,s]}const o=(e,t)=>BigInt(e>>>0)<<n|BigInt(t>>>0);t.toBig=o;const a=(e,t,r)=>e>>>r;t.shrSH=a;const c=(e,t,r)=>e<<32-r|t>>>r;t.shrSL=c;const f=(e,t,r)=>e>>>r|t<<32-r;t.rotrSH=f;const u=(e,t,r)=>e<<32-r|t>>>r;t.rotrSL=u;const h=(e,t,r)=>e<<64-r|t>>>r-32;t.rotrBH=h;const l=(e,t,r)=>e>>>r-32|t<<64-r;t.rotrBL=l;const d=(e,t)=>t;t.rotr32H=d;const p=(e,t)=>e;t.rotr32L=p;const y=(e,t,r)=>e<<r|t>>>32-r;t.rotlSH=y;const g=(e,t,r)=>t<<r|e>>>32-r;t.rotlSL=g;const m=(e,t,r)=>t<<r-32|e>>>64-r;t.rotlBH=m;const b=(e,t,r)=>e<<r-32|t>>>64-r;function w(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}}t.rotlBL=b;const _=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);t.add3L=_;const v=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;t.add3H=v;const E=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);t.add4L=E;const S=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;t.add4H=S;const B=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);t.add5L=B;const A=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;t.add5H=A;const I={fromBig:i,split:s,toBig:o,shrSH:a,shrSL:c,rotrSH:f,rotrSL:u,rotrBH:h,rotrBL:l,rotr32H:d,rotr32L:p,rotlSH:y,rotlSL:g,rotlBH:m,rotlBL:b,add:w,add3L:_,add3H:v,add4L:E,add4H:S,add5H:A,add5L:B};t.default=I},3903:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.storagify=t.MessagePackStore=t.MemoryStore=t.MessagePackStorage=t.LocalStorage=t.MemoryStorage=t.deserialize=t.serialize=void 0;const n=r(2655),i=r(4686),s=(e,t)=>t?"certificate"===e||"publicKey"===e||"secretKey"===e?"_bx_"+i.Buffer.from(t).toString("base64"):"Buffer"===t.constructor.name?"_bx_"+t.toString("base64"):"Buffer"===t.type?"_bx_"+i.Buffer.from(t.data).toString("base64"):"Array"===t.constructor.name||"Uint8Array"===t.constructor.name?"_bx_"+i.Buffer.from(t).toString("base64"):t:t,o=(e,t)=>{if("string"==typeof t){if(t.startsWith("__C__"))return i.Buffer.from(t.slice(5),"base64");if(t.startsWith("_bx_"))return i.Buffer.from(t.slice(4),"base64")}return t};t.serialize=e=>JSON.stringify(e,s),t.deserialize=e=>JSON.parse(e,o),t.MemoryStorage=e=>{let r={};return e||(e=()=>(0,t.serialize)(r)),(0,t.storagify)(r,e,()=>"")},t.LocalStorage=(e="vaultysStorage")=>{let r={};return localStorage[e]?r=(0,t.deserialize)(localStorage[e]):localStorage[e]="{}",(0,t.storagify)(r,()=>localStorage.setItem(e,(0,t.serialize)(r)),()=>localStorage.removeItem(e))},t.MessagePackStorage=(e="vaultysStorage")=>{let r={};return localStorage[e]?r=(0,n.decode)(localStorage[e]):localStorage[e]=i.Buffer.from((0,n.encode)({})).toString("base64"),(0,t.storagify)(r,()=>localStorage.setItem(e,i.Buffer.from((0,n.encode)(r)).toString("base64")),()=>localStorage.removeItem(e))};class a{constructor(e){this._raw=e}save(){}destroy(){}toString(){return i.Buffer.from((0,n.encode)(this._raw)).toString("base64")}toJSON(){return(0,n.decode)((0,n.encode)(this._raw))}fromJSON(e,t,r){return new a(e)}fromString(e,t,r){return new a((0,n.decode)(i.Buffer.from(e,"base64")))}set(e,t){this._raw[e]=t}delete(e){delete this._raw[e]}get(e){return this._raw[e]}list(){return Object.keys(this._raw).filter(e=>!e.startsWith("!"))}listSubstores(){return Object.keys(this._raw).filter(e=>e.startsWith("!")).map(e=>e.slice(1))}deleteSubstore(e){delete this._raw["!"+e]}renameSubstore(e,t){e===t||this._raw["!"+t]||(this._raw["!"+t]=this._raw["!"+e],delete this._raw["!"+e])}substore(e){return this._raw["!"+e]||(this._raw["!"+e]={}),new a(this._raw["!"+e])}}t.MemoryStore=class extends a{},t.MessagePackStore=class extends a{},t.storagify=(e,r=()=>{},n=()=>{})=>{const i={_raw:e};return{...i,destroy:n,save:r,toString:()=>(0,t.serialize)(i._raw),toJSON:()=>(0,t.deserialize)((0,t.serialize)(i._raw)),fromJSON:(e,r,n)=>(0,t.storagify)(e,r,n),fromString:(e,r,n)=>(0,t.storagify)((0,t.deserialize)(e),r,n),set:(e,t)=>i._raw[e]=t,delete:e=>delete i._raw[e],get:e=>i._raw[e],list:()=>Object.keys(i._raw).filter(e=>!e.startsWith("!")),listSubstores:()=>Object.keys(i._raw).filter(e=>e.startsWith("!")).map(e=>e.slice(1)),deleteSubstore:e=>delete i._raw["!"+e],renameSubstore:(e,t)=>{e===t||i._raw["!"+t]||(i._raw["!"+t]=i._raw["!"+e],delete i._raw["!"+e])},substore:e=>(i._raw["!"+e]||(i._raw["!"+e]={}),(0,t.storagify)(i._raw["!"+e],r,n))}}},3990:function(e,t,r){"use strict";var n=r(4686).Buffer,i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DecryptStream=t.EncryptStream=void 0,t.debugSetKey=function(e){y=e},t.debugSetKeypair=function(e){g=e},t.encrypt=function(e,t,r){return i(this,void 0,void 0,function*(){const i=(0,u.chunkBuffer)(e,p),s=null!=y?y:n.from((0,l.randomBytes)(32)),o=null!=g?g:l.box.keyPair();t=null!=t?t:o;const h=r.map((e,t)=>c.default.create(e,o.secretKey,s,t)),d=a.default.create(o.publicKey,s,t.publicKey,h);for(const e of h)e.generateMacKeyForSender(d.hash,o.secretKey,t.secretKey);const m=[];for(const e in i){const t=i[e],r=i.length===parseInt(e)+1,n=f.default.create(d,s,t,BigInt(e),r);m.push(n)}return n.concat([d.encoded,n.concat(m.map(e=>e.encoded))])})},t.decrypt=function(e,t,r){return i(this,void 0,void 0,function*(){var i,o,c,u;const l=new h.Readable;l.push(e),l.push(null);const p=[];try{for(var y,g=!0,m=s((0,d.decodeMultiStream)(l));!(i=(y=yield m.next()).done);g=!0){u=y.value,g=!1;const e=u;p.push(e)}}catch(e){o={error:e}}finally{try{g||i||!(c=m.return)||(yield c.call(m))}finally{if(o)throw o.error}}const b=p.shift(),w=a.default.decode(b,!0),[_,v]=w.decryptPayloadKey(t),E=w.decryptSender(_);if(r&&!n.from(E).equals(r))throw new Error("Sender public key doesn't match");v.generateMacKeyForRecipient(w.hash,w.public_key,E,t.secretKey);let S=n.alloc(0);for(const e in p){const t=p[e],r=f.default.decode(t,!0),i=p.length===parseInt(e)+1;if(r.final&&!i)throw new Error("Found payload with invalid final flag, message extended?");if(!r.final&&i)throw new Error("Found payload with invalid final flag, message truncated?");S=n.concat([S,r.decrypt(w,v,_,BigInt(e))])}if(!p.length)throw new Error("No encrypted payloads, message truncated?");return Object.assign(S,{sender_public_key:E})})};const a=o(r(9913)),c=o(r(9981)),f=o(r(3548)),u=r(568),h=r(896),l=r(4406),d=r(2655),p=1048576;let y=null,g=null;class m extends h.Transform{constructor(e,t){super(),this.in_buffer=n.alloc(0),this.payload_index=BigInt(0),this.i=0,this.payload_key=null!=y?y:n.from((0,l.randomBytes)(32)),this.ephemeral_keypair=null!=g?g:l.box.keyPair(),this.keypair=null!=e?e:this.ephemeral_keypair;const r=t.map((e,t)=>c.default.create(e,this.ephemeral_keypair.secretKey,this.payload_key,t));this.header=a.default.create(this.ephemeral_keypair.publicKey,this.payload_key,this.keypair.publicKey,r),this.push(this.header.encoded);for(const e of r)e.generateMacKeyForSender(this.header.hash,this.ephemeral_keypair.secretKey,this.keypair.secretKey)}_transform(e,t,r){for(this.in_buffer=n.concat([this.in_buffer,e]);this.in_buffer.length>p;){const e=this.in_buffer.slice(0,p);this.in_buffer=this.in_buffer.slice(p);const t=f.default.create(this.header,this.payload_key,e,this.payload_index,!1);this.push(t.encoded),this.payload_index++}r()}_flush(e){for(;this.in_buffer.length>=p;){const e=this.in_buffer.slice(0,p);this.in_buffer=this.in_buffer.slice(p);const t=!this.in_buffer.length,r=f.default.create(this.header,this.payload_key,e,this.payload_index,t);this.push(r.encoded),this.payload_index++}if(this.in_buffer.length){const e=this.in_buffer;this.in_buffer=n.alloc(0);const t=!this.in_buffer.length,r=f.default.create(this.header,this.payload_key,e,this.payload_index,t);this.push(r.encoded),this.payload_index++}e()}}t.EncryptStream=m;class b extends h.Transform{constructor(e,t){super(),this.keypair=e,this.decoder=new d.Decoder({extensionCodec:void 0}),this.header_data=null,this.last_payload=null,this.payload_index=BigInt(-1),this.i=0,this.sender=null!=t?t:null}get header(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[0]}get payload_key(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[1]}get recipient(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[2]}get sender_public_key(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[3]}_transform(e,t,r){this.decoder.appendBuffer(e);try{let e;for(;e=this.decoder.doDecodeSync();){const t=n.from(this.decoder.bytes).slice(this.decoder.pos);this.decoder.setBuffer(t),this._handleMessage(e)}}catch(e){}r()}_handleMessage(e){if(this.header_data){if(this.payload_index++,this.last_payload){if(this.last_payload.final)throw new Error("Found payload with invalid final flag, message extended?");this.push(this.last_payload.decrypt(this.header,this.recipient,this.payload_key,this.payload_index-BigInt(1)))}const t=f.default.decode(e,!0);this.last_payload=t}else{const t=a.default.decode(e,!0),[r,i]=t.decryptPayloadKey(this.keypair),s=t.decryptSender(r);if(this.sender&&!n.from(s).equals(this.sender))throw new Error("Sender public key doesn't match");i.generateMacKeyForRecipient(t.hash,t.public_key,s,this.keypair.secretKey),this.header_data=[t,r,i,s]}}_flush(e){try{if(this.last_payload){if(!this.last_payload.final)throw new Error("Found payload with invalid final flag, message truncated?");this.push(this.last_payload.decrypt(this.header,this.recipient,this.payload_key,this.payload_index))}if(!this.last_payload)throw new Error("No encrypted payloads, message truncated?")}catch(t){return e(t)}e()}}t.DecryptStream=b},4015:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;const n=r(5598),i=r(4686);t.encrypt=(e,t)=>{const r=t,s=(0,n.randomBytes)(n.secretbox.nonceLength),o=(0,n.secretbox)(Uint8Array.from(e),s,r),a=new Uint8Array(s.length+o.length);return a.set(s),a.set(o,s.length),i.Buffer.from(a)},t.decrypt=(e,t)=>{const r=t,s=e,o=s.slice(0,n.secretbox.nonceLength),a=s.slice(n.secretbox.nonceLength,e.length),c=n.secretbox.open(a,o,r);if(!c)throw new Error("Could not decrypt message");return i.Buffer.from(c)},t.default={decrypt:t.decrypt,encrypt:t.encrypt,encryptChannel:(e,r)=>{const n={apply:(e,n,i)=>e.call(n,(0,t.encrypt)(i[0],r))},i={async apply(e,n,i){const s=await e.call(n);return(0,t.decrypt)(s,r)}};return e.send=new Proxy(e.send,n),e.receive=new Proxy(e.receive,i),e},generateKey:()=>(0,n.randomBytes)(32)}},4048:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=void 0,t.isNode="undefined"==typeof window,t.isBrowser=!t.isNode},4072:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sha512_224=t.sha512_256=t.sha384=t.sha512=t.sha224=t.sha256=t.SHA512_256=t.SHA512_224=t.SHA384=t.SHA512=t.SHA224=t.SHA256=void 0;const n=r(7734),i=r(3842),s=r(11),o=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array(64);class c extends n.HashMD{constructor(e=32){super(64,e,8,!1),this.A=0|n.SHA256_IV[0],this.B=0|n.SHA256_IV[1],this.C=0|n.SHA256_IV[2],this.D=0|n.SHA256_IV[3],this.E=0|n.SHA256_IV[4],this.F=0|n.SHA256_IV[5],this.G=0|n.SHA256_IV[6],this.H=0|n.SHA256_IV[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)a[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=a[e-15],r=a[e-2],n=(0,s.rotr)(t,7)^(0,s.rotr)(t,18)^t>>>3,i=(0,s.rotr)(r,17)^(0,s.rotr)(r,19)^r>>>10;a[e]=i+a[e-7]+n+a[e-16]|0}let{A:r,B:i,C:c,D:f,E:u,F:h,G:l,H:d}=this;for(let e=0;e<64;e++){const t=d+((0,s.rotr)(u,6)^(0,s.rotr)(u,11)^(0,s.rotr)(u,25))+(0,n.Chi)(u,h,l)+o[e]+a[e]|0,p=((0,s.rotr)(r,2)^(0,s.rotr)(r,13)^(0,s.rotr)(r,22))+(0,n.Maj)(r,i,c)|0;d=l,l=h,h=u,u=f+t|0,f=c,c=i,i=r,r=t+p|0}r=r+this.A|0,i=i+this.B|0,c=c+this.C|0,f=f+this.D|0,u=u+this.E|0,h=h+this.F|0,l=l+this.G|0,d=d+this.H|0,this.set(r,i,c,f,u,h,l,d)}roundClean(){(0,s.clean)(a)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,s.clean)(this.buffer)}}t.SHA256=c;class f extends c{constructor(){super(28),this.A=0|n.SHA224_IV[0],this.B=0|n.SHA224_IV[1],this.C=0|n.SHA224_IV[2],this.D=0|n.SHA224_IV[3],this.E=0|n.SHA224_IV[4],this.F=0|n.SHA224_IV[5],this.G=0|n.SHA224_IV[6],this.H=0|n.SHA224_IV[7]}}t.SHA224=f;const u=(()=>i.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),h=(()=>u[0])(),l=(()=>u[1])(),d=new Uint32Array(80),p=new Uint32Array(80);class y extends n.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=0|n.SHA512_IV[0],this.Al=0|n.SHA512_IV[1],this.Bh=0|n.SHA512_IV[2],this.Bl=0|n.SHA512_IV[3],this.Ch=0|n.SHA512_IV[4],this.Cl=0|n.SHA512_IV[5],this.Dh=0|n.SHA512_IV[6],this.Dl=0|n.SHA512_IV[7],this.Eh=0|n.SHA512_IV[8],this.El=0|n.SHA512_IV[9],this.Fh=0|n.SHA512_IV[10],this.Fl=0|n.SHA512_IV[11],this.Gh=0|n.SHA512_IV[12],this.Gl=0|n.SHA512_IV[13],this.Hh=0|n.SHA512_IV[14],this.Hl=0|n.SHA512_IV[15]}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:f,Fh:u,Fl:h,Gh:l,Gl:d,Hh:p,Hl:y}=this;return[e,t,r,n,i,s,o,a,c,f,u,h,l,d,p,y]}set(e,t,r,n,i,s,o,a,c,f,u,h,l,d,p,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|f,this.Fh=0|u,this.Fl=0|h,this.Gh=0|l,this.Gl=0|d,this.Hh=0|p,this.Hl=0|y}process(e,t){for(let r=0;r<16;r++,t+=4)d[r]=e.getUint32(t),p[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|d[e-15],r=0|p[e-15],n=i.rotrSH(t,r,1)^i.rotrSH(t,r,8)^i.shrSH(t,r,7),s=i.rotrSL(t,r,1)^i.rotrSL(t,r,8)^i.shrSL(t,r,7),o=0|d[e-2],a=0|p[e-2],c=i.rotrSH(o,a,19)^i.rotrBH(o,a,61)^i.shrSH(o,a,6),f=i.rotrSL(o,a,19)^i.rotrBL(o,a,61)^i.shrSL(o,a,6),u=i.add4L(s,f,p[e-7],p[e-16]),h=i.add4H(u,n,c,d[e-7],d[e-16]);d[e]=0|h,p[e]=0|u}let{Ah:r,Al:n,Bh:s,Bl:o,Ch:a,Cl:c,Dh:f,Dl:u,Eh:y,El:g,Fh:m,Fl:b,Gh:w,Gl:_,Hh:v,Hl:E}=this;for(let e=0;e<80;e++){const t=i.rotrSH(y,g,14)^i.rotrSH(y,g,18)^i.rotrBH(y,g,41),S=i.rotrSL(y,g,14)^i.rotrSL(y,g,18)^i.rotrBL(y,g,41),B=y&m^~y&w,A=g&b^~g&_,I=i.add5L(E,S,A,l[e],p[e]),x=i.add5H(I,v,t,B,h[e],d[e]),T=0|I,O=i.rotrSH(r,n,28)^i.rotrBH(r,n,34)^i.rotrBH(r,n,39),k=i.rotrSL(r,n,28)^i.rotrBL(r,n,34)^i.rotrBL(r,n,39),U=r&s^r&a^s&a,M=n&o^n&c^o&c;v=0|w,E=0|_,w=0|m,_=0|b,m=0|y,b=0|g,({h:y,l:g}=i.add(0|f,0|u,0|x,0|T)),f=0|a,u=0|c,a=0|s,c=0|o,s=0|r,o=0|n;const R=i.add3L(T,k,M);r=i.add3H(R,x,O,U),n=0|R}({h:r,l:n}=i.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:s,l:o}=i.add(0|this.Bh,0|this.Bl,0|s,0|o)),({h:a,l:c}=i.add(0|this.Ch,0|this.Cl,0|a,0|c)),({h:f,l:u}=i.add(0|this.Dh,0|this.Dl,0|f,0|u)),({h:y,l:g}=i.add(0|this.Eh,0|this.El,0|y,0|g)),({h:m,l:b}=i.add(0|this.Fh,0|this.Fl,0|m,0|b)),({h:w,l:_}=i.add(0|this.Gh,0|this.Gl,0|w,0|_)),({h:v,l:E}=i.add(0|this.Hh,0|this.Hl,0|v,0|E)),this.set(r,n,s,o,a,c,f,u,y,g,m,b,w,_,v,E)}roundClean(){(0,s.clean)(d,p)}destroy(){(0,s.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}t.SHA512=y;class g extends y{constructor(){super(48),this.Ah=0|n.SHA384_IV[0],this.Al=0|n.SHA384_IV[1],this.Bh=0|n.SHA384_IV[2],this.Bl=0|n.SHA384_IV[3],this.Ch=0|n.SHA384_IV[4],this.Cl=0|n.SHA384_IV[5],this.Dh=0|n.SHA384_IV[6],this.Dl=0|n.SHA384_IV[7],this.Eh=0|n.SHA384_IV[8],this.El=0|n.SHA384_IV[9],this.Fh=0|n.SHA384_IV[10],this.Fl=0|n.SHA384_IV[11],this.Gh=0|n.SHA384_IV[12],this.Gl=0|n.SHA384_IV[13],this.Hh=0|n.SHA384_IV[14],this.Hl=0|n.SHA384_IV[15]}}t.SHA384=g;const m=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),b=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class w extends y{constructor(){super(28),this.Ah=0|m[0],this.Al=0|m[1],this.Bh=0|m[2],this.Bl=0|m[3],this.Ch=0|m[4],this.Cl=0|m[5],this.Dh=0|m[6],this.Dl=0|m[7],this.Eh=0|m[8],this.El=0|m[9],this.Fh=0|m[10],this.Fl=0|m[11],this.Gh=0|m[12],this.Gl=0|m[13],this.Hh=0|m[14],this.Hl=0|m[15]}}t.SHA512_224=w;class _ extends y{constructor(){super(32),this.Ah=0|b[0],this.Al=0|b[1],this.Bh=0|b[2],this.Bl=0|b[3],this.Ch=0|b[4],this.Cl=0|b[5],this.Dh=0|b[6],this.Dl=0|b[7],this.Eh=0|b[8],this.El=0|b[9],this.Fh=0|b[10],this.Fl=0|b[11],this.Gh=0|b[12],this.Gl=0|b[13],this.Hh=0|b[14],this.Hl=0|b[15]}}t.SHA512_256=_,t.sha256=(0,s.createHasher)(()=>new c),t.sha224=(0,s.createHasher)(()=>new f),t.sha512=(0,s.createHasher)(()=>new y),t.sha384=(0,s.createHasher)(()=>new g),t.sha512_256=(0,s.createHasher)(()=>new _),t.sha512_224=(0,s.createHasher)(()=>new w)},4105:(e,t,r)=>{"use strict";var n=r(6671).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=f,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=l,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function f(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function l(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.I=s,s.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=o(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},4203:()=>{},4324:(e,t,r)=>{"use strict";var n,i=r(8558);e.exports=A,A.ReadableState=B,r(9784).EventEmitter;var s,o=function(e,t){return e.listeners(t).length},a=r(9481),c=r(4686).Buffer,f=(void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},u=r(8854);s=u&&u.debuglog?u.debuglog("stream"):function(){};var h,l,d,p=r(9865),y=r(4552),g=r(7963).getHighWaterMark,m=r(8704).F,b=m.ERR_INVALID_ARG_TYPE,w=m.ERR_STREAM_PUSH_AFTER_EOF,_=m.ERR_METHOD_NOT_IMPLEMENTED,v=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(6192)(A,a);var E=y.errorOrDestroy,S=["error","close","destroy","pause","resume"];function B(e,t,i){n=n||r(5606),e=e||{},"boolean"!=typeof i&&(i=t instanceof n),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(4105).I),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function A(e){if(n=n||r(5606),!(this instanceof A))return new A(e);var t=this instanceof n;this._readableState=new B(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function I(e,t,r,n,i){s("readableAddChunk",t);var o,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(s("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?k(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,U(e)))}}(e,a);else if(i||(o=function(e,t){var r,n;return n=t,c.isBuffer(n)||n instanceof f||"string"==typeof t||void 0===t||e.objectMode||(r=new b("chunk",["string","Buffer","Uint8Array"],t)),r}(a,t)),o)E(e,o);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n)a.endEmitted?E(e,new v):x(e,a,t,!0);else if(a.ended)E(e,new w);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?x(e,a,t,!1):M(e,a)):x(e,a,t,!1)}else n||(a.reading=!1,M(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function x(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&k(e)),M(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=y.destroy,A.prototype._undestroy=y.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),I(this,e,t,!1,r)},A.prototype.unshift=function(e){return I(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(e){h||(h=r(4105).I);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var T=1073741824;function O(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=T?e=T:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function k(e){var t=e._readableState;s("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(s("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(U,e))}function U(e){var t=e._readableState;s("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function M(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(R,e,t))}function R(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(s("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function P(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function C(e){s("readable nexttick read 0"),e.read(0)}function L(e,t){s("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(s("flow",t.flowing);t.flowing&&null!==e.read(););}function N(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function K(e){var t=e._readableState;s("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(H,t,e))}function H(e,t){if(s("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function F(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}A.prototype.read=function(e){s("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return s("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?K(this):k(this),null;if(0===(e=O(e,t))&&t.ended)return 0===t.length&&K(this),null;var n,i=t.needReadable;return s("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&s("length less than watermark",i=!0),t.ended||t.reading?s("reading or ended",i=!1):i&&(s("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O(r,t))),null===(n=e>0?N(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&K(this)),null!==n&&this.emit("data",n),n},A.prototype._read=function(e){E(this,new _("_read()"))},A.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,s("pipe count=%d opts=%j",n.pipesCount,t);var a=t&&!1===t.end||e===i.stdout||e===i.stderr?y:c;function c(){s("onend"),e.end()}n.endEmitted?i.nextTick(a):r.once("end",a),e.on("unpipe",function t(i,o){s("onunpipe"),i===r&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,s("cleanup"),e.removeListener("close",d),e.removeListener("finish",p),e.removeListener("drain",f),e.removeListener("error",l),e.removeListener("unpipe",t),r.removeListener("end",c),r.removeListener("end",y),r.removeListener("data",h),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||f())});var f=function(e){return function(){var t=e._readableState;s("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,D(e))}}(r);e.on("drain",f);var u=!1;function h(t){s("ondata");var i=e.write(t);s("dest.write",i),!1===i&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==F(n.pipes,e))&&!u&&(s("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function l(t){s("onerror",t),y(),e.removeListener("error",l),0===o(e,"error")&&E(e,t)}function d(){e.removeListener("finish",p),y()}function p(){s("onfinish"),e.removeListener("close",d),y()}function y(){s("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",l),e.once("close",d),e.once("finish",p),e.emit("pipe",r),n.flowing||(s("pipe resume"),r.resume()),e},A.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=F(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},A.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,s("on readable",n.length,n.reading),n.length?k(this):n.reading||i.nextTick(C,this))),r},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(e,t){var r=a.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(P,this),r},A.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(P,this),t},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(s("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(L,e,t))}(this,e)),e.paused=!1,this},A.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",function(){if(s("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){s("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<S.length;o++)e.on(S[o],this.emit.bind(this,S[o]));return this._read=function(t){s("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===l&&(l=r(9035)),l(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=N,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(e,t){return void 0===d&&(d=r(6869)),d(A,e,t)})},4406:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var o=t(),a=t([1]),c=t([56129,1]),f=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function y(e,t,r,n,i){var s,o=0;for(s=0;s<i;s++)o|=e[t+s]^r[n+s];return(1&o-1>>>8)-1}function g(e,t,r,n){return y(e,t,r,n,16)}function m(e,t,r,n){return y(e,t,r,n,32)}function b(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,f=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,b=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,_=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,v=s,E=o,S=a,B=c,A=f,I=u,x=h,T=l,O=d,k=p,U=y,M=g,R=m,P=b,C=w,L=_,D=0;D<20;D+=2)v^=(i=(R^=(i=(O^=(i=(A^=(i=v+R|0)<<7|i>>>25)+v|0)<<9|i>>>23)+A|0)<<13|i>>>19)+O|0)<<18|i>>>14,I^=(i=(E^=(i=(P^=(i=(k^=(i=I+E|0)<<7|i>>>25)+I|0)<<9|i>>>23)+k|0)<<13|i>>>19)+P|0)<<18|i>>>14,U^=(i=(x^=(i=(S^=(i=(C^=(i=U+x|0)<<7|i>>>25)+U|0)<<9|i>>>23)+C|0)<<13|i>>>19)+S|0)<<18|i>>>14,L^=(i=(M^=(i=(T^=(i=(B^=(i=L+M|0)<<7|i>>>25)+L|0)<<9|i>>>23)+B|0)<<13|i>>>19)+T|0)<<18|i>>>14,v^=(i=(B^=(i=(S^=(i=(E^=(i=v+B|0)<<7|i>>>25)+v|0)<<9|i>>>23)+E|0)<<13|i>>>19)+S|0)<<18|i>>>14,I^=(i=(A^=(i=(T^=(i=(x^=(i=I+A|0)<<7|i>>>25)+I|0)<<9|i>>>23)+x|0)<<13|i>>>19)+T|0)<<18|i>>>14,U^=(i=(k^=(i=(O^=(i=(M^=(i=U+k|0)<<7|i>>>25)+U|0)<<9|i>>>23)+M|0)<<13|i>>>19)+O|0)<<18|i>>>14,L^=(i=(C^=(i=(P^=(i=(R^=(i=L+C|0)<<7|i>>>25)+L|0)<<9|i>>>23)+R|0)<<13|i>>>19)+P|0)<<18|i>>>14;v=v+s|0,E=E+o|0,S=S+a|0,B=B+c|0,A=A+f|0,I=I+u|0,x=x+h|0,T=T+l|0,O=O+d|0,k=k+p|0,U=U+y|0,M=M+g|0,R=R+m|0,P=P+b|0,C=C+w|0,L=L+_|0,e[0]=v>>>0&255,e[1]=v>>>8&255,e[2]=v>>>16&255,e[3]=v>>>24&255,e[4]=E>>>0&255,e[5]=E>>>8&255,e[6]=E>>>16&255,e[7]=E>>>24&255,e[8]=S>>>0&255,e[9]=S>>>8&255,e[10]=S>>>16&255,e[11]=S>>>24&255,e[12]=B>>>0&255,e[13]=B>>>8&255,e[14]=B>>>16&255,e[15]=B>>>24&255,e[16]=A>>>0&255,e[17]=A>>>8&255,e[18]=A>>>16&255,e[19]=A>>>24&255,e[20]=I>>>0&255,e[21]=I>>>8&255,e[22]=I>>>16&255,e[23]=I>>>24&255,e[24]=x>>>0&255,e[25]=x>>>8&255,e[26]=x>>>16&255,e[27]=x>>>24&255,e[28]=T>>>0&255,e[29]=T>>>8&255,e[30]=T>>>16&255,e[31]=T>>>24&255,e[32]=O>>>0&255,e[33]=O>>>8&255,e[34]=O>>>16&255,e[35]=O>>>24&255,e[36]=k>>>0&255,e[37]=k>>>8&255,e[38]=k>>>16&255,e[39]=k>>>24&255,e[40]=U>>>0&255,e[41]=U>>>8&255,e[42]=U>>>16&255,e[43]=U>>>24&255,e[44]=M>>>0&255,e[45]=M>>>8&255,e[46]=M>>>16&255,e[47]=M>>>24&255,e[48]=R>>>0&255,e[49]=R>>>8&255,e[50]=R>>>16&255,e[51]=R>>>24&255,e[52]=P>>>0&255,e[53]=P>>>8&255,e[54]=P>>>16&255,e[55]=P>>>24&255,e[56]=C>>>0&255,e[57]=C>>>8&255,e[58]=C>>>16&255,e[59]=C>>>24&255,e[60]=L>>>0&255,e[61]=L>>>8&255,e[62]=L>>>16&255,e[63]=L>>>24&255}(e,t,r,n)}function w(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,f=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,b=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,_=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,v=0;v<20;v+=2)s^=(i=(m^=(i=(d^=(i=(f^=(i=s+m|0)<<7|i>>>25)+s|0)<<9|i>>>23)+f|0)<<13|i>>>19)+d|0)<<18|i>>>14,u^=(i=(o^=(i=(b^=(i=(p^=(i=u+o|0)<<7|i>>>25)+u|0)<<9|i>>>23)+p|0)<<13|i>>>19)+b|0)<<18|i>>>14,y^=(i=(h^=(i=(a^=(i=(w^=(i=y+h|0)<<7|i>>>25)+y|0)<<9|i>>>23)+w|0)<<13|i>>>19)+a|0)<<18|i>>>14,_^=(i=(g^=(i=(l^=(i=(c^=(i=_+g|0)<<7|i>>>25)+_|0)<<9|i>>>23)+c|0)<<13|i>>>19)+l|0)<<18|i>>>14,s^=(i=(c^=(i=(a^=(i=(o^=(i=s+c|0)<<7|i>>>25)+s|0)<<9|i>>>23)+o|0)<<13|i>>>19)+a|0)<<18|i>>>14,u^=(i=(f^=(i=(l^=(i=(h^=(i=u+f|0)<<7|i>>>25)+u|0)<<9|i>>>23)+h|0)<<13|i>>>19)+l|0)<<18|i>>>14,y^=(i=(p^=(i=(d^=(i=(g^=(i=y+p|0)<<7|i>>>25)+y|0)<<9|i>>>23)+g|0)<<13|i>>>19)+d|0)<<18|i>>>14,_^=(i=(w^=(i=(b^=(i=(m^=(i=_+w|0)<<7|i>>>25)+_|0)<<9|i>>>23)+m|0)<<13|i>>>19)+b|0)<<18|i>>>14;e[0]=s>>>0&255,e[1]=s>>>8&255,e[2]=s>>>16&255,e[3]=s>>>24&255,e[4]=u>>>0&255,e[5]=u>>>8&255,e[6]=u>>>16&255,e[7]=u>>>24&255,e[8]=y>>>0&255,e[9]=y>>>8&255,e[10]=y>>>16&255,e[11]=y>>>24&255,e[12]=_>>>0&255,e[13]=_>>>8&255,e[14]=_>>>16&255,e[15]=_>>>24&255,e[16]=h>>>0&255,e[17]=h>>>8&255,e[18]=h>>>16&255,e[19]=h>>>24&255,e[20]=l>>>0&255,e[21]=l>>>8&255,e[22]=l>>>16&255,e[23]=l>>>24&255,e[24]=d>>>0&255,e[25]=d>>>8&255,e[26]=d>>>16&255,e[27]=d>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var _=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function v(e,t,r,n,i,s,o){var a,c,f=new Uint8Array(16),u=new Uint8Array(64);for(c=0;c<16;c++)f[c]=0;for(c=0;c<8;c++)f[c]=s[c];for(;i>=64;){for(b(u,f,o,_),c=0;c<64;c++)e[t+c]=r[n+c]^u[c];for(a=1,c=8;c<16;c++)a=a+(255&f[c])|0,f[c]=255&a,a>>>=8;i-=64,t+=64,n+=64}if(i>0)for(b(u,f,o,_),c=0;c<i;c++)e[t+c]=r[n+c]^u[c];return 0}function E(e,t,r,n,i){var s,o,a=new Uint8Array(16),c=new Uint8Array(64);for(o=0;o<16;o++)a[o]=0;for(o=0;o<8;o++)a[o]=n[o];for(;r>=64;){for(b(c,a,i,_),o=0;o<64;o++)e[t+o]=c[o];for(s=1,o=8;o<16;o++)s=s+(255&a[o])|0,a[o]=255&s,s>>>=8;r-=64,t+=64}if(r>0)for(b(c,a,i,_),o=0;o<r;o++)e[t+o]=c[o];return 0}function S(e,t,r,n,i){var s=new Uint8Array(32);w(s,n,i,_);for(var o=new Uint8Array(8),a=0;a<8;a++)o[a]=n[a+16];return E(e,t,r,o,s)}function B(e,t,r,n,i,s,o){var a=new Uint8Array(32);w(a,s,o,_);for(var c=new Uint8Array(8),f=0;f<8;f++)c[f]=s[f+16];return v(e,t,r,n,i,c,a)}var A=function(e){var t,r,n,i,s,o,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|i<<9),s=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|s<<12),this.r[5]=s>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(s>>>14|o<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|a<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function I(e,t,r,n,i,s){var o=new A(s);return o.update(r,n,i),o.finish(e,t),0}function x(e,t,r,n,i,s){var o=new Uint8Array(16);return I(o,0,r,n,i,s),g(e,t,o,0)}function T(e,t,r,n,i){var s;if(r<32)return-1;for(B(e,0,t,0,r,n,i),I(e,16,e,32,r-32,e),s=0;s<16;s++)e[s]=0;return 0}function O(e,t,r,n,i){var s,o=new Uint8Array(32);if(r<32)return-1;if(S(o,0,32,n,i),0!==x(t,16,t,32,r-32,o))return-1;for(B(e,0,t,0,r,n,i),s=0;s<32;s++)e[s]=0;return 0}function k(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function U(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function M(e,t,r){for(var n,i=~(r-1),s=0;s<16;s++)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function R(e,r){var n,i,s,o=t(),a=t();for(n=0;n<16;n++)a[n]=r[n];for(U(a),U(a),U(a),i=0;i<2;i++){for(o[0]=a[0]-65517,n=1;n<15;n++)o[n]=a[n]-65535-(o[n-1]>>16&1),o[n-1]&=65535;o[15]=a[15]-32767-(o[14]>>16&1),s=o[15]>>16&1,o[14]&=65535,M(a,o,1-s)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function P(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return R(r,e),R(n,t),m(r,0,n,0)}function C(e){var t=new Uint8Array(32);return R(t,e),1&t[0]}function L(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function D(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function N(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function K(e,t,r){var n,i,s=0,o=0,a=0,c=0,f=0,u=0,h=0,l=0,d=0,p=0,y=0,g=0,m=0,b=0,w=0,_=0,v=0,E=0,S=0,B=0,A=0,I=0,x=0,T=0,O=0,k=0,U=0,M=0,R=0,P=0,C=0,L=r[0],D=r[1],N=r[2],K=r[3],H=r[4],F=r[5],j=r[6],G=r[7],V=r[8],Y=r[9],q=r[10],z=r[11],W=r[12],$=r[13],X=r[14],Z=r[15];s+=(n=t[0])*L,o+=n*D,a+=n*N,c+=n*K,f+=n*H,u+=n*F,h+=n*j,l+=n*G,d+=n*V,p+=n*Y,y+=n*q,g+=n*z,m+=n*W,b+=n*$,w+=n*X,_+=n*Z,o+=(n=t[1])*L,a+=n*D,c+=n*N,f+=n*K,u+=n*H,h+=n*F,l+=n*j,d+=n*G,p+=n*V,y+=n*Y,g+=n*q,m+=n*z,b+=n*W,w+=n*$,_+=n*X,v+=n*Z,a+=(n=t[2])*L,c+=n*D,f+=n*N,u+=n*K,h+=n*H,l+=n*F,d+=n*j,p+=n*G,y+=n*V,g+=n*Y,m+=n*q,b+=n*z,w+=n*W,_+=n*$,v+=n*X,E+=n*Z,c+=(n=t[3])*L,f+=n*D,u+=n*N,h+=n*K,l+=n*H,d+=n*F,p+=n*j,y+=n*G,g+=n*V,m+=n*Y,b+=n*q,w+=n*z,_+=n*W,v+=n*$,E+=n*X,S+=n*Z,f+=(n=t[4])*L,u+=n*D,h+=n*N,l+=n*K,d+=n*H,p+=n*F,y+=n*j,g+=n*G,m+=n*V,b+=n*Y,w+=n*q,_+=n*z,v+=n*W,E+=n*$,S+=n*X,B+=n*Z,u+=(n=t[5])*L,h+=n*D,l+=n*N,d+=n*K,p+=n*H,y+=n*F,g+=n*j,m+=n*G,b+=n*V,w+=n*Y,_+=n*q,v+=n*z,E+=n*W,S+=n*$,B+=n*X,A+=n*Z,h+=(n=t[6])*L,l+=n*D,d+=n*N,p+=n*K,y+=n*H,g+=n*F,m+=n*j,b+=n*G,w+=n*V,_+=n*Y,v+=n*q,E+=n*z,S+=n*W,B+=n*$,A+=n*X,I+=n*Z,l+=(n=t[7])*L,d+=n*D,p+=n*N,y+=n*K,g+=n*H,m+=n*F,b+=n*j,w+=n*G,_+=n*V,v+=n*Y,E+=n*q,S+=n*z,B+=n*W,A+=n*$,I+=n*X,x+=n*Z,d+=(n=t[8])*L,p+=n*D,y+=n*N,g+=n*K,m+=n*H,b+=n*F,w+=n*j,_+=n*G,v+=n*V,E+=n*Y,S+=n*q,B+=n*z,A+=n*W,I+=n*$,x+=n*X,T+=n*Z,p+=(n=t[9])*L,y+=n*D,g+=n*N,m+=n*K,b+=n*H,w+=n*F,_+=n*j,v+=n*G,E+=n*V,S+=n*Y,B+=n*q,A+=n*z,I+=n*W,x+=n*$,T+=n*X,O+=n*Z,y+=(n=t[10])*L,g+=n*D,m+=n*N,b+=n*K,w+=n*H,_+=n*F,v+=n*j,E+=n*G,S+=n*V,B+=n*Y,A+=n*q,I+=n*z,x+=n*W,T+=n*$,O+=n*X,k+=n*Z,g+=(n=t[11])*L,m+=n*D,b+=n*N,w+=n*K,_+=n*H,v+=n*F,E+=n*j,S+=n*G,B+=n*V,A+=n*Y,I+=n*q,x+=n*z,T+=n*W,O+=n*$,k+=n*X,U+=n*Z,m+=(n=t[12])*L,b+=n*D,w+=n*N,_+=n*K,v+=n*H,E+=n*F,S+=n*j,B+=n*G,A+=n*V,I+=n*Y,x+=n*q,T+=n*z,O+=n*W,k+=n*$,U+=n*X,M+=n*Z,b+=(n=t[13])*L,w+=n*D,_+=n*N,v+=n*K,E+=n*H,S+=n*F,B+=n*j,A+=n*G,I+=n*V,x+=n*Y,T+=n*q,O+=n*z,k+=n*W,U+=n*$,M+=n*X,R+=n*Z,w+=(n=t[14])*L,_+=n*D,v+=n*N,E+=n*K,S+=n*H,B+=n*F,A+=n*j,I+=n*G,x+=n*V,T+=n*Y,O+=n*q,k+=n*z,U+=n*W,M+=n*$,R+=n*X,P+=n*Z,_+=(n=t[15])*L,o+=38*(E+=n*N),a+=38*(S+=n*K),c+=38*(B+=n*H),f+=38*(A+=n*F),u+=38*(I+=n*j),h+=38*(x+=n*G),l+=38*(T+=n*V),d+=38*(O+=n*Y),p+=38*(k+=n*q),y+=38*(U+=n*z),g+=38*(M+=n*W),m+=38*(R+=n*$),b+=38*(P+=n*X),w+=38*(C+=n*Z),s=(n=(s+=38*(v+=n*D))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=f,e[5]=u,e[6]=h,e[7]=l,e[8]=d,e[9]=p,e[10]=y,e[11]=g,e[12]=m,e[13]=b,e[14]=w,e[15]=_}function H(e,t){K(e,t,t)}function F(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=253;n>=0;n--)H(i,i),2!==n&&4!==n&&K(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function j(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=250;n>=0;n--)H(i,i),1!==n&&K(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function G(e,r,n){var i,s,o=new Uint8Array(32),a=new Float64Array(80),f=t(),u=t(),h=t(),l=t(),d=t(),p=t();for(s=0;s<31;s++)o[s]=r[s];for(o[31]=127&r[31]|64,o[0]&=248,L(a,n),s=0;s<16;s++)u[s]=a[s],l[s]=f[s]=h[s]=0;for(f[0]=l[0]=1,s=254;s>=0;--s)M(f,u,i=o[s>>>3]>>>(7&s)&1),M(h,l,i),D(d,f,h),N(f,f,h),D(h,u,l),N(u,u,l),H(l,d),H(p,f),K(f,h,f),K(h,u,d),D(d,f,h),N(f,f,h),H(u,f),N(h,l,p),K(f,h,c),D(f,f,l),K(h,h,f),K(f,l,p),K(l,u,a),H(u,d),M(f,u,i),M(h,l,i);for(s=0;s<16;s++)a[s+16]=f[s],a[s+32]=h[s],a[s+48]=u[s],a[s+64]=l[s];var y=a.subarray(32),g=a.subarray(16);return F(y,y),K(g,g,y),R(e,g),0}function V(e,t){return G(e,t,s)}function Y(e,t){return n(t,32),V(e,t)}function q(e,t,r){var n=new Uint8Array(32);return G(n,r,t),w(e,i,n,_)}A.prototype.blocks=function(e,t,r){for(var n,i,s,o,a,c,f,u,h,l,d,p,y,g,m,b,w,_,v,E=this.fin?0:2048,S=this.h[0],B=this.h[1],A=this.h[2],I=this.h[3],x=this.h[4],T=this.h[5],O=this.h[6],k=this.h[7],U=this.h[8],M=this.h[9],R=this.r[0],P=this.r[1],C=this.r[2],L=this.r[3],D=this.r[4],N=this.r[5],K=this.r[6],H=this.r[7],F=this.r[8],j=this.r[9];r>=16;)l=h=0,l+=(S+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*R,l+=(B+=8191&(n>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*j),l+=(A+=8191&(i>>>10|(s=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*F),l+=(I+=8191&(s>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*H),h=(l+=(x+=8191&(o>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*K))>>>13,l&=8191,l+=(T+=a>>>1&8191)*(5*N),l+=(O+=8191&(a>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*D),l+=(k+=8191&(c>>>11|(f=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*L),l+=(U+=8191&(f>>>8|(u=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*C),d=h+=(l+=(M+=u>>>5|E)*(5*P))>>>13,d+=S*P,d+=B*R,d+=A*(5*j),d+=I*(5*F),h=(d+=x*(5*H))>>>13,d&=8191,d+=T*(5*K),d+=O*(5*N),d+=k*(5*D),d+=U*(5*L),h+=(d+=M*(5*C))>>>13,d&=8191,p=h,p+=S*C,p+=B*P,p+=A*R,p+=I*(5*j),h=(p+=x*(5*F))>>>13,p&=8191,p+=T*(5*H),p+=O*(5*K),p+=k*(5*N),p+=U*(5*D),y=h+=(p+=M*(5*L))>>>13,y+=S*L,y+=B*C,y+=A*P,y+=I*R,h=(y+=x*(5*j))>>>13,y&=8191,y+=T*(5*F),y+=O*(5*H),y+=k*(5*K),y+=U*(5*N),g=h+=(y+=M*(5*D))>>>13,g+=S*D,g+=B*L,g+=A*C,g+=I*P,h=(g+=x*R)>>>13,g&=8191,g+=T*(5*j),g+=O*(5*F),g+=k*(5*H),g+=U*(5*K),m=h+=(g+=M*(5*N))>>>13,m+=S*N,m+=B*D,m+=A*L,m+=I*C,h=(m+=x*P)>>>13,m&=8191,m+=T*R,m+=O*(5*j),m+=k*(5*F),m+=U*(5*H),b=h+=(m+=M*(5*K))>>>13,b+=S*K,b+=B*N,b+=A*D,b+=I*L,h=(b+=x*C)>>>13,b&=8191,b+=T*P,b+=O*R,b+=k*(5*j),b+=U*(5*F),w=h+=(b+=M*(5*H))>>>13,w+=S*H,w+=B*K,w+=A*N,w+=I*D,h=(w+=x*L)>>>13,w&=8191,w+=T*C,w+=O*P,w+=k*R,w+=U*(5*j),_=h+=(w+=M*(5*F))>>>13,_+=S*F,_+=B*H,_+=A*K,_+=I*N,h=(_+=x*D)>>>13,_&=8191,_+=T*L,_+=O*C,_+=k*P,_+=U*R,v=h+=(_+=M*(5*j))>>>13,v+=S*j,v+=B*F,v+=A*H,v+=I*K,h=(v+=x*N)>>>13,v&=8191,v+=T*D,v+=O*L,v+=k*C,v+=U*P,S=l=8191&(h=(h=((h+=(v+=M*R)>>>13)<<2)+h|0)+(l&=8191)|0),B=d+=h>>>=13,A=p&=8191,I=y&=8191,x=g&=8191,T=m&=8191,O=b&=8191,k=w&=8191,U=_&=8191,M=v&=8191,t+=16,r-=16;this.h[0]=S,this.h[1]=B,this.h[2]=A,this.h[3]=I,this.h[4]=x,this.h[5]=T,this.h[6]=O,this.h[7]=k,this.h[8]=U,this.h[9]=M},A.prototype.finish=function(e,t){var r,n,i,s,o=new Uint16Array(10);if(this.leftover){for(s=this.leftover,this.buffer[s++]=1;s<16;s++)this.buffer[s]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,s=2;s<10;s++)this.h[s]+=r,r=this.h[s]>>>13,this.h[s]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this.h[s]+r,r=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,n=(1^r)-1,s=0;s<10;s++)o[s]&=n;for(n=~n,s=0;s<10;s++)this.h[s]=this.h[s]&n|o[s];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,s=1;s<8;s++)i=(this.h[s]+this.pad[s]|0)+(i>>>16)|0,this.h[s]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},A.prototype.update=function(e,t,r){var n,i;if(this.leftover){for((i=16-this.leftover)>r&&(i=r),n=0;n<i;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(i=r-r%16,this.blocks(e,t,i),t+=i,r-=i),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var z=T,W=O,$=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function X(e,t,r,n){for(var i,s,o,a,c,f,u,h,l,d,p,y,g,m,b,w,_,v,E,S,B,A,I,x,T,O,k=new Int32Array(16),U=new Int32Array(16),M=e[0],R=e[1],P=e[2],C=e[3],L=e[4],D=e[5],N=e[6],K=e[7],H=t[0],F=t[1],j=t[2],G=t[3],V=t[4],Y=t[5],q=t[6],z=t[7],W=0;n>=128;){for(E=0;E<16;E++)S=8*E+W,k[E]=r[S+0]<<24|r[S+1]<<16|r[S+2]<<8|r[S+3],U[E]=r[S+4]<<24|r[S+5]<<16|r[S+6]<<8|r[S+7];for(E=0;E<80;E++)if(i=M,s=R,o=P,a=C,c=L,f=D,u=N,l=H,d=F,p=j,y=G,g=V,m=Y,b=q,I=65535&(A=z),x=A>>>16,T=65535&(B=K),O=B>>>16,I+=65535&(A=(V>>>14|L<<18)^(V>>>18|L<<14)^(L>>>9|V<<23)),x+=A>>>16,T+=65535&(B=(L>>>14|V<<18)^(L>>>18|V<<14)^(V>>>9|L<<23)),O+=B>>>16,I+=65535&(A=V&Y^~V&q),x+=A>>>16,T+=65535&(B=L&D^~L&N),O+=B>>>16,I+=65535&(A=$[2*E+1]),x+=A>>>16,T+=65535&(B=$[2*E]),O+=B>>>16,B=k[E%16],x+=(A=U[E%16])>>>16,T+=65535&B,O+=B>>>16,T+=(x+=(I+=65535&A)>>>16)>>>16,I=65535&(A=v=65535&I|x<<16),x=A>>>16,T=65535&(B=_=65535&T|(O+=T>>>16)<<16),O=B>>>16,I+=65535&(A=(H>>>28|M<<4)^(M>>>2|H<<30)^(M>>>7|H<<25)),x+=A>>>16,T+=65535&(B=(M>>>28|H<<4)^(H>>>2|M<<30)^(H>>>7|M<<25)),O+=B>>>16,x+=(A=H&F^H&j^F&j)>>>16,T+=65535&(B=M&R^M&P^R&P),O+=B>>>16,h=65535&(T+=(x+=(I+=65535&A)>>>16)>>>16)|(O+=T>>>16)<<16,w=65535&I|x<<16,I=65535&(A=y),x=A>>>16,T=65535&(B=a),O=B>>>16,x+=(A=v)>>>16,T+=65535&(B=_),O+=B>>>16,R=i,P=s,C=o,L=a=65535&(T+=(x+=(I+=65535&A)>>>16)>>>16)|(O+=T>>>16)<<16,D=c,N=f,K=u,M=h,F=l,j=d,G=p,V=y=65535&I|x<<16,Y=g,q=m,z=b,H=w,E%16==15)for(S=0;S<16;S++)B=k[S],I=65535&(A=U[S]),x=A>>>16,T=65535&B,O=B>>>16,B=k[(S+9)%16],I+=65535&(A=U[(S+9)%16]),x+=A>>>16,T+=65535&B,O+=B>>>16,_=k[(S+1)%16],I+=65535&(A=((v=U[(S+1)%16])>>>1|_<<31)^(v>>>8|_<<24)^(v>>>7|_<<25)),x+=A>>>16,T+=65535&(B=(_>>>1|v<<31)^(_>>>8|v<<24)^_>>>7),O+=B>>>16,_=k[(S+14)%16],x+=(A=((v=U[(S+14)%16])>>>19|_<<13)^(_>>>29|v<<3)^(v>>>6|_<<26))>>>16,T+=65535&(B=(_>>>19|v<<13)^(v>>>29|_<<3)^_>>>6),O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,k[S]=65535&T|O<<16,U[S]=65535&I|x<<16;I=65535&(A=H),x=A>>>16,T=65535&(B=M),O=B>>>16,B=e[0],x+=(A=t[0])>>>16,T+=65535&B,O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[0]=M=65535&T|O<<16,t[0]=H=65535&I|x<<16,I=65535&(A=F),x=A>>>16,T=65535&(B=R),O=B>>>16,B=e[1],x+=(A=t[1])>>>16,T+=65535&B,O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[1]=R=65535&T|O<<16,t[1]=F=65535&I|x<<16,I=65535&(A=j),x=A>>>16,T=65535&(B=P),O=B>>>16,B=e[2],x+=(A=t[2])>>>16,T+=65535&B,O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[2]=P=65535&T|O<<16,t[2]=j=65535&I|x<<16,I=65535&(A=G),x=A>>>16,T=65535&(B=C),O=B>>>16,B=e[3],x+=(A=t[3])>>>16,T+=65535&B,O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[3]=C=65535&T|O<<16,t[3]=G=65535&I|x<<16,I=65535&(A=V),x=A>>>16,T=65535&(B=L),O=B>>>16,B=e[4],x+=(A=t[4])>>>16,T+=65535&B,O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[4]=L=65535&T|O<<16,t[4]=V=65535&I|x<<16,I=65535&(A=Y),x=A>>>16,T=65535&(B=D),O=B>>>16,B=e[5],x+=(A=t[5])>>>16,T+=65535&B,O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[5]=D=65535&T|O<<16,t[5]=Y=65535&I|x<<16,I=65535&(A=q),x=A>>>16,T=65535&(B=N),O=B>>>16,B=e[6],x+=(A=t[6])>>>16,T+=65535&B,O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[6]=N=65535&T|O<<16,t[6]=q=65535&I|x<<16,I=65535&(A=z),x=A>>>16,T=65535&(B=K),O=B>>>16,B=e[7],x+=(A=t[7])>>>16,T+=65535&B,O+=B>>>16,O+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[7]=K=65535&T|O<<16,t[7]=z=65535&I|x<<16,W+=128,n-=128}return n}function Z(e,t,r){var n,i=new Int32Array(8),s=new Int32Array(8),o=new Uint8Array(256),a=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,X(i,s,t,r),r%=128,n=0;n<r;n++)o[n]=t[a-r+n];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,p(o,r-8,a/536870912|0,a<<3),X(i,s,o,r),n=0;n<8;n++)p(e,8*n,i[n],s[n]);return 0}function J(e,r){var n=t(),i=t(),s=t(),o=t(),a=t(),c=t(),f=t(),h=t(),l=t();N(n,e[1],e[0]),N(l,r[1],r[0]),K(n,n,l),D(i,e[0],e[1]),D(l,r[0],r[1]),K(i,i,l),K(s,e[3],r[3]),K(s,s,u),K(o,e[2],r[2]),D(o,o,o),N(a,i,n),N(c,o,s),D(f,o,s),D(h,i,n),K(e[0],a,c),K(e[1],h,f),K(e[2],f,c),K(e[3],a,h)}function Q(e,t,r){var n;for(n=0;n<4;n++)M(e[n],t[n],r)}function ee(e,r){var n=t(),i=t(),s=t();F(s,r[2]),K(n,r[0],s),K(i,r[1],s),R(e,i),e[31]^=C(n)<<7}function te(e,t,r){var n,i;for(k(e[0],o),k(e[1],a),k(e[2],a),k(e[3],o),i=255;i>=0;--i)Q(e,t,n=r[i/8|0]>>(7&i)&1),J(t,e),J(e,e),Q(e,t,n)}function re(e,r){var n=[t(),t(),t(),t()];k(n[0],h),k(n[1],l),k(n[2],a),K(n[3],h,l),te(e,n,r)}function ne(e,r,i){var s,o=new Uint8Array(64),a=[t(),t(),t(),t()];for(i||n(r,32),Z(o,r,32),o[0]&=248,o[31]&=127,o[31]|=64,re(a,o),ee(e,a),s=0;s<32;s++)r[s+32]=e[s];return 0}var ie=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function se(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*ie[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*ie[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*ie[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;se(e,r)}function ae(e,r,n,i){var s,o,a=new Uint8Array(64),c=new Uint8Array(64),f=new Uint8Array(64),u=new Float64Array(64),h=[t(),t(),t(),t()];Z(a,i,32),a[0]&=248,a[31]&=127,a[31]|=64;var l=n+64;for(s=0;s<n;s++)e[64+s]=r[s];for(s=0;s<32;s++)e[32+s]=a[32+s];for(Z(f,e.subarray(32),n+32),oe(f),re(h,f),ee(e,h),s=32;s<64;s++)e[s]=i[s];for(Z(c,e,n+64),oe(c),s=0;s<64;s++)u[s]=0;for(s=0;s<32;s++)u[s]=f[s];for(s=0;s<32;s++)for(o=0;o<32;o++)u[s+o]+=c[s]*a[o];return se(e.subarray(32),u),l}function ce(e,r,n,i){var s,c=new Uint8Array(32),u=new Uint8Array(64),h=[t(),t(),t(),t()],l=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),i=t(),s=t(),c=t(),u=t(),h=t(),l=t();return k(e[2],a),L(e[1],r),H(s,e[1]),K(c,s,f),N(s,s,e[2]),D(c,e[2],c),H(u,c),H(h,u),K(l,h,u),K(n,l,s),K(n,n,c),j(n,n),K(n,n,s),K(n,n,c),K(n,n,c),K(e[0],n,c),H(i,e[0]),K(i,i,c),P(i,s)&&K(e[0],e[0],d),H(i,e[0]),K(i,i,c),P(i,s)?-1:(C(e[0])===r[31]>>7&&N(e[0],o,e[0]),K(e[3],e[0],e[1]),0)}(l,i))return-1;for(s=0;s<n;s++)e[s]=r[s];for(s=0;s<32;s++)e[s+32]=i[s];if(Z(u,e,n),oe(u),te(h,l,u),re(l,r.subarray(32)),J(h,l),ee(c,h),n-=64,m(r,0,c,0)){for(s=0;s<n;s++)e[s]=0;return-1}for(s=0;s<n;s++)e[s]=r[s+64];return n}var fe,ue=64,he=32,le=64;function de(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function pe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ye(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:w,crypto_stream_xor:B,crypto_stream:S,crypto_stream_salsa20_xor:v,crypto_stream_salsa20:E,crypto_onetimeauth:I,crypto_onetimeauth_verify:x,crypto_verify_16:g,crypto_verify_32:m,crypto_secretbox:T,crypto_secretbox_open:O,crypto_scalarmult:G,crypto_scalarmult_base:V,crypto_box_beforenm:q,crypto_box_afternm:z,crypto_box:function(e,t,r,n,i,s){var o=new Uint8Array(32);return q(o,i,s),z(e,t,r,n,o)},crypto_box_open:function(e,t,r,n,i,s){var o=new Uint8Array(32);return q(o,i,s),W(e,t,r,n,o)},crypto_box_keypair:Y,crypto_hash:Z,crypto_sign:ae,crypto_sign_keypair:ne,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:ue,crypto_sign_PUBLICKEYBYTES:he,crypto_sign_SECRETKEYBYTES:le,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:f,L:ie,pack25519:R,unpack25519:L,M:K,A:D,S:H,Z:N,pow2523:j,add:J,set25519:k,modL:se,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,r){pe(e,t,r),de(r,t);for(var n=new Uint8Array(32+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+32]=e[s];return T(i,n,n.length,t,r),i.subarray(16)},e.secretbox.open=function(e,t,r){pe(e,t,r),de(r,t);for(var n=new Uint8Array(16+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+16]=e[s];return n.length<32||0!==O(i,n,n.length,t,r)?null:i.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(pe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return G(r,e,t),r},e.scalarMult.base=function(e){if(pe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return V(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox(t,r,s)},e.box.before=function(e,t){pe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return q(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox.open(t,r,s)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return Y(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(pe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return V(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(pe(e,t),t.length!==le)throw new Error("bad secret key size");var r=new Uint8Array(ue+e.length);return ae(r,e,e.length,t),r},e.sign.open=function(e,t){if(pe(e,t),t.length!==he)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ce(r,e,e.length,t);if(n<0)return null;for(var i=new Uint8Array(n),s=0;s<i.length;s++)i[s]=r[s];return i},e.sign.detached=function(t,r){for(var n=e.sign(t,r),i=new Uint8Array(ue),s=0;s<i.length;s++)i[s]=n[s];return i},e.sign.detached.verify=function(e,t,r){if(pe(e,t,r),t.length!==ue)throw new Error("bad signature size");if(r.length!==he)throw new Error("bad public key size");var n,i=new Uint8Array(ue+e.length),s=new Uint8Array(ue+e.length);for(n=0;n<ue;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+ue]=e[n];return ce(s,i,i.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(he),t=new Uint8Array(le);return ne(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(pe(e),e.length!==le)throw new Error("bad secret key size");for(var t=new Uint8Array(he),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(pe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(he),r=new Uint8Array(le),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=he,e.sign.secretKeyLength=le,e.sign.seedLength=32,e.sign.signatureLength=ue,e.hash=function(e){pe(e);var t=new Uint8Array(64);return Z(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return pe(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===y(e,0,t,0,e.length)},e.setPRNG=function(e){n=e},(fe="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&fe.getRandomValues?e.setPRNG(function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)fe.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];ye(n)}):(fe=r(8308))&&fe.randomBytes&&e.setPRNG(function(e,t){var r,n=fe.randomBytes(t);for(r=0;r<t;r++)e[r]=n[r];ye(n)})}(e.exports?e.exports:self.nacl=self.nacl||{})},4552:(e,t,r)=>{"use strict";var n=r(8558);function i(e,t){o(e,t),s(e)}function s(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(o,this,e)):n.nextTick(o,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?r._writableState?r._writableState.errorEmitted?n.nextTick(s,r):(r._writableState.errorEmitted=!0,n.nextTick(i,r,e)):n.nextTick(i,r,e):t?(n.nextTick(s,r),t(e)):n.nextTick(s,r)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}},4635:e=>{e.exports=function(e){var t=e._readableState;return t?t.objectMode||"number"==typeof e._duplexState?e.read():e.read(function(e){if(e.buffer.length){var t=e.bufferIndex||0;if(e.buffer.head)return e.buffer.head.data.length;if(e.buffer.length-t>0&&e.buffer[t])return e.buffer[t].length}return e.length}(t)):null}},4686:(e,t,r)=>{"use strict";const n=r(5350),i=r(7947),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return f(e,t,r)}function f(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|y(e,t);let n=a(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return l(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return d(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||X(e.length)?a(0):l(e):"Buffer"===e.type&&Array.isArray(e.data)?l(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),a(e<0?0:0|p(e))}function l(e){const t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function y(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(e).length;default:if(i)return n?-1:q(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return O(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function m(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),X(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){let s,o=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function f(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(f(e,s)===f(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){let r=!0;for(let n=0;n<c;n++)if(f(e,s+n)!==f(t,n)){r=!1;break}if(r)return s}return-1}function _(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(X(n))return o;e[r+o]=n}return o}function v(e,t,r,n){return W(q(t,e.length-r),e,r,n)}function E(e,t,r,n){return W(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return W(z(t),e,r,n)}function B(e,t,r,n){return W(function(e,t){let r,n,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,c;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(s=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){const t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=x));return r}(n)}t.kMaxLength=o,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return f(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return function(e,t,r){return u(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if($(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=c.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if($(t,Uint8Array))i+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},c.byteLength=y,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if($(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(s,o),f=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<a;++e)if(f[e]!==u[e]){s=f[e],o=u[e];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return _(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":case"latin1":case"binary":return E(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function T(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function O(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=Z[e[n]];return i}function U(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function M(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,i,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function P(e,t,r,n,i){j(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function C(e,t,r,n,i){j(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function L(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function D(e,t,r,n,s){return t=+t,r>>>=0,s||L(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function N(e,t,r,n,s){return t=+t,r>>>=0,s||L(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||M(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||M(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=J(function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))}),c.prototype.readBigUInt64BE=J(function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||M(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||M(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=J(function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),c.prototype.readBigInt64BE=J(function(e){G(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=J(function(e,t=0){return P(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=J(function(e,t=0){return C(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=J(function(e,t=0){return P(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=J(function(e,t=0){return C(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeFloatLE=function(e,t,r){return D(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return D(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return N(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return N(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=c.isBuffer(e)?e:c.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%o]}return this};const K={};function H(e,t,r){K[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function F(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function j(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new K.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){G(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||V(t,e.length-(r+1))}(n,i,s)}function G(e,t){if("number"!=typeof e)throw new K.ERR_INVALID_ARG_TYPE(t,"number",e)}function V(e,t,r){if(Math.floor(e)!==e)throw G(e,r),new K.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new K.ERR_BUFFER_OUT_OF_BOUNDS;throw new K.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}H("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),H("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),H("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=F(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=F(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);const Y=/[^+/0-9A-Za-z-_]/g;function q(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function z(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Y,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function X(e){return e!=e}const Z=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},4914:(e,t,r)=>{"use strict";e.exports=u;var n=r(8704).F,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,c=r(5606);function f(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);c.call(this,e),this._transformState={afterTransform:f.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?l(this,null,null):this._flush(function(t,r){l(e,t,r)})}function l(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}r(6192)(u,c),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new i("_transform()"))},u.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,function(e){t(e)})}},5079:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.instanciateApp=t.instanciateContact=void 0;const i=n(r(2114)),s=r(2810),o=r(3061),a=r(3903),c=n(r(7961)),f=n(r(5550)),u=r(5598),h=r(2655),l=r(4686),d=n(r(4406)),p=r(3127),y=l.Buffer.from("7661756c7479732f656e6372797074696f6e2f01","hex"),g=32,m=e=>e.startsWith("vaultys://connect?")?"LOGIN":e.startsWith("vaultys://signfile?")?"DOCUMENT":"UNKNOWN";t.instanciateContact=e=>{let t;return t=3===e.type?new f.default(s.Fido2Manager.instantiate(e.keyManager),e.certificate,e.type):4===e.type?new f.default(s.Fido2PRFManager.instantiate(e.keyManager),e.certificate,e.type):1952===e.keyManager.signer.publicKey.length?new f.default(s.DilithiumManager.instantiate(e.keyManager),e.certificate,e.type):1984===e.keyManager.signer.publicKey.length?new f.default(s.HybridManager.instantiate(e.keyManager),e.certificate,e.type):new f.default(s.Ed25519Manager.instantiate(e.keyManager),e.certificate,e.type),t},t.instanciateApp=e=>f.default.fromId(l.Buffer.from(e.serverId,"base64"),e.certificate);class b{constructor(e,t){this.protocol_version=0,this.acceptEncryptFile=this.acceptDecryptFile,this.vaultysId=e,this.store=t,this.store.get("metadata")||this.store.set("metadata",{}),this.vaultysId.keyManager.entropy?this.store.set("entropy",this.vaultysId.keyManager.entropy):this.store.set("secret",this.vaultysId.getSecret()),this.store.save()}setProtocolVersion(e){this.protocol_version=e}async exportBackup(e){if(e){const t=await p.platformCrypto.pbkdf2.encrypt(e,l.Buffer.from((0,h.encode)(this.store.toJSON())));if(!t)throw new Error("Failed to encrypt backup");return(0,h.encode)(t)}{const e={version:1,data:l.Buffer.from((0,h.encode)(this.store.toJSON()))};return(0,h.encode)(e)}}static async importBackup(e,t){try{const r=(0,h.decode)(e);let n;if(r.encryptInfo){if(!t)throw new Error("Passphrase required for encrypted backup");if(!r.data)throw new Error("Invalid backup format");if(n=await p.platformCrypto.pbkdf2.decrypt(r,t),!n)throw new Error("Failed to decrypt backup. Incorrect passphrase?")}else n=r.data;const i=(0,a.storagify)((0,h.decode)(n),()=>{},()=>{});return await b.fromStore(i)}catch(e){return console.error("Import error:",e),null}}static async fromStore(e){const t=e.get("entropy"),r=e.get("secret");if(r){if(t){const n=l.Buffer.from(r,"base64")[0],i=await f.default.fromEntropy(t,n);return new b(i,e)}{const t=f.default.fromSecret(r);return new b(t,e)}}if(t){const r=await f.default.machineFromEntropy(t);return new b(r,e)}{const t=await f.default.generateMachine();return new b(t,e)}}merge(e,t=!0){const r=t?e:this.store,n=t?this.store:e;this.store.set("metadata",{...n.get("metadata"),...r.get("metadata")}),["signatures","wot"].forEach(t=>{const r=e.substore(t),n=this.store.substore(t);r.list().forEach(e=>{n.get(e)||n.set(e,r.get(e))})});const i=e.substore("contacts"),s=this.store.substore("contacts"),o=t?i:s,a=t?s:i;i.list().forEach(e=>{if(s.get(e)){const t=s.get(e);t.metadata={...a.get(e).metadata,...o.get(e).metadata},s.set(e,t)}else s.set(e,i.get(e))}),this.store.save()}async verifyWebOfTrust(){let e=!0;for(const t of this.store.substore("wot").list()){const r=this.store.substore("wot").get(t);e=e&&await i.default.verifyCertificate(r)}for(const t of this.store.substore("registrations").list()){const r=this.store.substore("registrations").get(t);e=e&&t===f.default.fromId(r.serverId,void 0,"base64").did}for(const t of this.contacts)e=e&&await i.default.verifyCertificate(t.certificate);for(const t of this.apps)e=e&&await i.default.verifyCertificate(t.certificate);return e}isHardware(){return this.vaultysId.isHardware()}async signIn(){if(!this.vaultysId.isHardware())return!0;await window.CredentialUserInteractionRequest();const e=(0,u.randomBytes)(g),t=this.vaultysId.keyManager,r=await navigator.credentials.get({publicKey:{challenge:e,allowCredentials:[{type:"public-key",id:t.fid,transports:t.transports}],userVerification:"discouraged"}});if(null==r)return!1;const n=r.response,i=c.default.extractChallenge(n.clientDataJSON);return e.toString("base64")===i&&t.verifyCredentials(r)}get contacts(){const e=this.store.substore("contacts");return e.list().map(t=>e.get(t)).map(t.instanciateContact).map(e=>e.toVersion(this.vaultysId.version))}get apps(){const e=this.store.substore("registrations");return e.list().map(t=>e.get(t)).map(t.instanciateApp).map(e=>e.toVersion(this.vaultysId.version))}getContact(e){const r=this.store.substore("contacts").get(e);return r?(0,t.instanciateContact)(r).toVersion(this.vaultysId.version):null}getApp(e){const r=this.store.substore("registrations").get(e);return r?(0,t.instanciateApp)(r).toVersion(this.vaultysId.version):null}setContactMetadata(e,t,r){const n=this.store.substore("contacts").get(e);n&&(n.metadata||(n.metadata={}),n.metadata[t]=r)}getContactMetadata(e,t){const r=this.store.substore("contacts").get(e);return r&&r.metadata?r.metadata[t]:null}getContactMetadatas(e){const t=this.store.substore("contacts").get(e);return t&&t.metadata?t.metadata:null}async verifyRelationshipCertificate(e){const t=this.store.substore("contacts").get(e)||this.store.substore("registrations").get(e);return i.default.verifyCertificate(t.certificate)}set name(e){this.store.get("metadata").name=e}get name(){return this.store.get("metadata").name}get displayName(){const e=this.store.get("metadata"),t=e.firstname?e.firstname+" "+(e.name??""):e.name;return t?.length>0?t:"Anonymous "+this.vaultysId.fingerprint?.slice(-4)}set phone(e){this.store.get("metadata").phone=e}get phone(){return this.store.get("metadata").phone}set email(e){this.store.get("metadata").email=e}get email(){return this.store.get("metadata").email}async signChallenge(e){const t=await this.vaultysId.signChallenge(e);return this.store.substore("signatures").set(""+Date.now(),{signature:t,challenge:e}),this.store.save(),t}async signFile(e){const t=(0,u.hash)("sha256",e.arrayBuffer).toString("hex"),r=l.Buffer.from(`vaultys://signfile?hash=${t}&timestamp=${Date.now()}`,"utf-8"),n={challenge:r,signature:await this.vaultysId.signChallenge(r)};return this.store.substore("signatures").set(Date.now()+"",n),this.store.save(),n}verifyFile(e,t,r,n=!0){const i=t.challenge.toString("utf8");if(!i.startsWith("vaultys://signfile?"))return!1;const s=(0,u.hash)("sha256",e.arrayBuffer).toString("hex"),o=new URL(i);return s===o.searchParams.get("hash")&&!(2!==o.search.match(/[a-z\d]+=[a-z\d]+/gi)?.length||!o.searchParams.get("timestamp"))&&r.verifyChallenge(t.challenge,t.signature,n)}async decryptFile(e,t){const r=new Uint8Array(e.arrayBuffer),n=r.slice(0,y.length);if(l.Buffer.from(n).toString("hex")!==y.toString("hex"))throw new Error("Invalid header for encrypted file");const i=r.slice(y.length,y.length+g),s=r.slice(y.length+g,y.length+g+d.default.secretbox.nonceLength),o=r.slice(y.length+g+d.default.secretbox.nonceLength),a=t?await this.requestPRF(t,"encryption/"+l.Buffer.from(i).toString("hex")+"/encryption"):await this.vaultysId.hmac("prf|encryption/"+l.Buffer.from(i).toString("hex")+"/encryption|prf");if(a?.length!==g)throw new Error("Invalid PRF generated");const c=(0,u.hash)("sha256",a);(0,u.secureErase)(a);const f=d.default.secretbox.open(o,s,c);if((0,u.secureErase)(c),!f)throw new Error("Decryption failed");return{name:e.name,type:e.type,arrayBuffer:l.Buffer.from(f)}}async encryptFile(e,t){const r=(0,u.randomBytes)(g),n=t?await this.requestPRF(t,"encryption/"+l.Buffer.from(r).toString("hex")+"/encryption"):await this.vaultysId.hmac("prf|encryption/"+r.toString("hex")+"/encryption|prf");if(n?.length!==g)return null;const i=(0,u.hash)("sha256",n);(0,u.secureErase)(n);const s=d.default.randomBytes(d.default.secretbox.nonceLength),o=d.default.secretbox(new Uint8Array(e.arrayBuffer),s,i);(0,u.secureErase)(i);const a=new Uint8Array(y.length+g+s.length+o.length);return a.set(y),a.set(r,y.length),a.set(s,y.length+g),a.set(o,y.length+g+s.length),{name:e.name,type:e.type,arrayBuffer:l.Buffer.from(a)}}getSignatures(){const e=this.store.substore("signatures");return e.list().sort().map(t=>{const r=e.get(t),n=l.Buffer.from(r.challenge).toString("utf-8");return{date:t,payload:r,challenge:n,type:m(n)}})}migrate(e){this.vaultysId.toVersion(e);const r=this.store.substore("contacts");for(const n of r.list()){const i=r.get(n),s=(0,t.instanciateContact)(i),o=s.toVersion(e);o.did!==n&&(r.set(o.did,{...s,...o,metadata:i.metadata,oldDid:n}),r.delete(n))}const n=this.store.substore("registrations");for(const r of n.list()){const i=n.get(r),s=(0,t.instanciateApp)(i);if(s){const t=s.toVersion(e);if(t.did!==r){const e=i.site===r?t.did:i.site;n.set(t.did,{site:e,oldDid:r,serverId:t.id.toString("base64"),certificate:i.certificate,timestamp:i.timestamp}),n.delete(r)}}}this.store.save()}async verifyChallenge(e,t){return this.vaultysId.verifyChallenge(e,t,!0)}async upload(e,t){if((await this.startSRP(e,"p2p","transfer")).isComplete()){const{upload:r}=(0,o.StreamChannel)(e);await r(t)}else e.send(l.Buffer.from([0]))}async download(e,t){if((await this.acceptSRP(e,"p2p","transfer")).isComplete()){const{download:r}=(0,o.StreamChannel)(e);await r(t)}else e.send(l.Buffer.from([0]))}async requestDecrypt(e,t){const r=await this.acceptSRP(e,"p2p","decrypt");if(r.isComplete()){e.send(t);const n=await e.receive();return await this.vaultysId.dhiesDecrypt(n,r.getContactId().id)}e.send(l.Buffer.from([0]))}async acceptDecrypt(e,t){const r=await this.startSRP(e,"p2p","decrypt",{},t);if(r.isComplete()){const t=await e.receive(),n=await this.vaultysId.decrypt(t.toString("utf-8"));if(n){const t=await this.vaultysId.dhiesEncrypt(n,r.getContactId().id);e.send(t??l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}async requestDecryptFile(e,t){return this.decryptFile(t,e)}async requestEncryptFile(e,t){return this.encryptFile(t,e)}async acceptDecryptFile(e,t){let r=null;return await this.acceptPRF(e,(e,n)=>n.length>63&&n.startsWith("encryption/")&&n.endsWith("/encryption")?(r=e,t?.(e)||Promise.resolve(!0)):Promise.resolve(!1)),r}async requestSignFile(e,t){const r=await this.acceptSRP(e,"p2p","signfile");if(r.isComplete()){e.send(l.Buffer.from((0,h.encode)(t)));const n=await e.receive(),i=(0,h.decode)(n);return this.verifyFile(t,i,r.getContactId().toVersion(1))?i:void 0}e.send(l.Buffer.from([0]))}async acceptSignFile(e,t){const r=await this.startSRP(e,"p2p","signfile");if(r.isComplete()){const n=await e.receive(),i=(0,h.decode)(n);if(!t||await t(r.getContactId(),i)){const t=await this.signFile(i);e.send(l.Buffer.from((0,h.encode)(t)))}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}async requestPRF(e,t){if(t.length<3)throw new Error("appid is too short, less than 3 characters");if(t.split("|").length>1)throw new Error("appid contains illegal character |");if((await this.acceptSRP(e,"p2p","prf")).isComplete()){e.send(l.Buffer.from(t,"utf-8"));const r=await e.receive();return l.Buffer.from(r)}e.send(l.Buffer.from([0]))}async acceptPRF(e,t){const r=await this.startSRP(e,"p2p","prf");if(r.isComplete()){const n=(await e.receive()).toString("utf-8");if(n.length<3||n.split("|").length>1)e.send(l.Buffer.from([0]));else if(!t||await t(r.getContactId(),n)){const t=await this.vaultysId.hmac("prf|"+n+"|prf")??l.Buffer.from([0]);e.send(t),(0,u.secureErase)(t)}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}listCertificates(){const e=this.store.substore("wot");return e.list().map(t=>{const r=e.get(t);if(r.timestamp)return r;{const n={...i.default.deserializeCertificate(e.get(t)),raw:r};return e.set(t,n),n}})}async startSRP(e,t,r,n={},s){const o=new i.default(this.vaultysId);o.createChallenge(t,r,this.protocol_version,n);const a=o.getCertificate();if(!a)throw e.close(),e.send(l.Buffer.from([0])),new Error("Error processing challenge");e.send(a);try{const t=await e.receive(),r=i.default.deserializeCertificate(t).pk2;if(!r)throw e.send(l.Buffer.from([0])),new Error("Contact pk2 is not sent");if(s&&!await s(f.default.fromId(r)))throw e.send(l.Buffer.from([0])),new Error("Contact refused");await o.update(t)}catch(t){throw e.send(l.Buffer.from([0])),new Error(t)}if(o.isComplete()){const t=o.getCertificate();if(!t)throw e.close(),e.send(l.Buffer.from([0])),new Error("Error processing challenge");return e.send(t),this.store.substore("wot").set(Date.now()+"",t),o}throw e.send(l.Buffer.from([0])),new Error("Can't add a new contact if the protocol is not complete")}async acceptSRP(e,t,r,n={},s){const o=new i.default(this.vaultysId);try{const a=await e.receive(),c=i.default.deserializeCertificate(a);if(!c.pk1)throw e.send(l.Buffer.from([0])),new Error("Contact pk1 is not sent");if(c.protocol!==t)throw e.send(l.Buffer.from([0])),new Error("protocol is not the one expected: "+c.protocol+" !="+t);if(c.service!==r)throw e.send(l.Buffer.from([0])),new Error("service is not the one expected: "+c.service+" !="+r);if(s&&!await s(f.default.fromId(c.pk1)))throw e.send(l.Buffer.from([0])),new Error("Contact refused");await o.update(a,n)}catch(t){throw e.send(l.Buffer.from([0])),new Error(t)}const a=o.getCertificate();if(!a)throw e.send(l.Buffer.from([0])),await e.close(),new Error("Error processing challenge");e.send(a);try{const t=await e.receive();await o.update(t)}catch(t){throw await e.close(),new Error(t)}if(o.isComplete()){const e=o.getCertificate();return this.store.substore("wot").set(Date.now()+"",e),o}throw await e.close(),new Error("Can't add a new contact if the protocol is not complete")}saveApp(e,t){if(e.toVersion(this.vaultysId.version),e.isMachine()){const r=this.store.substore("registrations");r.get(e.did)||r.set(e.did,{site:t??e.did,serverId:e.id.toString("base64"),certificate:e.certificate})}else this.saveContact(e)}saveContact(e){if(e.toVersion(this.vaultysId.version),e.isMachine())this.saveApp(e);else{const t=this.store.substore("contacts");t.get(e.did)||(t.set(e.did,e),this.store.save())}}async askContact(e,t={},r){const n=(await this.startSRP(e,"p2p","auth",t,r)).getContactId();return this.saveContact(n),n}async acceptContact(e,t={},r){const n=(await this.acceptSRP(e,"p2p","auth",t,r)).getContactId();return this.saveContact(n),n}}t.default=b},5350:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=a(e),o=s[0],c=s[1],f=new i(function(e,t,r){return 3*(t+r)/4-r}(0,o,c)),u=0,h=c>0?o-4:o;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],f[u++]=t>>16&255,f[u++]=t>>8&255,f[u++]=255&t;return 2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,f[u++]=255&t),1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,f[u++]=t>>8&255,f[u++]=255&t),f},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],o=16383,a=0,c=n-i;a<c;a+=o)s.push(f(e,a,a+o>c?c:a+o));return 1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function f(e,t,r){for(var n,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(c(n));return i.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},5391:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shake256=t.shake128=t.keccak_512=t.keccak_384=t.keccak_256=t.keccak_224=t.sha3_512=t.sha3_384=t.sha3_256=t.sha3_224=t.Keccak=void 0,t.keccakP=w;const n=r(3842),i=r(11),s=BigInt(0),o=BigInt(1),a=BigInt(2),c=BigInt(7),f=BigInt(256),u=BigInt(113),h=[],l=[],d=[];for(let e=0,t=o,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],h.push(2*(5*n+r)),l.push((e+1)*(e+2)/2%64);let i=s;for(let e=0;e<7;e++)t=(t<<o^(t>>c)*u)%f,t&a&&(i^=o<<(o<<BigInt(e))-o);d.push(i)}const p=(0,n.split)(d,!0),y=p[0],g=p[1],m=(e,t,r)=>r>32?(0,n.rotlBH)(e,t,r):(0,n.rotlSH)(e,t,r),b=(e,t,r)=>r>32?(0,n.rotlBL)(e,t,r):(0,n.rotlSL)(e,t,r);function w(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,s=r[i],o=r[i+1],a=m(s,o,1)^r[n],c=b(s,o,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=l[r],s=m(t,i,n),o=b(t,i,n),a=h[r];t=e[a],i=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=y[n],e[1]^=g[n]}(0,i.clean)(r)}class _ extends i.Hash{constructor(e,t,r,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=s,(0,i.anumber)(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,i.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,i.swap32IfBE)(this.state32),w(this.state32,this.rounds),(0,i.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(e){(0,i.aexists)(this),e=(0,i.toBytes)(e),(0,i.abytes)(e);const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){(0,i.aexists)(this,!1),(0,i.abytes)(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,i.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,i.aoutput)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,i.clean)(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new _(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}t.Keccak=_;const v=(e,t,r)=>(0,i.createHasher)(()=>new _(t,e,r));t.sha3_224=v(6,144,28),t.sha3_256=v(6,136,32),t.sha3_384=v(6,104,48),t.sha3_512=v(6,72,64),t.keccak_224=v(1,144,28),t.keccak_256=v(1,136,32),t.keccak_384=v(1,104,48),t.keccak_512=v(1,72,64);const E=(e,t,r)=>(0,i.createXOFer)((n={})=>new _(t,e,void 0===n.dkLen?r:n.dkLen,!0));t.shake128=E(31,168,16),t.shake256=E(31,136,32)},5397:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHash=function(e){return{hash:e}},t.createCurve=function(e,t){const r=t=>(0,n.weierstrass)({...e,hash:t});return{...r(t),create:r}};const n=r(1164)},5466:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(4406),s=r(2655),o=r(4072);class a{constructor(e,t){this.payload_secretbox=e,this.final=t}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data}static create(e,t,r,s,o,a=!1){const c=this.generateNonce(e.hash,o,a),f=r?i.sign.detached(Uint8Array.from(this.generateSignatureData(e.hash,c,a,s)),Uint8Array.from(r)):n.alloc(64);return new this(n.from((0,i.secretbox)(Uint8Array.from(n.concat([f,s])),Uint8Array.from(c),Uint8Array.from(t))),a)}static generateNonce(e,t,r){const i=n.alloc(24,n.from(e));return i[15]=r?1|i[15]:254&i[15],i.writeBigUInt64BE(t,16),i}static generateSignatureData(e,t,r,i){return n.concat([n.from("saltpack encrypted signature"),n.from([0]),e,t,n.from([r?1:0]),o.sha512.create().update(i).digest()])}encode(){return a.encodePayload(this.payload_secretbox,this.final)}static encodePayload(e,t){const r=[e,t];return n.from((0,s.encode)(r))}static decode(e,t=!1){const r=t?e:(0,s.decode)(e);if(r.length<2)throw new Error("Invalid data");const[n,i]=r;return new this(n,i)}decrypt(e,t,r,n){const s=a.generateNonce(e.hash,n,this.final),o=i.secretbox.open(Uint8Array.from(this.payload_secretbox),Uint8Array.from(s),Uint8Array.from(r));if(!o)throw new Error("Failed to decrypt data");const c=o.slice(64);if(t){const r=o.slice(0,64),n=a.generateSignatureData(e.hash,s,this.final,c);if(!i.sign.detached.verify(Uint8Array.from(n),Uint8Array.from(r),Uint8Array.from(t)))throw new Error("Invalid signature")}return c}}a.PAYLOAD_NONCE_PREFIX=n.from("saltpack_ploadsb"),t.default=a},5550:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=r(2810),o=n(r(7961)),a=r(7165),c=r(4686),f=r(6761),u=n(r(7264)),h=c.Buffer.from("VAULTYS_SIGN","utf8");class l{constructor(e,t,r=0){this.encrypt=l.encrypt,this.type=r,this.keyManager=e,this.certificate=t}static fromId(e,t,r="hex"){let n=e;e.data&&(n=c.Buffer.from(e.data)),e instanceof Uint8Array&&(n=c.Buffer.from(e)),"string"==typeof e&&(n=c.Buffer.from(e,r));const i=n[0];if(3===i){const e=s.Fido2Manager.fromId(n.slice(1));return new l(e,t,i)}if(4===i){const e=s.Fido2PRFManager.fromId(n.slice(1));return new l(e,t,i)}if(1998===n.length){const e=s.DilithiumManager.fromId(n.slice(1));return new l(e,t,i)}if(2030===n.length){const e=s.HybridManager.fromId(n.slice(1));return new l(e,t,i)}{const e=s.Ed25519Manager.fromId(n.slice(1));return new l(e,t,i)}}static async fromEntropy(e,t,r="ed25519"){const n=e;if("dilithium"===r){const e=await s.DilithiumManager.createFromEntropy(n);return new l(e,void 0,t)}if("dilithium_ed25519"===r){const e=await s.HybridManager.createFromEntropy(n);return new l(e,void 0,t)}{const e=await s.Ed25519Manager.createFromEntropy(n);return new l(e,void 0,t)}}static async createWebauthn(e=!0,t){const r=l.createPublicKeyCredentialCreationOptions(e),n=(0,a.getWebAuthnProvider)(),i=await n.create(r);return i?l.fido2FromAttestation(i,t):null}static async createPQC(){const e=l.createPublicKeyCredentialOptionsPQC(),t=(0,a.getWebAuthnProvider)(),r=await t.create(e);return r?l.fido2FromAttestation(r):null}static async fido2FromAttestation(e,t){if(o.default.verifyPackedAttestation(e.response,!0),!e.getClientExtensionResults().prf?.enabled||t&&!await t()){const t=await s.Fido2Manager.createFromAttestation(e);return new l(t,void 0,3)}{const t=await s.Fido2PRFManager.createFromAttestation(e);return new l(t,void 0,4)}}static async machineFromEntropy(e){return l.fromEntropy(e,0)}static async organizationFromEntropy(e){return l.fromEntropy(e,2)}static async personFromEntropy(e){return l.fromEntropy(e,1)}static fromSecret(e,t="hex"){const r=c.Buffer.from(e,t),n=r[0];if(3==n){const e=s.Fido2Manager.fromSecret(r.slice(1));return new l(e,void 0,n)}if(4==n){const e=s.Fido2PRFManager.fromSecret(r.slice(1));return new l(e,void 0,n)}if(73===r.length){const e=s.DilithiumManager.fromSecret(r.slice(1));return new l(e,void 0,n)}if(84===r.length){const e=s.HybridManager.fromSecret(r.slice(1));return new l(e,void 0,n)}{const e=s.Ed25519Manager.fromSecret(r.slice(1));return new l(e,void 0,n)}}static async generatePerson(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new l(e,void 0,1)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new l(e,void 0,1)}{const e=await s.Ed25519Manager.generate();return new l(e,void 0,1)}}static async generateOrganization(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new l(e,void 0,2)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new l(e,void 0,2)}{const e=await s.Ed25519Manager.generate();return new l(e,void 0,2)}}static async generateMachine(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new l(e,void 0,0)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new l(e,void 0,0)}{const e=await s.Ed25519Manager.generate();return new l(e,void 0,0)}}get relationshipCertificate(){return this.certificate}getSecret(e="hex"){return c.Buffer.concat([c.Buffer.from([this.type]),this.keyManager.getSecret()]).toString(e)}get fingerprint(){return c.Buffer.concat([c.Buffer.from([this.type]),(0,i.hash)("SHA224",this.keyManager.id)]).toString("hex").slice(0,40).toUpperCase().match(/.{1,4}/g).join(" ")}get did(){return`did:vaultys:${c.Buffer.concat([c.Buffer.from([this.type]),(0,i.hash)("SHA224",this.keyManager.id)]).toString("hex").slice(0,40)}`}get didDocument(){return{"@context":["https://www.w3.org/ns/did/v1","https://w3id.org/security/suites/ed25519-2020/v1"],id:this.did,authentication:[{id:`${this.did}#keys-1`,type:this.keyManager.authType,controller:this.did,publicKeyMultibase:"m"+c.Buffer.from(this.keyManager.signer.publicKey).toString("base64")}],keyAgreement:[{id:`${this.did}#keys-2`,type:this.keyManager.encType,controller:this.did,publicKeyMultibase:"m"+c.Buffer.from(this.keyManager.cypher.publicKey).toString("base64")}]}}get id(){return c.Buffer.concat([c.Buffer.from([this.type]),this.keyManager.id])}toVersion(e){return this.keyManager.version=e,this}get version(){return this.keyManager.version}isHardware(){return 3===this.type||4===this.type}isMachine(){return 0===this.type}isPerson(){return 1===this.type}getOTPHmac(e=36e5){const t=Math.floor((new Date).getTime()/e);return this.keyManager.getSecretHash(c.Buffer.from(`OTP-${t}`)).toString("hex")}getOTP(e="password",t=864e5){if(this.certificate){const r=Math.floor((new Date).getTime()/t),n=c.Buffer.concat([c.Buffer.from(e,"utf-8"),c.Buffer.from(this.certificate),c.Buffer.from([r])]);return(0,i.hash)("SHA256",n).toString("hex")}throw new Error("no certificate, cannot derive OTP")}async performDiffieHellman(e){return this.keyManager.performDiffieHellman(e.keyManager)}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){let r;return r="string"==typeof t?c.Buffer.from(t.slice(2),"hex"):t.slice(1),this.keyManager.dhiesEncrypt(e,r)}async dhiesDecrypt(e,t){let r;return r="string"==typeof t?c.Buffer.from(t.slice(2),"hex"):t.slice(1),this.keyManager.dhiesDecrypt(e,r)}async signChallenge_v0(e,t){"string"==typeof e&&(e=c.Buffer.from(e,"hex"));const r=(0,i.hash)("sha256",c.Buffer.concat([t,e])),n=await this.keyManager.sign(r);if(n)return n;throw new Error("Could not sign challenge")}verifyChallenge_v0(e,t,r,n){"string"==typeof e&&(e=c.Buffer.from(e,"hex")),"string"==typeof t&&(t=c.Buffer.from(t,"hex"));const s=(0,i.hash)("sha256",c.Buffer.concat([n,e]));return this.keyManager.verify(s,t,r)}async signChallenge(e){"string"==typeof e&&(e=c.Buffer.from(e,"hex"));const t=(0,i.hash)("sha256",c.Buffer.concat([h,e])),r=await this.keyManager.sign(t);if(r)return r;throw new Error("Could not sign challenge")}verifyChallenge(e,t,r){"string"==typeof e&&(e=c.Buffer.from(e,"hex")),"string"==typeof t&&(t=c.Buffer.from(t,"hex"));const n=(0,i.hash)("sha256",c.Buffer.concat([h,e]));return this.keyManager.verify(n,t,r)}async signcrypt(e,t){return this.keyManager.signcrypt(e,t.map(e=>"string"==typeof e?c.Buffer.from(e.slice(2),"hex"):e.slice(1)))}static async encrypt(e,t){return u.default.encrypt(e,t.map(e=>"string"==typeof e?c.Buffer.from(e.slice(2),"hex"):e.slice(1)))}async decrypt(e,t){let r;return t&&(r="string"==typeof t?c.Buffer.from(t.slice(2)):t.subarray(1)),this.keyManager.decrypt(e,r)}async hmac(e){return(await this.keyManager.getCypher()).hmac(e)}}l.createPublicKeyCredentialOptionsPQC=()=>{const e=/^((?!chrome|android).)*applewebkit/i.test(navigator.userAgent);return{challenge:(0,i.randomBytes)(32),rp:{name:"Vaultys ID"},user:{id:(0,i.randomBytes)(16),name:"Vaultys ID",displayName:"Vaultys Wallet ID"},attestation:e?"none":"direct",authenticatorSelection:{authenticatorAttachment:"cross-platform",residentKey:"discouraged",userVerification:"preferred"},hints:["security-key"],extensions:{prf:{eval:{first:c.Buffer.from("VaultysID salt","utf-8")}}},pubKeyCredParams:[{type:"public-key",alg:f.PQ_COSE_ALG.DILITHIUM2}]}},l.createPublicKeyCredentialCreationOptions=e=>{const t=/^((?!chrome|android).)*applewebkit/i.test(navigator.userAgent),r=e?"client-device":"security-key";return{challenge:(0,i.randomBytes)(32),rp:{name:"Vaultys ID"},user:{id:(0,i.randomBytes)(16),name:"Vaultys ID",displayName:"Vaultys Wallet ID"},attestation:t?"none":"direct",authenticatorSelection:{authenticatorAttachment:e?"platform":"cross-platform",residentKey:e?"required":"discouraged",userVerification:"preferred"},hints:[r],extensions:{prf:{eval:{first:c.Buffer.from("VaultysID salt","utf-8")}}},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-8},{type:"public-key",alg:-257}]}},t.default=l},5598:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.secureErase=t.fromUTF8=t.fromHex=t.fromBase64=t.toUTF8=t.toHex=t.toBase64=t.secretbox=t.randomBytes=t.hmac=t.hash=t.Buffer=void 0;const a=o(r(4406)),c=r(4686);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return c.Buffer}});const f=r(4072),u=r(3835),h=e=>{const t=e.replaceAll("-","").toLowerCase();return"sha256"===t?f.sha256:"sha512"===t?f.sha512:"sha224"===t?f.sha224:f.sha256};t.randomBytes=e=>c.Buffer.from((0,a.randomBytes)(e)),t.hash=(e,t)=>c.Buffer.from(h(e).create().update(t).digest()),t.hmac=(e,t,r)=>c.Buffer.from((0,u.hmac)(h(e),t,r));const l=a.default.secretbox;t.secretbox=l,t.toBase64=e=>c.Buffer.from(e).toString("base64"),t.toHex=e=>c.Buffer.from(e).toString("hex"),t.toUTF8=e=>c.Buffer.from(e).toString("utf-8"),t.fromBase64=e=>c.Buffer.from(e,"base64"),t.fromHex=e=>c.Buffer.from(e,"hex"),t.fromUTF8=e=>c.Buffer.from(e,"utf-8"),t.secureErase=e=>{for(let t=0;t<e.length;t++)e[t]=0}},5606:(e,t,r)=>{"use strict";var n=r(8558),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var s=r(4324),o=r(6868);r(6192)(u,s);for(var a=i(o.prototype),c=0;c<a.length;c++){var f=a[c];u.prototype[f]||(u.prototype[f]=o.prototype[f])}function u(e){if(!(this instanceof u))return new u(e);s.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||n.nextTick(l,this)}function l(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},5617:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encryptInfo=void 0,t.encryptInfo={ALG:"PBKDF2",ITERATIONS:2e7,DERIVED_KEY_TYPE:"AES-GCM",DERIVED_KEY_LENGTH:256,HASH:"SHA-256"}},5691:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp521r1=t.p521=void 0;const n=r(2355);t.p521=n.p521,t.secp521r1=n.p521,t.hashToCurve=n.p521_hasher.hashToCurve,t.encodeToCurve=n.p521_hasher.encodeToCurve},5706:e=>{"use strict";class t{constructor(){this.clear()}clear(){this.map=new WeakMap,this.count=0,this.recording=!0}stop(){this.recording=!1}check(e){const r=this.map.get(e);if(r)return r.length>1?r[0]||this.recording?r[1]:(r[0]=!0,t.FIRST):this.recording?(r.push(this.count++),r[1]):t.NEVER;if(!this.recording)throw new Error("New object detected when not recording");return this.map.set(e,[!1]),t.NEVER}}t.NEVER=-1,t.FIRST=-2,e.exports=t},5709:e=>{e.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(e){n[e]=t[e]}),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(e){n[e]=i[e]}),n}}},5713:(e,t,r)=>{"use strict";const{Buffer:n}=r(4686),i=r(3271),s=r(5775),{MT:o}=r(790);class a extends Map{constructor(e){super(e)}static _encode(e){return i.encodeCanonical(e).toString("base64")}static _decode(e){return s.decodeFirstSync(e,"base64")}get(e){return super.get(a._encode(e))}set(e,t){return super.set(a._encode(e),t)}delete(e){return super.delete(a._encode(e))}has(e){return super.has(a._encode(e))}*keys(){for(const e of super.keys())yield a._decode(e)}*entries(){for(const e of super.entries())yield[a._decode(e[0]),e[1]]}[Symbol.iterator](){return this.entries()}forEach(e,t=this){if("function"!=typeof e)throw new TypeError("Must be function");for(const r of super.entries())e.call(t,r[1],a._decode(r[0]),this)}encodeCBOR(e){if(!e._pushInt(this.size,o.MAP))return!1;if(e.canonical){const t=Array.from(super.entries()).map(e=>[n.from(e[0],"base64"),e[1]]);t.sort((e,t)=>e[0].compare(t[0]));for(const r of t)if(!e.push(r[0])||!e.pushAny(r[1]))return!1}else for(const t of super.entries())if(!e.push(n.from(t[0],"base64"))||!e.pushAny(t[1]))return!1;return!0}}e.exports=a},5727:(e,t,r)=>{(t=e.exports=r(4324)).Stream=t,t.Readable=t,t.Writable=r(6868),t.Duplex=r(5606),t.Transform=r(4914),t.PassThrough=r(9648),t.finished=r(2862),t.pipeline=r(110)},5775:(e,t,r)=>{"use strict";const n=r(1883),i=r(1163),s=r(9109),o=r(8590),a=r(6899),c=r(790),{MT:f,NUMBYTES:u,SYMS:h,BI:l}=c,{Buffer:d}=r(4686),p=Symbol("count"),y=Symbol("major type"),g=Symbol("error"),m=Symbol("not found");function b(e,t,r){const n=[];return n[p]=r,n[h.PARENT]=e,n[y]=t,n}function w(e,t){const r=new a;return r[p]=-1,r[h.PARENT]=e,r[y]=t,r}class _ extends Error{constructor(e,t){super(`Unexpected data: 0x${e.toString(16)}`),this.name="UnexpectedDataError",this.byte=e,this.value=t}}function v(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}class E extends n{constructor(e={}){const{tags:t={},max_depth:r=-1,preferMap:n=!1,preferWeb:i=!1,required:s=!1,encoding:o="hex",extendedResults:c=!1,preventDuplicateKeys:f=!1,...u}=e;super({defaultEncoding:o,...u}),this.running=!0,this.max_depth=r,this.tags=t,this.preferMap=n,this.preferWeb=i,this.extendedResults=c,this.required=s,this.preventDuplicateKeys=f,c&&(this.bs.on("read",this._onRead.bind(this)),this.valueBytes=new a)}static nullcheck(e){switch(e){case h.NULL:return null;case h.UNDEFINED:return;case m:throw new Error("Value not found");default:return e}}static decodeFirstSync(e,t={}){if(null==e)throw new TypeError("input required");({options:t}=v(t));const{encoding:r="hex",...n}=t,i=new E(n),s=o.guessEncoding(e,r),a=i._parse();let c=a.next();for(;!c.done;){const e=s.read(c.value);if(null==e||e.length!==c.value)throw new Error("Insufficient data");i.extendedResults&&i.valueBytes.write(e),c=a.next(e)}let f=null;if(i.extendedResults)f=c.value,f.unused=s.read();else if(f=E.nullcheck(c.value),s.length>0){const e=s.read(1);throw s.unshift(e),new _(e[0],f)}return f}static decodeAllSync(e,t={}){if(null==e)throw new TypeError("input required");({options:t}=v(t));const{encoding:r="hex",...n}=t,i=new E(n),s=o.guessEncoding(e,r),a=[];for(;s.length>0;){const e=i._parse();let t=e.next();for(;!t.done;){const r=s.read(t.value);if(null==r||r.length!==t.value)throw new Error("Insufficient data");i.extendedResults&&i.valueBytes.write(r),t=e.next(r)}a.push(E.nullcheck(t.value))}return a}static decodeFirst(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=v(t,r));const{encoding:n="hex",required:i=!1,...s}=t,a=new E(s);let c=m;const f=o.guessEncoding(e,n),u=new Promise((e,t)=>{a.on("data",e=>{c=E.nullcheck(e),a.close()}),a.once("error",r=>a.extendedResults&&r instanceof _?(c.unused=a.bs.slice(),e(c)):(c!==m&&(r.value=c),c=g,a.close(),t(r))),a.once("end",()=>{switch(c){case m:return i?t(new Error("No CBOR found")):e(c);case g:return;default:return e(c)}})});return"function"==typeof r&&u.then(e=>r(null,e),r),f.pipe(a),u}static decodeAll(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=v(t,r));const{encoding:n="hex",...i}=t,s=new E(i),a=[];s.on("data",e=>a.push(E.nullcheck(e)));const c=new Promise((e,t)=>{s.on("error",t),s.on("end",()=>e(a))});return"function"==typeof r&&c.then(e=>r(void 0,e),e=>r(e,void 0)),o.guessEncoding(e,n).pipe(s),c}close(){this.running=!1,this.__fresh=!0}_onRead(e){this.valueBytes.write(e)}*_parse(){let e=null,t=0,r=null;for(;;){if(this.max_depth>=0&&t>this.max_depth)throw new Error(`Maximum depth ${this.max_depth} exceeded`);const[n]=yield 1;if(!this.running)throw this.bs.unshift(d.from([n])),new _(n);const c=n>>5,g=31&n,m=null==e?void 0:e[y],v=null==e?void 0:e.length;switch(g){case u.ONE:this.emit("more-bytes",c,1,m,v),[r]=yield 1;break;case u.TWO:case u.FOUR:case u.EIGHT:{const e=1<<g-24;this.emit("more-bytes",c,e,m,v);const t=yield e;r=c===f.SIMPLE_FLOAT?t:o.parseCBORint(g,t);break}case 28:case 29:case 30:throw this.running=!1,new Error(`Additional info not implemented: ${g}`);case u.INDEFINITE:switch(c){case f.POS_INT:case f.NEG_INT:case f.TAG:throw new Error(`Invalid indefinite encoding for MT ${c}`)}r=-1;break;default:r=g}switch(c){case f.POS_INT:break;case f.NEG_INT:r=r===Number.MAX_SAFE_INTEGER?l.NEG_MAX:"bigint"==typeof r?l.MINUS_ONE-r:-1-r;break;case f.BYTE_STRING:case f.UTF8_STRING:switch(r){case 0:this.emit("start-string",c,r,m,v),r=c===f.UTF8_STRING?"":this.preferWeb?new Uint8Array(0):d.allocUnsafe(0);break;case-1:this.emit("start",c,h.STREAM,m,v),e=w(e,c),t++;continue;default:this.emit("start-string",c,r,m,v),r=yield r,c===f.UTF8_STRING?r=o.utf8(r):this.preferWeb&&(r=new Uint8Array(r.buffer,r.byteOffset,r.length))}break;case f.ARRAY:case f.MAP:switch(r){case 0:r=c===f.MAP?this.preferMap?new Map:{}:[];break;case-1:this.emit("start",c,h.STREAM,m,v),e=b(e,c,-1),t++;continue;default:this.emit("start",c,r,m,v),e=b(e,c,r*(c-3)),t++;continue}break;case f.TAG:this.emit("start",c,r,m,v),e=b(e,c,1),e.push(r),t++;continue;case f.SIMPLE_FLOAT:if("number"==typeof r){if(g===u.ONE&&r<32)throw new Error(`Invalid two-byte encoding of simple value ${r}`);const t=null!=e;r=s.decode(r,t,t&&e[p]<0)}else r=o.parseCBORfloat(r)}this.emit("value",r,m,v,g);let S=!1;for(;null!=e;){if(r===h.BREAK)e[p]=1;else if(Array.isArray(e))e.push(r);else{const t=e[y];if(null!=t&&t!==c)throw this.running=!1,new Error("Invalid major type in indefinite encoding");e.write(r)}if(0!==--e[p]){S=!0;break}if(--t,delete e[p],Array.isArray(e))switch(e[y]){case f.ARRAY:r=e;break;case f.MAP:{let t=!this.preferMap;if(e.length%2!=0)throw new Error(`Invalid map length: ${e.length}`);for(let r=0,n=e.length;t&&r<n;r+=2)if("string"!=typeof e[r]||"__proto__"===e[r]){t=!1;break}if(t){r={};for(let t=0,n=e.length;t<n;t+=2){if(this.preventDuplicateKeys&&Object.prototype.hasOwnProperty.call(r,e[t]))throw new Error("Duplicate keys in a map");r[e[t]]=e[t+1]}}else{r=new Map;for(let t=0,n=e.length;t<n;t+=2){if(this.preventDuplicateKeys&&r.has(e[t]))throw new Error("Duplicate keys in a map");r.set(e[t],e[t+1])}}break}case f.TAG:r=new i(e[0],e[1]).convert(this.tags)}else if(e instanceof a)switch(e[y]){case f.BYTE_STRING:r=e.slice(),this.preferWeb&&(r=new Uint8Array(r.buffer,r.byteOffset,r.length));break;case f.UTF8_STRING:r=e.toString("utf-8")}this.emit("stop",e[y]);const n=e;e=e[h.PARENT],delete n[h.PARENT],delete n[y]}if(!S){if(this.extendedResults){const e=this.valueBytes.slice(),t={value:E.nullcheck(r),bytes:e,length:e.length};return this.valueBytes=new a,t}return r}}}}E.NOT_FOUND=m,e.exports=E},5826:()=>{},6136:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hash_to_ristretto255=t.hashToRistretto255=t.RistrettoPoint=t.encodeToCurve=t.hashToCurve=t.ed25519_hasher=t.edwardsToMontgomery=t.x25519=t.ed25519ph=t.ed25519ctx=t.ed25519=t.ED25519_TORSION_SUBGROUP=void 0,t.edwardsToMontgomeryPub=A,t.edwardsToMontgomeryPriv=function(e){const t=S.hash(e.subarray(0,32));return S.adjustScalarBytes(t).subarray(0,32)};const n=r(4072),i=r(11),s=r(407),o=r(3144),a=r(2844),c=r(7342),f=r(8881),u=r(6376),h=BigInt(0),l=BigInt(1),d=BigInt(2),p=BigInt(3),y=BigInt(5),g=BigInt(8),m={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:g,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function b(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=m.p,o=e*e%s*e%s,a=(0,c.pow2)(o,d,s)*o%s,f=(0,c.pow2)(a,l,s)*e%s,u=(0,c.pow2)(f,y,s)*f%s,h=(0,c.pow2)(u,t,s)*u%s,p=(0,c.pow2)(h,r,s)*h%s,g=(0,c.pow2)(p,n,s)*p%s,b=(0,c.pow2)(g,i,s)*g%s,w=(0,c.pow2)(b,i,s)*g%s,_=(0,c.pow2)(w,t,s)*u%s;return{pow_p_5_8:(0,c.pow2)(_,d,s)*e%s,b2:o}}function w(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const _=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function v(e,t){const r=m.p,n=(0,c.mod)(t*t*t,r),i=b(e*(0,c.mod)(n*n*t,r)).pow_p_5_8;let s=(0,c.mod)(e*n*i,r);const o=(0,c.mod)(t*s*s,r),a=s,f=(0,c.mod)(s*_,r),u=o===e,h=o===(0,c.mod)(-e,r),l=o===(0,c.mod)(-e*_,r);return u&&(s=a),(h||l)&&(s=f),(0,c.isNegativeLE)(s,r)&&(s=(0,c.mod)(-s,r)),{isValid:u||h,value:s}}t.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];const E=(()=>(0,c.Field)(m.p,void 0,!0))(),S=(()=>({...m,Fp:E,hash:n.sha512,adjustScalarBytes:w,uvRatio:v}))();function B(e,t,r){if(t.length>255)throw new Error("Context is too big");return(0,i.concatBytes)((0,i.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}function A(e){const r=(0,u.ensureBytes)("pub",e),{y:n}=t.ed25519.Point.fromHex(r),i=BigInt(1);return E.toBytes(E.create((i+n)*E.inv(i-n)))}t.ed25519=(0,o.twistedEdwards)(S),t.ed25519ctx=(0,o.twistedEdwards)({...S,domain:B}),t.ed25519ph=(0,o.twistedEdwards)(Object.assign({},S,{domain:B,prehash:n.sha512})),t.x25519=(()=>{const e=m.p;return(0,f.montgomery)({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:r,b2:n}=b(t);return(0,c.mod)((0,c.pow2)(r,p,e)*n,e)},adjustScalarBytes:w})})(),t.edwardsToMontgomery=A;const I=(()=>(E.ORDER+p)/g)(),x=(()=>E.pow(d,I))(),T=(()=>E.sqrt(E.neg(E.ONE)))(),O=(()=>(0,c.FpSqrtEven)(E,E.neg(BigInt(486664))))();function k(e){if(!(e instanceof H))throw new Error("RistrettoPoint expected")}t.ed25519_hasher=(0,a.createHasher)(t.ed25519.Point,e=>function(e){const{xMn:t,xMd:r,yMn:n,yMd:i}=function(e){const t=(E.ORDER-y)/g,r=BigInt(486662);let n=E.sqr(e);n=E.mul(n,d);let i=E.add(n,E.ONE),s=E.neg(r),o=E.sqr(i),a=E.mul(o,i),c=E.mul(n,r);c=E.mul(c,s),c=E.add(c,o),c=E.mul(c,s);let f=E.sqr(a);o=E.sqr(f),f=E.mul(f,a),f=E.mul(f,c),o=E.mul(o,f);let u=E.pow(o,t);u=E.mul(u,f);let h=E.mul(u,T);o=E.sqr(u),o=E.mul(o,a);let p=E.eql(o,c),m=E.cmov(h,u,p),b=E.mul(s,n),w=E.mul(u,e);w=E.mul(w,x);let _=E.mul(w,T),v=E.mul(c,n);o=E.sqr(w),o=E.mul(o,a);let S=E.eql(o,v),B=E.cmov(_,w,S);o=E.sqr(m),o=E.mul(o,a);let A=E.eql(o,c),I=E.cmov(b,s,A),O=E.cmov(B,m,A),k=E.isOdd(O);return O=E.cmov(O,E.neg(O),A!==k),{xMn:I,xMd:i,yMn:O,yMd:l}}(e);let s=E.mul(t,i);s=E.mul(s,O);let o=E.mul(r,n),a=E.sub(t,r),f=E.add(t,r),u=E.mul(o,f),h=E.eql(u,E.ZERO);s=E.cmov(s,E.ZERO,h),o=E.cmov(o,E.ONE,h),a=E.cmov(a,E.ONE,h),f=E.cmov(f,E.ONE,h);const[p,m]=(0,c.FpInvertBatch)(E,[o,f],!0);return{x:E.mul(s,p),y:E.mul(a,m)}}(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:E.ORDER,m:1,k:128,expand:"xmd",hash:n.sha512}),t.hashToCurve=t.ed25519_hasher.hashToCurve,t.encodeToCurve=t.ed25519_hasher.encodeToCurve;const U=_,M=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),R=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),P=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),C=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),L=e=>v(l,e),D=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),N=e=>t.ed25519.CURVE.Fp.create((0,u.bytesToNumberLE)(e)&D);function K(e){const{d:r}=t.ed25519.CURVE,n=t.ed25519.CURVE.Fp.ORDER,i=t.ed25519.CURVE.Fp.create,s=i(U*e*e),o=i((s+l)*P);let a=BigInt(-1);const f=i((a-r*s)*i(s+r));let{isValid:u,value:h}=v(o,f),d=i(h*e);(0,c.isNegativeLE)(d,n)||(d=i(-d)),u||(h=d),u||(a=s);const p=i(a*(s-l)*C-f),y=h*h,g=i((h+h)*f),m=i(p*M),b=i(l-y),w=i(l+y);return new t.ed25519.Point(i(g*w),i(b*m),i(m*w),i(g*b))}class H{constructor(e){this.ep=e}static fromAffine(e){return new H(t.ed25519.Point.fromAffine(e))}static hashToCurve(e){e=(0,u.ensureBytes)("ristrettoHash",e,64);const t=K(N(e.slice(0,32))),r=K(N(e.slice(32,64)));return new H(t.add(r))}static fromBytes(e){return(0,i.abytes)(e),this.fromHex(e)}static fromHex(e){e=(0,u.ensureBytes)("ristrettoHex",e,32);const{a:r,d:n}=t.ed25519.CURVE,i=E.ORDER,s=E.create,o="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=N(e);if(!(0,u.equalBytes)((0,u.numberToBytesLE)(a,32),e)||(0,c.isNegativeLE)(a,i))throw new Error(o);const f=s(a*a),d=s(l+r*f),p=s(l-r*f),y=s(d*d),g=s(p*p),m=s(r*n*y-g),{isValid:b,value:w}=L(s(m*g)),_=s(w*p),v=s(w*_*m);let S=s((a+a)*_);(0,c.isNegativeLE)(S,i)&&(S=s(-S));const B=s(d*v),A=s(S*B);if(!b||(0,c.isNegativeLE)(A,i)||B===h)throw new Error(o);return new H(new t.ed25519.Point(S,B,l,A))}static msm(e,r){const n=(0,c.Field)(t.ed25519.CURVE.n,t.ed25519.CURVE.nBitLength);return(0,s.pippenger)(H,n,e,r)}toBytes(){let{ex:e,ey:t,ez:r,et:n}=this.ep;const i=E.ORDER,s=E.create,o=s(s(r+t)*s(r-t)),a=s(e*t),f=s(a*a),{value:h}=L(s(o*f)),l=s(h*o),d=s(h*a),p=s(l*d*n);let y;if((0,c.isNegativeLE)(n*p,i)){let r=s(t*U),n=s(e*U);e=r,t=n,y=s(l*R)}else y=d;(0,c.isNegativeLE)(e*p,i)&&(t=s(-t));let g=s((r-t)*y);return(0,c.isNegativeLE)(g,i)&&(g=s(-g)),(0,u.numberToBytesLE)(g,32)}toRawBytes(){return this.toBytes()}toHex(){return(0,u.bytesToHex)(this.toBytes())}toString(){return this.toHex()}equals(e){k(e);const{ex:t,ey:r}=this.ep,{ex:n,ey:i}=e.ep,s=E.create,o=s(t*i)===s(r*n),a=s(r*i)===s(t*n);return o||a}add(e){return k(e),new H(this.ep.add(e.ep))}subtract(e){return k(e),new H(this.ep.subtract(e.ep))}multiply(e){return new H(this.ep.multiply(e))}multiplyUnsafe(e){return new H(this.ep.multiplyUnsafe(e))}double(){return new H(this.ep.double())}negate(){return new H(this.ep.negate())}}t.RistrettoPoint=(H.BASE||(H.BASE=new H(t.ed25519.Point.BASE)),H.ZERO||(H.ZERO=new H(t.ed25519.Point.ZERO)),H),t.hashToRistretto255=(e,t)=>{const r=t.DST,s="string"==typeof r?(0,i.utf8ToBytes)(r):r,o=(0,a.expand_message_xmd)(e,s,64,n.sha512);return H.hashToCurve(o)},t.hash_to_ristretto255=t.hashToRistretto255},6141:(e,t,r)=>{var n=r(8558),i=r(1661),s=function(){},o=r.g.Bare?queueMicrotask:n.nextTick.bind(n),a=function(e,t,r){if("function"==typeof t)return a(e,null,t);t||(t={}),r=i(r||s);var n=e._writableState,c=e._readableState,f=t.readable||!1!==t.readable&&e.readable,u=t.writable||!1!==t.writable&&e.writable,h=!1,l=function(){e.writable||d()},d=function(){u=!1,f||r.call(e)},p=function(){f=!1,u||r.call(e)},y=function(t){r.call(e,t?new Error("exited with error code: "+t):null)},g=function(t){r.call(e,t)},m=function(){o(b)},b=function(){if(!h)return(!f||c&&c.ended&&!c.destroyed)&&(!u||n&&n.ended&&!n.destroyed)?void 0:r.call(e,new Error("premature close"))},w=function(){e.req.on("finish",d)};return function(e){return e.setHeader&&"function"==typeof e.abort}(e)?(e.on("complete",d),e.on("abort",m),e.req?w():e.on("request",w)):u&&!n&&(e.on("end",l),e.on("close",l)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",y),e.on("end",p),e.on("finish",d),!1!==t.error&&e.on("error",g),e.on("close",m),function(){h=!0,e.removeListener("complete",d),e.removeListener("abort",m),e.removeListener("request",w),e.req&&e.req.removeListener("finish",d),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",d),e.removeListener("exit",y),e.removeListener("end",p),e.removeListener("error",g),e.removeListener("close",m)}};e.exports=a},6192:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},6215:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY=t.utf8ToBytes=t.concatBytes=t.randomBytes=t.ensureBytes=void 0,t.equalBytes=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},t.splitCoder=function(...e){const r=e=>"number"==typeof e?e:e.bytesLen,n=e.reduce((e,t)=>e+r(t),0);return{bytesLen:n,encode:i=>{const s=new Uint8Array(n);for(let n=0,o=0;n<e.length;n++){const a=e[n],c=r(a),f="number"==typeof a?i[n]:a.encode(i[n]);(0,t.ensureBytes)(f,c),s.set(f,o),"number"!=typeof a&&f.fill(0),o+=c}return s},decode:i=>{(0,t.ensureBytes)(i,n);const s=[];for(const t of e){const e=r(t),n=i.subarray(0,e);s.push("number"==typeof t?n:t.decode(n)),i=i.subarray(e)}return s}}},t.vecCoder=function(e,r){const n=r*e.bytesLen;return{bytesLen:n,encode:t=>{if(t.length!==r)throw new Error(`vecCoder.encode: wrong length=${t.length}. Expected: ${r}`);const i=new Uint8Array(n);for(let r=0,n=0;r<t.length;r++){const s=e.encode(t[r]);i.set(s,n),s.fill(0),n+=s.length}return i},decode:r=>{(0,t.ensureBytes)(r,n);const i=[];for(let t=0;t<r.length;t+=e.bytesLen)i.push(e.decode(r.subarray(t,t+e.bytesLen)));return i}}},t.cleanBytes=function(...e){for(const t of e)if(Array.isArray(t))for(const e of t)e.fill(0);else t.fill(0)},t.getMask=function(e){return(1<<e)-1},t.getMessage=function(e,r=t.EMPTY){if((0,t.ensureBytes)(e),(0,t.ensureBytes)(r),r.length>255)throw new Error("context should be less than 255 bytes");return(0,s.concatBytes)(new Uint8Array([0,r.length]),r,e)},t.getMessagePrehash=function(e,r,n=t.EMPTY){if((0,t.ensureBytes)(r),(0,t.ensureBytes)(n),n.length>255)throw new Error("context should be less than 255 bytes");if(!o[e])throw new Error("unknown hash: "+e);const{oid:i,hash:a}=o[e],c=a(r);return(0,s.concatBytes)(new Uint8Array([1,n.length]),n,i,c)};const n=r(4072),i=r(5391),s=r(11);Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return s.concatBytes}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return s.utf8ToBytes}}),t.ensureBytes=s.abytes,t.randomBytes=s.randomBytes,t.EMPTY=new Uint8Array(0);const o={"SHA2-256":{oid:(0,s.hexToBytes)("0609608648016503040201"),hash:n.sha256},"SHA2-384":{oid:(0,s.hexToBytes)("0609608648016503040202"),hash:n.sha384},"SHA2-512":{oid:(0,s.hexToBytes)("0609608648016503040203"),hash:n.sha512},"SHA2-224":{oid:(0,s.hexToBytes)("0609608648016503040204"),hash:n.sha224},"SHA2-512/224":{oid:(0,s.hexToBytes)("0609608648016503040205"),hash:n.sha512_224},"SHA2-512/256":{oid:(0,s.hexToBytes)("0609608648016503040206"),hash:n.sha512_256},"SHA3-224":{oid:(0,s.hexToBytes)("0609608648016503040207"),hash:i.sha3_224},"SHA3-256":{oid:(0,s.hexToBytes)("0609608648016503040208"),hash:i.sha3_256},"SHA3-384":{oid:(0,s.hexToBytes)("0609608648016503040209"),hash:i.sha3_384},"SHA3-512":{oid:(0,s.hexToBytes)("060960864801650304020A"),hash:i.sha3_512},"SHAKE-128":{oid:(0,s.hexToBytes)("060960864801650304020B"),hash:e=>(0,i.shake128)(e,{dkLen:32})},"SHAKE-256":{oid:(0,s.hexToBytes)("060960864801650304020C"),hash:e=>(0,i.shake256)(e,{dkLen:64})}}},6376:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notImplemented=t.bitMask=t.utf8ToBytes=t.randomBytes=t.isBytes=t.hexToBytes=t.concatBytes=t.bytesToUtf8=t.bytesToHex=t.anumber=t.abytes=void 0,t.abool=function(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)},t.numberToHexUnpadded=a,t.hexToNumber=c,t.bytesToNumberBE=function(e){return c((0,n.bytesToHex)(e))},t.bytesToNumberLE=function(e){return(0,n.abytes)(e),c((0,n.bytesToHex)(Uint8Array.from(e).reverse()))},t.numberToBytesBE=f,t.numberToBytesLE=function(e,t){return f(e,t).reverse()},t.numberToVarBytesBE=function(e){return(0,n.hexToBytes)(a(e))},t.ensureBytes=function(e,t,r){let i;if("string"==typeof t)try{i=(0,n.hexToBytes)(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!(0,n.isBytes)(t))throw new Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const s=i.length;if("number"==typeof r&&s!==r)throw new Error(e+" of length "+r+" expected, got "+s);return i},t.equalBytes=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},t.inRange=h,t.aInRange=function(e,t,r,n){if(!h(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)},t.bitLen=function(e){let t;for(t=0;e>s;e>>=o,t+=1);return t},t.bitGet=function(e,t){return e>>BigInt(t)&o},t.bitSet=function(e,t,r){return e|(r?o:s)<<BigInt(t)},t.createHmacDrbg=function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");const i=e=>new Uint8Array(e),s=e=>Uint8Array.of(e);let o=i(e),a=i(e),c=0;const f=()=>{o.fill(1),a.fill(0),c=0},u=(...e)=>r(a,o,...e),h=(e=i(0))=>{a=u(s(0),e),o=u(),0!==e.length&&(a=u(s(1),e),o=u())},l=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){o=u();const t=o.slice();r.push(t),e+=o.length}return(0,n.concatBytes)(...r)};return(e,t)=>{let r;for(f(),h(e);!(r=t(l()));)h();return f(),r}},t.validateObject=function(e,t,r={}){const n=(t,r,n)=>{const i=l[r];if("function"!=typeof i)throw new Error("invalid validator function");const s=e[t];if(!(n&&void 0===s||i(s,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+s)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e},t.isHash=function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)},t._validateObject=function(e,t,r={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function n(t,r,n){const i=e[t];if(n&&void 0===i)return;const s=typeof i;if(s!==r||null===i)throw new Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>n(e,t,!1)),Object.entries(r).forEach(([e,t])=>n(e,t,!0))},t.memoized=function(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}};const n=r(11);var i=r(11);Object.defineProperty(t,"abytes",{enumerable:!0,get:function(){return i.abytes}}),Object.defineProperty(t,"anumber",{enumerable:!0,get:function(){return i.anumber}}),Object.defineProperty(t,"bytesToHex",{enumerable:!0,get:function(){return i.bytesToHex}}),Object.defineProperty(t,"bytesToUtf8",{enumerable:!0,get:function(){return i.bytesToUtf8}}),Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return i.concatBytes}}),Object.defineProperty(t,"hexToBytes",{enumerable:!0,get:function(){return i.hexToBytes}}),Object.defineProperty(t,"isBytes",{enumerable:!0,get:function(){return i.isBytes}}),Object.defineProperty(t,"randomBytes",{enumerable:!0,get:function(){return i.randomBytes}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return i.utf8ToBytes}});const s=BigInt(0),o=BigInt(1);function a(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function c(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?s:BigInt("0x"+e)}function f(e,t){return(0,n.hexToBytes)(e.toString(16).padStart(2*t,"0"))}const u=e=>"bigint"==typeof e&&s<=e;function h(e,t,r){return u(e)&&u(t)&&u(r)&&t<=e&&e<r}t.bitMask=e=>(o<<BigInt(e))-o;const l={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||(0,n.isBytes)(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};t.notImplemented=()=>{throw new Error("not implemented")}},6404:function(e,t,r){"use strict";var n,i=r(4686).Buffer,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&s(t,e,r[i]);return o(t,e),t}),c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})},f=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DesigncryptStream=t.SigncryptStream=void 0,t.debugSetKey=function(e){w=e},t.debugSetKeypair=function(e){_=e},t.signcrypt=function(e,t,r){return c(this,void 0,void 0,function*(){var n,s;const o=(0,p.chunkBuffer)(e,b),a=null!=w?w:(0,g.randomBytes)(32),c=null!=_?_:g.box.keyPair(),f=r.map((e,t)=>e instanceof l.SymmetricKeyRecipient?l.default.createSymmetric(e.key,e.recipient_identifier,c.publicKey,a,t):l.default.create(e,c.secretKey,a,t)),u=h.default.create(c.publicKey,a,null!==(n=null==t?void 0:t.publicKey)&&void 0!==n?n:null,f),y=[];for(const e in o){const r=o[e],n=o.length===parseInt(e)+1,i=d.default.create(u,a,null!==(s=null==t?void 0:t.secretKey)&&void 0!==s?s:null,r,BigInt(e),n);y.push(i)}return i.concat([u.encoded,i.concat(y.map(e=>e.encoded))])})},t.designcrypt=function(e,t,r){return c(this,void 0,void 0,function*(){var n,s,o,a;const c=new y.Readable;c.push(e),c.push(null);const u=[];try{for(var p,g=!0,b=f((0,m.decodeMultiStream)(c));!(n=(p=yield b.next()).done);g=!0){a=p.value,g=!1;const e=a;u.push(e)}}catch(e){s={error:e}}finally{try{g||n||!(o=b.return)||(yield o.call(b))}finally{if(s)throw s.error}}const w=u.shift(),_=h.default.decode(w,!0),v=t instanceof l.SymmetricKeyRecipient?_.decryptPayloadKeyWithSymmetricKey(t.key,t.recipient_identifier):_.decryptPayloadKeyWithCurve25519Keypair(t.secretKey);if(!v)throw new Error("keypair is not an intended recipient");const[E]=v,S=_.decryptSender(E);if(r&&(!S||!i.from(S).equals(i.from(r))))throw new Error("Sender public key doesn't match");let B=i.alloc(0);for(const e in u){const t=u[e],r=d.default.decode(t,!0),n=u.length===parseInt(e)+1;if(r.final&&!n)throw new Error("Found payload with invalid final flag, message extended?");if(!r.final&&n)throw new Error("Found payload with invalid final flag, message truncated?");B=i.concat([B,r.decrypt(_,S,E,BigInt(e))])}if(!u.length)throw new Error("No signcrypted payloads, message truncated?");return Object.assign(B,{sender_public_key:S})})};const h=u(r(8051)),l=a(r(3051)),d=u(r(5466)),p=r(568),y=r(896),g=r(4406),m=r(2655),b=1048576;let w=null,_=null;class v extends y.Transform{constructor(e,t){var r,n;super(),this.in_buffer=i.alloc(0),this.payload_index=BigInt(0),this.i=0,this.payload_key=null!=w?w:i.from((0,g.randomBytes)(32)),this.ephemeral_keypair=null!=_?_:g.box.keyPair(),this.keypair=e;const s=t.map((e,t)=>e instanceof l.SymmetricKeyRecipient?l.default.createSymmetric(e.key,e.recipient_identifier,this.ephemeral_keypair.publicKey,this.payload_key,t):l.default.create(e,this.ephemeral_keypair.secretKey,this.payload_key,t));this.header=h.default.create(this.ephemeral_keypair.publicKey,this.payload_key,null!==(n=null===(r=this.keypair)||void 0===r?void 0:r.publicKey)&&void 0!==n?n:null,s),this.push(this.header.encoded)}_transform(e,t,r){var n,s;for(this.in_buffer=i.concat([this.in_buffer,e]);this.in_buffer.length>b;){const e=this.in_buffer.slice(0,b);this.in_buffer=this.in_buffer.slice(b);const t=d.default.create(this.header,this.payload_key,null!==(s=null===(n=this.keypair)||void 0===n?void 0:n.secretKey)&&void 0!==s?s:null,e,this.payload_index,!1);this.push(t.encoded),this.payload_index++}r()}_flush(e){for(var t,r,n,s;this.in_buffer.length>=b;){const e=this.in_buffer.slice(0,b);this.in_buffer=this.in_buffer.slice(b);const n=!this.in_buffer.length,i=d.default.create(this.header,this.payload_key,null!==(r=null===(t=this.keypair)||void 0===t?void 0:t.secretKey)&&void 0!==r?r:null,e,this.payload_index,n);this.push(i.encoded),this.payload_index++}if(this.in_buffer.length){const e=this.in_buffer;this.in_buffer=i.alloc(0);const t=!this.in_buffer.length,r=d.default.create(this.header,this.payload_key,null!==(s=null===(n=this.keypair)||void 0===n?void 0:n.secretKey)&&void 0!==s?s:null,e,this.payload_index,t);this.push(r.encoded),this.payload_index++}e()}}t.SigncryptStream=v;class E extends y.Transform{constructor(e,t){super(),this.recipient_keys=e,this.decoder=new m.Decoder,this.header_data=null,this.last_payload=null,this.payload_index=BigInt(-1),this.i=0,this.sender=null!=t?t:null}get header(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[0]}get payload_key(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[1]}get recipient(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[2]}get sender_public_key(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[3]}_transform(e,t,r){this.decoder.appendBuffer(e);try{let e;for(;e=this.decoder.doDecodeSync();){const t=i.from(this.decoder.bytes).slice(this.decoder.pos);this.decoder.setBuffer(t),this._handleMessage(e)}}catch(e){}r()}_handleMessage(e){if(this.header_data){if(this.payload_index++,this.last_payload){if(this.last_payload.final)throw new Error("Found payload with invalid final flag, message extended?");this.push(this.last_payload.decrypt(this.header,this.sender_public_key,this.payload_key,this.payload_index-BigInt(1)))}const t=d.default.decode(e,!0);this.last_payload=t}else{const t=h.default.decode(e,!0),r=this.recipient_keys instanceof l.SymmetricKeyRecipient?t.decryptPayloadKeyWithSymmetricKey(this.recipient_keys.key,this.recipient_keys.recipient_identifier):t.decryptPayloadKeyWithCurve25519Keypair(this.recipient_keys.secretKey);if(!r)throw new Error("keypair is not an intended recipient");const[n,s]=r,o=t.decryptSender(n);if(this.sender&&(!o||!i.from(o).equals(i.from(this.sender))))throw new Error("Sender public key doesn't match");this.header_data=[t,n,s,o]}}_flush(e){try{if(this.last_payload){if(!this.last_payload.final)throw new Error("Found payload with invalid final flag, message truncated?");this.push(this.last_payload.decrypt(this.header,this.sender_public_key,this.payload_key,this.payload_index))}if(!this.last_payload)throw new Error("No signcrypted payloads, message truncated?")}catch(t){return e(t)}e()}}t.DesigncryptStream=E},6671:(e,t,r)=>{var n=r(4686),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},6760:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(2655),s=r(4406),o=r(4072);class a{constructor(e,t,r){this.final=e,this.signature=t,this.data=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data}static create(e,t,r,n,i=!1){"number"==typeof n&&(n=BigInt(n));const o=this.generateSignData(e.hash,n,i,r);return new this(i,s.sign.detached(Uint8Array.from(o),Uint8Array.from(t)),r)}static generateSignData(e,t,r,i){const s=n.alloc(8);return s.writeBigUInt64BE(t),n.concat([this.PAYLOAD_SIGNATURE_PREFIX,o.sha512.create().update(e).update(s).update(r?"":"\0").update(i).digest()])}encode(){return a.encodePayload(this.final,this.signature,this.data)}static encodePayload(e,t,r){return n.from((0,i.encode)([e,t,r]))}static decode(e,t=!1){const r=t?e:(0,i.decode)(e);if(r.length<3)throw new Error("Invalid data");const[n,s,o]=r;return new this(n,s,o)}verify(e,t,r){const n=a.generateSignData(e.hash,r,this.final,this.data);if(!s.sign.detached.verify(Uint8Array.from(n),Uint8Array.from(this.signature),Uint8Array.from(t)))throw new Error("Invalid signature")}}a.PAYLOAD_SIGNATURE_PREFIX=n.from("saltpack attached signature\0"),t.default=a},6761:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PQ_COSE_KEY_PARAMS=t.PQ_COSE_KEY_TYPE=t.PQ_COSE_ALG=void 0,t.generateDilithiumKeyPair=function(e){e||(e=(0,s.randomBytes)(32));const t=n.ml_dsa65.keygen(e);return{publicKey:i.Buffer.from(t.publicKey),secretKey:i.Buffer.from(t.secretKey)}},t.signDilithium=function(e,t){return i.Buffer.from(n.ml_dsa65.sign(t,e))},t.verifyDilithium=function(e,t,r){return n.ml_dsa65.verify(r,e,t)},t.createDilithiumCoseKey=function(e){const r=new Map;return r.set(1,t.PQ_COSE_KEY_TYPE.DILITHIUM),r.set(3,t.PQ_COSE_ALG.DILITHIUM2),r.set(t.PQ_COSE_KEY_PARAMS.DILITHIUM_MODE,2),r.set(t.PQ_COSE_KEY_PARAMS.DILITHIUM_PK,e),r},t.getDilithiumKeyInfo=function(){return{publicKeySize:1952,secretKeySize:4032,signatureSize:3309}};const n=r(2404),i=r(4686),s=r(5598);t.PQ_COSE_ALG={DILITHIUM2:-46,DILITHIUM3:-47,DILITHIUM5:-48},t.PQ_COSE_KEY_TYPE={DILITHIUM:4},t.PQ_COSE_KEY_PARAMS={DILITHIUM_MODE:-100,DILITHIUM_PK:-101,DILITHIUM_SK:-102}},6868:(e,t,r)=>{"use strict";var n,i=r(8558);function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t){var r=e.entry;for(e.entry=null;r;){var n=r.callback;t.pendingcb--,n(undefined),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=A,A.WritableState=B;var o,a={deprecate:r(1348)},c=r(9481),f=r(4686).Buffer,u=(void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},h=r(4552),l=r(7963).getHighWaterMark,d=r(8704).F,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,g=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,b=d.ERR_STREAM_DESTROYED,w=d.ERR_STREAM_NULL_VALUES,_=d.ERR_STREAM_WRITE_AFTER_END,v=d.ERR_UNKNOWN_ENCODING,E=h.errorOrDestroy;function S(){}function B(e,t,o){n=n||r(5606),e=e||{},"boolean"!=typeof o&&(o=t instanceof n),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=l(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,s=r.writecb;if("function"!=typeof s)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,s){--t.pendingcb,r?(i.nextTick(s,n),i.nextTick(U,e,t),e._writableState.errorEmitted=!0,E(e,n)):(s(n),e._writableState.errorEmitted=!0,E(e,n),U(e,t))}(e,r,n,t,s);else{var o=O(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||T(e,r),n?i.nextTick(x,e,r,o,s):x(e,r,o,s)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function A(e){var t=this instanceof(n=n||r(5606));if(!t&&!o.call(A,this))return new A(e);this._writableState=new B(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),c.call(this)}function I(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function x(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),U(e,t)}function T(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0,c=!0;r;)i[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;i.allBuffers=c,I(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;r;){var f=r.chunk,u=r.encoding,h=r.callback;if(I(e,t,!1,t.objectMode?1:f.length,f,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function k(e,t){e._final(function(r){t.pendingcb--,r&&E(e,r),t.prefinished=!0,e.emit("prefinish"),U(e,t)})}function U(e,t){var r=O(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(k,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}r(6192)(A,c),B.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(B.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return!!o.call(this,e)||this===A&&e&&e._writableState instanceof B}})):o=function(e){return e instanceof this},A.prototype.pipe=function(){E(this,new m)},A.prototype.write=function(e,t,r){var n,s=this._writableState,o=!1,a=!s.objectMode&&(n=e,f.isBuffer(n)||n instanceof u);return a&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=S),s.ending?function(e,t){var r=new _;E(e,r),i.nextTick(t,r)}(this,r):(a||function(e,t,r,n){var s;return null===r?s=new w:"string"==typeof r||t.objectMode||(s=new p("chunk",["string","Buffer"],r)),!s||(E(e,s),i.nextTick(n,s),!1)}(this,s,e,r))&&(s.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,r)),t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=t.objectMode?1:n.length;t.length+=a;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else I(e,t,!1,a,n,i,s);return c}(this,s,a,e,t,r)),o},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||T(this,e))},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new v(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(e,t,r){r(new y("_write()"))},A.prototype._writev=null,A.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,U(e,t),r&&(t.finished?i.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),A.prototype.destroy=h.destroy,A.prototype._undestroy=h.undestroy,A.prototype._destroy=function(e,t){t(e)}},6869:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},6899:(e,t,r)=>{"use strict";const n=r(896),{Buffer:i}=r(4686),s=new TextDecoder("utf8",{fatal:!0,ignoreBOM:!0});class o extends n.Transform{constructor(e,t,r={}){let n=null,s=null;switch(typeof e){case"object":i.isBuffer(e)?n=e:e&&(r=e);break;case"string":n=e;break;case"undefined":break;default:throw new TypeError("Invalid input")}switch(typeof t){case"object":t&&(r=t);break;case"string":s=t;break;case"undefined":break;default:throw new TypeError("Invalid inputEncoding")}if(!r||"object"!=typeof r)throw new TypeError("Invalid options");null==n&&(n=r.input),null==s&&(s=r.inputEncoding),delete r.input,delete r.inputEncoding;const o=null==r.watchPipe||r.watchPipe;delete r.watchPipe;const a=Boolean(r.readError);delete r.readError,super(r),this.readError=a,o&&this.on("pipe",e=>{const t=e._readableState.objectMode;if(this.length>0&&t!==this._readableState.objectMode)throw new Error("Do not switch objectMode in the middle of the stream");this._readableState.objectMode=t,this._writableState.objectMode=t}),null!=n&&this.end(n,s)}static isNoFilter(e){return e instanceof this}static compare(e,t){if(!(e instanceof this))throw new TypeError("Arguments must be NoFilters");return e===t?0:e.compare(t)}static concat(e,t){if(!Array.isArray(e))throw new TypeError("list argument must be an Array of NoFilters");if(0===e.length||0===t)return i.alloc(0);null==t&&(t=e.reduce((e,t)=>{if(!(t instanceof o))throw new TypeError("list argument must be an Array of NoFilters");return e+t.length},0));let r=!0,n=!0;const s=e.map(e=>{if(!(e instanceof o))throw new TypeError("list argument must be an Array of NoFilters");const t=e.slice();return i.isBuffer(t)?n=!1:r=!1,t});if(r)return i.concat(s,t);if(n)return[].concat(...s).slice(0,t);throw new Error("Concatenating mixed object and byte streams not supported")}_transform(e,t,r){this._readableState.objectMode||i.isBuffer(e)||(e=i.from(e,t)),this.push(e),r()}_bufArray(){let e=this._readableState.buffer;if(!Array.isArray(e)){let t=e.head;for(e=[];null!=t;)e.push(t.data),t=t.next}return e}read(e){const t=super.read(e);if(null!=t){if(this.emit("read",t),this.readError&&t.length<e)throw new Error(`Read ${t.length}, wanted ${e}`)}else if(this.readError)throw new Error(`No data available, wanted ${e}`);return t}readFull(e){let t=null,r=null,n=null;return new Promise((i,s)=>{this.length>=e?i(this.read(e)):this.writableFinished?s(new Error(`Stream finished before ${e} bytes were available`)):(t=t=>{this.length>=e&&i(this.read(e))},r=()=>{s(new Error(`Stream finished before ${e} bytes were available`))},n=s,this.on("readable",t),this.on("error",n),this.on("finish",r))}).finally(()=>{t&&(this.removeListener("readable",t),this.removeListener("error",n),this.removeListener("finish",r))})}promise(e){let t=!1;return new Promise((r,n)=>{this.on("finish",()=>{const n=this.read();null==e||t||(t=!0,e(null,n)),r(n)}),this.on("error",r=>{null==e||t||(t=!0,e(r)),n(r)})})}compare(e){if(!(e instanceof o))throw new TypeError("Arguments must be NoFilters");if(this===e)return 0;const t=this.slice(),r=e.slice();if(i.isBuffer(t)&&i.isBuffer(r))return t.compare(r);throw new Error("Cannot compare streams in object mode")}equals(e){return 0===this.compare(e)}slice(e,t){if(this._readableState.objectMode)return this._bufArray().slice(e,t);const r=this._bufArray();switch(r.length){case 0:return i.alloc(0);case 1:return r[0].slice(e,t);default:return i.concat(r).slice(e,t)}}get(e){return this.slice()[e]}toJSON(){const e=this.slice();return i.isBuffer(e)?e.toJSON():e}toString(e,t,r){const n=this.slice(t,r);return i.isBuffer(n)?e&&"utf8"!==e?n.toString(e):s.decode(n):JSON.stringify(n)}[Symbol.for("nodejs.util.inspect.custom")](e,t){const r=this._bufArray().map(e=>i.isBuffer(e)?t.stylize(e.toString("hex"),"string"):JSON.stringify(e)).join(", ");return`${this.constructor.name} [${r}]`}get length(){return this._readableState.length}writeBigInt(e){let t=e.toString(16);if(e<0){const r=BigInt(Math.floor(t.length/2));t=(e=(BigInt(1)<<r*BigInt(8))+e).toString(16)}return t.length%2&&(t=`0${t}`),this.push(i.from(t,"hex"))}readUBigInt(e){const t=this.read(e);return i.isBuffer(t)?BigInt(`0x${t.toString("hex")}`):null}readBigInt(e){const t=this.read(e);if(!i.isBuffer(t))return null;let r=BigInt(`0x${t.toString("hex")}`);return 128&t[0]&&(r-=BigInt(1)<<BigInt(t.length)*BigInt(8)),r}writeUInt8(e){const t=i.from([e]);return this.push(t)}writeUInt16LE(e){const t=i.alloc(2);return t.writeUInt16LE(e),this.push(t)}writeUInt16BE(e){const t=i.alloc(2);return t.writeUInt16BE(e),this.push(t)}writeUInt32LE(e){const t=i.alloc(4);return t.writeUInt32LE(e),this.push(t)}writeUInt32BE(e){const t=i.alloc(4);return t.writeUInt32BE(e),this.push(t)}writeInt8(e){const t=i.from([e]);return this.push(t)}writeInt16LE(e){const t=i.alloc(2);return t.writeUInt16LE(e),this.push(t)}writeInt16BE(e){const t=i.alloc(2);return t.writeUInt16BE(e),this.push(t)}writeInt32LE(e){const t=i.alloc(4);return t.writeUInt32LE(e),this.push(t)}writeInt32BE(e){const t=i.alloc(4);return t.writeUInt32BE(e),this.push(t)}writeFloatLE(e){const t=i.alloc(4);return t.writeFloatLE(e),this.push(t)}writeFloatBE(e){const t=i.alloc(4);return t.writeFloatBE(e),this.push(t)}writeDoubleLE(e){const t=i.alloc(8);return t.writeDoubleLE(e),this.push(t)}writeDoubleBE(e){const t=i.alloc(8);return t.writeDoubleBE(e),this.push(t)}writeBigInt64LE(e){const t=i.alloc(8);return t.writeBigInt64LE(e),this.push(t)}writeBigInt64BE(e){const t=i.alloc(8);return t.writeBigInt64BE(e),this.push(t)}writeBigUInt64LE(e){const t=i.alloc(8);return t.writeBigUInt64LE(e),this.push(t)}writeBigUInt64BE(e){const t=i.alloc(8);return t.writeBigUInt64BE(e),this.push(t)}readUInt8(){const e=this.read(1);return i.isBuffer(e)?e.readUInt8():null}readUInt16LE(){const e=this.read(2);return i.isBuffer(e)?e.readUInt16LE():null}readUInt16BE(){const e=this.read(2);return i.isBuffer(e)?e.readUInt16BE():null}readUInt32LE(){const e=this.read(4);return i.isBuffer(e)?e.readUInt32LE():null}readUInt32BE(){const e=this.read(4);return i.isBuffer(e)?e.readUInt32BE():null}readInt8(){const e=this.read(1);return i.isBuffer(e)?e.readInt8():null}readInt16LE(){const e=this.read(2);return i.isBuffer(e)?e.readInt16LE():null}readInt16BE(){const e=this.read(2);return i.isBuffer(e)?e.readInt16BE():null}readInt32LE(){const e=this.read(4);return i.isBuffer(e)?e.readInt32LE():null}readInt32BE(){const e=this.read(4);return i.isBuffer(e)?e.readInt32BE():null}readFloatLE(){const e=this.read(4);return i.isBuffer(e)?e.readFloatLE():null}readFloatBE(){const e=this.read(4);return i.isBuffer(e)?e.readFloatBE():null}readDoubleLE(){const e=this.read(8);return i.isBuffer(e)?e.readDoubleLE():null}readDoubleBE(){const e=this.read(8);return i.isBuffer(e)?e.readDoubleBE():null}readBigInt64LE(){const e=this.read(8);return i.isBuffer(e)?e.readBigInt64LE():null}readBigInt64BE(){const e=this.read(8);return i.isBuffer(e)?e.readBigInt64BE():null}readBigUInt64LE(){const e=this.read(8);return i.isBuffer(e)?e.readBigUInt64LE():null}readBigUInt64BE(){const e=this.read(8);return i.isBuffer(e)?e.readBigUInt64BE():null}}e.exports=o},7165:function(e,t,r){"use strict";var n,i=this&&this.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},s=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeWebAuthn=t.BrowserWebAuthn=void 0,t.getWebAuthnProvider=function(e){return"undefined"!=typeof window?new c:new f(e?.origin)},t.createCredentialRequest=function(e,t=!1){return a.default.createRequest(e,t)};const a=o(r(7961));class c{constructor(e="test"){this.origin=e}isAvailable(){return"undefined"!=typeof window&&void 0!==window.PublicKeyCredential}async create(e){if(!this.isAvailable())throw new Error("WebAuthn is not available in this environment");return await navigator.credentials.create({publicKey:e})}async get(e){if(!this.isAvailable())throw new Error("WebAuthn is not available in this environment");return await navigator.credentials.get({publicKey:e})}}t.BrowserWebAuthn=c;class f{constructor(e="test"){n.set(this,void 0),i(this,n,e,"f")}isAvailable(){return!0}async create(e){return await a.default.create({publicKey:e},s(this,n,"f"))}async get(e){return await a.default.get({publicKey:e},s(this,n,"f"))}}t.NodeWebAuthn=f,n=new WeakMap},7264:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DHIES=void 0,t.getCypherPublicKeyFromId=h;const i=r(9750),s=r(5598),o=r(4686),a=n(r(4406)),c=n(r(3616)),f=r(2655);class u{constructor(e){this.keyManager=e}async encrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot encrypt with DHIES using a public KeyManager"),null;const r=await this.keyManager.getCypher(),n="string"==typeof e?o.Buffer.from(e,"utf8"):e;try{const e=(0,s.randomBytes)(32),i=await r.diffieHellman(t),c=o.Buffer.from(a.default.scalarMult(e,i)),f=this.kdf(c,this.keyManager.cypher.publicKey,t),u=f.encryptionKey,h=f.macKey,l=(0,s.randomBytes)(24),d=o.Buffer.from(a.default.secretbox(n,l,u)),p=o.Buffer.concat([this.keyManager.cypher.publicKey,l,d]),y=this.computeMAC(h,p),g=o.Buffer.concat([l,e,d,y]);return(0,s.secureErase)(c),(0,s.secureErase)(i),(0,s.secureErase)(u),(0,s.secureErase)(h),g}catch(e){return console.error("DHIES encryption failed:",e),null}}async decrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot decrypt with DHIES using a public KeyManager"),null;try{const r=e.slice(0,24),n=e.slice(24,56),i=e.slice(e.length-32),c=e.slice(56,e.length-32),f=await this.keyManager.getCypher(),u=await f.diffieHellman(t),h=o.Buffer.from(a.default.scalarMult(n,u)),l=this.kdf(h,t,this.keyManager.cypher.publicKey),d=l.encryptionKey,p=l.macKey,y=o.Buffer.concat([t,r,c]),g=this.computeMAC(p,y);if(!this.constantTimeEqual(i,g))return console.error("DHIES: MAC verification failed"),null;const m=a.default.secretbox.open(c,r,d);if(!m)return console.error("DHIES: Decryption failed"),null;const b=o.Buffer.from(m);return(0,s.secureErase)(h),(0,s.secureErase)(d),(0,s.secureErase)(p),b}catch(e){return console.error("DHIES decryption failed:",e),null}}kdf(e,t,r){const n=o.Buffer.concat([o.Buffer.from("DHIES-KDF"),t,r]),i=(0,s.hash)("sha512",o.Buffer.concat([e,n,o.Buffer.from([1])])),a=(0,s.hash)("sha512",o.Buffer.concat([e,n,o.Buffer.from([2])]));return{encryptionKey:i.slice(0,32),macKey:a.slice(0,32)}}computeMAC(e,t){return(0,s.hash)("sha256",o.Buffer.concat([e,t]))}constantTimeEqual(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}}function h(e){return(0,f.decode)(e).e}t.DHIES=u;class l extends c.default{constructor(){super(),this.version=1,this.capability="private",this.authType="",this.encType="X25519KeyAgreementKey2019"}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?(0,s.hmac)("sha256",o.Buffer.from(e.secretKey),"VaultysID/"+t+"/end"):void 0,signcrypt:async(t,r)=>(0,i.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,i.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>o.Buffer.from(a.default.scalarMult(e.secretKey,t))}}cleanSecureData(){this.cypher?.secretKey&&((0,s.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.entropy&&((0,s.secureErase)(this.entropy),delete this.entropy)}async performDiffieHellman(e){if("public"===this.capability)return console.error("Cannot perform DH key exchange with a public key capability"),null;const t=await this.getCypher(),r=e.cypher.publicKey,n=await t.diffieHellman(r),i=(o=n,(0,s.hash)("sha256",o));var o;return(0,s.secureErase)(n),i}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){return new u(this).encrypt(e,h(t))}async dhiesDecrypt(e,t){return new u(this).decrypt(e,h(t))}static async encrypt(e,t){const r=t.map(h);return await(0,i.encryptAndArmor)(e,null,r)}async signcrypt(e,t){const r=t.map(h),n=await this.getCypher();return await n.signcrypt(e,r)}async decrypt(e,t=null){const r=await this.getCypher(),n=t?h(t):null;return(await r.decrypt(e,n)).toString()}getSecretHash(e){const t=o.Buffer.concat([e,o.Buffer.from("secrethash"),this.cypher.secretKey]);return(0,s.hash)("sha256",t)}}t.default=l},7268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp384r1=t.p384=void 0;const n=r(2355);t.p384=n.p384,t.secp384r1=n.p384,t.hashToCurve=n.p384_hasher.hashToCurve,t.encodeToCurve=n.p384_hasher.encodeToCurve},7342:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNegativeLE=void 0,t.mod=h,t.pow=function(e,t,r){return b(E(r),e,t)},t.pow2=function(e,t,r){let n=e;for(;t-- >i;)n*=n,n%=r;return n},t.invert=l,t.tonelliShanks=y,t.FpSqrt=g,t.validateField=function(e){const t=m.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"});return(0,n._validateObject)(e,t),e},t.FpPow=b,t.FpInvertBatch=w,t.FpDiv=function(e,t,r){return e.mul(t,"bigint"==typeof r?l(r,e.ORDER):e.inv(r))},t.FpLegendre=_,t.FpIsSquare=function(e,t){return 1===_(e,t)},t.nLength=v,t.Field=E,t.FpSqrtOdd=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)},t.FpSqrtEven=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r},t.hashToPrivateScalar=function(e,t,r=!1){const i=(e=(0,n.ensureBytes)("privateHash",e)).length,o=v(t).nByteLength+8;if(o<24||i<o||i>1024)throw new Error("hashToPrivateScalar: expected "+o+"-1024 bytes of input, got "+i);return h(r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e),t-s)+s},t.getFieldBytesLength=S,t.getMinHashLength=B,t.mapHashToField=function(e,t,r=!1){const i=e.length,o=S(t),a=B(t);if(i<16||i<a||i>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+i);const c=h(r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e),t-s)+s;return r?(0,n.numberToBytesLE)(c,o):(0,n.numberToBytesBE)(c,o)};const n=r(6376),i=BigInt(0),s=BigInt(1),o=BigInt(2),a=BigInt(3),c=BigInt(4),f=BigInt(5),u=BigInt(8);function h(e,t){const r=e%t;return r>=i?r:t+r}function l(e,t){if(e===i)throw new Error("invert: expected non-zero number");if(t<=i)throw new Error("invert: expected positive modulus, got "+t);let r=h(e,t),n=t,o=i,a=s,c=s,f=i;for(;r!==i;){const e=n/r,t=n%r,i=o-c*e,s=a-f*e;n=r,r=t,o=c,a=f,c=i,f=s}if(n!==s)throw new Error("invert: does not exist");return h(o,t)}function d(e,t){const r=(e.ORDER+s)/c,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function p(e,t){const r=(e.ORDER-f)/u,n=e.mul(t,o),i=e.pow(n,r),s=e.mul(t,i),a=e.mul(e.mul(s,o),i),c=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(c),t))throw new Error("Cannot find square root");return c}function y(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-s,r=0;for(;t%o===i;)t/=o,r++;let n=o;const a=E(e);for(;1===_(a,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return d;let c=a.pow(n,t);const f=(t+s)/o;return function(e,n){if(e.is0(n))return n;if(1!==_(e,n))throw new Error("Cannot find square root");let i=r,o=e.mul(e.ONE,c),a=e.pow(n,t),u=e.pow(n,f);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,r=e.sqr(a);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=s<<BigInt(i-t-1),c=e.pow(o,n);i=t,o=e.sqr(c),a=e.mul(a,o),u=e.mul(u,c)}return u}}function g(e){return e%c===a?d:e%u===f?p:y(e)}t.isNegativeLE=(e,t)=>(h(e,t)&s)===s;const m=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function b(e,t,r){if(r<i)throw new Error("invalid exponent, negatives unsupported");if(r===i)return e.ONE;if(r===s)return t;let n=e.ONE,o=t;for(;r>i;)r&s&&(n=e.mul(n,o)),o=e.sqr(o),r>>=s;return n}function w(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),s=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),s),n}function _(e,t){const r=(e.ORDER-s)/o,n=e.pow(t,r),i=e.eql(n,e.ONE),a=e.eql(n,e.ZERO),c=e.eql(n,e.neg(e.ONE));if(!i&&!a&&!c)throw new Error("invalid Legendre symbol result");return i?1:a?0:-1}function v(e,t){void 0!==t&&(0,n.anumber)(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function E(e,t,r=!1,o={}){if(e<=i)throw new Error("invalid field: expected ORDER > 0, got "+e);let a,c;if("object"==typeof t&&null!=t){if(o.sqrt||r)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(a=e.BITS),e.sqrt&&(c=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE)}else"number"==typeof t&&(a=t),o.sqrt&&(c=o.sqrt);const{nBitLength:f,nByteLength:u}=v(e,a);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let d;const p=Object.freeze({ORDER:e,isLE:r,BITS:f,BYTES:u,MASK:(0,n.bitMask)(f),ZERO:i,ONE:s,create:t=>h(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return i<=t&&t<e},is0:e=>e===i,isValidNot0:e=>!p.is0(e)&&p.isValid(e),isOdd:e=>(e&s)===s,neg:t=>h(-t,e),eql:(e,t)=>e===t,sqr:t=>h(t*t,e),add:(t,r)=>h(t+r,e),sub:(t,r)=>h(t-r,e),mul:(t,r)=>h(t*r,e),pow:(e,t)=>b(p,e,t),div:(t,r)=>h(t*l(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>l(t,e),sqrt:c||(t=>(d||(d=g(e)),d(p,t))),toBytes:e=>r?(0,n.numberToBytesLE)(e,u):(0,n.numberToBytesBE)(e,u),fromBytes:e=>{if(e.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+e.length);return r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e)},invertBatch:e=>w(p,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(p)}function S(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function B(e){const t=S(e);return t+Math.ceil(t/2)}},7603:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=r(4686),o=n(r(4406)),a=r(2655),c=r(6761),f=n(r(7264)),u=r(6136),h=e=>(0,i.hash)("sha512",e);class l extends f.default{constructor(){super(),this.authType="DilithiumEdDSAVerificationKey2025"}static async createFromEntropy(e){const t=new l;t.entropy=e,t.capability="private",t.seed=h(e);const r=h(t.seed.slice(0,32));t.pqSigner=(0,c.generateDilithiumKeyPair)(r.slice(0,32)),t.edSigner={publicKey:s.Buffer.from(u.ed25519.getPublicKey(r.slice(32,64))),secretKey:r.slice(32,64)},t.signer={publicKey:s.Buffer.concat([t.edSigner.publicKey,t.pqSigner.publicKey]),secretKey:s.Buffer.concat([t.edSigner.secretKey,t.pqSigner.secretKey])};const n=o.default.box.keyPair.fromSecretKey(t.seed.slice(32,64));return t.cypher={publicKey:s.Buffer.from(n.publicKey),secretKey:s.Buffer.from(n.secretKey)},t}static generate(){return l.createFromEntropy((0,i.randomBytes)(32))}getSecret(){return s.Buffer.from((0,a.encode)({v:this.version,alg:"hybrid",s:this.seed}))}get id(){return s.Buffer.from((0,a.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,a.decode)(e);if("hybrid"!==t.alg)throw new Error("Not a secret for Hybrid Cryptography");const r=new l;r.version=t.v??0,r.capability="private",r.seed=s.Buffer.from(t.s);const n=h(r.seed.slice(0,32));r.pqSigner=(0,c.generateDilithiumKeyPair)(n.slice(0,32)),r.edSigner={publicKey:s.Buffer.from(u.ed25519.getPublicKey(n.slice(32,64))),secretKey:n.slice(32,64)},r.signer={publicKey:s.Buffer.concat([r.edSigner.publicKey,r.pqSigner.publicKey]),secretKey:s.Buffer.concat([r.edSigner.secretKey,r.pqSigner.secretKey])};const i=o.default.box.keyPair.fromSecretKey(r.seed.slice(32,64));return r.cypher={publicKey:s.Buffer.from(i.publicKey),secretKey:s.Buffer.from(i.secretKey)},r}static instantiate(e){const t=new l;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?s.Buffer.from(e.signer.publicKey.data):s.Buffer.from(e.signer.publicKey)},t.edSigner={publicKey:t.signer.publicKey.slice(0,32)},t.pqSigner={publicKey:t.signer.publicKey.slice(32)},t.cypher={publicKey:e.cypher.publicKey.data?s.Buffer.from(e.cypher.publicKey.data):s.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,a.decode)(e),r=new l;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.edSigner={publicKey:t.x.slice(0,32)},r.pqSigner={publicKey:t.x.slice(32)},r.cypher={publicKey:t.e},r}getSigner(){return Promise.resolve({sign:e=>{const t=u.ed25519.sign(e,this.edSigner.secretKey),r=(0,c.signDilithium)(s.Buffer.concat([e,t]),this.pqSigner.secretKey);return Promise.resolve(s.Buffer.concat([t,r]))}})}verify(e,t,r){const n=t.slice(0,64),i=t.slice(64);return!!u.ed25519.verify(n,e,this.edSigner.publicKey)&&(0,c.verifyDilithium)(s.Buffer.concat([e,n]),i,this.pqSigner.publicKey)}}t.default=l},7734:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHA512_IV=t.SHA384_IV=t.SHA224_IV=t.SHA256_IV=t.HashMD=void 0,t.setBigUint64=i,t.Chi=function(e,t,r){return e&t^~e&r},t.Maj=function(e,t,r){return e&t^e&r^t&r};const n=r(11);function i(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,f=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+f,a,n)}class s extends n.Hash{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,n.createView)(this.buffer)}update(e){(0,n.aexists)(this),e=(0,n.toBytes)(e),(0,n.abytes)(e);const{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const t=(0,n.createView)(e);for(;i<=s-o;o+=i)this.process(t,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,n.aexists)(this),(0,n.aoutput)(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:o}=this;let{pos:a}=this;t[a++]=128,(0,n.clean)(this.buffer.subarray(a)),this.padOffset>s-a&&(this.process(r,0),a=0);for(let e=a;e<s;e++)t[e]=0;i(r,s-8,BigInt(8*this.length),o),this.process(r,0);const c=(0,n.createView)(e),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=f/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<u;e++)c.setUint32(4*e,h[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=i,e.length=n,e.pos=o,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}t.HashMD=s,t.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),t.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),t.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),t.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])},7947:(e,t)=>{t.read=function(e,t,r,n,i){var s,o,a=8*i-n-1,c=(1<<a)-1,f=c>>1,u=-7,h=r?i-1:0,l=r?-1:1,d=e[t+h];for(h+=l,s=d&(1<<-u)-1,d>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=l,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+e[t+h],h+=l,u-=8);if(0===s)s=1-f;else{if(s===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),s-=f}return(d?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var o,a,c,f=8*s-i-1,u=(1<<f)-1,h=u>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+h>=1?l/c:l*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*c-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,f+=i;f>0;e[r+d]=255&o,d+=p,o/=256,f-=8);e[r+d-p]|=128*y}},7961:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4686),s=r(5598),o=n(r(1167)),a=r(6136),c=r(1440),f=r(7268),u=r(5691),h=r(6761),l={},d=h.PQ_COSE_KEY_TYPE.DILITHIUM,p={1:c.p256,2:f.p384,3:u.p521},y={"-257":"SHA-256","-258":"SHA-384","-259":"SHA-512","-65535":"SHA-1","-39":"SHA-512","-38":"SHA-384","-37":"SHA-256","-260":"SHA-256","-261":"SHA-512","-7":"SHA-256","-36":"SHA-512",[h.PQ_COSE_ALG.DILITHIUM2.toString()]:"SHA-256"},g=(e,t)=>(0,s.hash)(e.replace("-",""),t),m=e=>{const t=e.slice(0,32),r=(e=e.slice(32)).slice(0,1);e=e.slice(1);const n=r[0],i={up:!!(1&n),uv:!!(4&n),at:!!(64&n),ed:!!(128&n),flagsInt:n},s=e.slice(0,4);e=e.slice(4);const o=s.readUInt32BE(0);let a,c,f;if(i.at){a=e.slice(0,16);const t=(e=e.slice(16)).slice(0,2);e=e.slice(2);const r=t.readUInt16BE(0);c=e.slice(0,r),f=e=e.slice(r)}return{rpIdHash:t,flagsBuf:r,flags:i,counter:o,counterBuf:s,aaguid:a,credID:c,COSEPublicKey:f}},b=(e,t,r)=>c.p256.verify(c.p256.Signature.fromDER(r).toCompactHex(),e,t),w=(e,t,r)=>a.ed25519.verify(r,e,t);class _{constructor(){this.signCount=0,this.rawId=(0,s.randomBytes)(32),this.aaguid=i.Buffer.alloc(16)}static createRequest(e,t=!1){const r={publicKey:{challenge:i.Buffer.from((0,s.randomBytes)(32).toString("base64")),rp:{name:"Vaultys ID",id:"Vaultys ID"},user:{id:i.Buffer.from("Vaultys Wallet ID","utf8"),name:"Vaultys Wallet ID",displayName:"Vaultys Wallet ID"},pubKeyCredParams:[{type:"public-key",alg:e}]}};return t&&(r.publicKey.extensions={prf:{eval:{first:(0,s.randomBytes)(32)}}}),r}static async create(e,t="test"){const r=new _,n=e.publicKey;r.options=n,r.rpId=n.rp.id||n.rp.name,r.userHandle=i.Buffer.from(n.user.id.toString(),"base64"),l[r.rawId.toString("base64")]=r;const f=n.pubKeyCredParams.some(e=>e.alg===h.PQ_COSE_ALG.DILITHIUM2);if(r.alg=f?h.PQ_COSE_ALG.DILITHIUM2:n.pubKeyCredParams[0].alg,-8===r.alg){const e=a.ed25519.utils.randomPrivateKey();r.keyPair={privateKey:e,publicKey:a.ed25519.getPublicKey(e),algorithm:"EdDSA"},r.coseKey=new Map,r.coseKey.set(1,1),r.coseKey.set(3,-8),r.coseKey.set(-1,6);const t=r.keyPair.publicKey.slice(0,32);r.coseKey.set(-2,t)}else if(-7===r.alg){const e=c.p256.utils.randomPrivateKey();r.keyPair={privateKey:e,publicKey:c.p256.getPublicKey(e,!1),algorithm:"ES256"},r.coseKey=new Map,r.coseKey.set(1,2),r.coseKey.set(3,-7),r.coseKey.set(-1,6);const t=r.keyPair.publicKey.slice(1,33),n=r.keyPair.publicKey.slice(33);r.coseKey.set(-2,t),r.coseKey.set(-3,n)}else if(r.alg===h.PQ_COSE_ALG.DILITHIUM2){const{publicKey:e,secretKey:t}=(0,h.generateDilithiumKeyPair)();r.keyPair={privateKey:t,publicKey:e,algorithm:"DILITHIUM2",isDILITHIUM:!0},r.coseKey=(0,h.createDilithiumCoseKey)(e)}const u={type:"webauthn.create",challenge:n.challenge,origin:t},d=(0,s.hash)("sha256",i.Buffer.from(r.rpId,"ascii")),p=i.Buffer.from("41","hex"),y=i.Buffer.allocUnsafe(4);y.writeUInt32BE(r.signCount,0);const g=i.Buffer.allocUnsafe(2);g.writeUInt16BE(r.rawId.length,0);const m=o.default.encode(r.coseKey),b={authData:i.Buffer.concat([d,p,y,r.aaguid,g,r.rawId,m]),fmt:"none",attStmt:{}};return{id:r.rawId.toString("base64"),rawId:r.rawId,authenticatorAttachment:null,type:"public-key",getClientExtensionResults:()=>n.extensions?.prf?.eval?.first?{prf:{enabled:!0}}:{},toJSON(){},response:{clientDataJSON:i.Buffer.from(JSON.stringify(u),"utf-8"),attestationObject:o.default.encode(b),getTransports:()=>["usb","hybrid"],getAuthenticatorData:()=>b.authData,getPublicKey:()=>m,getPublicKeyAlgorithm:()=>-7}}}static simpleVerify(e,t,r=!1){const n=o.default.decode(e,{extendedResults:!0}).value,a=(t.authenticatorData.slice(0,32),i.Buffer.from(t.authenticatorData)[32]);if(t.authenticatorData.slice(33,37),!(r?4&a:1&a))return!1;const c=(0,s.hash)("sha256",i.Buffer.from(t.clientDataJSON));let f=i.Buffer.concat([i.Buffer.from(t.authenticatorData),c]);if(-7==n.get(3)&&(f=(0,s.hash)("sha256",f)),1==n.get(1)){const e=n.get(-2);return w(f,e,i.Buffer.from(t.signature))}if(2==n.get(1)){const e=n.get(-2),r=n.get(-3),s=i.Buffer.concat([i.Buffer.from("04","hex"),e,r]);return b(f,s,i.Buffer.from(t.signature))}if(n.get(1)===d){const e=n.get(h.PQ_COSE_KEY_PARAMS.DILITHIUM_PK);return(0,h.verifyDilithium)(f,i.Buffer.from(t.signature),e)}return!1}static getCOSEPublicKey(e){const t=e.response,r=o.default.decode(t.attestationObject);return m(r.authData).COSEPublicKey}static verifyPackedAttestation(e,t=!1){return((e,t=!1)=>{const r=i.Buffer.from(e.attestationObject),n=o.default.decodeAllSync(r)[0];if("none"==n.fmt)return!1;const s=m(n.authData);if(!s.flags.up)return!1;if(t&&!s.flags.uv)return!1;const c=g("sha256",i.Buffer.from(e.clientDataJSON)),f=i.Buffer.concat([n.authData,c]),u=n.attStmt.sig;let h=!1;if(n.attStmt.ecdaaKeyId)throw new Error("ECDAA IS NOT SUPPORTED!");{const e=o.default.decodeAllSync(s.COSEPublicKey)[0],t=y[e.get(3)],r=g(t,f);if(2===e.get(1)){const t=e.get(-2),n=e.get(-3),s=i.Buffer.concat([i.Buffer.from([4]),t,n]),o=p[e.get(-1)],a=o.Signature.fromDER(u);h=o.verify(a,r,s)}else{if(1!==e.get(1))return!1;{const t=e.get(-2);h=a.ed25519.verify(u,r,t)}}}if(!h)throw new Error("Failed to verify the signature!");return!0})(e,t)}static async verify(e,t,r=!1){const n=(0,s.hash)("sha256",i.Buffer.from(t.response.clientDataJSON)),a=t.response,c=e.response;let f=i.Buffer.concat([i.Buffer.from(a.authenticatorData),n]);const u=o.default.decode(c.attestationObject),l=m(u.authData);if(!l.flags.up)return!1;if(r&&!l.flags.uv||!l.COSEPublicKey)return!1;const p=o.default.decode(l.COSEPublicKey);-7==p.get(3)&&(f=(0,s.hash)("sha256",f));const y=p.get(1);if(1===y){const e=p.get(-2);return w(f,e,i.Buffer.from(a.signature))}if(2===y){const e=p.get(-2),t=p.get(-3),r=i.Buffer.concat([i.Buffer.from("04","hex"),e,t]);return b(f,r,i.Buffer.from(a.signature))}if(y===d){const e=p.get(h.PQ_COSE_KEY_PARAMS.DILITHIUM_PK);return(0,h.verifyDilithium)(f,i.Buffer.from(a.signature),e)}return!1}static extractChallenge(e){const t=JSON.parse(e.toString()),r=t.challenge.length%4;return t.challenge.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.challenge.length+(0===r?0:4-r),"=")}static async get({publicKey:e},t="test"){if(!e.allowCredentials)throw new Error;const r=i.Buffer.from(e.allowCredentials[0].id).toString("base64"),n=l[r];n.signCount+=1;const o={type:"webauthn.get",challenge:i.Buffer.from(e.challenge).toString("base64"),origin:t},f=(0,s.hash)("sha256",(0,s.fromUTF8)(JSON.stringify(o))),u=(0,s.hash)("sha256",i.Buffer.from(n.rpId,"utf-8")),d=i.Buffer.from("05","hex"),p=i.Buffer.allocUnsafe(4);p.writeUInt32BE(n.signCount,0);const y=i.Buffer.concat([u,d,p]),m=i.Buffer.concat([y,f]);let b=new Uint8Array;return-7===n.alg?b=c.p256.sign(m,n.keyPair.privateKey,{prehash:!0}).toDERRawBytes():-8===n.alg?b=a.ed25519.sign(m,n.keyPair.privateKey):n.alg===h.PQ_COSE_ALG.DILITHIUM2&&(b=(0,h.signDilithium)(m,n.keyPair.privateKey)),{id:r,rawId:i.Buffer.from(r,"base64").buffer,type:"public-key",authenticatorAttachment:null,getClientExtensionResults:()=>e.extensions?.prf?.eval?.first?{prf:{results:{first:g("sha256",e.extensions?.prf?.eval?.first)}}}:{},toJSON(){},response:{authenticatorData:y,clientDataJSON:i.Buffer.from(JSON.stringify(o),"utf-8"),signature:b,userHandle:n.userHandle}}}}t.default=_},7963:(e,t,r)=>{"use strict";var n=r(8704).F.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var s=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new n(i?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},7981:function(e,t,r){"use strict";var n,i=r(4686).Buffer,s=r(8558),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&o(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0});const f=r(2655),u=r(4406),h=c(r(931)),l=r(568),d=r(4072);class p extends h.default{constructor(e,t,r=!0){if(super(),!(0,l.isBufferOrUint8Array)(e)||32!==e.length)throw new TypeError("public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||32!==t.length)throw new TypeError("nonce must be a 32 byte Uint8Array");if("boolean"!=typeof r)throw new TypeError("attached must be a boolean");this.public_key=e,this.nonce=t,this.attached=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data[1]}get hash(){return this.encoded_data[0]}static create(e,t=!0){var r;return new this(e,null!==(r=this.debug_fix_nonce)&&void 0!==r?r:(0,u.randomBytes)(32),t)}encode(){return p.encodeHeader(this.public_key,this.nonce,this.attached)}static encodeHeader(e,t,r){const n=["saltpack",[2,0],r?h.MessageType.ATTACHED_SIGNING:h.MessageType.DETACHED_SIGNING,e,t],s=(0,f.encode)(n);return[d.sha512.create().update(s).digest(),i.from((0,f.encode)(s))]}static decode(e,t=!1){const[,r]=super.decode1(e,t);if(r[2]!==h.MessageType.ATTACHED_SIGNING&&r[2]!==h.MessageType.DETACHED_SIGNING)throw new Error("Invalid data");const[,,,n,i]=r;return new this(n,i,r[2]===h.MessageType.ATTACHED_SIGNING)}signDetached(e,t){if(this.attached)throw new Error("Header attached is true");const r=d.sha512.create().update(this.hash).update(e).digest(),n=i.concat([p.DETACHED_SIGNATURE_PREFIX,r]);return i.from(u.sign.detached(Uint8Array.from(n),Uint8Array.from(t)))}verifyDetached(e,t,r){if(this.attached)throw new Error("Header attached is true");const n=d.sha512.create().update(this.hash).update(t).digest(),s=i.concat([p.DETACHED_SIGNATURE_PREFIX,n]);if(!u.sign.detached.verify(Uint8Array.from(s),Uint8Array.from(e),Uint8Array.from(r)))throw new Error("Invalid signature")}}p.DETACHED_SIGNATURE_PREFIX=i.from("saltpack detached signature\0"),p.debug_fix_nonce=s.env.TEST?i.alloc(32).fill(0):null,t.default=p},8051:function(e,t,r){"use strict";var n,i=r(4686).Buffer,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&s(t,e,r[i]);return o(t,e),t}),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const f=a(r(931)),u=c(r(3051)),h=r(4406),l=r(568),d=r(2655),p=r(4072),y=r(3835);class g extends f.default{constructor(e,t,r){if(super(),!(0,l.isBufferOrUint8Array)(e)||32!==e.length)throw new TypeError("public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||48!==t.length)throw new TypeError("sender_secretbox must be a 48 byte Uint8Array");this.public_key=e,this.sender_secretbox=t,this.recipients=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data[1]}get hash(){return this.encoded_data[0]}static create(e,t,r,n){if(null!==r&&(!(0,l.isBufferOrUint8Array)(r)||32!==r.length))throw new TypeError("sender_public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||32!==t.length)throw new TypeError("payload_key must be a 32 byte Uint8Array");return r||(r=i.alloc(32)),new this(e,(0,h.secretbox)(Uint8Array.from(r),Uint8Array.from(g.SENDER_KEY_SECRETBOX_NONCE),Uint8Array.from(t)),n)}encode(){return g.encodeHeader(this.public_key,this.sender_secretbox,this.recipients)}static encodeHeader(e,t,r){const n=["saltpack",[2,0],f.MessageType.SIGNCRYPTION,e,t,r.map(e=>[e.recipient_identifier,e.encrypted_payload_key])],s=(0,d.encode)(n);return[p.sha512.create().update(s).digest(),i.from((0,d.encode)(s))]}static decode(e,t=!1){const[r,n]=super.decode1(e,t);if(n[2]!==f.MessageType.SIGNCRYPTION)throw new Error("Invalid data");const[,,,i,s,o]=n;if(!(o instanceof Array))throw new Error("Invalid data");return new this(i,s,o.map((e,t)=>{if(!(e instanceof Array)||e.length<2)throw new TypeError("Invalid data");return u.default.from(e[0],e[1],t)}))}decryptPayloadKeyWithCurve25519Keypair(e){for(const t of this.recipients){const{recipient_identifier:r,shared_symmetric_key:n}=u.default.generateRecipientIdentifierForRecipient(this.public_key,e,t.recipient_index);if(!r.equals(t.recipient_identifier))continue;const i=t.decryptPayloadKey(n);if(!i)throw new Error("Invalid shared symmetric key");return[i,t]}return null}decryptPayloadKeyWithSymmetricKey(e,t){const r=(0,y.hmac)(p.sha512,u.default.HMAC_KEY_SYMMETRIC,i.concat([this.public_key,e])).slice(0,32),n=t?i.from(t):null;for(const e of this.recipients){if(n&&!n.equals(e.recipient_identifier))continue;const t=e.decryptPayloadKey(r);if(t)return[t,e]}return null}decryptSender(e){const t=h.secretbox.open(Uint8Array.from(this.sender_secretbox),Uint8Array.from(g.SENDER_KEY_SECRETBOX_NONCE),Uint8Array.from(e));if(!t)throw new Error("Failed to decrypt sender public key");return i.alloc(32).equals(t)?null:t}}g.SENDER_KEY_SECRETBOX_NONCE=i.from("saltpack_sender_key_sbox"),t.default=g},8308:()=>{},8558:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var a,c=[],f=!1,u=-1;function h(){f&&a&&(f=!1,a.length?c=a.concat(c):u=-1,c.length&&l())}function l(){if(!f){var e=o(h);f=!0;for(var t=c.length;t;){for(a=c,c=[];++u<t;)a&&a[u].run();u=-1,t=c.length}a=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new d(e,t)),1!==c.length||f||o(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},8590:(e,t,r)=>{"use strict";const{Buffer:n}=r(4686),i=r(6899),s=r(896),o=r(790),{NUMBYTES:a,SHIFT32:c,BI:f,SYMS:u}=o,h=new TextDecoder("utf8",{fatal:!0,ignoreBOM:!0});t.utf8=e=>h.decode(e),t.utf8.checksUTF8=!0,t.isBufferish=function(e){return e&&"object"==typeof e&&(n.isBuffer(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof ArrayBuffer||e instanceof DataView)},t.bufferishToBuffer=function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?n.from(e):null},t.parseCBORint=function(e,t){switch(e){case a.ONE:return t.readUInt8(0);case a.TWO:return t.readUInt16BE(0);case a.FOUR:return t.readUInt32BE(0);case a.EIGHT:{const e=t.readUInt32BE(0),r=t.readUInt32BE(4);return e>2097151?BigInt(e)*f.SHIFT32+BigInt(r):e*c+r}default:throw new Error(`Invalid additional info for int: ${e}`)}},t.writeHalf=function(e,t){const r=n.allocUnsafe(4);r.writeFloatBE(t,0);const i=r.readUInt32BE(0);if(8191&i)return!1;let s=i>>16&32768;const o=i>>23&255,a=8388607&i;if(o>=113&&o<=142)s+=(o-112<<10)+(a>>13);else{if(!(o>=103&&o<113))return!1;if(a&(1<<126-o)-1)return!1;s+=a+8388608>>126-o}return e.writeUInt16BE(s),!0},t.parseHalf=function(e){const t=128&e[0]?-1:1,r=(124&e[0])>>2,n=(3&e[0])<<8|e[1];return r?31===r?t*(n?NaN:1/0):t*2**(r-25)*(1024+n):5.960464477539063e-8*t*n},t.parseCBORfloat=function(e){switch(e.length){case 2:return t.parseHalf(e);case 4:return e.readFloatBE(0);case 8:return e.readDoubleBE(0);default:throw new Error(`Invalid float size: ${e.length}`)}},t.hex=function(e){return n.from(e.replace(/^0x/,""),"hex")},t.bin=function(e){let t=0,r=(e=e.replace(/\s/g,"")).length%8||8;const i=[];for(;r<=e.length;)i.push(parseInt(e.slice(t,r),2)),t=r,r+=8;return n.from(i)},t.arrayEqual=function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every((e,r)=>e===t[r])},t.bufferToBigInt=function(e){return BigInt(`0x${e.toString("hex")}`)},t.cborValueToString=function(e,r=-1){switch(typeof e){case"symbol":{switch(e){case u.NULL:return"null";case u.UNDEFINED:return"undefined";case u.BREAK:return"BREAK"}if(e.description)return e.description;const t=e.toString().match(/^Symbol\((?<name>.*)\)/);return t&&t.groups.name?t.groups.name:"Symbol"}case"string":return JSON.stringify(e);case"bigint":return e.toString();case"number":{const t=Object.is(e,-0)?"-0":String(e);return r>0?`${t}_${r}`:t}case"object":{if(!e)return"null";const n=t.bufferishToBuffer(e);if(n){const e=n.toString("hex");return r===-1/0?e:`h'${e}'`}return e&&"function"==typeof e[Symbol.for("nodejs.util.inspect.custom")]?e[Symbol.for("nodejs.util.inspect.custom")]():Array.isArray(e)?"[]":"{}"}}return String(e)},t.guessEncoding=function(e,r){if("string"==typeof e)return new i(e,null==r?"hex":r);const n=t.bufferishToBuffer(e);if(n)return new i(n);if((o=e)instanceof s.Readable||["read","on","pipe"].every(e=>"function"==typeof o[e]))return e;var o;throw new Error("Unknown input type")};const l={"=":"","+":"-","/":"_"};t.base64url=function(e){return t.bufferishToBuffer(e).toString("base64").replace(/[=+/]/g,e=>l[e])},t.base64=function(e){return t.bufferishToBuffer(e).toString("base64")},t.isBigEndian=function(){const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])}},8676:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(9750),s=r(5598),o=r(4686),a=n(r(4406)),c=r(2655),f=r(6136),u=n(r(7264));f.ed25519.CURVE={...f.ed25519.CURVE},f.ed25519.CURVE.adjustScalarBytes=e=>(e[0]&=248,e[31]&=63,e[31]|=64,e);class h extends u.default{constructor(){super(),this.version=1,this.capability="private",this.authType="Ed25519VerificationKey2020"}static async createFromEntropy(e){const t=new h;t.entropy=e,t.capability="private";const r=(n=e,(0,s.hash)("sha512",n));var n;t.signer={publicKey:o.Buffer.from(f.ed25519.getPublicKey(r.slice(0,32))),secretKey:r.slice(0,32)};const i=a.default.box.keyPair.fromSecretKey(r.slice(32,64));return t.cypher={publicKey:o.Buffer.from(i.publicKey),secretKey:o.Buffer.from(i.secretKey)},t}static generate(){return h.createFromEntropy((0,s.randomBytes)(32))}get id(){return 0===this.version?(e=>{const t=e=>e.length<=65535?o.Buffer.from([197,e.length>>8,255&e.length,...e]):o.Buffer.from([198,e.length>>24&255,e.length>>16&255,e.length>>8&255,255&e.length,...e]),r=o.Buffer.from([132,161,118,0]),n=o.Buffer.concat([o.Buffer.from([161,112]),t(o.Buffer.from([]))]),i=o.Buffer.concat([o.Buffer.from([161,120]),t(e.signer.publicKey)]),s=o.Buffer.concat([o.Buffer.from([161,101]),t(e.cypher.publicKey)]);return o.Buffer.concat([r,n,i,s])})(this):o.Buffer.from((0,c.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?(0,s.hmac)("sha256",o.Buffer.from(e.secretKey),"VaultysID/"+t+"/end"):void 0,signcrypt:async(t,r)=>(0,i.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,i.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>o.Buffer.from(a.default.scalarMult(e.secretKey,t))}}getSigner(){const e=this.signer.secretKey;return Promise.resolve({sign:t=>Promise.resolve(o.Buffer.from(f.ed25519.sign(t,e)))})}getSecret(){return o.Buffer.from((0,c.encode)({v:this.version,x:this.signer.secretKey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,c.decode)(e),r=new h;r.version=t.v??0,r.capability="private",r.signer={secretKey:t.x.slice(0,32),publicKey:o.Buffer.from(f.ed25519.getPublicKey(t.x.slice(0,32)))};const n=a.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:o.Buffer.from(n.publicKey),secretKey:o.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new h;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?o.Buffer.from(e.signer.publicKey.data):o.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?o.Buffer.from(e.cypher.publicKey.data):o.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,c.decode)(e),r=new h;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}verify(e,t,r){return f.ed25519.verify(t,e,this.signer.publicKey)}cleanSecureData(){this.cypher?.secretKey&&((0,s.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.signer?.secretKey&&((0,s.secureErase)(this.signer.secretKey),delete this.signer.secretKey),this.entropy&&((0,s.secureErase)(this.entropy),delete this.entropy)}}t.default=h},8704:e=>{"use strict";var t={};function r(e,r,n){n||(n=Error);var i=function(e){var t,n;function i(t,n,i){return e.call(this,function(e,t,n){return"string"==typeof r?r:r(e,t,n)}(t,n,i))||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(n);i.prototype.name=n.name,i.prototype.code=e,t[e]=i}function n(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map(function(e){return String(e)}),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(e,t,r){var i,s,o,a,c;if("string"==typeof t&&(s="not ",t.substr(0,4)===s)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-9,r)===t}(e," argument"))o="The ".concat(e," ").concat(i," ").concat(n(t,"type"));else{var f=("number"!=typeof c&&(c=0),c+1>(a=e).length||-1===a.indexOf(".",c)?"argument":"property");o='The "'.concat(e,'" ').concat(f," ").concat(i," ").concat(n(t,"type"))}return o+". Received type ".concat(typeof r)},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.F=t},8854:()=>{},8881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.montgomery=function(e){const t=(d=e,(0,n._validateObject)(d,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...d})),{P:r,type:c,adjustScalarBytes:f,powPminus2:u,randomBytes:h}=t,l="x25519"===c;var d;if(!l&&"x448"!==c)throw new Error("invalid type");const p=h||n.randomBytes,y=l?255:448,g=l?32:56,m=l?BigInt(9):BigInt(5),b=l?BigInt(121665):BigInt(39081),w=l?a**BigInt(254):a**BigInt(447),_=l?BigInt(8)*a**BigInt(251)-o:BigInt(4)*a**BigInt(445)-o,v=w+_+o,E=e=>(0,i.mod)(e,r),S=B(m);function B(e){return(0,n.numberToBytesLE)(E(e),g)}function A(e,t){const i=function(e,t){(0,n.aInRange)("u",e,s,r),(0,n.aInRange)("scalar",t,w,v);const i=t,a=e;let c=o,f=s,h=e,l=o,d=s;for(let e=BigInt(y-1);e>=s;e--){const t=i>>e&o;d^=t,({x_2:c,x_3:h}=x(d,c,h)),({x_2:f,x_3:l}=x(d,f,l)),d=t;const r=c+f,n=E(r*r),s=c-f,u=E(s*s),p=n-u,y=h+l,g=E((h-l)*r),m=E(y*s),w=g+m,_=g-m;h=E(w*w),l=E(a*E(_*_)),c=E(n*u),f=E(p*(n+E(b*p)))}({x_2:c,x_3:h}=x(d,c,h)),({x_2:f,x_3:l}=x(d,f,l));const p=u(f);return E(c*p)}(function(e){const t=(0,n.ensureBytes)("u coordinate",e,g);return l&&(t[31]&=127),E((0,n.bytesToNumberLE)(t))}(t),function(e){return(0,n.bytesToNumberLE)(f((0,n.ensureBytes)("scalar",e,g)))}(e));if(i===s)throw new Error("invalid private or public key received");return B(i)}function I(e){return A(e,S)}function x(e,t,r){const n=E(e*(t-r));return{x_2:t=E(t-n),x_3:r=E(r+n)}}return{scalarMult:A,scalarMultBase:I,getSharedSecret:(e,t)=>A(e,t),getPublicKey:e=>I(e),utils:{randomPrivateKey:()=>p(g)},GuBytes:S.slice()}};const n=r(6376),i=r(7342),s=BigInt(0),o=BigInt(1),a=BigInt(2)},8917:(e,t,r)=>{var n,i=r(8558),s=r(1661),o=r(6141);try{n=r(5826)}catch(e){}var a=function(){},c=void 0!==i&&/^v?\.0/.test(i.version),f=function(e){return"function"==typeof e},u=function(e){e()},h=function(e,t){return e.pipe(t)};e.exports=function(){var e,t=Array.prototype.slice.call(arguments),r=f(t[t.length-1]||a)&&t.pop()||a;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var i=t.map(function(h,l){var d=l<t.length-1;return function(e,t,r,i){i=s(i);var u=!1;e.on("close",function(){u=!0}),o(e,{readable:t,writable:r},function(e){if(e)return i(e);u=!0,i()});var h=!1;return function(t){if(!u&&!h)return h=!0,function(e){return!!c&&!!n&&(e instanceof(n.ReadStream||a)||e instanceof(n.WriteStream||a))&&f(e.close)}(e)?e.close(a):function(e){return e.setHeader&&f(e.abort)}(e)?e.abort():f(e.destroy)?e.destroy():void i(t||new Error("stream was destroyed"))}}(h,d,l>0,function(t){e||(e=t),t&&i.forEach(u),d||(i.forEach(u),r(e))})});return t.reduce(h)}},9035:(e,t,r)=>{"use strict";var n,i=r(8558);function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(2862),a=Symbol("lastResolve"),c=Symbol("lastReject"),f=Symbol("error"),u=Symbol("ended"),h=Symbol("lastPromise"),l=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function y(e){var t=e[a];if(null!==t){var r=e[d].read();null!==r&&(e[h]=null,e[a]=null,e[c]=null,t(p(r,!1)))}}function g(e){i.nextTick(y,e)}var m=Object.getPrototypeOf(function(){}),b=Object.setPrototypeOf((s(n={get stream(){return this[d]},next:function(){var e=this,t=this[f];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise(function(t,r){i.nextTick(function(){e[f]?r(e[f]):t(p(void 0,!0))})});var r,n=this[h];if(n)r=new Promise(function(e,t){return function(r,n){e.then(function(){t[u]?r(p(void 0,!0)):t[l](r,n)},n)}}(n,this));else{var s=this[d].read();if(null!==s)return Promise.resolve(p(s,!1));r=new Promise(this[l])}return this[h]=r,r}},Symbol.asyncIterator,function(){return this}),s(n,"return",function(){var e=this;return new Promise(function(t,r){e[d].destroy(null,function(e){e?r(e):t(p(void 0,!0))})})}),n),m);e.exports=function(e){var t,r=Object.create(b,(s(t={},d,{value:e,writable:!0}),s(t,a,{value:null,writable:!0}),s(t,c,{value:null,writable:!0}),s(t,f,{value:null,writable:!0}),s(t,u,{value:e._readableState.endEmitted,writable:!0}),s(t,l,{value:function(e,t){var n=r[d].read();n?(r[h]=null,r[a]=null,r[c]=null,e(p(n,!1))):(r[a]=e,r[c]=t)},writable:!0}),t));return r[h]=null,o(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[c];return null!==t&&(r[h]=null,r[a]=null,r[c]=null,t(e)),void(r[f]=e)}var n=r[a];null!==n&&(r[h]=null,r[a]=null,r[c]=null,n(p(void 0,!0))),r[u]=!0}),e.on("readable",g.bind(null,r)),r}},9055:(e,t,r)=>{"use strict";const n=r(896),i=r(5775),s=r(8590),o=r(6899),{MT:a,SYMS:c}=r(790);class f extends n.Transform{constructor(e={}){const{separator:t="\n",stream_errors:r=!1,tags:n,max_depth:s,preferWeb:o,encoding:a,...c}=e;super({...c,readableObjectMode:!1,writableObjectMode:!1}),this.float_bytes=-1,this.separator=t,this.stream_errors=r,this.parser=new i({tags:n,max_depth:s,preferWeb:o,encoding:a}),this.parser.on("more-bytes",this._on_more.bind(this)),this.parser.on("value",this._on_value.bind(this)),this.parser.on("start",this._on_start.bind(this)),this.parser.on("stop",this._on_stop.bind(this)),this.parser.on("data",this._on_data.bind(this)),this.parser.on("error",this._on_error.bind(this))}_transform(e,t,r){this.parser.write(e,t,r)}_flush(e){this.parser._flush(t=>this.stream_errors?(t&&this._on_error(t),e()):e(t))}static diagnose(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=function(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}(t,r));const{encoding:n="hex",...i}=t,a=new o,c=new f(i);let u=null;return"function"==typeof r?(c.on("end",()=>r(null,a.toString("utf8"))),c.on("error",r)):u=new Promise((e,t)=>{c.on("end",()=>e(a.toString("utf8"))),c.on("error",t)}),c.pipe(a),s.guessEncoding(e,n).pipe(c),u}_on_error(e){this.stream_errors?this.push(e.toString()):this.emit("error",e)}_on_more(e,t,r,n){e===a.SIMPLE_FLOAT&&(this.float_bytes={2:1,4:2,8:3}[t])}_fore(e,t){switch(e){case a.BYTE_STRING:case a.UTF8_STRING:case a.ARRAY:t>0&&this.push(", ");break;case a.MAP:t>0&&(t%2?this.push(": "):this.push(", "))}}_on_value(e,t,r){if(e===c.BREAK)return;this._fore(t,r);const n=this.float_bytes;this.float_bytes=-1,this.push(s.cborValueToString(e,n))}_on_start(e,t,r,n){switch(this._fore(r,n),e){case a.TAG:this.push(`${t}(`);break;case a.ARRAY:this.push("[");break;case a.MAP:this.push("{");break;case a.BYTE_STRING:case a.UTF8_STRING:this.push("(")}t===c.STREAM&&this.push("_ ")}_on_stop(e){switch(e){case a.TAG:this.push(")");break;case a.ARRAY:this.push("]");break;case a.MAP:this.push("}");break;case a.BYTE_STRING:case a.UTF8_STRING:this.push(")")}}_on_data(){this.push(this.separator)}}e.exports=f},9071:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCrypto=void 0;const n=r(1866),i=r(7165);t.NodeCrypto={webauthn:new i.NodeWebAuthn,pbkdf2:{encrypt:n.encrypt,decrypt:n.decrypt}}},9109:(e,t,r)=>{"use strict";const{MT:n,SIMPLE:i,SYMS:s}=r(790);class o{constructor(e){if("number"!=typeof e)throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(0|e)!==e)throw new Error(`value must be a small positive integer: ${e}`);this.value=e}toString(){return`simple(${this.value})`}[Symbol.for("nodejs.util.inspect.custom")](e,t){return`simple(${this.value})`}encodeCBOR(e){return e._pushInt(this.value,n.SIMPLE_FLOAT)}static isSimple(e){return e instanceof o}static decode(e,t=!0,r=!1){switch(e){case i.FALSE:return!1;case i.TRUE:return!0;case i.NULL:return t?null:s.NULL;case i.UNDEFINED:if(t)return;return s.UNDEFINED;case-1:if(!t||!r)throw new Error("Invalid BREAK");return s.BREAK;default:return new o(e)}}}e.exports=o},9126:(e,t,r)=>{var n=r(8917),i=r(6192),s=r(347),o=function(e){return e.length?Array.isArray(e[0])?e[0]:Array.prototype.slice.call(e):[]},a=function(e){var t=function(){var r=o(arguments);if(!(this instanceof t))return new t(r);s.call(this,null,null,e),r.length&&this.setPipeline(r)};return i(t,s),t.prototype.setPipeline=function(){var e=o(arguments),t=this,r=!1,i=e[0],s=e[e.length-1];s=s.readable?s:null,i=i.writable?i:null;var a=function(){e[0].emit("error",new Error("stream was destroyed"))};if(this.on("close",a),this.on("prefinish",function(){r||t.cork()}),n(e,function(e){if(t.removeListener("close",a),e)return t.destroy("premature close"===e.message?null:e);r=!0,!1===t._autoDestroy&&(t._autoDestroy=!0),t.uncork()}),this.destroyed)return a();this.setWritable(i),this.setReadable(s)},t};e.exports=a({autoDestroy:!1,destroy:!1}),e.exports.obj=a({autoDestroy:!1,destroy:!1,objectMode:!0,highWaterMark:16}),e.exports.ctor=a},9399:e=>{var t=1/0,r=9007199254740991,n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=/^(?:0|[1-9]\d*)$/,c=parseInt,f=Object.prototype.toString,u=Math.ceil,h=Math.max;function l(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(i);++n<i;)s[n]=e[n+t];return s}function d(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e,p,y){p=(y?function(e,t,n){if(!d(n))return!1;var i=typeof t;return!!("number"==i?function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!function(e){var t=d(e)?f.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(n)&&function(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||a.test(e))&&e>-1&&e%1==0&&e<t}(t,n.length):"string"==i&&t in n)&&function(e,t){return e===t||e!=e&&t!=t}(n[t],e)}(e,p,y):void 0===p)?1:h(function(e){var r=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(d(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=d(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var r=s.test(e);return r||o.test(e)?c(e.slice(2),r?2:8):i.test(e)?NaN:+e}(e))===t||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),a=r%1;return r==r?a?r-a:r:0}(p),0);var g=e?e.length:0;if(!g||p<1)return[];for(var m=0,b=0,w=Array(u(g/p));m<g;)w[b++]=l(e,m,m+=p);return w}},9463:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=n(r(1167)),o=n(r(4406)),a=n(r(7961)),c=r(2655),f=n(r(1449)),u=r(4686),h=r(6761),l={usb:1,nfc:2,ble:4,internal:8,hybrid:16,"smart-card":32},d=e=>{const t=s.default.decode(e,{extendedResults:!0}).value.get(1);return 1===t?"Ed25519VerificationKey2020":2===t?"P256VerificationKey2020":"Unknown"},p=e=>{const t=s.default.decode(e,{extendedResults:!0}).value;let r=u.Buffer.from([]);return-7==t.get(3)?r=u.Buffer.concat([u.Buffer.from("04","hex"),t.get(-2),t.get(-3)]):-8==t.get(3)?r=t.get(-2):t.get(3)==h.PQ_COSE_ALG.DILITHIUM2&&(r=t.get(-101)),{publicKey:r}};class y extends f.default{constructor(){super(),this.prfsalt=u.Buffer.from("VaultysID salt")}static async createFromAttestation(e){const t=new y;t.ckey=a.default.getCOSEPublicKey(e),t.authType=d(t.ckey),t.fid=u.Buffer.from(e.id,"base64");const r=e.response,n=r.getTransports?r.getTransports():["usb"];return t._transports=(e=>e.reduceRight((e,t)=>e+(l[t]?l[t]:0),0))(n),t.signer=p(t.ckey),await t.getCypher(),delete t.cypher.secretKey,t}getSecret(){return u.Buffer.from((0,c.encode)({v:this.version,f:this.fid,t:this._transports,c:this.ckey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,c.decode)(e),r=new y;return r.version=t.v??0,r.capability="private",r.fid="string"==typeof t.f?u.Buffer.from(t.f,"base64"):t.f,r._transports=t.t?t.t:15,r.ckey=t.c,r.authType=d(r.ckey),r.signer=p(t.c),r.cypher={publicKey:t.e},r}cleanSecureData(){this.cypher?.secretKey&&((0,i.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey)}async getCypher(){if(!this.cypher?.secretKey){const t={challenge:u.Buffer.from([]),userVerification:"preferred",allowCredentials:[{type:"public-key",id:this.fid,transports:(e=this._transports,Object.keys(l).filter(t=>e&&l[t]))}],extensions:{prf:{eval:{first:this.prfsalt}}}},r=await this.webAuthn.get(t),{prf:n}=r.getClientExtensionResults(),i=n?.results?.first;if(!i)throw new Error("PRF failed");const s=o.default.box.keyPair.fromSecretKey(new Uint8Array(i));this.cypher={publicKey:u.Buffer.from(s.publicKey),secretKey:u.Buffer.from(s.secretKey)}}var e;return super.getCypher()}async createRevocationCertificate(){return null}}t.default=y},9481:(e,t,r)=>{e.exports=r(9784).EventEmitter},9495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserCrypto=void 0;const n=r(3170),i=r(7165);t.BrowserCrypto={webauthn:new i.BrowserWebAuthn,pbkdf2:{encrypt:n.encrypt,decrypt:n.decrypt}}},9517:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crypto=void 0,t.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},9648:(e,t,r)=>{"use strict";e.exports=i;var n=r(4914);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(6192)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},9750:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DearmorAndDesigncryptStream=t.SigncryptAndArmorStream=t.dearmorAndDesigncrypt=t.signcryptAndArmor=t.verifyDetachedArmored=t.signDetachedAndArmor=t.DearmorAndVerifyStream=t.SignAndArmorStream=t.verifyArmored=t.signAndArmor=t.DearmorAndDecryptStream=t.EncryptAndArmorStream=t.dearmorAndDecrypt=t.encryptAndArmor=t.SymmetricKeyRecipient=t.DesigncryptStream=t.designcrypt=t.SigncryptStream=t.signcrypt=t.verifyDetached=t.signDetached=t.VerifyStream=t.verify=t.SignStream=t.sign=t.DecryptStream=t.decrypt=t.EncryptStream=t.encrypt=t.MessageType=t.DearmorStream=t.dearmor=t.ArmorStream=t.armor=void 0;var n=r(3321);Object.defineProperty(t,"armor",{enumerable:!0,get:function(){return n.armor}}),Object.defineProperty(t,"ArmorStream",{enumerable:!0,get:function(){return n.ArmorStream}}),Object.defineProperty(t,"dearmor",{enumerable:!0,get:function(){return n.dearmor}}),Object.defineProperty(t,"DearmorStream",{enumerable:!0,get:function(){return n.DearmorStream}});var i=r(931);Object.defineProperty(t,"MessageType",{enumerable:!0,get:function(){return i.MessageType}});var s=r(3990);Object.defineProperty(t,"encrypt",{enumerable:!0,get:function(){return s.encrypt}}),Object.defineProperty(t,"EncryptStream",{enumerable:!0,get:function(){return s.EncryptStream}}),Object.defineProperty(t,"decrypt",{enumerable:!0,get:function(){return s.decrypt}}),Object.defineProperty(t,"DecryptStream",{enumerable:!0,get:function(){return s.DecryptStream}});var o=r(3474);Object.defineProperty(t,"sign",{enumerable:!0,get:function(){return o.sign}}),Object.defineProperty(t,"SignStream",{enumerable:!0,get:function(){return o.SignStream}}),Object.defineProperty(t,"verify",{enumerable:!0,get:function(){return o.verify}}),Object.defineProperty(t,"VerifyStream",{enumerable:!0,get:function(){return o.VerifyStream}}),Object.defineProperty(t,"signDetached",{enumerable:!0,get:function(){return o.signDetached}}),Object.defineProperty(t,"verifyDetached",{enumerable:!0,get:function(){return o.verifyDetached}});var a=r(6404);Object.defineProperty(t,"signcrypt",{enumerable:!0,get:function(){return a.signcrypt}}),Object.defineProperty(t,"SigncryptStream",{enumerable:!0,get:function(){return a.SigncryptStream}}),Object.defineProperty(t,"designcrypt",{enumerable:!0,get:function(){return a.designcrypt}}),Object.defineProperty(t,"DesigncryptStream",{enumerable:!0,get:function(){return a.DesigncryptStream}});var c=r(3051);Object.defineProperty(t,"SymmetricKeyRecipient",{enumerable:!0,get:function(){return c.SymmetricKeyRecipient}});var f=r(9862);Object.defineProperty(t,"encryptAndArmor",{enumerable:!0,get:function(){return f.encryptAndArmor}}),Object.defineProperty(t,"dearmorAndDecrypt",{enumerable:!0,get:function(){return f.dearmorAndDecrypt}}),Object.defineProperty(t,"EncryptAndArmorStream",{enumerable:!0,get:function(){return f.EncryptAndArmorStream}}),Object.defineProperty(t,"DearmorAndDecryptStream",{enumerable:!0,get:function(){return f.DearmorAndDecryptStream}}),Object.defineProperty(t,"signAndArmor",{enumerable:!0,get:function(){return f.signAndArmor}}),Object.defineProperty(t,"verifyArmored",{enumerable:!0,get:function(){return f.verifyArmored}}),Object.defineProperty(t,"SignAndArmorStream",{enumerable:!0,get:function(){return f.SignAndArmorStream}}),Object.defineProperty(t,"DearmorAndVerifyStream",{enumerable:!0,get:function(){return f.DearmorAndVerifyStream}}),Object.defineProperty(t,"signDetachedAndArmor",{enumerable:!0,get:function(){return f.signDetachedAndArmor}}),Object.defineProperty(t,"verifyDetachedArmored",{enumerable:!0,get:function(){return f.verifyDetachedArmored}}),Object.defineProperty(t,"signcryptAndArmor",{enumerable:!0,get:function(){return f.signcryptAndArmor}}),Object.defineProperty(t,"dearmorAndDesigncrypt",{enumerable:!0,get:function(){return f.dearmorAndDesigncrypt}}),Object.defineProperty(t,"SigncryptAndArmorStream",{enumerable:!0,get:function(){return f.SigncryptAndArmorStream}}),Object.defineProperty(t,"DearmorAndDesigncryptStream",{enumerable:!0,get:function(){return f.DearmorAndDesigncryptStream}})},9784:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(r,n){function i(r){e.removeListener(t,s),n(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}y(e,t,s,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,i)})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function f(e,t,r,n){var i,s,o,f;if(a(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=c(e))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,f=u,console&&console.warn&&console.warn(f)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=u.bind(n);return i.listener=r,n.wrapFn=i,i}function l(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)})}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var f=c.length,u=p(c,f);for(r=0;r<f;++r)n(u[r],this,t)}return!0},s.prototype.addListener=function(e,t){return f(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return f(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,s,o;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return l(this,e,!0)},s.prototype.rawListeners=function(e){return l(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9862:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DearmorAndDesigncryptStream=t.SigncryptAndArmorStream=t.DearmorAndVerifyStream=t.SignAndArmorStream=t.DearmorAndDecryptStream=t.EncryptAndArmorStream=void 0,t.encryptAndArmor=function(e,t,r){return n(this,void 0,void 0,function*(){const n=yield(0,s.encrypt)(e,t,r);return(0,c.armor)(n,{message_type:c.MessageType.ENCRYPTED_MESSAGE})})},t.dearmorAndDecrypt=function(e,t,r){return n(this,void 0,void 0,function*(){const n=(0,c.dearmor)(e);return Object.assign(yield(0,s.decrypt)(n,t,r),{remaining:n.remaining,header_info:n.header_info})})},t.signAndArmor=function(e,t){return n(this,void 0,void 0,function*(){const r=(0,o.sign)(e,t);return(0,c.armor)(r,{message_type:c.MessageType.SIGNED_MESSAGE})})},t.verifyArmored=function(e,t){return n(this,void 0,void 0,function*(){const r=(0,c.dearmor)(e);return Object.assign(yield(0,o.verify)(r,t),{remaining:r.remaining,header_info:r.header_info})})},t.signDetachedAndArmor=function(e,t){return n(this,void 0,void 0,function*(){const r=(0,o.signDetached)(e,t);return(0,c.armor)(r,{message_type:c.MessageType.DETACHED_SIGNATURE})})},t.verifyDetachedArmored=function(e,t,r){return n(this,void 0,void 0,function*(){const n=(0,c.dearmor)(e),i=yield(0,o.verifyDetached)(n,t,r);return{remaining:n.remaining,header_info:n.header_info,public_key:i.public_key}})},t.signcryptAndArmor=function(e,t,r){return n(this,void 0,void 0,function*(){const n=yield(0,a.signcrypt)(e,t,r);return(0,c.armor)(n,{message_type:c.MessageType.ENCRYPTED_MESSAGE})})},t.dearmorAndDesigncrypt=function(e,t,r){return n(this,void 0,void 0,function*(){const n=(0,c.dearmor)(e);return Object.assign(yield(0,a.designcrypt)(n,t,r),{remaining:n.remaining,header_info:n.header_info})})};const s=r(3990),o=r(3474),a=r(6404),c=r(3321),f=i(r(9126));class u extends f.default{constructor(e,t,r){super(new s.EncryptStream(e,t),new c.ArmorStream(Object.assign({message_type:c.MessageType.ENCRYPTED_MESSAGE},r)))}}t.EncryptAndArmorStream=u;class h extends f.default{constructor(e,t,r){const n=new c.DearmorStream(r),i=new s.DecryptStream(e,t);super(n,i),this.dearmor=n,this.decrypt=i}get info(){return this.dearmor.info}get sender_public_key(){return this.decrypt.sender_public_key}}t.DearmorAndDecryptStream=h;class l extends f.default{constructor(e,t){super(new o.SignStream(e),new c.ArmorStream(Object.assign({message_type:c.MessageType.SIGNED_MESSAGE},t)))}}t.SignAndArmorStream=l;class d extends f.default{constructor(e,t){const r=new c.DearmorStream(t),n=new o.VerifyStream(e);super(r,n),this.dearmor=r,this.verify=n}get info(){return this.dearmor.info}get public_key(){return this.verify.public_key}}t.DearmorAndVerifyStream=d;class p extends f.default{constructor(e,t,r){super(new a.SigncryptStream(e,t),new c.ArmorStream(Object.assign({message_type:c.MessageType.ENCRYPTED_MESSAGE},r)))}}t.SigncryptAndArmorStream=p;class y extends f.default{constructor(e,t){const r=new c.DearmorStream(t),n=new a.DesigncryptStream(e);super(r,n),this.dearmor=r,this.decrypt=n}get info(){return this.dearmor.info}get sender_public_key(){return this.decrypt.sender_public_key}}t.DearmorAndDesigncryptStream=y},9865:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}var c=r(4686).Buffer,f=r(1220).inspect,u=f&&f.custom||"inspect";function h(e,t,r){c.prototype.copy.call(e,t,r)}e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return c.alloc(0);for(var t=c.allocUnsafe(e>>>0),r=this.head,n=0;r;)h(r.data,t,n),n+=r.data.length,r=r.next;return t}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?n+=i:n+=i.slice(0,e),0===(e-=s)){s===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=c.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0===(e-=s)){s===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(s));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return f(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9913:function(e,t,r){"use strict";var n,i=r(4686).Buffer,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&s(t,e,r[i]);return o(t,e),t}),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const f=a(r(931)),u=c(r(9981)),h=r(4406),l=r(568),d=r(2655),p=r(4072);class y extends f.default{constructor(e,t,r){if(super(),!(0,l.isBufferOrUint8Array)(e)||32!==e.length)throw new TypeError("public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||48!==t.length)throw new TypeError("sender_secretbox must be a 48 byte Uint8Array");this.public_key=e,this.sender_secretbox=t,this.recipients=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data[1]}get hash(){return this.encoded_data[0]}static create(e,t,r,n){if(!(0,l.isBufferOrUint8Array)(r)||32!==r.length)throw new TypeError("sender_public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||32!==t.length)throw new TypeError("payload_key must be a 32 byte Uint8Array");return new this(e,(0,h.secretbox)(Uint8Array.from(r),Uint8Array.from(y.SENDER_KEY_SECRETBOX_NONCE),Uint8Array.from(t)),n)}encode(){return y.encodeHeader(this.public_key,this.sender_secretbox,this.recipients)}static encodeHeader(e,t,r){const n=["saltpack",[2,0],f.MessageType.ENCRYPTION,e,t,r.map(e=>[e.anonymous?null:e.public_key,e.encrypted_payload_key])],s=(0,d.encode)(n);return[i.from(p.sha512.create().update(s).digest()),i.from((0,d.encode)(s))]}static decode(e,t=!1){const[r,n]=super.decode1(e,t);if(n[2]!==f.MessageType.ENCRYPTION)throw new Error("Invalid data");const[,,,i,s,o]=n;if(!(o instanceof Array))throw new Error("Invalid data");return new this(i,s,o.map((e,t)=>{if(!(e instanceof Array)||e.length<2)throw new TypeError("Invalid data");return u.default.from(e[0],e[1],t)}))}decryptPayloadKey(e){const t=h.box.before(this.public_key,e.secretKey);for(const r of this.recipients){if(r.public_key&&!i.from(r.public_key).equals(e.publicKey))continue;const n=r.decryptPayloadKey(this.public_key,e.secretKey,t);if(n)return r.setPublicKey(e.publicKey),[n,r]}throw new Error("keypair is not an intended recipient")}decryptSender(e){const t=h.secretbox.open(Uint8Array.from(this.sender_secretbox),Uint8Array.from(y.SENDER_KEY_SECRETBOX_NONCE),Uint8Array.from(e));if(!t)throw new Error("Failed to decrypt sender public key");return t}}y.SENDER_KEY_SECRETBOX_NONCE=i.from("saltpack_sender_key_sbox"),t.default=y},9981:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(4406),s=r(568),o=r(4072);class a{constructor(e,t,r,n=!1){if(this.mac_key=null,null!==e&&(!(0,s.isBufferOrUint8Array)(e)||32!==e.length))throw new TypeError("recipient_public_key must be a 32 byte Uint8Array");if(!(0,s.isBufferOrUint8Array)(t)||48!==t.length)throw new TypeError("payload_key_box must be a 48 byte Uint8Array");if("bigint"!=typeof r)throw new TypeError("index must be a bigint");if("boolean"!=typeof n)throw new TypeError("anonymous must be a boolean");this.public_key=e,this.encrypted_payload_key=t,this.index=r,this.recipient_index=a.generateRecipientIndex(r),this.anonymous=n}setPublicKey(e){this.public_key=e}static create(e,t,r,n,s=!1){"number"==typeof n&&(n=BigInt(n));const o=this.generateRecipientIndex(n);return new this(e,(0,i.box)(Uint8Array.from(r),Uint8Array.from(o),Uint8Array.from(e),Uint8Array.from(t)),n,s)}static from(e,t,r){return"number"==typeof r&&(r=BigInt(r)),new this(e,t,r,null===e)}static generateRecipientIndex(e){const t=n.alloc(8);return t.writeBigUInt64BE(e),n.concat([this.PAYLOAD_KEY_BOX_NONCE_PREFIX_V2,t])}decryptPayloadKey(e,t,r=null){return(r?i.box.open.after(Uint8Array.from(this.encrypted_payload_key),Uint8Array.from(this.recipient_index),Uint8Array.from(r)):i.box.open(Uint8Array.from(this.encrypted_payload_key),Uint8Array.from(this.recipient_index),Uint8Array.from(e),Uint8Array.from(t)))||null}generateMacKeyForSender(e,t,r,s=null){if(!s&&this.public_key&&(s=this.public_key),!s)throw new Error("Generating MAC key requires the recipient's public key");const a=n.alloc(8);a.writeBigUInt64BE(this.index);const c=n.concat([e.slice(0,16),a]);c[15]&=254;const f=(0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(c),Uint8Array.from(s),Uint8Array.from(r));c[15]|=1;const u=(0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(c),Uint8Array.from(s),Uint8Array.from(t)),h=o.sha512.create().update(f.slice(-32)).update(u.slice(-32)).digest().slice(0,32);return this.mac_key=h,n.from(h)}generateMacKeyForRecipient(e,t,r,s){const a=n.alloc(8);a.writeBigUInt64BE(this.index);const c=n.concat([e.slice(0,16),a]);c[15]&=254;const f=(0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(c),Uint8Array.from(r),Uint8Array.from(s));c[15]|=1;const u=(0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(c),Uint8Array.from(t),Uint8Array.from(s)),h=o.sha512.create().update(f.slice(-32)).update(u.slice(-32)).digest().slice(0,32);return this.mac_key=h,n.from(h)}}a.PAYLOAD_KEY_BOX_NONCE_PREFIX_V2=n.from("saltpack_recipsb"),t.default=a},9995:(e,t,r)=>{"use strict";const n=r(896),i=r(8590),s=r(5775),o=r(6899),{MT:a,NUMBYTES:c,SYMS:f}=r(790),{Buffer:u}=r(4686);function h(e){return e>1?"s":""}class l extends n.Transform{constructor(e={}){const{depth:t=1,max_depth:r=10,no_summary:n=!1,tags:i={},preferWeb:a,encoding:c,...f}=e;super({...f,readableObjectMode:!1,writableObjectMode:!1}),this.depth=t,this.max_depth=r,this.all=new o,i[24]||(i[24]=this._tag_24.bind(this)),this.parser=new s({tags:i,max_depth:r,preferWeb:a,encoding:c}),this.parser.on("value",this._on_value.bind(this)),this.parser.on("start",this._on_start.bind(this)),this.parser.on("start-string",this._on_start_string.bind(this)),this.parser.on("stop",this._on_stop.bind(this)),this.parser.on("more-bytes",this._on_more.bind(this)),this.parser.on("error",this._on_error.bind(this)),n||this.parser.on("data",this._on_data.bind(this)),this.parser.bs.on("read",this._on_read.bind(this))}_tag_24(e){const t=new l({depth:this.depth+1,no_summary:!0});t.on("data",e=>this.push(e)),t.on("error",e=>this.emit("error",e)),t.end(e)}_transform(e,t,r){this.parser.write(e,t,r)}_flush(e){return this.parser._flush(e)}static comment(e,t={},r=null){if(null==e)throw new Error("input required");({options:t,cb:r}=function(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"number":return{options:{max_depth:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}(t,r));const n=new o,{encoding:s="hex",...a}=t,c=new l(a);let f=null;return"function"==typeof r?(c.on("end",()=>{r(null,n.toString("utf8"))}),c.on("error",r)):f=new Promise((e,t)=>{c.on("end",()=>{e(n.toString("utf8"))}),c.on("error",t)}),c.pipe(n),i.guessEncoding(e,s).pipe(c),f}_on_error(e){this.push("ERROR: "),this.push(e.toString()),this.push("\n")}_on_read(e){this.all.write(e);const t=e.toString("hex");this.push(new Array(this.depth+1).join("  ")),this.push(t);let r=2*(this.max_depth-this.depth)-t.length;r<1&&(r=1),this.push(new Array(r+1).join(" ")),this.push("-- ")}_on_more(e,t,r,n){let i="";switch(this.depth++,e){case a.POS_INT:i="Positive number,";break;case a.NEG_INT:i="Negative number,";break;case a.ARRAY:i="Array, length";break;case a.MAP:i="Map, count";break;case a.BYTE_STRING:i="Bytes, length";break;case a.UTF8_STRING:i="String, length";break;case a.SIMPLE_FLOAT:i=1===t?"Simple value,":"Float,"}this.push(`${i} next ${t} byte${h(t)}\n`)}_on_start_string(e,t,r,n){let i="";switch(this.depth++,e){case a.BYTE_STRING:i=`Bytes, length: ${t}`;break;case a.UTF8_STRING:i=`String, length: ${t.toString()}`}this.push(`${i}\n`)}_on_start(e,t,r,n){switch(this.depth++,r){case a.ARRAY:this.push(`[${n}], `);break;case a.MAP:n%2?this.push(`{Val:${Math.floor(n/2)}}, `):this.push(`{Key:${Math.floor(n/2)}}, `)}switch(e){case a.TAG:this.push(`Tag #${t}`),24===t&&this.push(" Encoded CBOR data item");break;case a.ARRAY:t===f.STREAM?this.push("Array (streaming)"):this.push(`Array, ${t} item${h(t)}`);break;case a.MAP:t===f.STREAM?this.push("Map (streaming)"):this.push(`Map, ${t} pair${h(t)}`);break;case a.BYTE_STRING:this.push("Bytes (streaming)");break;case a.UTF8_STRING:this.push("String (streaming)")}this.push("\n")}_on_stop(e){this.depth--}_on_value(e,t,r,n){if(e!==f.BREAK)switch(t){case a.ARRAY:this.push(`[${r}], `);break;case a.MAP:r%2?this.push(`{Val:${Math.floor(r/2)}}, `):this.push(`{Key:${Math.floor(r/2)}}, `)}const s=i.cborValueToString(e,-1/0);switch("string"==typeof e||u.isBuffer(e)?(e.length>0&&(this.push(s),this.push("\n")),this.depth--):(this.push(s),this.push("\n")),n){case c.ONE:case c.TWO:case c.FOUR:case c.EIGHT:this.depth--}}_on_data(){this.push("0x"),this.push(this.all.read().toString("hex")),this.push("\n")}}e.exports=l}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(3274)})());
//# sourceMappingURL=vaultysid.min.js.map