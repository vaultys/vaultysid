/*! For license information please see vaultysid.min.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,(()=>(()=>{var e={11:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.Hash=t.nextTick=t.swap32IfBE=t.byteSwapIfBE=t.swap8IfBE=t.isLE=void 0,t.isBytes=i,t.anumber=s,t.abytes=o,t.ahash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");s(e.outputLen),s(e.blockLen)},t.aexists=function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},t.aoutput=function(e,t){o(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)},t.u8=function(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},t.u32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))},t.clean=function(...e){for(let t=0;t<e.length;t++)e[t].fill(0)},t.createView=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},t.rotr=function(e,t){return e<<32-t|e>>>t},t.rotl=function(e,t){return e<<t|e>>>32-t>>>0},t.byteSwap=a,t.byteSwap32=f,t.bytesToHex=function(e){if(o(e),c)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=u[e[r]];return t},t.hexToBytes=function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(c)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=l(e.charCodeAt(i)),s=l(e.charCodeAt(i+1));if(void 0===r||void 0===s){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+s}return n},t.asyncLoop=async function(e,r,n){let i=Date.now();for(let s=0;s<e;s++){n(s);const e=Date.now()-i;e>=0&&e<r||(await(0,t.nextTick)(),i+=e)}},t.utf8ToBytes=d,t.bytesToUtf8=function(e){return(new TextDecoder).decode(e)},t.toBytes=p,t.kdfInputToBytes=function(e){return"string"==typeof e&&(e=d(e)),o(e),e},t.concatBytes=function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];o(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r},t.checkOpts=function(e,t){if(void 0!==t&&"[object Object]"!=={}.toString.call(t))throw new Error("options should be object or undefined");return Object.assign(e,t)},t.createHasher=y,t.createOptHasher=g,t.createXOFer=m,t.randomBytes=function(e=32){if(n.crypto&&"function"==typeof n.crypto.getRandomValues)return n.crypto.getRandomValues(new Uint8Array(e));if(n.crypto&&"function"==typeof n.crypto.randomBytes)return Uint8Array.from(n.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")};const n=r(9517);function i(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function s(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function o(e,...t){if(!i(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function f(e){for(let t=0;t<e.length;t++)e[t]=a(e[t]);return e}t.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],t.swap8IfBE=t.isLE?e=>e:e=>a(e),t.byteSwapIfBE=t.swap8IfBE,t.swap32IfBE=t.isLE?e=>e:f;const c=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),u=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0"))),h={_0:48,_9:57,A:65,F:70,a:97,f:102};function l(e){return e>=h._0&&e<=h._9?e-h._0:e>=h.A&&e<=h.F?e-(h.A-10):e>=h.a&&e<=h.f?e-(h.a-10):void 0}function d(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function p(e){return"string"==typeof e&&(e=d(e)),o(e),e}function y(e){const t=t=>e().update(p(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function g(e){const t=(t,r)=>e(r).update(p(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}function m(e){const t=(t,r)=>e(r).update(p(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}t.nextTick=async()=>{},t.Hash=class{},t.wrapConstructor=y,t.wrapConstructorWithOpts=g,t.wrapXOFConstructorWithOpts=m},45:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7999),s=n(r(1167)),o=n(r(4406)),a=n(r(5800)),f=r(2655),c=n(r(5163)),u=r(4686),h=r(4084),l={usb:1,nfc:2,ble:4,internal:8,hybrid:16,"smart-card":32},d=e=>{const t=s.default.decode(e,{extendedResults:!0}).value.get(1);return 1===t?"Ed25519VerificationKey2020":2===t?"P256VerificationKey2020":"Unknown"},p=e=>{const t=s.default.decode(e,{extendedResults:!0}).value;let r=u.Buffer.from([]);return-7==t.get(3)?r=u.Buffer.concat([u.Buffer.from("04","hex"),t.get(-2),t.get(-3)]):-8==t.get(3)?r=t.get(-2):t.get(3)==h.PQ_COSE_ALG.DILITHIUM2&&(r=t.get(-101)),{publicKey:r}};class y extends c.default{constructor(){super(),this.prfsalt=u.Buffer.from("VaultysID salt")}static async createFromAttestation(e){const t=new y;t.ckey=a.default.getCOSEPublicKey(e),t.authType=d(t.ckey),t.fid=u.Buffer.from(e.id,"base64");const r=e.response,n=r.getTransports?r.getTransports():["usb"];return t._transports=(e=>e.reduceRight(((e,t)=>e+(l[t]?l[t]:0)),0))(n),t.signer=p(t.ckey),await t.getCypher(),delete t.cypher.secretKey,t}getSecret(){return u.Buffer.from((0,f.encode)({v:this.version,f:this.fid,t:this._transports,c:this.ckey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,f.decode)(e),r=new y;return r.version=t.v??0,r.capability="private",r.fid="string"==typeof t.f?u.Buffer.from(t.f,"base64"):t.f,r._transports=t.t?t.t:15,r.ckey=t.c,r.authType=d(r.ckey),r.signer=p(t.c),r.cypher={publicKey:t.e},r}cleanSecureData(){this.cypher?.secretKey&&((0,i.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey)}async getCypher(){if(!this.cypher?.secretKey){const t={challenge:u.Buffer.from([]),userVerification:"preferred",allowCredentials:[{type:"public-key",id:this.fid,transports:(e=this._transports,Object.keys(l).filter((t=>e&&l[t])))}],extensions:{prf:{eval:{first:this.prfsalt}}}},r=await this.webAuthn.get(t),{prf:n}=r.getClientExtensionResults(),i=n?.results?.first;if(!i)throw new Error("PRF failed");const s=o.default.box.keyPair.fromSecretKey(new Uint8Array(i));this.cypher={publicKey:u.Buffer.from(s.publicKey),secretKey:u.Buffer.from(s.secretKey)}}var e;return super.getCypher()}async createRevocationCertificate(){return null}}t.default=y},110:(e,t,r)=>{"use strict";var n,i=r(8704).F,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function f(e){e()}function c(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var u,h=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var l=t.map((function(e,i){var s=i<t.length-1;return function(e,t,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;e.on("close",(function(){a=!0})),void 0===n&&(n=r(2862)),n(e,{readable:t,writable:i},(function(e){if(e)return s(e);a=!0,s()}));var f=!1;return function(t){if(!a&&!f)return f=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void s(t||new o("pipe"))}}(e,s,i>0,(function(e){u||(u=e),e&&l.forEach(f),s||(l.forEach(f),h(u))}))}));return t.reduce(c)}},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XOF256=t.XOF128=t.genCrystals=void 0;const n=r(5391),i=r(6215);function s(e,t=8){const r=e.toString(2).padStart(8,"0").slice(-t).padStart(7,"0").split("").reverse().join("");return Number.parseInt(r,2)}t.genCrystals=e=>{const{newPoly:t,N:r,Q:n,F:o,ROOT_OF_UNITY:a,brvBits:f,isKyber:c}=e,u=(e,t=n)=>{const r=e%t|0;return 0|(r>=0?r:t+r)},h=function(){const e=t(r);for(let t=0;t<r;t++){const r=s(t,f),i=BigInt(a)**BigInt(r)%BigInt(n);e[t]=0|Number(i)}return e}(),l=c?128:r,d=c?1:0,p={encode:e=>{for(let t=1,n=128;n>d;n>>=1)for(let i=0;i<r;i+=2*n){const r=h[t++];for(let t=i;t<i+n;t++){const i=u(r*e[t+n]);e[t+n]=0|u(e[t]-i),e[t]=0|u(e[t]+i)}}return e},decode:e=>{for(let t=l-1,n=1+d;n<l+d;n<<=1)for(let i=0;i<r;i+=2*n){const r=h[t--];for(let t=i;t<i+n;t++){const i=e[t];e[t]=u(i+e[t+n]),e[t+n]=u(r*(e[t+n]-i))}}for(let t=0;t<e.length;t++)e[t]=u(o*e[t]);return e}};return{mod:u,smod:(e,t=n)=>{const r=0|u(e,t);return 0|(r>t>>1?r-t:r)},nttZetas:h,NTT:p,bitsCoder:(e,n)=>{const s=(0,i.getMask)(e),o=e*(r/8);return{bytesLen:o,encode:t=>{const r=new Uint8Array(o);for(let o=0,a=0,f=0,c=0;o<t.length;o++)for(a|=(n.encode(t[o])&s)<<f,f+=e;f>=8;f-=8,a>>=8)r[c++]=a&(0,i.getMask)(f);return r},decode:i=>{const o=t(r);for(let t=0,r=0,a=0,f=0;t<i.length;t++)for(r|=i[t]<<a,a+=8;a>=e;a-=e,r>>=e)o[f++]=n.decode(r&s);return o}}}}};const o=e=>(t,r)=>{r||(r=e.blockLen);const n=new Uint8Array(t.length+2);n.set(t);const i=t.length,s=new Uint8Array(r);let o=e.create({}),a=0,f=0;return{stats:()=>({calls:a,xofs:f}),get:(t,r)=>(n[i+0]=t,n[i+1]=r,o.destroy(),o=e.create({}).update(n),a++,()=>(f++,o.xofInto(s))),clean:()=>{o.destroy(),s.fill(0),n.fill(0)}}};t.XOF128=o(n.shake128),t.XOF256=o(n.shake256)},407:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.negateCt=a,t.normalizeZ=function(e,t,r){const n="pz"===t?e=>e.pz:e=>e.ez,s=(0,i.FpInvertBatch)(e.Fp,r.map(n));return r.map(((e,t)=>e.toAffine(s[t]))).map(e.fromAffine)},t.wNAF=function(e,t){return{constTimeNegate:a,hasPrecomputes:e=>1!==y(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>s;)r&o&&(n=n.add(i)),i=i.double(),r>>=o;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=c(r,t),s=[];let o=e,a=o;for(let e=0;e<n;e++){a=o,s.push(a);for(let e=1;e<i;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(r,n,i){let s=e.ZERO,o=e.BASE;const f=c(r,t);for(let e=0;e<f.windows;e++){const{nextN:t,offset:r,isZero:c,isNeg:h,isNegF:l,offsetF:d}=u(i,e,f);i=t,c?o=o.add(a(l,n[d])):s=s.add(a(h,n[r]))}return g(i),{p:s,f:o}},wNAFUnsafe(r,n,i,o=e.ZERO){const a=c(r,t);for(let e=0;e<a.windows&&i!==s;e++){const{nextN:t,offset:r,isZero:s,isNeg:f}=u(i,e,a);if(i=t,!s){const e=n[r];o=o.add(f?e.negate():e)}}return g(i),o},getPrecomputes(e,t,r){let n=d.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),d.set(t,n))),n},wNAFCached(e,t,r){const n=y(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=y(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){f(r,t),p.set(e,r),d.delete(e)}}},t.mulEndoUnsafe=function(e,t,r,n){let i=t,a=e.ZERO,f=e.ZERO;for(;r>s||n>s;)r&o&&(a=a.add(i)),n&o&&(f=f.add(i)),i=i.double(),r>>=o,n>>=o;return{p1:a,p2:f}},t.pippenger=function(e,t,r,i){h(r,e),l(i,t);const s=r.length,o=i.length;if(s!==o)throw new Error("arrays of points and scalars must have equal length");const a=e.ZERO,f=(0,n.bitLen)(BigInt(s));let c=1;f>12?c=f-3:f>4?c=f-2:f>0&&(c=2);const u=(0,n.bitMask)(c),d=new Array(Number(u)+1).fill(a);let p=a;for(let e=Math.floor((t.BITS-1)/c)*c;e>=0;e-=c){d.fill(a);for(let t=0;t<o;t++){const n=i[t],s=Number(n>>BigInt(e)&u);d[s]=d[s].add(r[t])}let t=a;for(let e=d.length-1,r=a;e>0;e--)r=r.add(d[e]),t=t.add(r);if(p=p.add(t),0!==e)for(let e=0;e<c;e++)p=p.double()}return p},t.precomputeMSMUnsafe=function(e,t,r,i){f(i,t.BITS),h(r,e);const s=e.ZERO,o=2**i-1,a=Math.ceil(t.BITS/i),c=(0,n.bitMask)(i),u=r.map((e=>{const t=[];for(let r=0,n=e;r<o;r++)t.push(n),n=n.add(e);return t}));return e=>{if(l(e,t),e.length>r.length)throw new Error("array of scalars must be smaller than array of points");let n=s;for(let t=0;t<a;t++){if(n!==s)for(let e=0;e<i;e++)n=n.double();const r=BigInt(a*i-(t+1)*i);for(let t=0;t<e.length;t++){const i=e[t],s=Number(i>>r&c);s&&(n=n.add(u[t][s-1]))}}return n}},t.validateBasic=function(e){return(0,i.validateField)(e.Fp),(0,n.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,i.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})},t._createCurveFields=function(e,t,r={}){if(!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const r=t[e];if(!("bigint"==typeof r&&r>s))throw new Error(`CURVE.${e} must be positive bigint`)}const n=m(t.p,r.Fp),i=m(t.n,r.Fn),o=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const e of o)if(!n.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}};const n=r(6376),i=r(7342),s=BigInt(0),o=BigInt(1);function a(e,t){const r=t.negate();return e?r:t}function f(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function c(e,t){f(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:(0,n.bitMask)(e),maxNumber:r,shiftBy:BigInt(e)}}function u(e,t,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:a}=r;let f=Number(e&i),c=e>>a;f>n&&(f-=s,c+=o);const u=t*n;return{nextN:c,offset:u+Math.abs(f)-1,isZero:0===f,isNeg:f<0,isNegF:t%2!=0,offsetF:u}}function h(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)}))}function l(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)}))}const d=new WeakMap,p=new WeakMap;function y(e){return p.get(e)||1}function g(e){if(e!==s)throw new Error("invalid wNAF")}function m(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,i.validateField)(t),t}return(0,i.Field)(e)}},790:(e,t)=>{"use strict";t.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},t.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36,SET:258},t.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},t.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},t.SYMS={NULL:Symbol.for("github.com/hildjj/node-cbor/null"),UNDEFINED:Symbol.for("github.com/hildjj/node-cbor/undef"),PARENT:Symbol.for("github.com/hildjj/node-cbor/parent"),BREAK:Symbol.for("github.com/hildjj/node-cbor/break"),STREAM:Symbol.for("github.com/hildjj/node-cbor/stream")},t.SHIFT32=4294967296,t.BI={MINUS_ONE:BigInt(-1),NEG_MAX:BigInt(-1)-BigInt(Number.MAX_SAFE_INTEGER),MAXINT32:BigInt("0xffffffff"),MAXINT64:BigInt("0xffffffffffffffff"),SHIFT32:BigInt(t.SHIFT32)}},896:(e,t,r)=>{e.exports=i;var n=r(9784).EventEmitter;function i(){n.call(this)}r(6192)(i,n),i.Readable=r(4324),i.Writable=r(6868),i.Duplex=r(5606),i.Transform=r(4914),i.PassThrough=r(9648),i.finished=r(2862),i.pipeline=r(110),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",s),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",f));var o=!1;function a(){o||(o=!0,e.end())}function f(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(u(),0===n.listenerCount(this,"error"))throw e}function u(){r.removeListener("data",i),e.removeListener("drain",s),r.removeListener("end",a),r.removeListener("close",f),r.removeListener("error",c),e.removeListener("error",c),r.removeListener("end",u),r.removeListener("close",u),e.removeListener("close",u)}return r.on("error",c),e.on("error",c),r.on("end",u),r.on("close",u),e.on("close",u),e.emit("pipe",r),e}},1163:(e,t,r)=>{"use strict";const n=r(790),i=r(8590),s=Symbol("INTERNAL_JSON");function o(e,t){if(i.isBufferish(e))e.toJSON=t;else if(Array.isArray(e))for(const r of e)o(r,t);else if(e&&"object"==typeof e&&(!(e instanceof p)||e.tag<21||e.tag>23))for(const r of Object.values(e))o(r,t)}function a(){return i.base64(this)}function f(){return i.base64url(this)}function c(){return this.toString("hex")}const u={0:e=>new Date(e),1:e=>new Date(1e3*e),2:e=>i.bufferToBigInt(e),3:e=>n.BI.MINUS_ONE-i.bufferToBigInt(e),21:(e,t)=>(i.isBufferish(e)?t[s]=f:o(e,f),t),22:(e,t)=>(i.isBufferish(e)?t[s]=a:o(e,a),t),23:(e,t)=>(i.isBufferish(e)?t[s]=c:o(e,c),t),32:e=>new URL(e),33:(e,t)=>{if(!e.match(/^[a-zA-Z0-9_-]+$/))throw new Error("Invalid base64url characters");const r=e.length%4;if(1===r)throw new Error("Invalid base64url length");if(2===r){if(-1==="AQgw".indexOf(e[e.length-1]))throw new Error("Invalid base64 padding")}else if(3===r&&-1==="AEIMQUYcgkosw048".indexOf(e[e.length-1]))throw new Error("Invalid base64 padding");return t},34:(e,t)=>{const r=e.match(/^[a-zA-Z0-9+/]+(?<padding>={0,2})$/);if(!r)throw new Error("Invalid base64 characters");if(e.length%4!=0)throw new Error("Invalid base64 length");if("="===r.groups.padding){if(-1==="AQgw".indexOf(e[e.length-2]))throw new Error("Invalid base64 padding")}else if("=="===r.groups.padding&&-1==="AEIMQUYcgkosw048".indexOf(e[e.length-3]))throw new Error("Invalid base64 padding");return t},35:e=>new RegExp(e),258:e=>new Set(e)},h={64:Uint8Array,65:Uint16Array,66:Uint32Array,68:Uint8ClampedArray,69:Uint16Array,70:Uint32Array,72:Int8Array,73:Int16Array,74:Int32Array,77:Int16Array,78:Int32Array,81:Float32Array,82:Float64Array,85:Float32Array,86:Float64Array};function l(e,t){if(!i.isBufferish(e))throw new TypeError("val not a buffer");const{tag:r}=t,n=h[r];if(!n)throw new Error(`Invalid typed array tag: ${r}`);const s=2**(((16&r)>>4)+(3&r));return!(4&r)!==i.isBigEndian()&&s>1&&function(e,t,r,n){const i=new DataView(e),[s,o]={2:[i.getUint16,i.setUint16],4:[i.getUint32,i.setUint32],8:[i.getBigUint64,i.setBigUint64]}[t],a=r+n;for(let e=r;e<a;e+=t)o.call(i,e,s.call(i,e,!0))}(e.buffer,s,e.byteOffset,e.byteLength),new n(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}"undefined"!=typeof BigUint64Array&&(h[67]=BigUint64Array,h[71]=BigUint64Array),"undefined"!=typeof BigInt64Array&&(h[75]=BigInt64Array,h[79]=BigInt64Array);for(const e of Object.keys(h))u[e]=l;let d={};class p{constructor(e,t,r){if(this.tag=e,this.value=t,this.err=r,"number"!=typeof this.tag)throw new Error(`Invalid tag type (${typeof this.tag})`);if(this.tag<0||(0|this.tag)!==this.tag)throw new Error(`Tag must be a positive integer: ${this.tag}`)}toJSON(){if(this[s])return this[s].call(this.value);const e={tag:this.tag,value:this.value};return this.err&&(e.err=this.err),e}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){let t=null==e?void 0:e[this.tag];if(null===t)return this;if("function"!=typeof t&&(t=p.TAGS[this.tag],"function"!=typeof t))return this;try{return t.call(this,this.value,this)}catch(e){return e&&e.message&&e.message.length>0?this.err=e.message:this.err=e,this}}static get TAGS(){return d}static set TAGS(e){d=e}static reset(){p.TAGS={...u}}}p.INTERNAL_JSON=s,p.reset(),e.exports=p},1164:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DER=t.DERErr=void 0,t._legacyHelperEquat=p,t._legacyHelperNormPriv=y,t.weierstrassN=g,t.weierstrassPoints=function(e){const{CURVE:t,curveOpts:r}=w(e);return function(e,t){const{Fp:r,Fn:n}=t;const s=p(r,e.a,e.b),o=y(n,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:o,weierstrassEquation:s,isWithinCurveOrder:function(e){return(0,i.inRange)(e,u,n.ORDER)}})}(e,g(t,r))},t.ecdsa=b,t.weierstrass=function(e){const{CURVE:t,curveOpts:r,ecdsaOpts:n}=function(e){const{CURVE:t,curveOpts:r}=w(e);return{CURVE:t,curveOpts:r,ecdsaOpts:{hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}(e);return function(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}(e,b(g(t,r),n,r))},t.SWUFpSqrtRatio=v,t.mapToCurveSimpleSWU=function(e,t){(0,o.validateField)(e);const{A:r,B:n,Z:i}=t;if(!e.isValid(r)||!e.isValid(n)||!e.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const s=v(e,i);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return t=>{let a,f,c,u,h,l,d,p;a=e.sqr(t),a=e.mul(a,i),f=e.sqr(a),f=e.add(f,a),c=e.add(f,e.ONE),c=e.mul(c,n),u=e.cmov(i,e.neg(f),!e.eql(f,e.ZERO)),u=e.mul(u,r),f=e.sqr(c),l=e.sqr(u),h=e.mul(l,r),f=e.add(f,h),f=e.mul(f,c),l=e.mul(l,u),h=e.mul(l,n),f=e.add(f,h),d=e.mul(a,c);const{isValid:y,value:g}=s(f,l);p=e.mul(a,t),p=e.mul(p,g),d=e.cmov(d,c,y),p=e.cmov(p,g,y);const m=e.isOdd(t)===e.isOdd(p);p=e.cmov(e.neg(p),p,m);const b=(0,o.FpInvertBatch)(e,[u],!0)[0];return d=e.mul(d,b),{x:d,y:p}}};const n=r(3835),i=r(6376),s=r(407),o=r(7342);function a(e){void 0!==e.lowS&&(0,i.abool)("lowS",e.lowS),void 0!==e.prehash&&(0,i.abool)("prehash",e.prehash)}class f extends Error{constructor(e=""){super(e)}}t.DERErr=f,t.DER={Err:f,_tlv:{encode:(e,r)=>{const{Err:n}=t.DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&r.length)throw new n("tlv.encode: unpadded data");const s=r.length/2,o=(0,i.numberToHexUnpadded)(s);if(o.length/2&128)throw new n("tlv.encode: long form length too big");const a=s>127?(0,i.numberToHexUnpadded)(o.length/2|128):"";return(0,i.numberToHexUnpadded)(e)+a+o+r},decode(e,r){const{Err:n}=t.DER;let i=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(r.length<2||r[i++]!==e)throw new n("tlv.decode: wrong tlv");const s=r[i++];let o=0;if(128&s){const e=127&s;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const t=r.subarray(i,i+e);if(t.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===t[0])throw new n("tlv.decode(long): zero leftmost byte");for(const e of t)o=o<<8|e;if(i+=e,o<128)throw new n("tlv.decode(long): not minimal encoding")}else o=s;const a=r.subarray(i,i+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:r.subarray(i+o)}}},_int:{encode(e){const{Err:r}=t.DER;if(e<c)throw new r("integer: negative integers are not allowed");let n=(0,i.numberToHexUnpadded)(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new r("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:r}=t.DER;if(128&e[0])throw new r("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new r("invalid signature integer: unnecessary leading zero");return(0,i.bytesToNumberBE)(e)}},toSig(e){const{Err:r,_int:n,_tlv:s}=t.DER,o=(0,i.ensureBytes)("signature",e),{v:a,l:f}=s.decode(48,o);if(f.length)throw new r("invalid signature: left bytes after parsing");const{v:c,l:u}=s.decode(2,a),{v:h,l}=s.decode(2,u);if(l.length)throw new r("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(h)}},hexFromSig(e){const{_tlv:r,_int:n}=t.DER,i=r.encode(2,n.encode(e.r))+r.encode(2,n.encode(e.s));return r.encode(48,i)}};const c=BigInt(0),u=BigInt(1),h=BigInt(2),l=BigInt(3),d=BigInt(4);function p(e,t,r){return function(n){const i=e.sqr(n),s=e.mul(i,n);return e.add(e.add(s,e.mul(n,t)),r)}}function y(e,t,r){const{BYTES:n}=e;return function(s){let o;if("bigint"==typeof s)o=s;else{let r=(0,i.ensureBytes)("private key",s);if(t){if(!t.includes(2*r.length))throw new Error("invalid private key");const e=new Uint8Array(n);e.set(r,e.length-r.length),r=e}try{o=e.fromBytes(r)}catch(e){throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof s}`)}}if(r&&(o=e.create(o)),!e.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}}function g(e,t={}){const{Fp:r,Fn:n}=(0,s._createCurveFields)("weierstrass",e,t),{h:o,n:a}=e;(0,i._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:f}=t;if(f&&(!r.is0(e.a)||"bigint"!=typeof f.beta||"function"!=typeof f.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function h(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const g=t.toBytes||function(e,t,n){const{x:s,y:o}=t.toAffine(),a=r.toBytes(s);if((0,i.abool)("isCompressed",n),n){h();const e=!r.isOdd(o);return(0,i.concatBytes)(m(e),a)}return(0,i.concatBytes)(Uint8Array.of(4),a,r.toBytes(o))},b=t.fromBytes||function(e){(0,i.abytes)(e);const t=r.BYTES,n=t+1,s=2*t+1,o=e.length,a=e[0],f=e.subarray(1);if(o!==n||2!==a&&3!==a){if(o===s&&4===a){const e=r.fromBytes(f.subarray(0*t,1*t)),n=r.fromBytes(f.subarray(1*t,2*t));if(!v(e,n))throw new Error("bad point: is not on curve");return{x:e,y:n}}throw new Error(`bad point: got length ${o}, expected compressed=${n} or uncompressed=${s}`)}{const e=r.fromBytes(f);if(!r.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=w(e);let n;try{n=r.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}return h(),!(1&~a)!==r.isOdd(n)&&(n=r.neg(n)),{x:e,y:n}}},w=p(r,e.a,e.b);function v(e,t){const n=r.sqr(t),i=w(e);return r.eql(n,i)}if(!v(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const E=r.mul(r.pow(e.a,l),d),B=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(E,B)))throw new Error("bad curve params: a or b");function _(e,t,n=!1){if(!r.isValid(t)||n&&r.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function S(e){if(!(e instanceof T))throw new Error("ProjectivePoint expected")}const A=(0,i.memoized)(((e,t)=>{const{px:n,py:i,pz:s}=e;if(r.eql(s,r.ONE))return{x:n,y:i};const o=e.is0();null==t&&(t=o?r.ONE:r.inv(s));const a=r.mul(n,t),f=r.mul(i,t),c=r.mul(s,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(c,r.ONE))throw new Error("invZ was invalid");return{x:a,y:f}})),I=(0,i.memoized)((e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not field elements");if(!v(n,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));function x(e,t,n,i,o){return n=new T(r.mul(n.px,e),n.py,n.pz),t=(0,s.negateCt)(i,t),n=(0,s.negateCt)(o,n),t.add(n)}class T{constructor(e,t,r){this.px=_("x",e),this.py=_("y",t,!0),this.pz=_("z",r),Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof T)throw new Error("projective point not allowed");return r.is0(t)&&r.is0(n)?T.ZERO:new T(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){return(0,s.normalizeZ)(T,"pz",e)}static fromBytes(e){return(0,i.abytes)(e),T.fromHex(e)}static fromHex(e){const t=T.fromAffine(b((0,i.ensureBytes)("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){const r=y(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return T.BASE.multiply(r(e))}static msm(e,t){return(0,s.pippenger)(T,n,e,t)}precompute(e=8,t=!0){return O.setWindowSize(this,e),t||this.multiply(l),this}_setWindowSize(e){this.precompute(e)}assertValidity(){I(this)}hasEvenY(){const{y:e}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){S(e);const{px:t,py:n,pz:i}=this,{px:s,py:o,pz:a}=e,f=r.eql(r.mul(t,a),r.mul(s,i)),c=r.eql(r.mul(n,a),r.mul(o,i));return f&&c}negate(){return new T(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,l),{px:s,py:o,pz:a}=this;let f=r.ZERO,c=r.ZERO,u=r.ZERO,h=r.mul(s,s),d=r.mul(o,o),p=r.mul(a,a),y=r.mul(s,o);return y=r.add(y,y),u=r.mul(s,a),u=r.add(u,u),f=r.mul(t,u),c=r.mul(i,p),c=r.add(f,c),f=r.sub(d,c),c=r.add(d,c),c=r.mul(f,c),f=r.mul(y,f),u=r.mul(i,u),p=r.mul(t,p),y=r.sub(h,p),y=r.mul(t,y),y=r.add(y,u),u=r.add(h,h),h=r.add(u,h),h=r.add(h,p),h=r.mul(h,y),c=r.add(c,h),p=r.mul(o,a),p=r.add(p,p),h=r.mul(p,y),f=r.sub(f,h),u=r.mul(p,d),u=r.add(u,u),u=r.add(u,u),new T(f,c,u)}add(t){S(t);const{px:n,py:i,pz:s}=this,{px:o,py:a,pz:f}=t;let c=r.ZERO,u=r.ZERO,h=r.ZERO;const d=e.a,p=r.mul(e.b,l);let y=r.mul(n,o),g=r.mul(i,a),m=r.mul(s,f),b=r.add(n,i),w=r.add(o,a);b=r.mul(b,w),w=r.add(y,g),b=r.sub(b,w),w=r.add(n,s);let v=r.add(o,f);return w=r.mul(w,v),v=r.add(y,m),w=r.sub(w,v),v=r.add(i,s),c=r.add(a,f),v=r.mul(v,c),c=r.add(g,m),v=r.sub(v,c),h=r.mul(d,w),c=r.mul(p,m),h=r.add(c,h),c=r.sub(g,h),h=r.add(g,h),u=r.mul(c,h),g=r.add(y,y),g=r.add(g,y),m=r.mul(d,m),w=r.mul(p,w),g=r.add(g,m),m=r.sub(y,m),m=r.mul(d,m),w=r.add(w,m),y=r.mul(g,w),u=r.add(u,y),y=r.mul(v,w),c=r.mul(b,c),c=r.sub(c,y),y=r.mul(b,g),h=r.mul(v,h),h=r.add(h,y),new T(c,u,h)}subtract(e){return this.add(e.negate())}is0(){return this.equals(T.ZERO)}multiply(e){const{endo:r}=t;if(!n.isValidNot0(e))throw new Error("invalid scalar: out of range");let i,s;const o=e=>O.wNAFCached(this,e,T.normalizeZ);if(r){const{k1neg:t,k1:n,k2neg:a,k2:f}=r.splitScalar(e),{p:c,f:u}=o(n),{p:h,f:l}=o(f);s=u.add(l),i=x(r.beta,c,h,t,a)}else{const{p:t,f:r}=o(e);i=t,s=r}return T.normalizeZ([i,s])[0]}multiplyUnsafe(e){const{endo:r}=t,i=this;if(!n.isValid(e))throw new Error("invalid scalar: out of range");if(e===c||i.is0())return T.ZERO;if(e===u)return i;if(O.hasPrecomputes(this))return this.multiply(e);if(r){const{k1neg:t,k1:n,k2neg:o,k2:a}=r.splitScalar(e),{p1:f,p2:c}=(0,s.mulEndoUnsafe)(T,i,n,a);return x(r.beta,f,c,t,o)}return O.wNAFCachedUnsafe(i,e)}multiplyAndAddUnsafe(e,t,r){const n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(e){return A(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return o===u||(e?e(T,this):O.wNAFCachedUnsafe(this,a).is0())}clearCofactor(){const{clearCofactor:e}=t;return o===u?this:e?e(T,this):this.multiplyUnsafe(o)}toBytes(e=!0){return(0,i.abool)("isCompressed",e),this.assertValidity(),g(T,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return(0,i.bytesToHex)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}T.BASE=new T(e.Gx,e.Gy,r.ONE),T.ZERO=new T(r.ZERO,r.ONE,r.ZERO),T.Fp=r,T.Fn=n;const U=n.BITS,O=(0,s.wNAF)(T,t.endo?Math.ceil(U/2):U);return T}function m(e){return Uint8Array.of(e?2:3)}function b(e,r,s={}){(0,i._validateObject)(r,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const f=r.randomBytes||i.randomBytes,l=r.hmac||((e,...t)=>(0,n.hmac)(r.hash,e,(0,i.concatBytes)(...t))),{Fp:d,Fn:p}=e,{ORDER:g,BITS:b}=p;function w(e){return e>g>>u}function v(e,t){if(!p.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..CURVE.n`)}class E{constructor(e,t,r){v("r",e),v("s",t),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){const t=p.BYTES,r=(0,i.ensureBytes)("compactSignature",e,2*t);return new E(p.fromBytes(r.subarray(0,t)),p.fromBytes(r.subarray(t,2*t)))}static fromDER(e){const{r,s:n}=t.DER.toSig((0,i.ensureBytes)("DER",e));return new E(r,n)}assertValidity(){}addRecoveryBit(e){return new E(this.r,this.s,e)}recoverPublicKey(t){const r=d.ORDER,{r:n,s,recovery:o}=this;if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");if(g*h<r&&o>1)throw new Error("recovery id is ambiguous for h>1 curve");const a=2===o||3===o?n+g:n;if(!d.isValid(a))throw new Error("recovery id 2 or 3 invalid");const f=d.toBytes(a),c=e.fromHex((0,i.concatBytes)(m(!(1&o)),f)),u=p.inv(a),l=I((0,i.ensureBytes)("msgHash",t)),y=p.create(-l*u),b=p.create(s*u),w=e.BASE.multiplyUnsafe(y).add(c.multiplyUnsafe(b));if(w.is0())throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new E(this.r,p.neg(this.s),this.recovery):this}toBytes(e){if("compact"===e)return(0,i.concatBytes)(p.toBytes(this.r),p.toBytes(this.s));if("der"===e)return(0,i.hexToBytes)(t.DER.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,i.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,i.bytesToHex)(this.toBytes("compact"))}}const B=y(p,s.allowedPrivateKeyLengths,s.wrapPrivateKey),_={isValidPrivateKey(e){try{return B(e),!0}catch(e){return!1}},normPrivateKeyToScalar:B,randomPrivateKey:()=>{const e=g;return(0,o.mapHashToField)(f((0,o.getMinHashLength)(e)),e)},precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)};function S(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const r=(0,i.ensureBytes)("key",t).length,n=d.BYTES,o=n+1,a=2*n+1;return s.allowedPrivateKeyLengths||p.BYTES===o?void 0:r===o||r===a}const A=r.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=(0,i.bytesToNumberBE)(e),r=8*e.length-b;return r>0?t>>BigInt(r):t},I=r.bits2int_modN||function(e){return p.create(A(e))},x=(0,i.bitMask)(b);function T(e){return(0,i.aInRange)("num < 2^"+b,e,c,x),p.toBytes(e)}const U={lowS:r.lowS,prehash:!1},O={lowS:r.lowS,prehash:!1};return e.BASE.precompute(8),Object.freeze({getPublicKey:function(t,r=!0){return e.fromPrivateKey(t).toBytes(r)},getSharedSecret:function(t,r,n=!0){if(!0===S(t))throw new Error("first arg must be private key");if(!1===S(r))throw new Error("second arg must be public key");return e.fromHex(r).multiply(B(t)).toBytes(n)},sign:function(t,n,s=U){const{seed:o,k2sig:h}=function(t,n,s=U){if(["recovered","canonical"].some((e=>e in s)))throw new Error("sign() legacy options not supported");const{hash:o}=r;let{lowS:h,prehash:l,extraEntropy:y}=s;null==h&&(h=!0),t=(0,i.ensureBytes)("msgHash",t),a(s),l&&(t=(0,i.ensureBytes)("prehashed msgHash",o(t)));const g=I(t),m=B(n),b=[T(m),T(g)];if(null!=y&&!1!==y){const e=!0===y?f(d.BYTES):y;b.push((0,i.ensureBytes)("extraEntropy",e))}const v=(0,i.concatBytes)(...b),_=g;return{seed:v,k2sig:function(t){const r=A(t);if(!p.isValidNot0(r))return;const n=p.inv(r),i=e.BASE.multiply(r).toAffine(),s=p.create(i.x);if(s===c)return;const o=p.create(n*p.create(_+s*m));if(o===c)return;let a=(i.x===s?0:2)|Number(i.y&u),f=o;return h&&w(o)&&(f=function(e){return w(e)?p.neg(e):e}(o),a^=1),new E(s,f,a)}}}(t,n,s);return(0,i.createHmacDrbg)(r.hash.outputLen,p.BYTES,l)(o,h)},verify:function(n,s,o,f=O){const c=n;s=(0,i.ensureBytes)("msgHash",s),o=(0,i.ensureBytes)("publicKey",o),a(f);const{lowS:u,prehash:h,format:l}=f;if("strict"in f)throw new Error("options.strict was renamed to lowS");if(void 0!==l&&!["compact","der","js"].includes(l))throw new Error('format must be "compact", "der" or "js"');const d="string"==typeof c||(0,i.isBytes)(c),y=!d&&!l&&"object"==typeof c&&null!==c&&"bigint"==typeof c.r&&"bigint"==typeof c.s;if(!d&&!y)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let g,m;try{if(y){if(void 0!==l&&"js"!==l)throw new Error("invalid format");g=new E(c.r,c.s)}if(d){try{"compact"!==l&&(g=E.fromDER(c))}catch(e){if(!(e instanceof t.DER.Err))throw e}g||"der"===l||(g=E.fromCompact(c))}m=e.fromHex(o)}catch(e){return!1}if(!g)return!1;if(u&&g.hasHighS())return!1;h&&(s=r.hash(s));const{r:b,s:w}=g,v=I(s),B=p.inv(w),_=p.create(v*B),S=p.create(b*B),A=e.BASE.multiplyUnsafe(_).add(m.multiplyUnsafe(S));return!A.is0()&&p.create(A.x)===b},utils:_,Point:e,Signature:E})}function w(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:(0,o.Field)(t.n,e.nBitLength),allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}function v(e,t){const r=e.ORDER;let n=c;for(let e=r-u;e%h===c;e/=h)n+=u;const i=n,s=h<<i-u-u,o=s*h,a=(r-u)/o,f=(a-u)/h,p=o-u,y=s,g=e.pow(t,a),m=e.pow(t,(a+u)/h);let b=(t,r)=>{let n=g,s=e.pow(r,p),o=e.sqr(s);o=e.mul(o,r);let a=e.mul(t,o);a=e.pow(a,f),a=e.mul(a,s),s=e.mul(a,r),o=e.mul(a,t);let c=e.mul(o,s);a=e.pow(c,y);let l=e.eql(a,e.ONE);s=e.mul(o,m),a=e.mul(c,n),o=e.cmov(s,o,l),c=e.cmov(a,c,l);for(let t=i;t>u;t--){let r=t-h;r=h<<r-u;let i=e.pow(c,r);const a=e.eql(i,e.ONE);s=e.mul(o,n),n=e.mul(n,n),i=e.mul(c,n),o=e.cmov(s,o,a),c=e.cmov(i,c,a)}return{isValid:l,value:o}};if(e.ORDER%d===l){const r=(e.ORDER-l)/d,n=e.sqrt(e.neg(t));b=(t,i)=>{let s=e.sqr(i);const o=e.mul(t,i);s=e.mul(s,o);let a=e.pow(s,r);a=e.mul(a,o);const f=e.mul(a,n),c=e.mul(e.sqr(a),i),u=e.eql(c,t);return{isValid:u,value:e.cmov(f,a,u)}}}return b}},1167:(e,t,r)=>{"use strict";const n=r(9995),i=r(9055),s=r(5775),o=r(3271),a=r(9109),f=r(1163),c=r(5713),u=r(3105);e.exports={Commented:n,Diagnose:i,Decoder:s,Encoder:o,Simple:a,Tagged:f,Map:c,SharedValueEncoder:u,comment:n.comment,decodeAll:s.decodeAll,decodeFirst:s.decodeFirst,decodeAllSync:s.decodeAllSync,decodeFirstSync:s.decodeFirstSync,diagnose:i.diagnose,encode:o.encode,encodeCanonical:o.encodeCanonical,encodeOne:o.encodeOne,encodeAsync:o.encodeAsync,decode:s.decodeFirstSync,leveldb:{decode:s.decodeFirstSync,encode:o.encode,buffer:!0,name:"cbor"},reset(){o.reset(),f.reset()}}},1220:()=>{},1348:(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return!1}catch(e){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},1440:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp256r1=t.p256=void 0;const n=r(2355);t.p256=n.p256,t.secp256r1=n.p256,t.hashToCurve=n.p256_hasher.hashToCurve,t.encodeToCurve=n.p256_hasher.encodeToCurve},1569:(e,t,r)=>{"use strict";r.r(t),Object.defineProperty(exports,"__esModule",{value:!0}),exports.DearmorAndDesigncryptStream=exports.SigncryptAndArmorStream=exports.dearmorAndDesigncrypt=exports.signcryptAndArmor=exports.verifyDetachedArmored=exports.signDetachedAndArmor=exports.DearmorAndVerifyStream=exports.SignAndArmorStream=exports.verifyArmored=exports.signAndArmor=exports.DearmorAndDecryptStream=exports.EncryptAndArmorStream=exports.dearmorAndDecrypt=exports.encryptAndArmor=exports.SymmetricKeyRecipient=exports.DesigncryptStream=exports.designcrypt=exports.SigncryptStream=exports.signcrypt=exports.verifyDetached=exports.signDetached=exports.VerifyStream=exports.verify=exports.SignStream=exports.sign=exports.DecryptStream=exports.decrypt=exports.EncryptStream=exports.encrypt=exports.MessageType=exports.DearmorStream=exports.dearmor=exports.ArmorStream=exports.armor=void 0;var n=require("./armor");Object.defineProperty(exports,"armor",{enumerable:!0,get:function(){return n.armor}}),Object.defineProperty(exports,"ArmorStream",{enumerable:!0,get:function(){return n.ArmorStream}}),Object.defineProperty(exports,"dearmor",{enumerable:!0,get:function(){return n.dearmor}}),Object.defineProperty(exports,"DearmorStream",{enumerable:!0,get:function(){return n.DearmorStream}});var i=require("./message-header");Object.defineProperty(exports,"MessageType",{enumerable:!0,get:function(){return i.MessageType}});var s=require("./encryption");Object.defineProperty(exports,"encrypt",{enumerable:!0,get:function(){return s.encrypt}}),Object.defineProperty(exports,"EncryptStream",{enumerable:!0,get:function(){return s.EncryptStream}}),Object.defineProperty(exports,"decrypt",{enumerable:!0,get:function(){return s.decrypt}}),Object.defineProperty(exports,"DecryptStream",{enumerable:!0,get:function(){return s.DecryptStream}});var o=require("./signing");Object.defineProperty(exports,"sign",{enumerable:!0,get:function(){return o.sign}}),Object.defineProperty(exports,"SignStream",{enumerable:!0,get:function(){return o.SignStream}}),Object.defineProperty(exports,"verify",{enumerable:!0,get:function(){return o.verify}}),Object.defineProperty(exports,"VerifyStream",{enumerable:!0,get:function(){return o.VerifyStream}}),Object.defineProperty(exports,"signDetached",{enumerable:!0,get:function(){return o.signDetached}}),Object.defineProperty(exports,"verifyDetached",{enumerable:!0,get:function(){return o.verifyDetached}});var a=require("./signcryption");Object.defineProperty(exports,"signcrypt",{enumerable:!0,get:function(){return a.signcrypt}}),Object.defineProperty(exports,"SigncryptStream",{enumerable:!0,get:function(){return a.SigncryptStream}}),Object.defineProperty(exports,"designcrypt",{enumerable:!0,get:function(){return a.designcrypt}}),Object.defineProperty(exports,"DesigncryptStream",{enumerable:!0,get:function(){return a.DesigncryptStream}});var f=require("./signcryption/recipient");Object.defineProperty(exports,"SymmetricKeyRecipient",{enumerable:!0,get:function(){return f.SymmetricKeyRecipient}});var c=require("./with-armor");Object.defineProperty(exports,"encryptAndArmor",{enumerable:!0,get:function(){return c.encryptAndArmor}}),Object.defineProperty(exports,"dearmorAndDecrypt",{enumerable:!0,get:function(){return c.dearmorAndDecrypt}}),Object.defineProperty(exports,"EncryptAndArmorStream",{enumerable:!0,get:function(){return c.EncryptAndArmorStream}}),Object.defineProperty(exports,"DearmorAndDecryptStream",{enumerable:!0,get:function(){return c.DearmorAndDecryptStream}}),Object.defineProperty(exports,"signAndArmor",{enumerable:!0,get:function(){return c.signAndArmor}}),Object.defineProperty(exports,"verifyArmored",{enumerable:!0,get:function(){return c.verifyArmored}}),Object.defineProperty(exports,"SignAndArmorStream",{enumerable:!0,get:function(){return c.SignAndArmorStream}}),Object.defineProperty(exports,"DearmorAndVerifyStream",{enumerable:!0,get:function(){return c.DearmorAndVerifyStream}}),Object.defineProperty(exports,"signDetachedAndArmor",{enumerable:!0,get:function(){return c.signDetachedAndArmor}}),Object.defineProperty(exports,"verifyDetachedArmored",{enumerable:!0,get:function(){return c.verifyDetachedArmored}}),Object.defineProperty(exports,"signcryptAndArmor",{enumerable:!0,get:function(){return c.signcryptAndArmor}}),Object.defineProperty(exports,"dearmorAndDesigncrypt",{enumerable:!0,get:function(){return c.dearmorAndDesigncrypt}}),Object.defineProperty(exports,"SigncryptAndArmorStream",{enumerable:!0,get:function(){return c.SigncryptAndArmorStream}}),Object.defineProperty(exports,"DearmorAndDesigncryptStream",{enumerable:!0,get:function(){return c.DearmorAndDesigncryptStream}})},1883:(e,t,r)=>{"use strict";const n=r(896),i=r(6899);class s extends n.Transform{constructor(e){super(e),this._writableState.objectMode=!1,this._readableState.objectMode=!0,this.bs=new i,this.__restart()}_transform(e,t,r){for(this.bs.write(e);this.bs.length>=this.__needed;){let e=null;const t=null===this.__needed?void 0:this.bs.read(this.__needed);try{e=this.__parser.next(t)}catch(e){return r(e)}this.__needed&&(this.__fresh=!1),e.done?(this.push(e.value),this.__restart()):this.__needed=e.value||1/0}return r()}*_parse(){throw new Error("Must be implemented in subclass")}__restart(){this.__needed=null,this.__parser=this._parse(),this.__fresh=!0}_flush(e){e(this.__fresh?null:new Error("unexpected end of input"))}}e.exports=s},2106:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7999),s=r(4686),o=n(r(4406)),a=r(2655),f=r(4084),c=n(r(5108)),u=e=>(0,i.hash)("sha256",e);class h extends c.default{constructor(){super(),this.authType="DilithiumVerificationKey2025"}static async create_PQ_fromEntropy(e,t=0){const r=new h;var n;r.entropy=e,r.level=1,r.capability="private",r.seed=(n=e,(0,i.hash)("sha512",n)),r.swapIndex=t,r.proof=(0,i.hash)("sha256",s.Buffer.from([])),r.signer=(0,f.generateDilithiumKeyPair)(r.seed.slice(0,32));const a=u(r.seed.slice(32,64)),c=o.default.box.keyPair.fromSecretKey(a);return r.cypher={publicKey:s.Buffer.from(c.publicKey),secretKey:s.Buffer.from(c.secretKey)},r}static generate_PQ(){return h.create_PQ_fromEntropy((0,i.randomBytes)(32))}getSecret(){return s.Buffer.from((0,a.encode)({v:this.version,p:this.proof,s:this.seed}))}static fromSecret(e){const t=(0,a.decode)(e),r=new h;r.version=t.v??0,r.level=2,r.capability="private",r.proof=t.p,r.seed=s.Buffer.from(t.s),r.signer=(0,f.generateDilithiumKeyPair)(r.seed.slice(0,32));const n=u(r.seed.slice(32,64)),i=o.default.box.keyPair.fromSecretKey(n);return r.cypher={publicKey:s.Buffer.from(i.publicKey),secretKey:s.Buffer.from(i.secretKey)},r}static instantiate(e){const t=new h;return t.version=e.version??0,t.level=e.level,t.proof=e.proof.data?s.Buffer.from(e.proof.data):s.Buffer.from(e.proof),t.signer={publicKey:e.signer.publicKey.data?s.Buffer.from(e.signer.publicKey.data):s.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?s.Buffer.from(e.cypher.publicKey.data):s.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,a.decode)(e),r=new h;return r.version=t.v??0,r.level=2,r.capability="public",r.proof=t.p,r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}async sign(e){return"public"==this.capability?null:(0,f.signDilithium)(e,this.signer.secretKey)}verify(e,t,r){return(0,f.verifyDilithium)(e,t,this.signer.publicKey)}}t.default=h},2355:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p521_hasher=t.secp521r1=t.p521=t.p384_hasher=t.secp384r1=t.p384=t.p256_hasher=t.secp256r1=t.p256=void 0;const n=r(4072),i=r(5397),s=r(2844),o=r(7342),a=r(1164),f={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},c={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},u={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},h=(0,o.Field)(f.p),l=(0,o.Field)(c.p),d=(0,o.Field)(u.p);function p(e,t){const r=(0,a.mapToCurveSimpleSWU)(e,t);return e=>r(e[0])}t.p256=(0,i.createCurve)({...f,Fp:h,lowS:!1},n.sha256),t.secp256r1=t.p256,t.p256_hasher=(0,s.createHasher)(t.p256.Point,p(h,{A:f.a,B:f.b,Z:h.create(BigInt("-10"))}),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:f.p,m:1,k:128,expand:"xmd",hash:n.sha256}),t.p384=(0,i.createCurve)({...c,Fp:l,lowS:!1},n.sha384),t.secp384r1=t.p384,t.p384_hasher=(0,s.createHasher)(t.p384.Point,p(l,{A:c.a,B:c.b,Z:l.create(BigInt("-12"))}),{DST:"P384_XMD:SHA-384_SSWU_RO_",encodeDST:"P384_XMD:SHA-384_SSWU_NU_",p:c.p,m:1,k:192,expand:"xmd",hash:n.sha384}),t.p521=(0,i.createCurve)({...u,Fp:d,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},n.sha512),t.secp521r1=t.p521,t.p521_hasher=(0,s.createHasher)(t.p521.Point,p(d,{A:u.a,B:u.b,Z:d.create(BigInt("-4"))}),{DST:"P521_XMD:SHA-512_SSWU_RO_",encodeDST:"P521_XMD:SHA-512_SSWU_NU_",p:u.p,m:1,k:256,expand:"xmd",hash:n.sha512})},2404:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ml_dsa87=t.ml_dsa65=t.ml_dsa44=t.PARAMS=void 0;const n=r(5391),i=r(360),s=r(6215),o=256,a=8380417,f=0|Math.floor(95232),c=0|Math.floor(261888);t.PARAMS={2:{K:4,L:4,D:13,GAMMA1:2**17,GAMMA2:f,TAU:39,ETA:2,OMEGA:80},3:{K:6,L:5,D:13,GAMMA1:2**19,GAMMA2:c,TAU:49,ETA:4,OMEGA:55},5:{K:8,L:7,D:13,GAMMA1:2**19,GAMMA2:c,TAU:60,ETA:2,OMEGA:75}};const u=e=>new Int32Array(e),{mod:h,smod:l,NTT:d,bitsCoder:p}=(0,i.genCrystals)({N:o,Q:a,F:8347681,ROOT_OF_UNITY:1753,newPoly:u,isKyber:!1,brvBits:8}),y=e=>e,g=(e,t=y,r=y)=>p(e,{encode:e=>t(r(e)),decode:e=>r(t(e))}),m=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=h(e[r]+t[r]);return e},b=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=h(e[r]-t[r]);return e},w=e=>{for(let t=0;t<o;t++)e[t]<<=13;return e},v=(e,t)=>{for(let r=0;r<o;r++)if(Math.abs(l(e[r]))>=t)return!0;return!1},E=(e,t)=>{const r=u(o);for(let n=0;n<e.length;n++)r[n]=h(e[n]*t[n]);return r};function B(e){const t=u(o);for(let r=0;r<o;){const n=e();if(n.length%3)throw new Error("RejNTTPoly: unaligned block");for(let e=0;r<o&&e<=n.length-3;e+=3){const i=8388607&(n[e+0]|n[e+1]<<8|n[e+2]<<16);i<a&&(t[r++]=i)}}return t}function _(e){const{K:t,L:r,GAMMA1:i,GAMMA2:p,TAU:y,ETA:_,OMEGA:S}=e,{CRH_BYTES:A,TR_BYTES:I,C_TILDE_BYTES:x,XOF128:T,XOF256:U}=e;if(![2,4].includes(_))throw new Error("Wrong ETA");if(![1<<17,1<<19].includes(i))throw new Error("Wrong GAMMA1");if(![f,c].includes(p))throw new Error("Wrong GAMMA2");const O=y*_,R=e=>{const t=h(e),r=0|l(t,2*p);return t-r===a-1?{r1:0,r0:r-1|0}:{r1:0|Math.floor((t-r)/(2*p)),r0:r}},k=e=>R(e).r1,M=e=>R(e).r0,L=(e,t)=>{const r=Math.floor((a-1)/(2*p)),{r1:n,r0:i}=R(t);return 1===e?i>0?0|h(n+1,r):0|h(n-1,r):0|n},C=e=>{const t=h(e),r=0|l(t,8192);return{r1:0|Math.floor((t-r)/8192),r0:r}},P={bytesLen:S+t,encode:e=>{if(!1===e)throw new Error("hint.encode: hint is false");const r=new Uint8Array(S+t);for(let n=0,i=0;n<t;n++){for(let t=0;t<o;t++)0!==e[n][t]&&(r[i++]=t);r[S+n]=i}return r},decode:e=>{const r=[];let n=0;for(let i=0;i<t;i++){const t=u(o);if(e[S+i]<n||e[S+i]>S)return!1;for(let r=n;r<e[S+i];r++){if(r>n&&e[r]<=e[r-1])return!1;t[e[r]]=1}n=e[S+i],r.push(t)}for(let t=n;t<S;t++)if(0!==e[t])return!1;return r}},N=g(2===_?3:4,(e=>_-e),(e=>{if(!(-_<=e&&e<=_))throw new Error(`malformed key s1/s3 ${e} outside of ETA range [${-_}, ${_}]`);return e})),D=g(13,(e=>4096-e)),F=g(10),H=g(i===1<<17?18:20,(e=>l(i-e))),j=g(p===f?6:4),K=(0,s.vecCoder)(j,t),V=(0,s.splitCoder)(32,(0,s.vecCoder)(F,t)),G=(0,s.splitCoder)(32,32,I,(0,s.vecCoder)(N,r),(0,s.vecCoder)(N,t),(0,s.vecCoder)(D,t)),q=(0,s.splitCoder)(x,(0,s.vecCoder)(H,r),P),z=2===_?e=>e<15&&2-e%5:e=>e<9&&4-e;function W(e){const t=u(o);for(let r=0;r<o;){const n=e();for(let e=0;r<o&&e<n.length;e+=1){const i=z(15&n[e]),s=z(n[e]>>4&15);!1!==i&&(t[r++]=i),r<o&&!1!==s&&(t[r++]=s)}}return t}const $=e=>{const t=u(o),r=n.shake256.create({}).update(e),i=new Uint8Array(n.shake256.blockLen);r.xofInto(i);const s=i.slice(0,8);for(let e=o-y,a=8,f=0,c=0;e<o;e++){let o=e+1;for(;o>e;)o=i[a++],a<n.shake256.blockLen||(r.xofInto(i),a=0);t[e]=t[o],t[o]=1-((s[f]>>c++&1)<<1),c>=8&&(f++,c=0)}return t},Y=e=>{const t=u(o),r=u(o);for(let n=0;n<e.length;n++){const{r0:i,r1:s}=C(e[n]);t[n]=i,r[n]=s}return{r0:t,r1:r}},Z=(e,t)=>{for(let r=0;r<o;r++)e[r]=L(t[r],e[r]);return e},X=(e,t)=>{const r=u(o);let n=0;for(let f=0;f<o;f++){const o=(i=e[f],s=t[f],i<=p||i>a-p||i===a-p&&0===s?0:1);r[f]=o,n+=o}var i,s;return{v:r,cnt:n}},Q=(0,s.splitCoder)(32,64,32),J={signRandBytes:32,keygen:e=>{const i=new Uint8Array(34),a=void 0===e;a&&(e=(0,s.randomBytes)(32)),(0,s.ensureBytes)(e,32),i.set(e),a&&e.fill(0),i[32]=t,i[33]=r;const[f,c,h]=Q.decode((0,n.shake256)(i,{dkLen:Q.bytesLen})),l=U(c),p=[];for(let e=0;e<r;e++)p.push(W(l.get(255&e,e>>8&255)));const y=[];for(let e=r;e<r+t;e++)y.push(W(l.get(255&e,e>>8&255)));const g=p.map((e=>d.encode(e.slice()))),b=[],w=[],v=T(f),_=u(o);for(let e=0;e<t;e++){_.fill(0);for(let t=0;t<r;t++){const r=B(v.get(t,e));m(_,E(r,g[t]))}d.decode(_);const{r0:t,r1:n}=Y(m(_,y[e]));b.push(t),w.push(n)}const S=V.encode([f,w]),A=(0,n.shake256)(S,{dkLen:I}),x=G.encode([f,h,A,p,y,b]);return v.clean(),l.clean(),(0,s.cleanBytes)(f,c,h,p,y,g,_,b,w,A,i),{publicKey:S,secretKey:x}},sign:(e,a,f,c=!1)=>{const[h,l,y,g,w,_]=G.decode(e),I=[],R=T(h);for(let e=0;e<t;e++){const t=[];for(let n=0;n<r;n++)t.push(B(R.get(n,e)));I.push(t)}R.clean();for(let e=0;e<r;e++)d.encode(g[e]);for(let e=0;e<t;e++)d.encode(w[e]),d.encode(_[e]);const L=c?a:n.shake256.create({dkLen:A}).update(y).update(a).digest(),C=f||new Uint8Array(32);(0,s.ensureBytes)(C);const P=n.shake256.create({dkLen:A}).update(l).update(C).update(L).digest();(0,s.ensureBytes)(P,A);const N=U(P,H.bytesLen);e:for(let e=0;;){const a=[];for(let t=0;t<r;t++,e++)a.push(H.decode(N.get(255&e,e>>8)()));const f=a.map((e=>d.encode(e.slice()))),c=[];for(let e=0;e<t;e++){const t=u(o);for(let n=0;n<r;n++)m(t,E(I[e][n],f[n]));d.decode(t),c.push(t)}const h=c.map((e=>e.map(k))),l=n.shake256.create({dkLen:x}).update(L).update(K.encode(h)).digest(),y=d.encode($(l)),B=g.map((e=>E(e,y)));for(let e=0;e<r;e++)if(m(d.decode(B[e]),a[e]),v(B[e],i-O))continue e;let A=0;const T=[];for(let e=0;e<t;e++){const t=d.decode(E(w[e],y)),r=b(c[e],t).map(M);if(v(r,p-O))continue e;const n=d.decode(E(_[e],y));if(v(n,p))continue e;m(r,n);const i=X(r,h[e]);T.push(i.v),A+=i.cnt}if(A>S)continue;N.clean();const U=q.encode([l,B,T]);return(0,s.cleanBytes)(l,B,T,y,h,c,f,a,P,L,g,w,_,...I),U}throw new Error("Unreachable code path reached, report this error")},verify:(e,a,f,c=!1)=>{const[h,l]=V.decode(e),p=(0,n.shake256)(e,{dkLen:I});if(f.length!==q.bytesLen)return!1;const[y,g,_]=q.decode(f);if(!1===_)return!1;for(let e=0;e<r;e++)if(v(g[e],i-O))return!1;const U=c?a:n.shake256.create({dkLen:A}).update(p).update(a).digest(),R=d.encode($(y)),k=g.map((e=>e.slice()));for(let e=0;e<r;e++)d.encode(k[e]);const M=[],L=T(h);for(let e=0;e<t;e++){const t=E(d.encode(w(l[e])),R),n=u(o);for(let t=0;t<r;t++){const r=B(L.get(t,e));m(n,E(r,k[t]))}const i=d.decode(b(n,t));M.push(Z(i,_[e]))}L.clean();const C=n.shake256.create({dkLen:x}).update(U).update(K.encode(M)).digest();for(const e of _)if(!(e.reduce(((e,t)=>e+t),0)<=S))return!1;for(const e of g)if(v(e,i-O))return!1;return(0,s.equalBytes)(y,C)}};return{internal:J,keygen:J.keygen,signRandBytes:J.signRandBytes,sign:(e,t,r=s.EMPTY,n)=>{const i=(0,s.getMessage)(t,r),o=J.sign(e,i,n);return i.fill(0),o},verify:(e,t,r,n=s.EMPTY)=>J.verify(e,(0,s.getMessage)(t,n),r),prehash:e=>({sign:(t,r,n=s.EMPTY,i)=>{const o=(0,s.getMessagePrehash)(e,r,n),a=J.sign(t,o,i);return o.fill(0),a},verify:(t,r,n,i=s.EMPTY)=>J.verify(t,(0,s.getMessagePrehash)(e,r,i),n)})}}t.ml_dsa44=_({...t.PARAMS[2],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:32,XOF128:i.XOF128,XOF256:i.XOF256}),t.ml_dsa65=_({...t.PARAMS[3],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:48,XOF128:i.XOF128,XOF256:i.XOF256}),t.ml_dsa87=_({...t.PARAMS[5],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:64,XOF128:i.XOF128,XOF256:i.XOF256})},2655:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DecodeError:()=>a,Decoder:()=>L,EXT_TIMESTAMP:()=>h,Encoder:()=>B,ExtData:()=>o,ExtensionCodec:()=>v,decode:()=>C,decodeArrayStream:()=>F,decodeAsync:()=>D,decodeMulti:()=>P,decodeMultiStream:()=>H,decodeTimestampExtension:()=>b,decodeTimestampToTimeSpec:()=>m,encode:()=>_,encodeDateToTimeSpec:()=>y,encodeTimeSpecToTimestamp:()=>p,encodeTimestampExtension:()=>g});const n=new TextEncoder;function i(e,t,r){let n=t;const i=n+r,s=[];let o="";for(;n<i;){const t=e[n++];if(128&t)if(192==(224&t)){const r=63&e[n++];s.push((31&t)<<6|r)}else if(224==(240&t)){const r=63&e[n++],i=63&e[n++];s.push((31&t)<<12|r<<6|i)}else if(240==(248&t)){let r=(7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];r>65535&&(r-=65536,s.push(r>>>10&1023|55296),r=56320|1023&r),s.push(r)}else s.push(t);else s.push(t);s.length>=4096&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}const s=new TextDecoder;class o{constructor(e,t){this.type=e,this.data=t}}class a extends Error{constructor(e){super(e);const t=Object.create(a.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:a.name})}}const f=4294967295;function c(e,t,r){const n=Math.floor(r/4294967296),i=r;e.setUint32(t,n),e.setUint32(t+4,i)}function u(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}const h=-1,l=4294967295,d=17179869183;function p({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=d){if(0===t&&e<=l){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}{const r=e/4294967296,n=4294967295&e,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,t<<2|3&r),s.setUint32(4,n),i}}{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,t),c(n,4,e),r}}function y(e){const t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),i=Math.floor(n/1e9);return{sec:r+i,nsec:n-1e9*i}}function g(e){return e instanceof Date?p(y(e)):null}function m(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const e=t.getUint32(0);return{sec:4294967296*(3&e)+t.getUint32(4),nsec:e>>>2}}case 12:return{sec:u(t,4),nsec:t.getUint32(0)};default:throw new a(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}function b(e){const t=m(e);return new Date(1e3*t.sec+t.nsec/1e6)}const w={type:h,encode:g,decode:b};class v{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(w)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{const n=-1-e;this.builtInEncoders[n]=t,this.builtInDecoders[n]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){const n=this.builtInEncoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new o(-1-r,i)}}for(let r=0;r<this.encoders.length;r++){const n=this.encoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new o(r,i)}}return e instanceof o?e:null}decode(e,t,r){const n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new o(t,e)}}function E(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):function(e){return e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}(e)?new Uint8Array(e):Uint8Array.from(e)}v.defaultCodec=new v;class B{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??v.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??100,this.initialBufferSize=e?.initialBufferSize??2048,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new B({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){const t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){!1===e?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error(`Too long string: ${e} bytes in UTF-8`);this.writeU8(219),this.writeU32(e)}}encodeString(e){const t=function(e){const t=e.length;let r=0,n=0;for(;n<t;){let i=e.charCodeAt(n++);if(4294967168&i)if(4294965248&i){if(i>=55296&&i<=56319&&n<t){const t=e.charCodeAt(n);56320==(64512&t)&&(++n,i=((1023&i)<<10)+(1023&t)+65536)}r+=4294901760&i?4:3}else r+=2;else r++}return r}(e);var r,i,s;this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),r=e,i=this.bytes,s=this.pos,r.length>50?function(e,t,r){n.encodeInto(e,t.subarray(r))}(r,i,s):function(e,t,r){const n=e.length;let i=r,s=0;for(;s<n;){let r=e.charCodeAt(s++);if(4294967168&r){if(4294965248&r){if(r>=55296&&r<=56319&&s<n){const t=e.charCodeAt(s);56320==(64512&t)&&(++s,r=((1023&r)<<10)+(1023&t)+65536)}4294901760&r?(t[i++]=r>>18&7|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128):(t[i++]=r>>12&15|224,t[i++]=r>>6&63|128)}else t[i++]=r>>6&31|192;t[i++]=63&r|128}else t[i++]=r}}(r,i,s),this.pos+=t}encodeObject(e,t){const r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`);this.encodeMap(e,t)}}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large binary: ${t}`);this.writeU8(198),this.writeU32(t)}const r=E(e);this.writeU8a(r)}encodeArray(e,t){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error(`Too large array: ${r}`);this.writeU8(221),this.writeU32(r)}for(const r of e)this.doEncode(r,t+1)}countWithoutUndefined(e,t){let r=0;for(const n of t)void 0!==e[n]&&r++;return r}encodeMap(e,t){const r=Object.keys(e);this.sortKeys&&r.sort();const n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error(`Too large map object: ${n}`);this.writeU8(223),this.writeU32(n)}for(const n of r){const r=e[n];this.ignoreUndefined&&void 0===r||(this.encodeString(n),this.doEncode(r,t+1))}}encodeExtension(e){if("function"==typeof e.data){const t=e.data(this.pos+6),r=t.length;if(r>=4294967296)throw new Error(`Too large extension object: ${r}`);return this.writeU8(201),this.writeU32(r),this.writeI8(e.type),void this.writeU8a(t)}const t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large extension object: ${t}`);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),function(e,t,r){const n=r/4294967296,i=r;e.setUint32(t,n),e.setUint32(t+4,i)}(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),c(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function _(e,t){return new B(t).encodeSharedRef(e)}function S(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}const A="array",I="map_key",x="map_value",T=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new a("The type of key must be string or number but "+typeof e)};class U{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=A,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=I,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===A){const t=e;t.size=0,t.array=void 0,t.position=0,t.type=void 0}if(e.type===I||e.type===x){const t=e;t.size=0,t.map=void 0,t.readCount=0,t.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const O=new DataView(new ArrayBuffer(0)),R=new Uint8Array(O.buffer);try{O.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const k=new RangeError("Insufficient data"),M=new class{constructor(e=16,t=16){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let e=0;e<this.maxKeyLength;e++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){const n=this.caches[r-1];e:for(const i of n){const n=i.bytes;for(let i=0;i<r;i++)if(n[i]!==e[t+i])continue e;return i.str}return null}store(e,t){const r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)}decode(e,t,r){const n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;const s=i(e,t,r),o=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(o,s),s}};class L{constructor(e){this.totalPos=0,this.pos=0,this.view=O,this.bytes=R,this.headByte=-1,this.stack=new U,this.entered=!1,this.extensionCodec=e?.extensionCodec??v.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??f,this.maxBinLength=e?.maxBinLength??f,this.maxArrayLength=e?.maxArrayLength??f,this.maxMapLength=e?.maxMapLength??f,this.maxExtLength=e?.maxExtLength??f,this.keyDecoder=void 0!==e?.keyDecoder?e.keyDecoder:M,this.mapKeyConverter=e?.mapKeyConverter??T}clone(){return new L({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){const t=E(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){const t=this.bytes.subarray(this.pos),r=E(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:r}=this;return new RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){const t=this.clone();yield*t.decodeMulti(e)}else try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let t,r=!1;for await(const n of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(n);try{t=this.doDecodeSync(),r=!0}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return t}const{headByte:n,pos:i,totalPos:s}=this;throw new RangeError(`Insufficient data in parsing ${S(n)} at ${s} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){const r=this.clone();yield*r.decodeMultiAsync(e,t)}else try{this.entered=!0;let r=t,n=-1;for await(const i of e){if(t&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(n=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),0!==--n;);}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const r=e-128;if(0!==r){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){const r=e-144;if(0!==r){this.pushArrayState(r),this.complete();continue e}t=[]}else{const r=e-160;t=this.decodeString(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){const e=this.lookU8();t=this.decodeString(e,1)}else if(218===e){const e=this.lookU16();t=this.decodeString(e,2)}else if(219===e){const e=this.lookU32();t=this.decodeString(e,4)}else if(220===e){const e=this.readU16();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(221===e){const e=this.readU32();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(222===e){const e=this.readU16();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(223===e){const e=this.readU32();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(196===e){const e=this.lookU8();t=this.decodeBinary(e,1)}else if(197===e){const e=this.lookU16();t=this.decodeBinary(e,2)}else if(198===e){const e=this.lookU32();t=this.decodeBinary(e,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){const e=this.lookU8();t=this.decodeExtension(e,1)}else if(200===e){const e=this.lookU16();t=this.decodeExtension(e,2)}else{if(201!==e)throw new a(`Unrecognized type byte: ${S(e)}`);{const e=this.lookU32();t=this.decodeExtension(e,4)}}this.complete();const r=this.stack;for(;r.length>0;){const e=r.top();if(e.type===A){if(e.array[e.position]=t,e.position++,e.position!==e.size)continue e;t=e.array,r.release(e)}else{if(e.type===I){if("__proto__"===t)throw new a("The key __proto__ is not allowed");e.key=this.mapKeyConverter(t),e.type=x;continue e}if(e.map[e.key]=t,e.readCount++,e.readCount!==e.size){e.key=null,e.type=I;continue e}t=e.map,r.release(e)}}return t}}readHeadByte(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new a(`Unrecognized array type byte: ${S(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new a(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new a(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){if(e>this.maxStrLength)throw new a(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw k;const r=this.pos+t;let n;return n=this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?this.keyDecoder.decode(this.bytes,r,e):function(e,t,r){return r>200?function(e,t,r){const n=e.subarray(t,t+r);return s.decode(n)}(e,t,r):i(e,t,r)}(this.bytes,r,e),this.pos+=t+e,n}stateIsMapKey(){return this.stack.length>0&&this.stack.top().type===I}decodeBinary(e,t){if(e>this.maxBinLength)throw new a(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw k;const r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n}decodeExtension(e,t){if(e>this.maxExtLength)throw new a(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=(t=this.view,r=this.pos,4294967296*t.getUint32(r)+t.getUint32(r+4));var t,r;return this.pos+=8,e}readI64(){const e=u(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function C(e,t){return new L(t).decode(e)}function P(e,t){return new L(t).decodeMulti(e)}function N(e){return null!=e[Symbol.asyncIterator]?e:async function*(e){const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)return;yield r}}finally{t.releaseLock()}}(e)}async function D(e,t){const r=N(e);return new L(t).decodeAsync(r)}function F(e,t){const r=N(e);return new L(t).decodeArrayStream(r)}function H(e,t){const r=N(e);return new L(t).decodeStream(r)}},2844:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expand_message_xmd=c,t.expand_message_xof=u,t.hash_to_field=h,t.isogenyMap=function(e,t){const r=t.map((e=>Array.from(e).reverse()));return(t,n)=>{const[s,o,a,f]=r.map((r=>r.reduce(((r,n)=>e.add(e.mul(r,t),n))))),[c,u]=(0,i.FpInvertBatch)(e,[o,f],!0);return t=e.mul(s,c),n=e.mul(n,e.mul(a,u)),{x:t,y:n}}},t.createHasher=function(e,t,r){if("function"!=typeof t)throw new Error("mapToCurve() must be defined");function n(r){return e.fromAffine(t(r))}function i(t){const r=t.clearCofactor();return r.equals(e.ZERO)?e.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(e,t){const s=r.DST?r.DST:{},o=h(e,2,Object.assign({},r,s,t)),a=n(o[0]),f=n(o[1]);return i(a.add(f))},encodeToCurve(e,t){const s=r.encodeDST?r.encodeDST:{};return i(n(h(e,1,Object.assign({},r,s,t))[0]))},mapToCurve(e){if(!Array.isArray(e))throw new Error("expected array of bigints");for(const t of e)if("bigint"!=typeof t)throw new Error("expected array of bigints");return i(n(e))}}};const n=r(6376),i=r(7342),s=n.bytesToNumberBE;function o(e,t){if(f(e),f(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=255&e,e>>>=8;return new Uint8Array(r)}function a(e,t){const r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}function f(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function c(e,t,r,i){(0,n.abytes)(e),(0,n.abytes)(t),f(r),t.length>255&&(t=i((0,n.concatBytes)((0,n.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));const{outputLen:s,blockLen:c}=i,u=Math.ceil(r/s);if(r>65535||u>255)throw new Error("expand_message_xmd: invalid lenInBytes");const h=(0,n.concatBytes)(t,o(t.length,1)),l=o(0,c),d=o(r,2),p=new Array(u),y=i((0,n.concatBytes)(l,e,d,o(0,1),h));p[0]=i((0,n.concatBytes)(y,o(1,1),h));for(let e=1;e<=u;e++){const t=[a(y,p[e-1]),o(e+1,1),h];p[e]=i((0,n.concatBytes)(...t))}return(0,n.concatBytes)(...p).slice(0,r)}function u(e,t,r,i,s){if((0,n.abytes)(e),(0,n.abytes)(t),f(r),t.length>255){const e=Math.ceil(2*i/8);t=s.create({dkLen:e}).update((0,n.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:r}).update(e).update(o(r,2)).update(t).update(o(t.length,1)).digest()}function h(e,t,r){(0,n._validateObject)(r,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:o,k:a,m:h,hash:l,expand:d,DST:p}=r;if(!(0,n.isBytes)(p)&&"string"!=typeof p)throw new Error("DST must be string or uint8array");if(!(0,n.isHash)(r.hash))throw new Error("expected valid hash");(0,n.abytes)(e),f(t);const y="string"==typeof p?(0,n.utf8ToBytes)(p):p,g=o.toString(2).length,m=Math.ceil((g+a)/8),b=t*h*m;let w;if("xmd"===d)w=c(e,y,b,l);else if("xof"===d)w=u(e,y,b,a,l);else{if("_internal_pass"!==d)throw new Error('expand must be "xmd" or "xof"');w=e}const v=new Array(t);for(let e=0;e<t;e++){const t=new Array(h);for(let r=0;r<h;r++){const n=m*(r+e*h),a=w.subarray(n,n+m);t[r]=(0,i.mod)(s(a),o)}v[e]=t}return v}},2862:(e,t,r)=>{"use strict";var n=r(8704).F.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(s||i);var o=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,f=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){a=!1,c=!0,o||s.call(t)},h=t._readableState&&t._readableState.endEmitted,l=function(){o=!1,h=!0,a||s.call(t)},d=function(e){s.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),s.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new n),s.call(t,e)):void 0},y=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",p),t.req?y():t.on("request",y)):a&&!t._writableState&&(t.on("end",f),t.on("close",f)),t.on("end",l),t.on("finish",u),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",u),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",u),t.removeListener("end",f),t.removeListener("close",f),t.removeListener("finish",u),t.removeListener("end",l),t.removeListener("error",d),t.removeListener("close",p)}}},3042:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryChannel=void 0,t.pipeChannels=function(e,t){let r=!0;return(async()=>{try{for(await e.start(),await t.start(),console.log("pipe1to2");r;)try{const n=await e.receive();if(console.log("pipe1to2",n),!r||0===n.length)break;t.send(n)}catch(e){r&&console.error("Error in pipe1to2:",e);break}}catch(e){console.error("Fatal error in pipe1to2:",e)}})(),(async()=>{try{for(;r;){console.log("pipe2to1");try{const n=await t.receive();if(console.log("pipe2to1",n),!r||0===n.length)break;e.send(n)}catch(e){r&&console.error("Error in pipe2to1:",e);break}}}catch(e){console.error("Fatal error in pipe2to1:",e)}})(),async()=>{r=!1,await Promise.all([e.close(),t.close()])}},t.unpipeChannels=async function(e,t){await Promise.all([e.close(),t.close()])},t.StreamChannel=function(e){const t=()=>new s.Stream.Writable({write:(t,r,n)=>{e.send(t),n()}}),r=async r=>new Promise((n=>{const i=t();r.pipe(i).once("finish",(()=>{e.send(o.Buffer.from("EOF","utf-8")),i.end(),n()}))})),n=()=>{let t,r;const n=new s.Stream.Readable({read(){t=e=>this.push(e)}});return(async()=>{let i=await e.receive();for(;i;){if(3===(s=i).length&&"EOF"===s.toString("utf-8")&&t&&(r&&t(r),t(null),n.destroy()),r=r?o.Buffer.concat([r,s]):s,t&&(!t(r)&&(t=null),r=null),"EOF"===i.toString("utf-8"))return;i=await e.receive()}var s})(),n};return{getReadStream:n,getWriteStream:t,upload:r,uploadData:async e=>{const t=s.Readable.from(e);await r(t)},download:async e=>{const t=n(),r=new Promise((e=>t.on("end",(()=>{e()}))));t.pipe(e),await r},downloadData:async()=>{const e=n(),t=[],r=new Promise((r=>e.on("end",(()=>{r(o.Buffer.concat(t))})))),i=new s.Stream.Writable({write:(e,r,n)=>{t.push(e),n()}});return e.pipe(i),r}}},t.convertWebWritableStreamToNodeWritable=function(e){const t=e.getWriter();return new s.Writable({async write(e,r,n){try{await t.write(e),t.releaseLock(),n()}catch(e){n()}},async final(t){try{const r=e.getWriter();await r.close(),r.releaseLock(),t()}catch(e){t()}},async destroy(t,r){try{const n=e.getWriter();await n.abort(t),n.releaseLock(),r(t)}catch(e){r(null)}}})},t.convertWebReadableStreamToNodeReadable=function(e){const t=e.getReader();return new s.Readable({async read(){try{for(;;){const{done:e,value:r}=await t.read();if(e){this.push(null);break}this.push(o.Buffer.from(r))}}catch(e){this.destroy()}}})};const i=n(r(8568)),s=r(896),o=r(4686);class a{constructor(){this.messageQueue=[],this.waitingResolvers=[],this.connected=!1,this.connectedCallbacks=[],this.closed=!1}setChannel(e,t){this.name=t,this.otherend=e}static createBidirectionnal(){const e=new a,t=new a;return e.setChannel(t),t.setChannel(e),e}onConnected(e){this.connected?e():this.connectedCallbacks.push(e)}static createEncryptedBidirectionnal(e=i.default.generateKey()){const t=i.default.encryptChannel(new a,e),r=i.default.encryptChannel(new a,e);return t.setChannel(r),r.setChannel(t),t}getConnectionString(){return"vaultys://memory"}fromConnectionString(e){return"vaultys://memory"===e?new a:null}setLogger(e){this.logger=e}setInjector(e){this.injector=e}async start(){this.connected=!0,this.connectedCallbacks.forEach((e=>e())),this.connectedCallbacks=[]}async send(e){if(this.closed)throw new Error("Cannot send on closed channel");if(!this.otherend)throw new Error("No other end connected to this channel");this.logger&&this.logger(e);let t=e;this.injector&&(t=await this.injector(e)),this.connected||await this.start(),this.otherend.deliverMessage(t)}deliverMessage(e){this.waitingResolvers.length>0?this.waitingResolvers.shift()(e):this.messageQueue.push(e)}async receive(){if(this.closed)throw new Error("Cannot receive on closed channel");return this.messageQueue.length>0?this.messageQueue.shift():new Promise((e=>{this.waitingResolvers.push(e)}))}async close(){for(this.closed=!0;this.waitingResolvers.length>0;)this.waitingResolvers.shift()(o.Buffer.alloc(0));this.messageQueue=[]}}t.MemoryChannel=a},3105:(e,t,r)=>{"use strict";const n=r(3271),i=r(5706),{Buffer:s}=r(4686);class o extends n{constructor(e){super(e),this.valueSharing=new i}_pushObject(e,t){if(null!==e){const t=this.valueSharing.check(e);switch(t){case i.FIRST:this._pushTag(28);break;case i.NEVER:break;default:return this._pushTag(29)&&this._pushIntNum(t)}}return super._pushObject(e,t)}stopRecording(){this.valueSharing.stop()}clearRecording(){this.valueSharing.clear()}static encode(...e){const t=new o;t.on("data",(()=>{}));for(const r of e)t.pushAny(r);return t.stopRecording(),t.removeAllListeners("data"),t._encodeAll(e)}static encodeCanonical(...e){throw new Error("Cannot encode canonically in a SharedValueEncoder, which serializes objects multiple times.")}static encodeOne(e,t){const r=new o(t);return r.on("data",(()=>{})),r.pushAny(e),r.stopRecording(),r.removeAllListeners("data"),r._encodeAll([e])}static encodeAsync(e,t){return new Promise(((r,n)=>{const i=[],a=new o(t);a.on("data",(()=>{})),a.on("error",n),a.on("finish",(()=>r(s.concat(i)))),a.pushAny(e),a.stopRecording(),a.removeAllListeners("data"),a.on("data",(e=>i.push(e))),a.pushAny(e),a.end()}))}}e.exports=o},3144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.edwards=h,t.eddsa=l,t.twistedEdwards=function(e){const{CURVE:t,curveOpts:r,eddsaOpts:n}=function(e){const t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:(0,s.Field)(t.n,e.nBitLength,!0),uvRatio:e.uvRatio},eddsaOpts:{hash:e.hash,randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve}}}(e);return function(e,t){return Object.assign({},t,{ExtendedPoint:t.Point,CURVE:e})}(e,l(h(t,r),n))};const n=r(6376),i=r(407),s=r(7342),o=BigInt(0),a=BigInt(1),f=BigInt(2),c=BigInt(8),u={zip215:!0};function h(e,t={}){const{Fp:r,Fn:s}=(0,i._createCurveFields)("edwards",e,t),{h:u,n:h}=e;(0,n._validateObject)(t,{},{uvRatio:"function"});const l=f<<BigInt(8*s.BYTES)-a,d=e=>r.create(e),p=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(r.div(e,t))}}catch(e){return{isValid:!1,value:o}}});if(!function(e,t,r,n){const i=e.sqr(r),s=e.sqr(n),o=e.add(e.mul(t.a,i),s),a=e.add(e.ONE,e.mul(t.d,e.mul(i,s)));return e.eql(o,a)}(r,e,e.Gx,e.Gy))throw new Error("bad curve params: generator point");function y(e,t,r=!1){const i=r?a:o;return(0,n.aInRange)("coordinate "+e,t,i,l),t}function g(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}const m=(0,n.memoized)(((e,t)=>{const{ex:n,ey:i,ez:s}=e,f=e.is0();null==t&&(t=f?c:r.inv(s));const u=d(n*t),h=d(i*t),l=d(s*t);if(f)return{x:o,y:a};if(l!==a)throw new Error("invZ was invalid");return{x:u,y:h}})),b=(0,n.memoized)((t=>{const{a:r,d:n}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:s,ez:o,et:a}=t,f=d(i*i),c=d(s*s),u=d(o*o),h=d(u*u),l=d(f*r);if(d(u*d(l+c))!==d(h+d(n*d(f*c))))throw new Error("bad point: equation left != right (1)");if(d(i*s)!==d(o*a))throw new Error("bad point: equation left != right (2)");return!0}));class w{constructor(e,t,r,n){this.ex=y("x",e),this.ey=y("y",t),this.ez=y("z",r,!0),this.et=y("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return y("x",t),y("y",r),new w(t,r,a,d(t*r))}static normalizeZ(e){return(0,i.normalizeZ)(w,"ez",e)}static msm(e,t){return(0,i.pippenger)(w,s,e,t)}_setWindowSize(e){this.precompute(e)}precompute(e=8,t=!0){return v.setWindowSize(this,e),t||this.multiply(f),this}assertValidity(){b(this)}equals(e){g(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:s,ez:o}=e,a=d(t*o),f=d(i*n),c=d(r*o),u=d(s*n);return a===f&&c===u}is0(){return this.equals(w.ZERO)}negate(){return new w(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,s=d(r*r),o=d(n*n),a=d(f*d(i*i)),c=d(t*s),u=r+n,h=d(d(u*u)-s-o),l=c+o,p=l-a,y=c-o,g=d(h*p),m=d(l*y),b=d(h*y),v=d(p*l);return new w(g,m,v,b)}add(t){g(t);const{a:r,d:n}=e,{ex:i,ey:s,ez:o,et:a}=this,{ex:f,ey:c,ez:u,et:h}=t,l=d(i*f),p=d(s*c),y=d(a*n*h),m=d(o*u),b=d((i+s)*(f+c)-l-p),v=m-y,E=m+y,B=d(p-r*l),_=d(b*v),S=d(E*B),A=d(b*B),I=d(v*E);return new w(_,S,I,A)}subtract(e){return this.add(e.negate())}multiply(e){const t=e;(0,n.aInRange)("scalar",t,a,h);const{p:r,f:i}=v.wNAFCached(this,t,w.normalizeZ);return w.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=w.ZERO){const r=e;return(0,n.aInRange)("scalar",r,o,h),r===o?w.ZERO:this.is0()||r===a?this:v.wNAFCachedUnsafe(this,r,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return v.wNAFCachedUnsafe(this,h).is0()}toAffine(e){return m(this,e)}clearCofactor(){return u===a?this:this.multiplyUnsafe(u)}static fromBytes(e,t=!1){return(0,n.abytes)(e),this.fromHex(e,t)}static fromHex(t,i=!1){const{d:s,a:f}=e,c=r.BYTES;t=(0,n.ensureBytes)("pointHex",t,c),(0,n.abool)("zip215",i);const u=t.slice(),h=t[c-1];u[c-1]=-129&h;const y=(0,n.bytesToNumberLE)(u),g=i?l:r.ORDER;(0,n.aInRange)("pointHex.y",y,o,g);const m=d(y*y),b=d(m-a),v=d(s*m-f);let{isValid:E,value:B}=p(b,v);if(!E)throw new Error("Point.fromHex: invalid y coordinate");const _=(B&a)===a,S=!!(128&h);if(!i&&B===o&&S)throw new Error("Point.fromHex: x=0 and x_0=1");return S!==_&&(B=d(-B)),w.fromAffine({x:B,y})}static fromPrivateScalar(e){return w.BASE.multiply(e)}toBytes(){const{x:e,y:t}=this.toAffine(),i=(0,n.numberToBytesLE)(t,r.BYTES);return i[i.length-1]|=e&a?128:0,i}toRawBytes(){return this.toBytes()}toHex(){return(0,n.bytesToHex)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}w.BASE=new w(e.Gx,e.Gy,a,d(e.Gx*e.Gy)),w.ZERO=new w(o,a,a,o),w.Fp=r,w.Fn=s;const v=(0,i.wNAF)(w,8*s.BYTES);return w}function l(e,t){(0,n._validateObject)(t,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r,hash:i}=t,{BASE:s,Fp:a,Fn:f}=e,c=f.ORDER,h=t.randomBytes||n.randomBytes,l=t.adjustScalarBytes||(e=>e),d=t.domain||((e,t,r)=>{if((0,n.abool)("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function p(e){return f.create(e)}function y(e){return p((0,n.bytesToNumberLE)(e))}function g(e){const{head:t,prefix:r,scalar:o}=function(e){const t=a.BYTES;e=(0,n.ensureBytes)("private key",e,t);const r=(0,n.ensureBytes)("hashed private key",i(e),2*t),s=l(r.slice(0,t));return{head:s,prefix:r.slice(t,2*t),scalar:y(s)}}(e),f=s.multiply(o),c=f.toBytes();return{head:t,prefix:r,scalar:o,point:f,pointBytes:c}}function m(e=Uint8Array.of(),...t){const s=(0,n.concatBytes)(...t);return y(i(d(s,(0,n.ensureBytes)("context",e),!!r)))}const b=u;return s.precompute(8),{getPublicKey:function(e){return g(e).pointBytes},sign:function(e,t,i={}){e=(0,n.ensureBytes)("message",e),r&&(e=r(e));const{prefix:f,scalar:u,pointBytes:h}=g(t),l=m(i.context,f,e),d=s.multiply(l).toBytes(),y=p(l+m(i.context,d,h,e)*u);(0,n.aInRange)("signature.s",y,o,c);const b=a.BYTES,w=(0,n.concatBytes)(d,(0,n.numberToBytesLE)(y,b));return(0,n.ensureBytes)("result",w,2*b)},verify:function(t,i,o,f=b){const{context:c,zip215:u}=f,h=a.BYTES;t=(0,n.ensureBytes)("signature",t,2*h),i=(0,n.ensureBytes)("message",i),o=(0,n.ensureBytes)("publicKey",o,h),void 0!==u&&(0,n.abool)("zip215",u),r&&(i=r(i));const l=(0,n.bytesToNumberLE)(t.slice(h,2*h));let d,p,y;try{d=e.fromHex(o,u),p=e.fromHex(t.slice(0,h),u),y=s.multiplyUnsafe(l)}catch(e){return!1}if(!u&&d.isSmallOrder())return!1;const g=m(c,p.toBytes(),d.toBytes(),i);return p.add(d.multiplyUnsafe(g)).subtract(y).clearCofactor().is0()},utils:{getExtendedPublicKey:g,randomPrivateKey:()=>h(a.BYTES),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},Point:e}}},3201:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CryptoChannel=t.GameOfLifeIcon=t.KeyManager=t.IdManager=t.LocalStorage=t.convertWebWritableStreamToNodeWritable=t.convertWebReadableStreamToNodeReadable=t.StreamChannel=t.MemoryStorage=t.MemoryChannel=t.Challenger=t.VaultysId=t.Buffer=t.crypto=void 0;const f=a(r(3639));t.Challenger=f.default;const c=a(r(6728));t.IdManager=c.default;const u=a(r(5108));t.KeyManager=u.default;const h=a(r(4981));t.VaultysId=h.default;const l=r(3042);Object.defineProperty(t,"MemoryChannel",{enumerable:!0,get:function(){return l.MemoryChannel}}),Object.defineProperty(t,"StreamChannel",{enumerable:!0,get:function(){return l.StreamChannel}}),Object.defineProperty(t,"convertWebReadableStreamToNodeReadable",{enumerable:!0,get:function(){return l.convertWebReadableStreamToNodeReadable}}),Object.defineProperty(t,"convertWebWritableStreamToNodeWritable",{enumerable:!0,get:function(){return l.convertWebWritableStreamToNodeWritable}});const d=r(3224);Object.defineProperty(t,"MemoryStorage",{enumerable:!0,get:function(){return d.MemoryStorage}}),Object.defineProperty(t,"LocalStorage",{enumerable:!0,get:function(){return d.LocalStorage}});const p=a(r(9366));t.GameOfLifeIcon=p.default;const y=a(r(8568));t.CryptoChannel=y.default;const g=o(r(7999));t.crypto=g;const m=g.Buffer;t.Buffer=m,void 0===Symbol.dispose&&(Symbol.dispose=Symbol("Symbol.dispose"))},3224:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorage=t.MemoryStorage=t.deserialize=t.serialize=void 0;const n=r(4686),i=(e,t)=>t?"certificate"===e?"__C__"+n.Buffer.from(t).toString("base64"):"Buffer"===t.type?"_bx_"+n.Buffer.from(t.data).toString("base64"):"Array"===t.constructor.name?"_bx_"+n.Buffer.from(t).toString("base64"):t:t,s=(e,t)=>t&&"certificate"===e?"string"==typeof t&&t.startsWith("__C__")?n.Buffer.from(t.slice(5),"base64"):n.Buffer.from(t):"string"==typeof t&&t.startsWith("_bx_")?n.Buffer.from(t.slice(4),"base64"):t;t.serialize=e=>JSON.stringify(e,i),t.deserialize=e=>JSON.parse(e,s),t.MemoryStorage=e=>{let r={};return e||(e=()=>(0,t.serialize)(r)),o(r,e,(()=>""))},t.LocalStorage=(e="vaultysStorage")=>{let r={};return Math.random(),localStorage[e]?r=(0,t.deserialize)(localStorage[e]):localStorage[e]="{}",o(r,(()=>{localStorage.setItem(e,(0,t.serialize)(r))}),(()=>localStorage.removeItem(e)))};const o=(e,r,n)=>({destroy:n,save:r,toString:()=>(0,t.serialize)(e),fromString:(e,r,n)=>o((0,t.deserialize)(e),r,n),_raw:e,set:(t,r)=>e[t]=r,delete:t=>delete e[t],get:t=>e[t],list:()=>Object.keys(e).filter((e=>!e.startsWith("!"))),listSubstores:()=>Object.keys(e).filter((e=>e.startsWith("!"))).map((e=>e.slice(1))),deleteSubstore:t=>delete e["!"+t],renameSubstore:(t,r)=>{t===r||e["!"+r]||(e["!"+r]=e["!"+t],delete e["!"+t])},substore:t=>(e["!"+t]||(e["!"+t]={}),o(e["!"+t],r,n))})},3271:(e,t,r)=>{"use strict";const n=r(896),i=r(6899),s=r(8590),o=r(790),{MT:a,NUMBYTES:f,SHIFT32:c,SIMPLE:u,SYMS:h,TAG:l,BI:d}=o,{Buffer:p}=r(4686),y=a.SIMPLE_FLOAT<<5|f.TWO,g=a.SIMPLE_FLOAT<<5|f.FOUR,m=a.SIMPLE_FLOAT<<5|f.EIGHT,b=a.SIMPLE_FLOAT<<5|u.TRUE,w=a.SIMPLE_FLOAT<<5|u.FALSE,v=a.SIMPLE_FLOAT<<5|u.UNDEFINED,E=a.SIMPLE_FLOAT<<5|u.NULL,B=p.from([255]),_=p.from("f97e00","hex"),S=p.from("f9fc00","hex"),A=p.from("f97c00","hex"),I=p.from("f98000","hex"),x={};let T={};class U extends n.Transform{constructor(e={}){const{canonical:t=!1,encodeUndefined:r,disallowUndefinedKeys:n=!1,dateType:i="number",collapseBigIntegers:s=!1,detectLoops:o=!1,omitUndefinedProperties:a=!1,genTypes:f=[],...c}=e;if(super({...c,readableObjectMode:!1,writableObjectMode:!0}),this.canonical=t,this.encodeUndefined=r,this.disallowUndefinedKeys=n,this.dateType=function(e){if(!e)return"number";switch(e.toLowerCase()){case"number":return"number";case"float":return"float";case"int":case"integer":return"int";case"string":return"string"}throw new TypeError(`dateType invalid, got "${e}"`)}(i),this.collapseBigIntegers=!!this.canonical||s,this.detectLoops=void 0,"boolean"==typeof o)o&&(this.detectLoops=new WeakSet);else{if(!(o instanceof WeakSet))throw new TypeError("detectLoops must be boolean or WeakSet");this.detectLoops=o}if(this.omitUndefinedProperties=a,this.semanticTypes={...U.SEMANTIC_TYPES},Array.isArray(f))for(let e=0,t=f.length;e<t;e+=2)this.addSemanticType(f[e],f[e+1]);else for(const[e,t]of Object.entries(f))this.addSemanticType(e,t)}_transform(e,t,r){r(!1===this.pushAny(e)?new Error("Push Error"):void 0)}_flush(e){e()}_pushUInt8(e){const t=p.allocUnsafe(1);return t.writeUInt8(e,0),this.push(t)}_pushUInt16BE(e){const t=p.allocUnsafe(2);return t.writeUInt16BE(e,0),this.push(t)}_pushUInt32BE(e){const t=p.allocUnsafe(4);return t.writeUInt32BE(e,0),this.push(t)}_pushFloatBE(e){const t=p.allocUnsafe(4);return t.writeFloatBE(e,0),this.push(t)}_pushDoubleBE(e){const t=p.allocUnsafe(8);return t.writeDoubleBE(e,0),this.push(t)}_pushNaN(){return this.push(_)}_pushInfinity(e){const t=e<0?S:A;return this.push(t)}_pushFloat(e){if(this.canonical){const t=p.allocUnsafe(2);if(s.writeHalf(t,e))return this._pushUInt8(y)&&this.push(t)}return Math.fround(e)===e?this._pushUInt8(g)&&this._pushFloatBE(e):this._pushUInt8(m)&&this._pushDoubleBE(e)}_pushInt(e,t,r){const n=t<<5;if(e<24)return this._pushUInt8(n|e);if(e<=255)return this._pushUInt8(n|f.ONE)&&this._pushUInt8(e);if(e<=65535)return this._pushUInt8(n|f.TWO)&&this._pushUInt16BE(e);if(e<=4294967295)return this._pushUInt8(n|f.FOUR)&&this._pushUInt32BE(e);let i=Number.MAX_SAFE_INTEGER;return t===a.NEG_INT&&i--,e<=i?this._pushUInt8(n|f.EIGHT)&&this._pushUInt32BE(Math.floor(e/c))&&this._pushUInt32BE(e%c):t===a.NEG_INT?this._pushFloat(r):this._pushFloat(e)}_pushIntNum(e){return Object.is(e,-0)?this.push(I):e<0?this._pushInt(-e-1,a.NEG_INT,e):this._pushInt(e,a.POS_INT)}_pushNumber(e){return isNaN(e)?this._pushNaN():isFinite(e)?Math.round(e)===e?this._pushIntNum(e):this._pushFloat(e):this._pushInfinity(e)}_pushString(e){const t=p.byteLength(e,"utf8");return this._pushInt(t,a.UTF8_STRING)&&this.push(e,"utf8")}_pushBoolean(e){return this._pushUInt8(e?b:w)}_pushUndefined(e){switch(typeof this.encodeUndefined){case"undefined":return this._pushUInt8(v);case"function":return this.pushAny(this.encodeUndefined(e));case"object":{const e=s.bufferishToBuffer(this.encodeUndefined);if(e)return this.push(e)}}return this.pushAny(this.encodeUndefined)}_pushNull(e){return this._pushUInt8(E)}_pushTag(e){return this._pushInt(e,a.TAG)}_pushJSBigint(e){let t=a.POS_INT,r=l.POS_BIGINT;if(e<0&&(e=-e+d.MINUS_ONE,t=a.NEG_INT,r=l.NEG_BIGINT),this.collapseBigIntegers&&e<=d.MAXINT64)return e<=4294967295?this._pushInt(Number(e),t):this._pushUInt8(t<<5|f.EIGHT)&&this._pushUInt32BE(Number(e/d.SHIFT32))&&this._pushUInt32BE(Number(e%d.SHIFT32));let n=e.toString(16);n.length%2&&(n=`0${n}`);const i=p.from(n,"hex");return this._pushTag(r)&&U._pushBuffer(this,i)}_pushObject(e,t){if(!e)return this._pushNull(e);if(!(t={indefinite:!1,skipTypes:!1,...t}).indefinite&&this.detectLoops){if(this.detectLoops.has(e))throw new Error("Loop detected while CBOR encoding.\nCall removeLoopDetectors before resuming.");this.detectLoops.add(e)}if(!t.skipTypes){const t=e.encodeCBOR;if("function"==typeof t)return t.call(e,this);const r=this.semanticTypes[e.constructor.name];if(r)return r.call(e,this,e)}const r=Object.keys(e).filter((t=>{const r=typeof e[t];return"function"!==r&&(!this.omitUndefinedProperties||"undefined"!==r)})),n={};if(this.canonical&&r.sort(((e,t)=>{const r=n[e]||(n[e]=U.encode(e)),i=n[t]||(n[t]=U.encode(t));return r.compare(i)})),t.indefinite){if(!this._pushUInt8(a.MAP<<5|f.INDEFINITE))return!1}else if(!this._pushInt(r.length,a.MAP))return!1;let i=null;for(let t=0,s=r.length;t<s;t++){const s=r[t];if(this.canonical&&(i=n[s])){if(!this.push(i))return!1}else if(!this._pushString(s))return!1;if(!this.pushAny(e[s]))return!1}if(t.indefinite){if(!this.push(B))return!1}else this.detectLoops&&this.detectLoops.delete(e);return!0}_encodeAll(e){const t=new i({highWaterMark:this.readableHighWaterMark});this.pipe(t);for(const t of e)this.pushAny(t);return this.end(),t.read()}addSemanticType(e,t){const r="string"==typeof e?e:e.name,n=this.semanticTypes[r];if(t){if("function"!=typeof t)throw new TypeError("fun must be of type function");this.semanticTypes[r]=t}else n&&delete this.semanticTypes[r];return n}pushAny(e){switch(typeof e){case"number":return this._pushNumber(e);case"bigint":return this._pushJSBigint(e);case"string":return this._pushString(e);case"boolean":return this._pushBoolean(e);case"undefined":return this._pushUndefined(e);case"object":return this._pushObject(e);case"symbol":switch(e){case h.NULL:return this._pushNull(null);case h.UNDEFINED:return this._pushUndefined(void 0);default:throw new TypeError(`Unknown symbol: ${e.toString()}`)}default:throw new TypeError(`Unknown type: ${typeof e}, ${"function"==typeof e.toString?e.toString():""}`)}}static pushArray(e,t,r){r={indefinite:!1,...r};const n=t.length;if(r.indefinite){if(!e._pushUInt8(a.ARRAY<<5|f.INDEFINITE))return!1}else if(!e._pushInt(n,a.ARRAY))return!1;for(let r=0;r<n;r++)if(!e.pushAny(t[r]))return!1;return!(r.indefinite&&!e.push(B))}removeLoopDetectors(){return!!this.detectLoops&&(this.detectLoops=new WeakSet,!0)}static _pushDate(e,t){switch(e.dateType){case"string":return e._pushTag(l.DATE_STRING)&&e._pushString(t.toISOString());case"int":return e._pushTag(l.DATE_EPOCH)&&e._pushIntNum(Math.round(t.getTime()/1e3));case"float":return e._pushTag(l.DATE_EPOCH)&&e._pushFloat(t.getTime()/1e3);default:return e._pushTag(l.DATE_EPOCH)&&e.pushAny(t.getTime()/1e3)}}static _pushBuffer(e,t){return e._pushInt(t.length,a.BYTE_STRING)&&e.push(t)}static _pushNoFilter(e,t){return U._pushBuffer(e,t.slice())}static _pushRegexp(e,t){return e._pushTag(l.REGEXP)&&e.pushAny(t.source)}static _pushSet(e,t){if(!e._pushTag(l.SET))return!1;if(!e._pushInt(t.size,a.ARRAY))return!1;for(const r of t)if(!e.pushAny(r))return!1;return!0}static _pushURL(e,t){return e._pushTag(l.URI)&&e.pushAny(t.toString())}static _pushBoxed(e,t){return e.pushAny(t.valueOf())}static _pushMap(e,t,r){r={indefinite:!1,...r};let n=[...t.entries()];if(e.omitUndefinedProperties&&(n=n.filter((([e,t])=>void 0!==t))),r.indefinite){if(!e._pushUInt8(a.MAP<<5|f.INDEFINITE))return!1}else if(!e._pushInt(n.length,a.MAP))return!1;if(e.canonical){const t=new U({genTypes:e.semanticTypes,canonical:e.canonical,detectLoops:Boolean(e.detectLoops),dateType:e.dateType,disallowUndefinedKeys:e.disallowUndefinedKeys,collapseBigIntegers:e.collapseBigIntegers}),r=new i({highWaterMark:e.readableHighWaterMark});t.pipe(r),n.sort((([e],[n])=>{t.pushAny(e);const i=r.read();t.pushAny(n);const s=r.read();return i.compare(s)}));for(const[t,r]of n){if(e.disallowUndefinedKeys&&void 0===t)throw new Error("Invalid Map key: undefined");if(!e.pushAny(t)||!e.pushAny(r))return!1}}else for(const[t,r]of n){if(e.disallowUndefinedKeys&&void 0===t)throw new Error("Invalid Map key: undefined");if(!e.pushAny(t)||!e.pushAny(r))return!1}return!(r.indefinite&&!e.push(B))}static _pushTypedArray(e,t){let r=64,n=t.BYTES_PER_ELEMENT;const{name:i}=t.constructor;return i.startsWith("Float")?(r|=16,n/=2):i.includes("U")||(r|=8),(i.includes("Clamped")||1!==n&&!s.isBigEndian())&&(r|=4),r|={1:0,2:1,4:2,8:3}[n],!!e._pushTag(r)&&U._pushBuffer(e,p.from(t.buffer,t.byteOffset,t.byteLength))}static _pushArrayBuffer(e,t){return U._pushBuffer(e,p.from(t))}static encodeIndefinite(e,t,r={}){if(null==t){if(null==this)throw new Error("No object to encode");t=this}const{chunkSize:n=4096}=r;let i=!0;const o=typeof t;let c=null;if("string"===o){i=i&&e._pushUInt8(a.UTF8_STRING<<5|f.INDEFINITE);let r=0;for(;r<t.length;){const s=r+n;i=i&&e._pushString(t.slice(r,s)),r=s}i=i&&e.push(B)}else if(c=s.bufferishToBuffer(t)){i=i&&e._pushUInt8(a.BYTE_STRING<<5|f.INDEFINITE);let t=0;for(;t<c.length;){const r=t+n;i=i&&U._pushBuffer(e,c.slice(t,r)),t=r}i=i&&e.push(B)}else if(Array.isArray(t))i=i&&U.pushArray(e,t,{indefinite:!0});else if(t instanceof Map)i=i&&U._pushMap(e,t,{indefinite:!0});else{if("object"!==o)throw new Error("Invalid indefinite encoding");i=i&&e._pushObject(t,{indefinite:!0,skipTypes:!0})}return i}static encode(...e){return(new U)._encodeAll(e)}static encodeCanonical(...e){return new U({canonical:!0})._encodeAll(e)}static encodeOne(e,t){return new U(t)._encodeAll([e])}static encodeAsync(e,t){return new Promise(((r,n)=>{const i=[],s=new U(t);s.on("data",(e=>i.push(e))),s.on("error",n),s.on("finish",(()=>r(p.concat(i)))),s.pushAny(e),s.end()}))}static get SEMANTIC_TYPES(){return T}static set SEMANTIC_TYPES(e){T=e}static reset(){U.SEMANTIC_TYPES={...x}}}Object.assign(x,{Array:U.pushArray,Date:U._pushDate,Buffer:U._pushBuffer,[p.name]:U._pushBuffer,Map:U._pushMap,NoFilter:U._pushNoFilter,[i.name]:U._pushNoFilter,RegExp:U._pushRegexp,Set:U._pushSet,ArrayBuffer:U._pushArrayBuffer,Uint8ClampedArray:U._pushTypedArray,Uint8Array:U._pushTypedArray,Uint16Array:U._pushTypedArray,Uint32Array:U._pushTypedArray,Int8Array:U._pushTypedArray,Int16Array:U._pushTypedArray,Int32Array:U._pushTypedArray,Float32Array:U._pushTypedArray,Float64Array:U._pushTypedArray,URL:U._pushURL,Boolean:U._pushBoxed,Number:U._pushBoxed,String:U._pushBoxed}),"undefined"!=typeof BigUint64Array&&(x[BigUint64Array.name]=U._pushTypedArray),"undefined"!=typeof BigInt64Array&&(x[BigInt64Array.name]=U._pushTypedArray),U.reset(),e.exports=U},3639:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(2655),s=r(7999),o=n(r(4981)),a=r(4686),f=-2,c=-1,u=(e,t)=>a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii"),a.Buffer.from([160+t.length]),a.Buffer.from(t,"ascii")]),h=(e,t)=>{const r=a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii")]);let n;return n=t.length<=65535?a.Buffer.from([197,t.length>>8&255,255&t.length]):a.Buffer.from([198,t.length>>24&255,t.length>>16&255,t.length>>8&255,255&t.length]),a.Buffer.concat([r,n,t])},l=(e,t)=>{const r=a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii")]);let n;if(t>=0&&t<=127)n=a.Buffer.from([t]);else if(t<0&&t>=-32)n=a.Buffer.from([t]);else if(t>0&&t<=255)n=a.Buffer.from([204,t]);else if(t>=-128&&t<=127)n=a.Buffer.from([208,t]);else if(t>0&&t<=65535)n=a.Buffer.from([205,t>>>8,t]);else if(t>=-32768&&t<=32767)n=a.Buffer.from([209,t>>>8,t]);else if(t>0&&t<=4294967295)n=a.Buffer.from([206,t>>>24,t>>>16,t>>>8,t]);else if(t>=-2147483648&&t<=2147483647)n=a.Buffer.from([210,t>>>24,t>>>16,t>>>8,t]);else if(t>0&&t<=0xffffffffffffffffn){const e=t/2**32,r=t%2**32;n=a.Buffer.from([211,e>>>24,e>>>16,e>>>8,e,r>>>24,r>>>16,r>>>8,r])}else n=a.Buffer.from([0]);return a.Buffer.concat([r,n])},d=e=>{const t=(0,i.decode)(e),r={state:f,error:""};t.version||(t.version=0);const n={...t,...r};try{if(n.timestamp&&n.protocol&&n.service)if(n.pk2||!n.pk1||n.sign1||n.sign2||16!==n.nonce?.length){if(!n.sign1&&32===n.nonce?.length&&n.pk1&&n.pk2&&n.sign2){n.state=1;const e=o.default.fromId(n.pk2),t=p(n);e.verifyChallenge(t,n.sign2,!0)||(n.state=f,n.error="[STEP1] failed the verification of pk2")}else if(n.sign1&&32===n.nonce?.length&&n.pk1&&n.pk2&&n.sign2){n.state=2;const e=o.default.fromId(n.pk1),r=o.default.fromId(n.pk2);e.version===t.version&&r.version===t.version||(n.state=f,n.error="[COMPLETE] pk1 and pk2 are using different serialization version");const i=p(n);r.verifyChallenge(i,n.sign2,!0)||(n.state=f,n.error="[COMPLETE] failed the verification of pk2"),e.verifyChallenge(i,n.sign1,!0)||(n.state=f,n.error="[COMPLETE] failed the verification of pk1")}}else n.state=0;else n.state=f,n.error="[ERROR] Challenge is missing values"}catch(e){n.error="["+n.state+" -> ERROR] "+e,n.state=f}return n},p=e=>{const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,metadata:d}=e,p={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,metadata:d};return 0===t?(({version:e,protocol:t,service:r,timestamp:n,pk1:i,pk2:s,nonce:o,metadata:f})=>a.Buffer.concat([a.Buffer.from([135]),u("protocol",t),u("service",r),l("timestamp",n),h("pk1",i),h("pk2",s),h("nonce",o),a.Buffer.from([168]),a.Buffer.from("metadata","ascii"),a.Buffer.from([128])]))(p):a.Buffer.from((0,i.encode)(p))},y=(e,t,r=Date.now())=>e.timestamp>r-t&&e.timestamp<r+t;class g{constructor(e,t=6e4){this.version=0,this.state=c,this.vaultysId=o.default.fromSecret(e.getSecret()),this.liveliness=t}static async verifyCertificate(e){return 2===d(e).state}static async fromCertificate(e,t){const r=d(e);if(r.version||(r.version=0),0===r.state){const e=new g(o.default.fromId(r.pk1).toVersion(r.version),t);e.challenge=r,e.mykey=r.pk1,e.state=0}else if(1===r.state){const e=new g(o.default.fromId(r.pk2).toVersion(r.version),t);return e.challenge=r,e.mykey=r.pk2,e.hisKey=r.pk1,e.state=1,e}}async setChallenge(e){if(this.state!==c)throw this.state=f,new Error("Challenger already initialised, can't reset the state");if(this.challenge=d(e),this.version=this.challenge.version,!y(this.challenge,this.liveliness))throw this.state=f,this.challenge.error="challenge timestamp failed the liveliness at first signature",new Error(this.challenge.error);if(this.challenge.state===f)throw this.state=f,new Error(this.challenge.error);if(0===this.challenge.state){this.mykey=this.vaultysId.id,this.challenge.pk2=this.mykey,this.hisKey=this.challenge.pk1,this.challenge.nonce=a.Buffer.concat([this.challenge.nonce||new Uint8Array,(0,s.randomBytes)(16)]);const e=this.getUnsignedChallenge();if(!e)throw new Error("Error processing Challenge");this.challenge.sign2=await this.vaultysId.signChallenge(e)||void 0,this.challenge.state=this.state=1}else{if(2!==this.challenge.state)throw new Error("Challenge is from a protocol already launched, this is completely unsafe");if(this.mykey=this.vaultysId.id,!this.challenge.pk1?.equals(this.mykey)&&!this.challenge.pk1?.equals(this.mykey))throw this.state=f,new Error("Can't link the vaultys id to this challenge");this.state=2}}getContext(){return{protocol:this.challenge?.protocol,service:this.challenge?.service,metadata:this.challenge?.metadata}}createChallenge(e,t,r=0,n){if(this.version=r,this.state!=c)throw this.state=f,new Error("Challenger already initialised, can't reset the state");this.mykey=this.vaultysId.toVersion(r).id,this.challenge={version:r,protocol:e,service:t,metadata:n?{pk1:n}:{},timestamp:Date.now(),pk1:this.mykey,nonce:(0,s.randomBytes)(16),state:0},this.state=0}getCertificate(){return this.challenge&&(e=>{if(0==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,nonce:f,metadata:c}=e,u={version:t,protocol:r,service:n,timestamp:s,pk1:o,nonce:f,metadata:c},h=(0,i.encode)(u);return a.Buffer.from(h)}if(1==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign2:u,metadata:h}=e,l={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign2:u,metadata:h},d=(0,i.encode)(l);return a.Buffer.from(d)}if(2==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign1:u,sign2:h,metadata:l}=e,d={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign1:u,sign2:h,metadata:l},p=(0,i.encode)(d);return a.Buffer.from(p)}return null})(this.challenge)||a.Buffer.from([])}getUnsignedChallenge(){return p(this.challenge)}getContactDid(){return this.hisKey?o.default.fromId(this.hisKey).did:null}getContactId(){if(this.isComplete())return o.default.fromId(this.hisKey,this.getCertificate()||void 0);throw new Error("The challenge is not COMPLETE, it is unsafe to get the Contact ID before")}static fromString(e,t){const r=new g(e);return r.setChallenge(t),r}hasFailed(){return this.state==f}isComplete(){return 2==this.state}async init(e){if(this.state!==c)throw new Error("Can't init INITIALISED challenge");const t=d(e);if(this.version=t.version=t.version?1:0,this.vaultysId.toVersion(this.version),0===t.state){if(t.pk2?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");return this.challenge=t,this.version=t.version,this.mykey=this.challenge.pk2=this.vaultysId.id,this.hisKey=this.challenge.pk1,void(this.challenge.state=this.state=0)}if(1===t.state){if(t.pk2?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");return this.challenge=t,this.version=t.version,this.mykey=this.challenge.pk2,this.hisKey=this.challenge.pk1,void(this.state=this.challenge.state=1)}}async update(e,t){if(this.state===f)throw new Error("Can't update errorneous challenge");if(2===this.state)throw new Error("Can't update COMPLETE challenge");{const r=d(e);if(!r)throw this.state=f,new Error("Can't read the new incoming challenge");if(r.state===f)throw this.state=f,new Error(r.error);if(!y(r,this.liveliness))throw this.state=f,new Error("challenge timestamp failed the liveliness");if(this.version=r.version,this.vaultysId.toVersion(this.version),this.state===c&&0===r.state){if(r.metadata.pk2)throw this.state=f,new Error("Metadata is malformed: pk2 is already set");this.challenge=r,this.mykey=this.challenge.pk2=this.vaultysId.id,this.hisKey=this.challenge.pk1,t&&(this.challenge.metadata.pk2=t),this.challenge.nonce=a.Buffer.concat([this.challenge.nonce,(0,s.randomBytes)(16)]);const e=this.getUnsignedChallenge();return this.challenge.sign2=await this.vaultysId.signChallenge(e),void(this.challenge.state=this.state=1)}if(this.state===c&&1===r.state){if(r.pk1?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");const e=p(r);return r.sign1=await this.vaultysId.signChallenge(e),this.challenge=r,this.mykey=this.challenge.pk1,this.hisKey=this.challenge.pk2,void(this.state=this.challenge.state=2)}if(this.state===c&&2===r.state)return void console.log("COMPLETE case?!!");if(r.protocol!==this.challenge.protocol||r.service!==this.challenge.service)throw this.state=f,new Error(`The challenge was expecting protocol '${this.challenge.protocol}' and service '${this.challenge.service}', received '${r.protocol}' and '${r.service}'`);if(0===this.state&&1===r.state){if(!r.nonce?.subarray(0,16).equals(this.challenge.nonce.subarray(0,16)))throw this.state=f,new Error("Nonce has been tampered with");if(r.timestamp!==this.challenge?.timestamp)throw this.state=f,new Error("Timestamp has been tampered with");if(!this.mykey?.equals(r.pk1))throw this.state=f,new Error(`The challenge has been tampered with. Received pk1 = '${r.pk1}', expected pk1 = '${this.mykey}'`);const e=p(r);if(!e)throw this.state=f,new Error("Error processing Challenge");r.sign1=await this.vaultysId.signChallenge(e),this.challenge=r,this.hisKey=r.pk2,this.state=this.challenge.state=2}else{if(1!==this.state||2!==r.state){const e=`The challenge is in an expected state. Received state = '${r.state}', expected state = '${this.state+1}'`;throw this.state=f,new Error(e)}if(r.protocol!==this.challenge.protocol||r.service!==this.challenge.service)throw this.state=f,new Error(`The challenge was expecting protocol '${this.challenge.protocol}' and service '${this.challenge.service}', received '${r.protocol}' and '${r.service}'`);if(!r.nonce?.subarray(16,32).equals(this.challenge.nonce.subarray(16,32)))throw this.state=f,new Error("Nonce has been tampered with");if(r.timestamp!==this.challenge?.timestamp)throw this.state=f,new Error("Timestamp has been tampered with");if(!this.mykey.equals(r.pk2))throw this.state=f,new Error("The challenge pk2 has been tampered with");this.challenge=r,this.state=2}}}}g.deserializeCertificate=d,g.serializeCertificate_v0=({version:e,protocol:t,service:r,timestamp:n,pk1:i,pk2:s,nonce:o,sign1:f,sign2:c,metadata:d})=>a.Buffer.concat([a.Buffer.from([137]),u("protocol",t),u("service",r),l("timestamp",n),h("pk1",i),h("pk2",s),h("nonce",o),h("sign1",f),h("sign2",c),a.Buffer.from([168]),a.Buffer.from("metadata","ascii"),a.Buffer.from([128])]),g.serializeCertificate=p,t.default=g},3835:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hmac=t.HMAC=void 0;const n=r(11);class i extends n.Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,n.ahash)(e);const r=(0,n.toBytes)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),(0,n.clean)(s)}update(e){return(0,n.aexists)(this),this.iHash.update(e),this}digestInto(e){(0,n.aexists)(this),(0,n.abytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}t.HMAC=i,t.hmac=(e,t,r)=>new i(e,t).update(r).digest(),t.hmac.create=(e,t)=>new i(e,t)},3842:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toBig=t.shrSL=t.shrSH=t.rotrSL=t.rotrSH=t.rotrBL=t.rotrBH=t.rotr32L=t.rotr32H=t.rotlSL=t.rotlSH=t.rotlBL=t.rotlBH=t.add5L=t.add5H=t.add4L=t.add4H=t.add3L=t.add3H=void 0,t.add=w,t.fromBig=i,t.split=s;const r=BigInt(2**32-1),n=BigInt(32);function i(e,t=!1){return t?{h:Number(e&r),l:Number(e>>n&r)}:{h:0|Number(e>>n&r),l:0|Number(e&r)}}function s(e,t=!1){const r=e.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:a}=i(e[o],t);[n[o],s[o]]=[r,a]}return[n,s]}const o=(e,t)=>BigInt(e>>>0)<<n|BigInt(t>>>0);t.toBig=o;const a=(e,t,r)=>e>>>r;t.shrSH=a;const f=(e,t,r)=>e<<32-r|t>>>r;t.shrSL=f;const c=(e,t,r)=>e>>>r|t<<32-r;t.rotrSH=c;const u=(e,t,r)=>e<<32-r|t>>>r;t.rotrSL=u;const h=(e,t,r)=>e<<64-r|t>>>r-32;t.rotrBH=h;const l=(e,t,r)=>e>>>r-32|t<<64-r;t.rotrBL=l;const d=(e,t)=>t;t.rotr32H=d;const p=(e,t)=>e;t.rotr32L=p;const y=(e,t,r)=>e<<r|t>>>32-r;t.rotlSH=y;const g=(e,t,r)=>t<<r|e>>>32-r;t.rotlSL=g;const m=(e,t,r)=>t<<r-32|e>>>64-r;t.rotlBH=m;const b=(e,t,r)=>e<<r-32|t>>>64-r;function w(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}}t.rotlBL=b;const v=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);t.add3L=v;const E=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;t.add3H=E;const B=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);t.add4L=B;const _=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;t.add4H=_;const S=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);t.add5L=S;const A=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;t.add5H=A;const I={fromBig:i,split:s,toBig:o,shrSH:a,shrSL:f,rotrSH:c,rotrSL:u,rotrBH:h,rotrBL:l,rotr32H:d,rotr32L:p,rotlSH:y,rotlSL:g,rotlBH:m,rotlBL:b,add:w,add3L:v,add3H:E,add4L:B,add4H:_,add5H:A,add5L:S};t.default=I},4072:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sha512_224=t.sha512_256=t.sha384=t.sha512=t.sha224=t.sha256=t.SHA512_256=t.SHA512_224=t.SHA384=t.SHA512=t.SHA224=t.SHA256=void 0;const n=r(7734),i=r(3842),s=r(11),o=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array(64);class f extends n.HashMD{constructor(e=32){super(64,e,8,!1),this.A=0|n.SHA256_IV[0],this.B=0|n.SHA256_IV[1],this.C=0|n.SHA256_IV[2],this.D=0|n.SHA256_IV[3],this.E=0|n.SHA256_IV[4],this.F=0|n.SHA256_IV[5],this.G=0|n.SHA256_IV[6],this.H=0|n.SHA256_IV[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)a[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=a[e-15],r=a[e-2],n=(0,s.rotr)(t,7)^(0,s.rotr)(t,18)^t>>>3,i=(0,s.rotr)(r,17)^(0,s.rotr)(r,19)^r>>>10;a[e]=i+a[e-7]+n+a[e-16]|0}let{A:r,B:i,C:f,D:c,E:u,F:h,G:l,H:d}=this;for(let e=0;e<64;e++){const t=d+((0,s.rotr)(u,6)^(0,s.rotr)(u,11)^(0,s.rotr)(u,25))+(0,n.Chi)(u,h,l)+o[e]+a[e]|0,p=((0,s.rotr)(r,2)^(0,s.rotr)(r,13)^(0,s.rotr)(r,22))+(0,n.Maj)(r,i,f)|0;d=l,l=h,h=u,u=c+t|0,c=f,f=i,i=r,r=t+p|0}r=r+this.A|0,i=i+this.B|0,f=f+this.C|0,c=c+this.D|0,u=u+this.E|0,h=h+this.F|0,l=l+this.G|0,d=d+this.H|0,this.set(r,i,f,c,u,h,l,d)}roundClean(){(0,s.clean)(a)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,s.clean)(this.buffer)}}t.SHA256=f;class c extends f{constructor(){super(28),this.A=0|n.SHA224_IV[0],this.B=0|n.SHA224_IV[1],this.C=0|n.SHA224_IV[2],this.D=0|n.SHA224_IV[3],this.E=0|n.SHA224_IV[4],this.F=0|n.SHA224_IV[5],this.G=0|n.SHA224_IV[6],this.H=0|n.SHA224_IV[7]}}t.SHA224=c;const u=(()=>i.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),h=(()=>u[0])(),l=(()=>u[1])(),d=new Uint32Array(80),p=new Uint32Array(80);class y extends n.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=0|n.SHA512_IV[0],this.Al=0|n.SHA512_IV[1],this.Bh=0|n.SHA512_IV[2],this.Bl=0|n.SHA512_IV[3],this.Ch=0|n.SHA512_IV[4],this.Cl=0|n.SHA512_IV[5],this.Dh=0|n.SHA512_IV[6],this.Dl=0|n.SHA512_IV[7],this.Eh=0|n.SHA512_IV[8],this.El=0|n.SHA512_IV[9],this.Fh=0|n.SHA512_IV[10],this.Fl=0|n.SHA512_IV[11],this.Gh=0|n.SHA512_IV[12],this.Gl=0|n.SHA512_IV[13],this.Hh=0|n.SHA512_IV[14],this.Hl=0|n.SHA512_IV[15]}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:f,El:c,Fh:u,Fl:h,Gh:l,Gl:d,Hh:p,Hl:y}=this;return[e,t,r,n,i,s,o,a,f,c,u,h,l,d,p,y]}set(e,t,r,n,i,s,o,a,f,c,u,h,l,d,p,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|f,this.El=0|c,this.Fh=0|u,this.Fl=0|h,this.Gh=0|l,this.Gl=0|d,this.Hh=0|p,this.Hl=0|y}process(e,t){for(let r=0;r<16;r++,t+=4)d[r]=e.getUint32(t),p[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|d[e-15],r=0|p[e-15],n=i.rotrSH(t,r,1)^i.rotrSH(t,r,8)^i.shrSH(t,r,7),s=i.rotrSL(t,r,1)^i.rotrSL(t,r,8)^i.shrSL(t,r,7),o=0|d[e-2],a=0|p[e-2],f=i.rotrSH(o,a,19)^i.rotrBH(o,a,61)^i.shrSH(o,a,6),c=i.rotrSL(o,a,19)^i.rotrBL(o,a,61)^i.shrSL(o,a,6),u=i.add4L(s,c,p[e-7],p[e-16]),h=i.add4H(u,n,f,d[e-7],d[e-16]);d[e]=0|h,p[e]=0|u}let{Ah:r,Al:n,Bh:s,Bl:o,Ch:a,Cl:f,Dh:c,Dl:u,Eh:y,El:g,Fh:m,Fl:b,Gh:w,Gl:v,Hh:E,Hl:B}=this;for(let e=0;e<80;e++){const t=i.rotrSH(y,g,14)^i.rotrSH(y,g,18)^i.rotrBH(y,g,41),_=i.rotrSL(y,g,14)^i.rotrSL(y,g,18)^i.rotrBL(y,g,41),S=y&m^~y&w,A=g&b^~g&v,I=i.add5L(B,_,A,l[e],p[e]),x=i.add5H(I,E,t,S,h[e],d[e]),T=0|I,U=i.rotrSH(r,n,28)^i.rotrBH(r,n,34)^i.rotrBH(r,n,39),O=i.rotrSL(r,n,28)^i.rotrBL(r,n,34)^i.rotrBL(r,n,39),R=r&s^r&a^s&a,k=n&o^n&f^o&f;E=0|w,B=0|v,w=0|m,v=0|b,m=0|y,b=0|g,({h:y,l:g}=i.add(0|c,0|u,0|x,0|T)),c=0|a,u=0|f,a=0|s,f=0|o,s=0|r,o=0|n;const M=i.add3L(T,O,k);r=i.add3H(M,x,U,R),n=0|M}({h:r,l:n}=i.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:s,l:o}=i.add(0|this.Bh,0|this.Bl,0|s,0|o)),({h:a,l:f}=i.add(0|this.Ch,0|this.Cl,0|a,0|f)),({h:c,l:u}=i.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h:y,l:g}=i.add(0|this.Eh,0|this.El,0|y,0|g)),({h:m,l:b}=i.add(0|this.Fh,0|this.Fl,0|m,0|b)),({h:w,l:v}=i.add(0|this.Gh,0|this.Gl,0|w,0|v)),({h:E,l:B}=i.add(0|this.Hh,0|this.Hl,0|E,0|B)),this.set(r,n,s,o,a,f,c,u,y,g,m,b,w,v,E,B)}roundClean(){(0,s.clean)(d,p)}destroy(){(0,s.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}t.SHA512=y;class g extends y{constructor(){super(48),this.Ah=0|n.SHA384_IV[0],this.Al=0|n.SHA384_IV[1],this.Bh=0|n.SHA384_IV[2],this.Bl=0|n.SHA384_IV[3],this.Ch=0|n.SHA384_IV[4],this.Cl=0|n.SHA384_IV[5],this.Dh=0|n.SHA384_IV[6],this.Dl=0|n.SHA384_IV[7],this.Eh=0|n.SHA384_IV[8],this.El=0|n.SHA384_IV[9],this.Fh=0|n.SHA384_IV[10],this.Fl=0|n.SHA384_IV[11],this.Gh=0|n.SHA384_IV[12],this.Gl=0|n.SHA384_IV[13],this.Hh=0|n.SHA384_IV[14],this.Hl=0|n.SHA384_IV[15]}}t.SHA384=g;const m=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),b=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class w extends y{constructor(){super(28),this.Ah=0|m[0],this.Al=0|m[1],this.Bh=0|m[2],this.Bl=0|m[3],this.Ch=0|m[4],this.Cl=0|m[5],this.Dh=0|m[6],this.Dl=0|m[7],this.Eh=0|m[8],this.El=0|m[9],this.Fh=0|m[10],this.Fl=0|m[11],this.Gh=0|m[12],this.Gl=0|m[13],this.Hh=0|m[14],this.Hl=0|m[15]}}t.SHA512_224=w;class v extends y{constructor(){super(32),this.Ah=0|b[0],this.Al=0|b[1],this.Bh=0|b[2],this.Bl=0|b[3],this.Ch=0|b[4],this.Cl=0|b[5],this.Dh=0|b[6],this.Dl=0|b[7],this.Eh=0|b[8],this.El=0|b[9],this.Fh=0|b[10],this.Fl=0|b[11],this.Gh=0|b[12],this.Gl=0|b[13],this.Hh=0|b[14],this.Hl=0|b[15]}}t.SHA512_256=v,t.sha256=(0,s.createHasher)((()=>new f)),t.sha224=(0,s.createHasher)((()=>new c)),t.sha512=(0,s.createHasher)((()=>new y)),t.sha384=(0,s.createHasher)((()=>new g)),t.sha512_256=(0,s.createHasher)((()=>new v)),t.sha512_224=(0,s.createHasher)((()=>new w))},4084:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PQ_COSE_KEY_PARAMS=t.PQ_COSE_KEY_TYPE=t.PQ_COSE_ALG=void 0,t.generateDilithiumKeyPair=function(e){e||(e=(0,s.randomBytes)(32));const t=n.ml_dsa65.keygen(e);return{publicKey:i.Buffer.from(t.publicKey),secretKey:i.Buffer.from(t.secretKey)}},t.signDilithium=function(e,t){return i.Buffer.from(n.ml_dsa65.sign(t,e))},t.verifyDilithium=function(e,t,r){return n.ml_dsa65.verify(r,e,t)},t.createDilithiumCoseKey=function(e){const r=new Map;return r.set(1,t.PQ_COSE_KEY_TYPE.DILITHIUM),r.set(3,t.PQ_COSE_ALG.DILITHIUM2),r.set(t.PQ_COSE_KEY_PARAMS.DILITHIUM_MODE,2),r.set(t.PQ_COSE_KEY_PARAMS.DILITHIUM_PK,e),r},t.getDilithiumKeyInfo=function(){return{publicKeySize:1952,secretKeySize:4032,signatureSize:3309}};const n=r(2404),i=r(4686),s=r(7999);t.PQ_COSE_ALG={DILITHIUM2:-46,DILITHIUM3:-47,DILITHIUM5:-48},t.PQ_COSE_KEY_TYPE={DILITHIUM:4},t.PQ_COSE_KEY_PARAMS={DILITHIUM_MODE:-100,DILITHIUM_PK:-101,DILITHIUM_SK:-102}},4105:(e,t,r)=>{"use strict";var n=r(6671).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=f,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=l,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function f(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function l(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.I=s,s.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=o(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},4324:(e,t,r)=>{"use strict";var n,i=r(8558);e.exports=A,A.ReadableState=S,r(9784).EventEmitter;var s,o=function(e,t){return e.listeners(t).length},a=r(9481),f=r(4686).Buffer,c=(void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},u=r(8854);s=u&&u.debuglog?u.debuglog("stream"):function(){};var h,l,d,p=r(9865),y=r(4552),g=r(7963).getHighWaterMark,m=r(8704).F,b=m.ERR_INVALID_ARG_TYPE,w=m.ERR_STREAM_PUSH_AFTER_EOF,v=m.ERR_METHOD_NOT_IMPLEMENTED,E=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(6192)(A,a);var B=y.errorOrDestroy,_=["error","close","destroy","pause","resume"];function S(e,t,i){n=n||r(5606),e=e||{},"boolean"!=typeof i&&(i=t instanceof n),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(4105).I),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function A(e){if(n=n||r(5606),!(this instanceof A))return new A(e);var t=this instanceof n;this._readableState=new S(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function I(e,t,r,n,i){s("readableAddChunk",t);var o,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(s("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?O(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,R(e)))}}(e,a);else if(i||(o=function(e,t){var r,n;return n=t,f.isBuffer(n)||n instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new b("chunk",["string","Buffer","Uint8Array"],t)),r}(a,t)),o)B(e,o);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===f.prototype||(t=function(e){return f.from(e)}(t)),n)a.endEmitted?B(e,new E):x(e,a,t,!0);else if(a.ended)B(e,new w);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?x(e,a,t,!1):k(e,a)):x(e,a,t,!1)}else n||(a.reading=!1,k(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function x(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&O(e)),k(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=y.destroy,A.prototype._undestroy=y.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=f.from(e,t),t=""),r=!0),I(this,e,t,!1,r)},A.prototype.unshift=function(e){return I(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(e){h||(h=r(4105).I);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var T=1073741824;function U(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=T?e=T:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;s("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(s("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(R,e))}function R(e){var t=e._readableState;s("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function k(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(M,e,t))}function M(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(s("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function C(e){s("readable nexttick read 0"),e.read(0)}function P(e,t){s("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(s("flow",t.flowing);t.flowing&&null!==e.read(););}function D(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;s("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(H,t,e))}function H(e,t){if(s("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function j(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}A.prototype.read=function(e){s("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return s("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):O(this),null;if(0===(e=U(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return s("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&s("length less than watermark",i=!0),t.ended||t.reading?s("reading or ended",i=!1):i&&(s("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=U(r,t))),null===(n=e>0?D(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},A.prototype._read=function(e){B(this,new v("_read()"))},A.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,s("pipe count=%d opts=%j",n.pipesCount,t);var a=t&&!1===t.end||e===i.stdout||e===i.stderr?y:f;function f(){s("onend"),e.end()}n.endEmitted?i.nextTick(a):r.once("end",a),e.on("unpipe",(function t(i,o){s("onunpipe"),i===r&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,s("cleanup"),e.removeListener("close",d),e.removeListener("finish",p),e.removeListener("drain",c),e.removeListener("error",l),e.removeListener("unpipe",t),r.removeListener("end",f),r.removeListener("end",y),r.removeListener("data",h),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}));var c=function(e){return function(){var t=e._readableState;s("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var u=!1;function h(t){s("ondata");var i=e.write(t);s("dest.write",i),!1===i&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==j(n.pipes,e))&&!u&&(s("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function l(t){s("onerror",t),y(),e.removeListener("error",l),0===o(e,"error")&&B(e,t)}function d(){e.removeListener("finish",p),y()}function p(){s("onfinish"),e.removeListener("close",d),y()}function y(){s("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",l),e.once("close",d),e.once("finish",p),e.emit("pipe",r),n.flowing||(s("pipe resume"),r.resume()),e},A.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=j(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},A.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,s("on readable",n.length,n.reading),n.length?O(this):n.reading||i.nextTick(C,this))),r},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(e,t){var r=a.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(L,this),r},A.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(L,this),t},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(s("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(P,e,t))}(this,e)),e.paused=!1,this},A.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(s("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){s("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<_.length;o++)e.on(_[o],this.emit.bind(this,_[o]));return this._read=function(t){s("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===l&&(l=r(9035)),l(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=D,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(e,t){return void 0===d&&(d=r(6869)),d(A,e,t)})},4406:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var o=t(),a=t([1]),f=t([56129,1]),c=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function y(e,t,r,n,i){var s,o=0;for(s=0;s<i;s++)o|=e[t+s]^r[n+s];return(1&o-1>>>8)-1}function g(e,t,r,n){return y(e,t,r,n,16)}function m(e,t,r,n){return y(e,t,r,n,32)}function b(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,c=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,b=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,v=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,E=s,B=o,_=a,S=f,A=c,I=u,x=h,T=l,U=d,O=p,R=y,k=g,M=m,L=b,C=w,P=v,N=0;N<20;N+=2)E^=(i=(M^=(i=(U^=(i=(A^=(i=E+M|0)<<7|i>>>25)+E|0)<<9|i>>>23)+A|0)<<13|i>>>19)+U|0)<<18|i>>>14,I^=(i=(B^=(i=(L^=(i=(O^=(i=I+B|0)<<7|i>>>25)+I|0)<<9|i>>>23)+O|0)<<13|i>>>19)+L|0)<<18|i>>>14,R^=(i=(x^=(i=(_^=(i=(C^=(i=R+x|0)<<7|i>>>25)+R|0)<<9|i>>>23)+C|0)<<13|i>>>19)+_|0)<<18|i>>>14,P^=(i=(k^=(i=(T^=(i=(S^=(i=P+k|0)<<7|i>>>25)+P|0)<<9|i>>>23)+S|0)<<13|i>>>19)+T|0)<<18|i>>>14,E^=(i=(S^=(i=(_^=(i=(B^=(i=E+S|0)<<7|i>>>25)+E|0)<<9|i>>>23)+B|0)<<13|i>>>19)+_|0)<<18|i>>>14,I^=(i=(A^=(i=(T^=(i=(x^=(i=I+A|0)<<7|i>>>25)+I|0)<<9|i>>>23)+x|0)<<13|i>>>19)+T|0)<<18|i>>>14,R^=(i=(O^=(i=(U^=(i=(k^=(i=R+O|0)<<7|i>>>25)+R|0)<<9|i>>>23)+k|0)<<13|i>>>19)+U|0)<<18|i>>>14,P^=(i=(C^=(i=(L^=(i=(M^=(i=P+C|0)<<7|i>>>25)+P|0)<<9|i>>>23)+M|0)<<13|i>>>19)+L|0)<<18|i>>>14;E=E+s|0,B=B+o|0,_=_+a|0,S=S+f|0,A=A+c|0,I=I+u|0,x=x+h|0,T=T+l|0,U=U+d|0,O=O+p|0,R=R+y|0,k=k+g|0,M=M+m|0,L=L+b|0,C=C+w|0,P=P+v|0,e[0]=E>>>0&255,e[1]=E>>>8&255,e[2]=E>>>16&255,e[3]=E>>>24&255,e[4]=B>>>0&255,e[5]=B>>>8&255,e[6]=B>>>16&255,e[7]=B>>>24&255,e[8]=_>>>0&255,e[9]=_>>>8&255,e[10]=_>>>16&255,e[11]=_>>>24&255,e[12]=S>>>0&255,e[13]=S>>>8&255,e[14]=S>>>16&255,e[15]=S>>>24&255,e[16]=A>>>0&255,e[17]=A>>>8&255,e[18]=A>>>16&255,e[19]=A>>>24&255,e[20]=I>>>0&255,e[21]=I>>>8&255,e[22]=I>>>16&255,e[23]=I>>>24&255,e[24]=x>>>0&255,e[25]=x>>>8&255,e[26]=x>>>16&255,e[27]=x>>>24&255,e[28]=T>>>0&255,e[29]=T>>>8&255,e[30]=T>>>16&255,e[31]=T>>>24&255,e[32]=U>>>0&255,e[33]=U>>>8&255,e[34]=U>>>16&255,e[35]=U>>>24&255,e[36]=O>>>0&255,e[37]=O>>>8&255,e[38]=O>>>16&255,e[39]=O>>>24&255,e[40]=R>>>0&255,e[41]=R>>>8&255,e[42]=R>>>16&255,e[43]=R>>>24&255,e[44]=k>>>0&255,e[45]=k>>>8&255,e[46]=k>>>16&255,e[47]=k>>>24&255,e[48]=M>>>0&255,e[49]=M>>>8&255,e[50]=M>>>16&255,e[51]=M>>>24&255,e[52]=L>>>0&255,e[53]=L>>>8&255,e[54]=L>>>16&255,e[55]=L>>>24&255,e[56]=C>>>0&255,e[57]=C>>>8&255,e[58]=C>>>16&255,e[59]=C>>>24&255,e[60]=P>>>0&255,e[61]=P>>>8&255,e[62]=P>>>16&255,e[63]=P>>>24&255}(e,t,r,n)}function w(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,c=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,u=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,b=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,v=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,E=0;E<20;E+=2)s^=(i=(m^=(i=(d^=(i=(c^=(i=s+m|0)<<7|i>>>25)+s|0)<<9|i>>>23)+c|0)<<13|i>>>19)+d|0)<<18|i>>>14,u^=(i=(o^=(i=(b^=(i=(p^=(i=u+o|0)<<7|i>>>25)+u|0)<<9|i>>>23)+p|0)<<13|i>>>19)+b|0)<<18|i>>>14,y^=(i=(h^=(i=(a^=(i=(w^=(i=y+h|0)<<7|i>>>25)+y|0)<<9|i>>>23)+w|0)<<13|i>>>19)+a|0)<<18|i>>>14,v^=(i=(g^=(i=(l^=(i=(f^=(i=v+g|0)<<7|i>>>25)+v|0)<<9|i>>>23)+f|0)<<13|i>>>19)+l|0)<<18|i>>>14,s^=(i=(f^=(i=(a^=(i=(o^=(i=s+f|0)<<7|i>>>25)+s|0)<<9|i>>>23)+o|0)<<13|i>>>19)+a|0)<<18|i>>>14,u^=(i=(c^=(i=(l^=(i=(h^=(i=u+c|0)<<7|i>>>25)+u|0)<<9|i>>>23)+h|0)<<13|i>>>19)+l|0)<<18|i>>>14,y^=(i=(p^=(i=(d^=(i=(g^=(i=y+p|0)<<7|i>>>25)+y|0)<<9|i>>>23)+g|0)<<13|i>>>19)+d|0)<<18|i>>>14,v^=(i=(w^=(i=(b^=(i=(m^=(i=v+w|0)<<7|i>>>25)+v|0)<<9|i>>>23)+m|0)<<13|i>>>19)+b|0)<<18|i>>>14;e[0]=s>>>0&255,e[1]=s>>>8&255,e[2]=s>>>16&255,e[3]=s>>>24&255,e[4]=u>>>0&255,e[5]=u>>>8&255,e[6]=u>>>16&255,e[7]=u>>>24&255,e[8]=y>>>0&255,e[9]=y>>>8&255,e[10]=y>>>16&255,e[11]=y>>>24&255,e[12]=v>>>0&255,e[13]=v>>>8&255,e[14]=v>>>16&255,e[15]=v>>>24&255,e[16]=h>>>0&255,e[17]=h>>>8&255,e[18]=h>>>16&255,e[19]=h>>>24&255,e[20]=l>>>0&255,e[21]=l>>>8&255,e[22]=l>>>16&255,e[23]=l>>>24&255,e[24]=d>>>0&255,e[25]=d>>>8&255,e[26]=d>>>16&255,e[27]=d>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var v=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function E(e,t,r,n,i,s,o){var a,f,c=new Uint8Array(16),u=new Uint8Array(64);for(f=0;f<16;f++)c[f]=0;for(f=0;f<8;f++)c[f]=s[f];for(;i>=64;){for(b(u,c,o,v),f=0;f<64;f++)e[t+f]=r[n+f]^u[f];for(a=1,f=8;f<16;f++)a=a+(255&c[f])|0,c[f]=255&a,a>>>=8;i-=64,t+=64,n+=64}if(i>0)for(b(u,c,o,v),f=0;f<i;f++)e[t+f]=r[n+f]^u[f];return 0}function B(e,t,r,n,i){var s,o,a=new Uint8Array(16),f=new Uint8Array(64);for(o=0;o<16;o++)a[o]=0;for(o=0;o<8;o++)a[o]=n[o];for(;r>=64;){for(b(f,a,i,v),o=0;o<64;o++)e[t+o]=f[o];for(s=1,o=8;o<16;o++)s=s+(255&a[o])|0,a[o]=255&s,s>>>=8;r-=64,t+=64}if(r>0)for(b(f,a,i,v),o=0;o<r;o++)e[t+o]=f[o];return 0}function _(e,t,r,n,i){var s=new Uint8Array(32);w(s,n,i,v);for(var o=new Uint8Array(8),a=0;a<8;a++)o[a]=n[a+16];return B(e,t,r,o,s)}function S(e,t,r,n,i,s,o){var a=new Uint8Array(32);w(a,s,o,v);for(var f=new Uint8Array(8),c=0;c<8;c++)f[c]=s[c+16];return E(e,t,r,n,i,f,a)}var A=function(e){var t,r,n,i,s,o,a,f;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|i<<9),s=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|s<<12),this.r[5]=s>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(s>>>14|o<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|a<<5),f=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|f<<8),this.r[9]=f>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function I(e,t,r,n,i,s){var o=new A(s);return o.update(r,n,i),o.finish(e,t),0}function x(e,t,r,n,i,s){var o=new Uint8Array(16);return I(o,0,r,n,i,s),g(e,t,o,0)}function T(e,t,r,n,i){var s;if(r<32)return-1;for(S(e,0,t,0,r,n,i),I(e,16,e,32,r-32,e),s=0;s<16;s++)e[s]=0;return 0}function U(e,t,r,n,i){var s,o=new Uint8Array(32);if(r<32)return-1;if(_(o,0,32,n,i),0!==x(t,16,t,32,r-32,o))return-1;for(S(e,0,t,0,r,n,i),s=0;s<32;s++)e[s]=0;return 0}function O(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function R(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function k(e,t,r){for(var n,i=~(r-1),s=0;s<16;s++)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function M(e,r){var n,i,s,o=t(),a=t();for(n=0;n<16;n++)a[n]=r[n];for(R(a),R(a),R(a),i=0;i<2;i++){for(o[0]=a[0]-65517,n=1;n<15;n++)o[n]=a[n]-65535-(o[n-1]>>16&1),o[n-1]&=65535;o[15]=a[15]-32767-(o[14]>>16&1),s=o[15]>>16&1,o[14]&=65535,k(a,o,1-s)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function L(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return M(r,e),M(n,t),m(r,0,n,0)}function C(e){var t=new Uint8Array(32);return M(t,e),1&t[0]}function P(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function N(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function D(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function F(e,t,r){var n,i,s=0,o=0,a=0,f=0,c=0,u=0,h=0,l=0,d=0,p=0,y=0,g=0,m=0,b=0,w=0,v=0,E=0,B=0,_=0,S=0,A=0,I=0,x=0,T=0,U=0,O=0,R=0,k=0,M=0,L=0,C=0,P=r[0],N=r[1],D=r[2],F=r[3],H=r[4],j=r[5],K=r[6],V=r[7],G=r[8],q=r[9],z=r[10],W=r[11],$=r[12],Y=r[13],Z=r[14],X=r[15];s+=(n=t[0])*P,o+=n*N,a+=n*D,f+=n*F,c+=n*H,u+=n*j,h+=n*K,l+=n*V,d+=n*G,p+=n*q,y+=n*z,g+=n*W,m+=n*$,b+=n*Y,w+=n*Z,v+=n*X,o+=(n=t[1])*P,a+=n*N,f+=n*D,c+=n*F,u+=n*H,h+=n*j,l+=n*K,d+=n*V,p+=n*G,y+=n*q,g+=n*z,m+=n*W,b+=n*$,w+=n*Y,v+=n*Z,E+=n*X,a+=(n=t[2])*P,f+=n*N,c+=n*D,u+=n*F,h+=n*H,l+=n*j,d+=n*K,p+=n*V,y+=n*G,g+=n*q,m+=n*z,b+=n*W,w+=n*$,v+=n*Y,E+=n*Z,B+=n*X,f+=(n=t[3])*P,c+=n*N,u+=n*D,h+=n*F,l+=n*H,d+=n*j,p+=n*K,y+=n*V,g+=n*G,m+=n*q,b+=n*z,w+=n*W,v+=n*$,E+=n*Y,B+=n*Z,_+=n*X,c+=(n=t[4])*P,u+=n*N,h+=n*D,l+=n*F,d+=n*H,p+=n*j,y+=n*K,g+=n*V,m+=n*G,b+=n*q,w+=n*z,v+=n*W,E+=n*$,B+=n*Y,_+=n*Z,S+=n*X,u+=(n=t[5])*P,h+=n*N,l+=n*D,d+=n*F,p+=n*H,y+=n*j,g+=n*K,m+=n*V,b+=n*G,w+=n*q,v+=n*z,E+=n*W,B+=n*$,_+=n*Y,S+=n*Z,A+=n*X,h+=(n=t[6])*P,l+=n*N,d+=n*D,p+=n*F,y+=n*H,g+=n*j,m+=n*K,b+=n*V,w+=n*G,v+=n*q,E+=n*z,B+=n*W,_+=n*$,S+=n*Y,A+=n*Z,I+=n*X,l+=(n=t[7])*P,d+=n*N,p+=n*D,y+=n*F,g+=n*H,m+=n*j,b+=n*K,w+=n*V,v+=n*G,E+=n*q,B+=n*z,_+=n*W,S+=n*$,A+=n*Y,I+=n*Z,x+=n*X,d+=(n=t[8])*P,p+=n*N,y+=n*D,g+=n*F,m+=n*H,b+=n*j,w+=n*K,v+=n*V,E+=n*G,B+=n*q,_+=n*z,S+=n*W,A+=n*$,I+=n*Y,x+=n*Z,T+=n*X,p+=(n=t[9])*P,y+=n*N,g+=n*D,m+=n*F,b+=n*H,w+=n*j,v+=n*K,E+=n*V,B+=n*G,_+=n*q,S+=n*z,A+=n*W,I+=n*$,x+=n*Y,T+=n*Z,U+=n*X,y+=(n=t[10])*P,g+=n*N,m+=n*D,b+=n*F,w+=n*H,v+=n*j,E+=n*K,B+=n*V,_+=n*G,S+=n*q,A+=n*z,I+=n*W,x+=n*$,T+=n*Y,U+=n*Z,O+=n*X,g+=(n=t[11])*P,m+=n*N,b+=n*D,w+=n*F,v+=n*H,E+=n*j,B+=n*K,_+=n*V,S+=n*G,A+=n*q,I+=n*z,x+=n*W,T+=n*$,U+=n*Y,O+=n*Z,R+=n*X,m+=(n=t[12])*P,b+=n*N,w+=n*D,v+=n*F,E+=n*H,B+=n*j,_+=n*K,S+=n*V,A+=n*G,I+=n*q,x+=n*z,T+=n*W,U+=n*$,O+=n*Y,R+=n*Z,k+=n*X,b+=(n=t[13])*P,w+=n*N,v+=n*D,E+=n*F,B+=n*H,_+=n*j,S+=n*K,A+=n*V,I+=n*G,x+=n*q,T+=n*z,U+=n*W,O+=n*$,R+=n*Y,k+=n*Z,M+=n*X,w+=(n=t[14])*P,v+=n*N,E+=n*D,B+=n*F,_+=n*H,S+=n*j,A+=n*K,I+=n*V,x+=n*G,T+=n*q,U+=n*z,O+=n*W,R+=n*$,k+=n*Y,M+=n*Z,L+=n*X,v+=(n=t[15])*P,o+=38*(B+=n*D),a+=38*(_+=n*F),f+=38*(S+=n*H),c+=38*(A+=n*j),u+=38*(I+=n*K),h+=38*(x+=n*V),l+=38*(T+=n*G),d+=38*(U+=n*q),p+=38*(O+=n*z),y+=38*(R+=n*W),g+=38*(k+=n*$),m+=38*(M+=n*Y),b+=38*(L+=n*Z),w+=38*(C+=n*X),s=(n=(s+=38*(E+=n*N))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=f,e[4]=c,e[5]=u,e[6]=h,e[7]=l,e[8]=d,e[9]=p,e[10]=y,e[11]=g,e[12]=m,e[13]=b,e[14]=w,e[15]=v}function H(e,t){F(e,t,t)}function j(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=253;n>=0;n--)H(i,i),2!==n&&4!==n&&F(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function K(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=250;n>=0;n--)H(i,i),1!==n&&F(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function V(e,r,n){var i,s,o=new Uint8Array(32),a=new Float64Array(80),c=t(),u=t(),h=t(),l=t(),d=t(),p=t();for(s=0;s<31;s++)o[s]=r[s];for(o[31]=127&r[31]|64,o[0]&=248,P(a,n),s=0;s<16;s++)u[s]=a[s],l[s]=c[s]=h[s]=0;for(c[0]=l[0]=1,s=254;s>=0;--s)k(c,u,i=o[s>>>3]>>>(7&s)&1),k(h,l,i),N(d,c,h),D(c,c,h),N(h,u,l),D(u,u,l),H(l,d),H(p,c),F(c,h,c),F(h,u,d),N(d,c,h),D(c,c,h),H(u,c),D(h,l,p),F(c,h,f),N(c,c,l),F(h,h,c),F(c,l,p),F(l,u,a),H(u,d),k(c,u,i),k(h,l,i);for(s=0;s<16;s++)a[s+16]=c[s],a[s+32]=h[s],a[s+48]=u[s],a[s+64]=l[s];var y=a.subarray(32),g=a.subarray(16);return j(y,y),F(g,g,y),M(e,g),0}function G(e,t){return V(e,t,s)}function q(e,t){return n(t,32),G(e,t)}function z(e,t,r){var n=new Uint8Array(32);return V(n,r,t),w(e,i,n,v)}A.prototype.blocks=function(e,t,r){for(var n,i,s,o,a,f,c,u,h,l,d,p,y,g,m,b,w,v,E,B=this.fin?0:2048,_=this.h[0],S=this.h[1],A=this.h[2],I=this.h[3],x=this.h[4],T=this.h[5],U=this.h[6],O=this.h[7],R=this.h[8],k=this.h[9],M=this.r[0],L=this.r[1],C=this.r[2],P=this.r[3],N=this.r[4],D=this.r[5],F=this.r[6],H=this.r[7],j=this.r[8],K=this.r[9];r>=16;)l=h=0,l+=(_+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*M,l+=(S+=8191&(n>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*K),l+=(A+=8191&(i>>>10|(s=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*j),l+=(I+=8191&(s>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*H),h=(l+=(x+=8191&(o>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*F))>>>13,l&=8191,l+=(T+=a>>>1&8191)*(5*D),l+=(U+=8191&(a>>>14|(f=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*N),l+=(O+=8191&(f>>>11|(c=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*P),l+=(R+=8191&(c>>>8|(u=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*C),d=h+=(l+=(k+=u>>>5|B)*(5*L))>>>13,d+=_*L,d+=S*M,d+=A*(5*K),d+=I*(5*j),h=(d+=x*(5*H))>>>13,d&=8191,d+=T*(5*F),d+=U*(5*D),d+=O*(5*N),d+=R*(5*P),h+=(d+=k*(5*C))>>>13,d&=8191,p=h,p+=_*C,p+=S*L,p+=A*M,p+=I*(5*K),h=(p+=x*(5*j))>>>13,p&=8191,p+=T*(5*H),p+=U*(5*F),p+=O*(5*D),p+=R*(5*N),y=h+=(p+=k*(5*P))>>>13,y+=_*P,y+=S*C,y+=A*L,y+=I*M,h=(y+=x*(5*K))>>>13,y&=8191,y+=T*(5*j),y+=U*(5*H),y+=O*(5*F),y+=R*(5*D),g=h+=(y+=k*(5*N))>>>13,g+=_*N,g+=S*P,g+=A*C,g+=I*L,h=(g+=x*M)>>>13,g&=8191,g+=T*(5*K),g+=U*(5*j),g+=O*(5*H),g+=R*(5*F),m=h+=(g+=k*(5*D))>>>13,m+=_*D,m+=S*N,m+=A*P,m+=I*C,h=(m+=x*L)>>>13,m&=8191,m+=T*M,m+=U*(5*K),m+=O*(5*j),m+=R*(5*H),b=h+=(m+=k*(5*F))>>>13,b+=_*F,b+=S*D,b+=A*N,b+=I*P,h=(b+=x*C)>>>13,b&=8191,b+=T*L,b+=U*M,b+=O*(5*K),b+=R*(5*j),w=h+=(b+=k*(5*H))>>>13,w+=_*H,w+=S*F,w+=A*D,w+=I*N,h=(w+=x*P)>>>13,w&=8191,w+=T*C,w+=U*L,w+=O*M,w+=R*(5*K),v=h+=(w+=k*(5*j))>>>13,v+=_*j,v+=S*H,v+=A*F,v+=I*D,h=(v+=x*N)>>>13,v&=8191,v+=T*P,v+=U*C,v+=O*L,v+=R*M,E=h+=(v+=k*(5*K))>>>13,E+=_*K,E+=S*j,E+=A*H,E+=I*F,h=(E+=x*D)>>>13,E&=8191,E+=T*N,E+=U*P,E+=O*C,E+=R*L,_=l=8191&(h=(h=((h+=(E+=k*M)>>>13)<<2)+h|0)+(l&=8191)|0),S=d+=h>>>=13,A=p&=8191,I=y&=8191,x=g&=8191,T=m&=8191,U=b&=8191,O=w&=8191,R=v&=8191,k=E&=8191,t+=16,r-=16;this.h[0]=_,this.h[1]=S,this.h[2]=A,this.h[3]=I,this.h[4]=x,this.h[5]=T,this.h[6]=U,this.h[7]=O,this.h[8]=R,this.h[9]=k},A.prototype.finish=function(e,t){var r,n,i,s,o=new Uint16Array(10);if(this.leftover){for(s=this.leftover,this.buffer[s++]=1;s<16;s++)this.buffer[s]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,s=2;s<10;s++)this.h[s]+=r,r=this.h[s]>>>13,this.h[s]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this.h[s]+r,r=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,n=(1^r)-1,s=0;s<10;s++)o[s]&=n;for(n=~n,s=0;s<10;s++)this.h[s]=this.h[s]&n|o[s];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,s=1;s<8;s++)i=(this.h[s]+this.pad[s]|0)+(i>>>16)|0,this.h[s]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},A.prototype.update=function(e,t,r){var n,i;if(this.leftover){for((i=16-this.leftover)>r&&(i=r),n=0;n<i;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(i=r-r%16,this.blocks(e,t,i),t+=i,r-=i),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var W=T,$=U,Y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Z(e,t,r,n){for(var i,s,o,a,f,c,u,h,l,d,p,y,g,m,b,w,v,E,B,_,S,A,I,x,T,U,O=new Int32Array(16),R=new Int32Array(16),k=e[0],M=e[1],L=e[2],C=e[3],P=e[4],N=e[5],D=e[6],F=e[7],H=t[0],j=t[1],K=t[2],V=t[3],G=t[4],q=t[5],z=t[6],W=t[7],$=0;n>=128;){for(B=0;B<16;B++)_=8*B+$,O[B]=r[_+0]<<24|r[_+1]<<16|r[_+2]<<8|r[_+3],R[B]=r[_+4]<<24|r[_+5]<<16|r[_+6]<<8|r[_+7];for(B=0;B<80;B++)if(i=k,s=M,o=L,a=C,f=P,c=N,u=D,l=H,d=j,p=K,y=V,g=G,m=q,b=z,I=65535&(A=W),x=A>>>16,T=65535&(S=F),U=S>>>16,I+=65535&(A=(G>>>14|P<<18)^(G>>>18|P<<14)^(P>>>9|G<<23)),x+=A>>>16,T+=65535&(S=(P>>>14|G<<18)^(P>>>18|G<<14)^(G>>>9|P<<23)),U+=S>>>16,I+=65535&(A=G&q^~G&z),x+=A>>>16,T+=65535&(S=P&N^~P&D),U+=S>>>16,I+=65535&(A=Y[2*B+1]),x+=A>>>16,T+=65535&(S=Y[2*B]),U+=S>>>16,S=O[B%16],x+=(A=R[B%16])>>>16,T+=65535&S,U+=S>>>16,T+=(x+=(I+=65535&A)>>>16)>>>16,I=65535&(A=E=65535&I|x<<16),x=A>>>16,T=65535&(S=v=65535&T|(U+=T>>>16)<<16),U=S>>>16,I+=65535&(A=(H>>>28|k<<4)^(k>>>2|H<<30)^(k>>>7|H<<25)),x+=A>>>16,T+=65535&(S=(k>>>28|H<<4)^(H>>>2|k<<30)^(H>>>7|k<<25)),U+=S>>>16,x+=(A=H&j^H&K^j&K)>>>16,T+=65535&(S=k&M^k&L^M&L),U+=S>>>16,h=65535&(T+=(x+=(I+=65535&A)>>>16)>>>16)|(U+=T>>>16)<<16,w=65535&I|x<<16,I=65535&(A=y),x=A>>>16,T=65535&(S=a),U=S>>>16,x+=(A=E)>>>16,T+=65535&(S=v),U+=S>>>16,M=i,L=s,C=o,P=a=65535&(T+=(x+=(I+=65535&A)>>>16)>>>16)|(U+=T>>>16)<<16,N=f,D=c,F=u,k=h,j=l,K=d,V=p,G=y=65535&I|x<<16,q=g,z=m,W=b,H=w,B%16==15)for(_=0;_<16;_++)S=O[_],I=65535&(A=R[_]),x=A>>>16,T=65535&S,U=S>>>16,S=O[(_+9)%16],I+=65535&(A=R[(_+9)%16]),x+=A>>>16,T+=65535&S,U+=S>>>16,v=O[(_+1)%16],I+=65535&(A=((E=R[(_+1)%16])>>>1|v<<31)^(E>>>8|v<<24)^(E>>>7|v<<25)),x+=A>>>16,T+=65535&(S=(v>>>1|E<<31)^(v>>>8|E<<24)^v>>>7),U+=S>>>16,v=O[(_+14)%16],x+=(A=((E=R[(_+14)%16])>>>19|v<<13)^(v>>>29|E<<3)^(E>>>6|v<<26))>>>16,T+=65535&(S=(v>>>19|E<<13)^(E>>>29|v<<3)^v>>>6),U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,O[_]=65535&T|U<<16,R[_]=65535&I|x<<16;I=65535&(A=H),x=A>>>16,T=65535&(S=k),U=S>>>16,S=e[0],x+=(A=t[0])>>>16,T+=65535&S,U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[0]=k=65535&T|U<<16,t[0]=H=65535&I|x<<16,I=65535&(A=j),x=A>>>16,T=65535&(S=M),U=S>>>16,S=e[1],x+=(A=t[1])>>>16,T+=65535&S,U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[1]=M=65535&T|U<<16,t[1]=j=65535&I|x<<16,I=65535&(A=K),x=A>>>16,T=65535&(S=L),U=S>>>16,S=e[2],x+=(A=t[2])>>>16,T+=65535&S,U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[2]=L=65535&T|U<<16,t[2]=K=65535&I|x<<16,I=65535&(A=V),x=A>>>16,T=65535&(S=C),U=S>>>16,S=e[3],x+=(A=t[3])>>>16,T+=65535&S,U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[3]=C=65535&T|U<<16,t[3]=V=65535&I|x<<16,I=65535&(A=G),x=A>>>16,T=65535&(S=P),U=S>>>16,S=e[4],x+=(A=t[4])>>>16,T+=65535&S,U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[4]=P=65535&T|U<<16,t[4]=G=65535&I|x<<16,I=65535&(A=q),x=A>>>16,T=65535&(S=N),U=S>>>16,S=e[5],x+=(A=t[5])>>>16,T+=65535&S,U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[5]=N=65535&T|U<<16,t[5]=q=65535&I|x<<16,I=65535&(A=z),x=A>>>16,T=65535&(S=D),U=S>>>16,S=e[6],x+=(A=t[6])>>>16,T+=65535&S,U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[6]=D=65535&T|U<<16,t[6]=z=65535&I|x<<16,I=65535&(A=W),x=A>>>16,T=65535&(S=F),U=S>>>16,S=e[7],x+=(A=t[7])>>>16,T+=65535&S,U+=S>>>16,U+=(T+=(x+=(I+=65535&A)>>>16)>>>16)>>>16,e[7]=F=65535&T|U<<16,t[7]=W=65535&I|x<<16,$+=128,n-=128}return n}function X(e,t,r){var n,i=new Int32Array(8),s=new Int32Array(8),o=new Uint8Array(256),a=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,Z(i,s,t,r),r%=128,n=0;n<r;n++)o[n]=t[a-r+n];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,p(o,r-8,a/536870912|0,a<<3),Z(i,s,o,r),n=0;n<8;n++)p(e,8*n,i[n],s[n]);return 0}function Q(e,r){var n=t(),i=t(),s=t(),o=t(),a=t(),f=t(),c=t(),h=t(),l=t();D(n,e[1],e[0]),D(l,r[1],r[0]),F(n,n,l),N(i,e[0],e[1]),N(l,r[0],r[1]),F(i,i,l),F(s,e[3],r[3]),F(s,s,u),F(o,e[2],r[2]),N(o,o,o),D(a,i,n),D(f,o,s),N(c,o,s),N(h,i,n),F(e[0],a,f),F(e[1],h,c),F(e[2],c,f),F(e[3],a,h)}function J(e,t,r){var n;for(n=0;n<4;n++)k(e[n],t[n],r)}function ee(e,r){var n=t(),i=t(),s=t();j(s,r[2]),F(n,r[0],s),F(i,r[1],s),M(e,i),e[31]^=C(n)<<7}function te(e,t,r){var n,i;for(O(e[0],o),O(e[1],a),O(e[2],a),O(e[3],o),i=255;i>=0;--i)J(e,t,n=r[i/8|0]>>(7&i)&1),Q(t,e),Q(e,e),J(e,t,n)}function re(e,r){var n=[t(),t(),t(),t()];O(n[0],h),O(n[1],l),O(n[2],a),F(n[3],h,l),te(e,n,r)}function ne(e,r,i){var s,o=new Uint8Array(64),a=[t(),t(),t(),t()];for(i||n(r,32),X(o,r,32),o[0]&=248,o[31]&=127,o[31]|=64,re(a,o),ee(e,a),s=0;s<32;s++)r[s+32]=e[s];return 0}var ie=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function se(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*ie[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*ie[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*ie[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;se(e,r)}function ae(e,r,n,i){var s,o,a=new Uint8Array(64),f=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),h=[t(),t(),t(),t()];X(a,i,32),a[0]&=248,a[31]&=127,a[31]|=64;var l=n+64;for(s=0;s<n;s++)e[64+s]=r[s];for(s=0;s<32;s++)e[32+s]=a[32+s];for(X(c,e.subarray(32),n+32),oe(c),re(h,c),ee(e,h),s=32;s<64;s++)e[s]=i[s];for(X(f,e,n+64),oe(f),s=0;s<64;s++)u[s]=0;for(s=0;s<32;s++)u[s]=c[s];for(s=0;s<32;s++)for(o=0;o<32;o++)u[s+o]+=f[s]*a[o];return se(e.subarray(32),u),l}function fe(e,r,n,i){var s,f=new Uint8Array(32),u=new Uint8Array(64),h=[t(),t(),t(),t()],l=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),i=t(),s=t(),f=t(),u=t(),h=t(),l=t();return O(e[2],a),P(e[1],r),H(s,e[1]),F(f,s,c),D(s,s,e[2]),N(f,e[2],f),H(u,f),H(h,u),F(l,h,u),F(n,l,s),F(n,n,f),K(n,n),F(n,n,s),F(n,n,f),F(n,n,f),F(e[0],n,f),H(i,e[0]),F(i,i,f),L(i,s)&&F(e[0],e[0],d),H(i,e[0]),F(i,i,f),L(i,s)?-1:(C(e[0])===r[31]>>7&&D(e[0],o,e[0]),F(e[3],e[0],e[1]),0)}(l,i))return-1;for(s=0;s<n;s++)e[s]=r[s];for(s=0;s<32;s++)e[s+32]=i[s];if(X(u,e,n),oe(u),te(h,l,u),re(l,r.subarray(32)),Q(h,l),ee(f,h),n-=64,m(r,0,f,0)){for(s=0;s<n;s++)e[s]=0;return-1}for(s=0;s<n;s++)e[s]=r[s+64];return n}var ce,ue=64,he=32,le=64;function de(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function pe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ye(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:w,crypto_stream_xor:S,crypto_stream:_,crypto_stream_salsa20_xor:E,crypto_stream_salsa20:B,crypto_onetimeauth:I,crypto_onetimeauth_verify:x,crypto_verify_16:g,crypto_verify_32:m,crypto_secretbox:T,crypto_secretbox_open:U,crypto_scalarmult:V,crypto_scalarmult_base:G,crypto_box_beforenm:z,crypto_box_afternm:W,crypto_box:function(e,t,r,n,i,s){var o=new Uint8Array(32);return z(o,i,s),W(e,t,r,n,o)},crypto_box_open:function(e,t,r,n,i,s){var o=new Uint8Array(32);return z(o,i,s),$(e,t,r,n,o)},crypto_box_keypair:q,crypto_hash:X,crypto_sign:ae,crypto_sign_keypair:ne,crypto_sign_open:fe,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:ue,crypto_sign_PUBLICKEYBYTES:he,crypto_sign_SECRETKEYBYTES:le,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:c,L:ie,pack25519:M,unpack25519:P,M:F,A:N,S:H,Z:D,pow2523:K,add:Q,set25519:O,modL:se,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,r){pe(e,t,r),de(r,t);for(var n=new Uint8Array(32+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+32]=e[s];return T(i,n,n.length,t,r),i.subarray(16)},e.secretbox.open=function(e,t,r){pe(e,t,r),de(r,t);for(var n=new Uint8Array(16+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+16]=e[s];return n.length<32||0!==U(i,n,n.length,t,r)?null:i.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(pe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return V(r,e,t),r},e.scalarMult.base=function(e){if(pe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return G(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox(t,r,s)},e.box.before=function(e,t){pe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return z(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox.open(t,r,s)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return q(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(pe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return G(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(pe(e,t),t.length!==le)throw new Error("bad secret key size");var r=new Uint8Array(ue+e.length);return ae(r,e,e.length,t),r},e.sign.open=function(e,t){if(pe(e,t),t.length!==he)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=fe(r,e,e.length,t);if(n<0)return null;for(var i=new Uint8Array(n),s=0;s<i.length;s++)i[s]=r[s];return i},e.sign.detached=function(t,r){for(var n=e.sign(t,r),i=new Uint8Array(ue),s=0;s<i.length;s++)i[s]=n[s];return i},e.sign.detached.verify=function(e,t,r){if(pe(e,t,r),t.length!==ue)throw new Error("bad signature size");if(r.length!==he)throw new Error("bad public key size");var n,i=new Uint8Array(ue+e.length),s=new Uint8Array(ue+e.length);for(n=0;n<ue;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+ue]=e[n];return fe(s,i,i.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(he),t=new Uint8Array(le);return ne(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(pe(e),e.length!==le)throw new Error("bad secret key size");for(var t=new Uint8Array(he),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(pe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(he),r=new Uint8Array(le),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=he,e.sign.secretKeyLength=le,e.sign.seedLength=32,e.sign.signatureLength=ue,e.hash=function(e){pe(e);var t=new Uint8Array(64);return X(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return pe(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===y(e,0,t,0,e.length)},e.setPRNG=function(e){n=e},(ce="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&ce.getRandomValues?e.setPRNG((function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)ce.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];ye(n)})):(ce=r(8308))&&ce.randomBytes&&e.setPRNG((function(e,t){var r,n=ce.randomBytes(t);for(r=0;r<t;r++)e[r]=n[r];ye(n)}))}(e.exports?e.exports:self.nacl=self.nacl||{})},4552:(e,t,r)=>{"use strict";var n=r(8558);function i(e,t){o(e,t),s(e)}function s(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,a=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return a||f?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(o,this,e)):n.nextTick(o,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?r._writableState?r._writableState.errorEmitted?n.nextTick(s,r):(r._writableState.errorEmitted=!0,n.nextTick(i,r,e)):n.nextTick(i,r,e):t?(n.nextTick(s,r),t(e)):n.nextTick(s,r)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}},4686:(e,t,r)=>{"use strict";const n=r(5350),i=r(7947),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=f,t.SlowBuffer=function(e){return+e!=e&&(e=0),f.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,f.prototype),t}function f(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!f.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|y(e,t);let n=a(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Y(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return l(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return d(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(Y(e,SharedArrayBuffer)||e&&Y(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return f.from(n,t,r);const i=function(e){if(f.isBuffer(e)){const t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Z(e.length)?a(0):l(e):"Buffer"===e.type&&Array.isArray(e.data)?l(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return f.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),a(e<0?0:0|p(e))}function l(e){const t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,f.prototype),n}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function y(e,t){if(f.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(e).length;default:if(i)return n?-1:z(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return U(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function m(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function b(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=f.from(t,n)),f.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){let s,o=1,a=e.length,f=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,f/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(c(e,s)===c(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===f)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+f>a&&(r=a-f),s=r;s>=0;s--){let r=!0;for(let n=0;n<f;n++)if(c(e,s+n)!==c(t,n)){r=!1;break}if(r)return s}return-1}function v(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(Z(n))return o;e[r+o]=n}return o}function E(e,t,r,n){return $(z(t,e.length-r),e,r,n)}function B(e,t,r,n){return $(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return $(W(t),e,r,n)}function S(e,t,r,n){return $(function(e,t){let r,n,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,f;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(f=(31&t)<<6|63&r,f>127&&(s=f));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(f=(15&t)<<12|(63&r)<<6|63&n,f>2047&&(f<55296||f>57343)&&(s=f));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(f=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,f>65535&&f<1114112&&(s=f))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){const t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=x));return r}(n)}t.kMaxLength=o,f.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),f.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}}),f.poolSize=8192,f.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array),f.alloc=function(e,t,r){return function(e,t,r){return u(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},f.allocUnsafe=function(e){return h(e)},f.allocUnsafeSlow=function(e){return h(e)},f.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==f.prototype},f.compare=function(e,t){if(Y(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),!f.isBuffer(e)||!f.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=f.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(Y(t,Uint8Array))i+t.length>n.length?(f.isBuffer(t)||(t=f.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!f.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},f.byteLength=y,f.prototype._isBuffer=!0,f.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)m(this,t,t+1);return this},f.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},f.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},f.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===f.compare(this,e)},f.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(f.prototype[s]=f.prototype.inspect),f.prototype.compare=function(e,t,r,n,i){if(Y(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(s,o),c=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<a;++e)if(c[e]!==u[e]){s=c[e],o=u[e];break}return s<o?-1:o<s?1:0},f.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},f.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},f.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},f.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return B(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function T(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function U(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function O(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=X[e[n]];return i}function R(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function k(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,i,s){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n,i){K(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function C(e,t,r,n,i){K(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function P(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function N(e,t,r,n,s){return t=+t,r>>>=0,s||P(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function D(e,t,r,n,s){return t=+t,r>>>=0,s||P(e,0,r,8),i.write(e,t,r,n,52,8),r+8}f.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,f.prototype),n},f.prototype.readUintLE=f.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||k(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},f.prototype.readUintBE=f.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||k(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},f.prototype.readUint8=f.prototype.readUInt8=function(e,t){return e>>>=0,t||k(e,1,this.length),this[e]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(e,t){return e>>>=0,t||k(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(e,t){return e>>>=0,t||k(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(e,t){return e>>>=0,t||k(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(e,t){return e>>>=0,t||k(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readBigUInt64LE=Q((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),f.prototype.readBigUInt64BE=Q((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),f.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||k(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},f.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||k(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},f.prototype.readInt8=function(e,t){return e>>>=0,t||k(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){e>>>=0,t||k(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},f.prototype.readInt16BE=function(e,t){e>>>=0,t||k(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},f.prototype.readInt32LE=function(e,t){return e>>>=0,t||k(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return e>>>=0,t||k(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readBigInt64LE=Q((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),f.prototype.readBigInt64BE=Q((function(e){V(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),f.prototype.readFloatLE=function(e,t){return e>>>=0,t||k(e,4,this.length),i.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return e>>>=0,t||k(e,4,this.length),i.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return e>>>=0,t||k(e,8,this.length),i.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return e>>>=0,t||k(e,8,this.length),i.read(this,e,!1,52,8)},f.prototype.writeUintLE=f.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||M(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||M(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},f.prototype.writeUint8=f.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,1,255,0),this[t]=255&e,t+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeBigUInt64LE=Q((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),f.prototype.writeBigUInt64BE=Q((function(e,t=0){return C(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),f.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);M(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},f.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);M(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},f.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},f.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},f.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeBigInt64LE=Q((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),f.prototype.writeBigInt64BE=Q((function(e,t=0){return C(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),f.prototype.writeFloatLE=function(e,t,r){return N(this,e,t,!0,r)},f.prototype.writeFloatBE=function(e,t,r){return N(this,e,t,!1,r)},f.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},f.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},f.prototype.copy=function(e,t,r,n){if(!f.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},f.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=f.isBuffer(e)?e:f.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%o]}return this};const F={};function H(e,t,r){F[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function K(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){V(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||G(t,e.length-(r+1))}(n,i,s)}function V(e,t){if("number"!=typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function G(e,t,r){if(Math.floor(e)!==e)throw V(e,r),new F.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}H("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),H("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),H("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=j(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const q=/[^+/0-9A-Za-z-_]/g;function z(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function W(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Q(e){return"undefined"==typeof BigInt?J:e}function J(){throw new Error("BigInt not supported")}},4914:(e,t,r)=>{"use strict";e.exports=u;var n=r(8704).F,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,f=r(5606);function c(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);f.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?l(this,null,null):this._flush((function(t,r){l(e,t,r)}))}function l(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}r(6192)(u,f),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,f.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new i("_transform()"))},u.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){f.prototype._destroy.call(this,e,(function(e){t(e)}))}},4981:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7999),s=n(r(5163)),o=n(r(45)),a=n(r(5108)),f=n(r(5800)),c=r(6070),u=r(4686),h=n(r(2106)),l=r(4084);class d{constructor(e,t,r=0){this.encrypt=d.encrypt,this.type=r,this.keyManager=e,this.certificate=t}static fromId(e,t,r="hex"){let n=e;e.data&&(n=u.Buffer.from(e.data)),e instanceof Uint8Array&&(n=u.Buffer.from(e)),"string"==typeof e&&(n=u.Buffer.from(e,r));const i=n[0];if(3===i){const e=s.default.fromId(n.slice(1));return new d(e,t,i)}if(4===i){const e=o.default.fromId(n.slice(1));return new d(e,t,i)}if(n.length>1952){const e=h.default.fromId(n.slice(1));return new d(e,t,i)}{const e=a.default.fromId(n.slice(1));return new d(e,t,i)}}static async fromEntropy(e,t,r=!1){const n=e;if(r){const e=await h.default.create_PQ_fromEntropy(n);return new d(e,void 0,t)}{const e=await a.default.create_Id25519_fromEntropy(n);return new d(e,void 0,t)}}static async createWebauthn(e=!0,t){const r=d.createPublicKeyCredentialCreationOptions(e),n=(0,c.getWebAuthnProvider)(),i=await n.create(r);return i?d.fido2FromAttestation(i,t):null}static async createPQC(){const e=d.createPublicKeyCredentialOptionsPQC(),t=(0,c.getWebAuthnProvider)(),r=await t.create(e);return r?d.fido2FromAttestation(r):null}static async fido2FromAttestation(e,t){if(f.default.verifyPackedAttestation(e.response,!0),!e.getClientExtensionResults().prf?.enabled||t&&!await t()){const t=await s.default.createFromAttestation(e);return new d(t,void 0,3)}{const t=await o.default.createFromAttestation(e);return new d(t,void 0,4)}}static async machineFromEntropy(e){return d.fromEntropy(e,0)}static async organizationFromEntropy(e){return d.fromEntropy(e,2)}static async personFromEntropy(e){return d.fromEntropy(e,1)}static fromSecret(e,t="hex"){const r=u.Buffer.from(e,t),n=r[0];if(3==n){const e=s.default.fromSecret(r.slice(1));return new d(e,void 0,n)}if(4==n){const e=o.default.fromSecret(r.slice(1));return new d(e,void 0,n)}if(109===r.length){const e=h.default.fromSecret(r.slice(1));return new d(e,void 0,n)}{const e=a.default.fromSecret(r.slice(1));return new d(e,void 0,n)}}static async generatePerson(e=!1){if(e){const e=await h.default.generate_PQ();return new d(e,void 0,1)}{const e=await a.default.generate_Id25519();return new d(e,void 0,1)}}static async generateOrganization(e=!1){if(e){const e=await h.default.generate_PQ();return new d(e,void 0,2)}{const e=await a.default.generate_Id25519();return new d(e,void 0,2)}}static async generateMachine(e=!1){if(e){const e=await h.default.generate_PQ();return new d(e,void 0,0)}{const e=await a.default.generate_Id25519();return new d(e,void 0,0)}}get relationshipCertificate(){return this.certificate}getSecret(e="hex"){return u.Buffer.concat([u.Buffer.from([this.type]),this.keyManager.getSecret()]).toString(e)}get fingerprint(){return(u.Buffer.from([this.type]).toString("hex")+(0,i.hash)("SHA224",this.keyManager.id).toString("hex")).slice(0,40).toUpperCase().match(/.{1,4}/g).join(" ")}get did(){return`did:vaultys:${(u.Buffer.from([this.type]).toString("hex")+(0,i.hash)("SHA224",this.keyManager.id).toString("hex")).slice(0,40)}`}get didDocument(){return{"@context":["https://www.w3.org/ns/did/v1","https://w3id.org/security/suites/ed25519-2020/v1"],id:this.did,authentication:[{id:`${this.did}#keys-1`,type:this.keyManager.authType,controller:this.did,publicKeyMultibase:"m"+u.Buffer.from(this.keyManager.signer.publicKey).toString("base64")}],keyAgreement:[{id:`${this.did}#keys-2`,type:this.keyManager.encType,controller:this.did,publicKeyMultibase:"m"+u.Buffer.from(this.keyManager.cypher.publicKey).toString("base64")}]}}get id(){return u.Buffer.concat([u.Buffer.from([this.type]),this.keyManager.id])}toVersion(e){return this.keyManager.version=e,this}get version(){return this.keyManager.version}isHardware(){return 3===this.type||4===this.type}isMachine(){return 0===this.type}isPerson(){return 1===this.type}getOTPHmac(e=36e5){const t=Math.floor((new Date).getTime()/e);return this.keyManager.getSecretHash(u.Buffer.from(`OTP-${t}`)).toString("hex")}getOTP(e="password",t=864e5){if(this.certificate){const r=Math.floor((new Date).getTime()/t),n=u.Buffer.concat([u.Buffer.from(e,"utf-8"),u.Buffer.from(this.certificate),u.Buffer.from([r])]);return(0,i.hash)("SHA256",n).toString("hex")}throw new Error("no certificate, cannot derive OTP")}async performDiffieHellman(e){return this.keyManager.performDiffieHellman(e.keyManager)}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){let r;return r="string"==typeof t?u.Buffer.from(t.slice(2),"hex"):t.slice(1),this.keyManager.dhiesEncrypt(e,r)}async dhiesDecrypt(e,t){let r;return r="string"==typeof t?u.Buffer.from(t.slice(2),"hex"):t.slice(1),this.keyManager.dhiesDecrypt(e,r)}async signChallenge(e){"string"==typeof e&&(e=u.Buffer.from(e,"hex"));const t=(0,i.hash)("sha256",u.Buffer.concat([this.id,e])),r=await this.keyManager.sign(t);if(r)return r;throw new Error("Could not sign challenge")}verifyChallenge(e,t,r){"string"==typeof e&&(e=u.Buffer.from(e,"hex")),"string"==typeof t&&(t=u.Buffer.from(t,"hex"));const n=(0,i.hash)("sha256",u.Buffer.concat([this.id,e]));return this.keyManager.verify(n,t,r)}async signcrypt(e,t){return this.keyManager.signcrypt(e,t.map((e=>"string"==typeof e?u.Buffer.from(e.slice(2),"hex"):e.slice(1))))}static async encrypt(e,t){return a.default.encrypt(e,t.map((e=>"string"==typeof e?u.Buffer.from(e.slice(2),"hex"):e.slice(1))))}async decrypt(e,t){let r;return t&&(r="string"==typeof t?u.Buffer.from(t.slice(2)):t.subarray(1)),this.keyManager.decrypt(e,r)}async hmac(e){return(await this.keyManager.getCypher()).hmac(e)}}d.createPublicKeyCredentialOptionsPQC=()=>{const e=/^((?!chrome|android).)*applewebkit/i.test(navigator.userAgent);return{challenge:(0,i.randomBytes)(32),rp:{name:"Vaultys ID"},user:{id:(0,i.randomBytes)(16),name:"Vaultys ID",displayName:"Vaultys Wallet ID"},attestation:e?"none":"direct",authenticatorSelection:{authenticatorAttachment:"cross-platform",residentKey:"discouraged",userVerification:"preferred"},hints:["security-key"],extensions:{prf:{eval:{first:u.Buffer.from("VaultysID salt","utf-8")}}},pubKeyCredParams:[{type:"public-key",alg:l.PQ_COSE_ALG.DILITHIUM2}]}},d.createPublicKeyCredentialCreationOptions=e=>{const t=/^((?!chrome|android).)*applewebkit/i.test(navigator.userAgent),r=e?"client-device":"security-key";return{challenge:(0,i.randomBytes)(32),rp:{name:"Vaultys ID"},user:{id:(0,i.randomBytes)(16),name:"Vaultys ID",displayName:"Vaultys Wallet ID"},attestation:t?"none":"direct",authenticatorSelection:{authenticatorAttachment:e?"platform":"cross-platform",residentKey:e?"required":"discouraged",userVerification:"preferred"},hints:[r],extensions:{prf:{eval:{first:u.Buffer.from("VaultysID salt","utf-8")}}},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-8},{type:"public-key",alg:-257}]}},t.default=d},5108:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DHIES=void 0;const i=r(1569),s=r(7999),o=r(4686),a=n(r(4406)),f=r(2655),c=r(6136);c.ed25519.CURVE={...c.ed25519.CURVE},c.ed25519.CURVE.adjustScalarBytes=e=>(e[0]&=248,e[31]&=63,e[31]|=64,e);const u=e=>(0,s.hash)("sha256",e);class h{constructor(e){this.keyManager=e}async encrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot encrypt with DHIES using a public KeyManager"),null;const r=await this.keyManager.getCypher(),n="string"==typeof e?o.Buffer.from(e,"utf8"):e;try{const e=(0,s.randomBytes)(32),i=await r.diffieHellman(t),f=o.Buffer.from(a.default.scalarMult(e,i)),c=this.kdf(f,this.keyManager.cypher.publicKey,t),u=c.encryptionKey,h=c.macKey,l=(0,s.randomBytes)(24),d=o.Buffer.from(a.default.secretbox(n,l,u)),p=o.Buffer.concat([this.keyManager.cypher.publicKey,l,d]),y=this.computeMAC(h,p),g=o.Buffer.concat([l,e,d,y]);return(0,s.secureErase)(f),(0,s.secureErase)(i),(0,s.secureErase)(u),(0,s.secureErase)(h),g}catch(e){return console.error("DHIES encryption failed:",e),null}}async decrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot decrypt with DHIES using a public KeyManager"),null;try{const r=e.slice(0,24),n=e.slice(24,56),i=e.slice(e.length-32),f=e.slice(56,e.length-32),c=await this.keyManager.getCypher(),u=await c.diffieHellman(t),h=o.Buffer.from(a.default.scalarMult(n,u)),l=this.kdf(h,t,this.keyManager.cypher.publicKey),d=l.encryptionKey,p=l.macKey,y=o.Buffer.concat([t,r,f]),g=this.computeMAC(p,y);if(!this.constantTimeEqual(i,g))return console.error("DHIES: MAC verification failed"),null;const m=a.default.secretbox.open(f,r,d);if(!m)return console.error("DHIES: Decryption failed"),null;const b=o.Buffer.from(m);return(0,s.secureErase)(h),(0,s.secureErase)(d),(0,s.secureErase)(p),b}catch(e){return console.error("DHIES decryption failed:",e),null}}kdf(e,t,r){const n=o.Buffer.concat([o.Buffer.from("DHIES-KDF"),t,r]),i=(0,s.hash)("sha512",o.Buffer.concat([e,n,o.Buffer.from([1])])),a=(0,s.hash)("sha512",o.Buffer.concat([e,n,o.Buffer.from([2])]));return{encryptionKey:i.slice(0,32),macKey:a.slice(0,32)}}computeMAC(e,t){return(0,s.hash)("sha256",o.Buffer.concat([e,t]))}constantTimeEqual(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}}t.DHIES=h;class l{constructor(){this.level=1,this.version=1,this.capability="private",this.authType="Ed25519VerificationKey2020",this.encType="X25519KeyAgreementKey2019"}static async create_Id25519_fromEntropy(e,t=0){const r=new l;r.entropy=e,r.level=1,r.capability="private";const n=(i=e,(0,s.hash)("sha512",i));var i;r.proofKey={publicKey:o.Buffer.from([])},r.swapIndex=t,r.proof=(0,s.hash)("sha256",r.proofKey.publicKey),r.signer={publicKey:o.Buffer.from(c.ed25519.getPublicKey(n.slice(0,32))),secretKey:n.slice(0,32)};const f=o.Buffer.alloc(8);f.writeBigInt64LE(BigInt(t),0);const h=u(o.Buffer.concat([n.slice(32,64),f])),d=a.default.box.keyPair.fromSecretKey(h);return r.cypher={publicKey:o.Buffer.from(d.publicKey),secretKey:o.Buffer.from(d.secretKey)},r}static generate_Id25519(){return l.create_Id25519_fromEntropy((0,s.randomBytes)(32))}get id(){return 0==this.version?(e=>{const t=e=>e.length<=65535?o.Buffer.from([197,e.length>>8,255&e.length,...e]):o.Buffer.from([198,e.length>>24&255,e.length>>16&255,e.length>>8&255,255&e.length,...e]),r=o.Buffer.from([132,161,118,0]),n=o.Buffer.concat([o.Buffer.from([161,112]),t(e.proof)]),i=o.Buffer.concat([o.Buffer.from([161,120]),t(e.signer.publicKey)]),s=o.Buffer.concat([o.Buffer.from([161,101]),t(e.cypher.publicKey)]);return o.Buffer.concat([r,n,i,s])})(this):o.Buffer.from((0,f.encode)({v:this.version,p:this.proof,x:this.signer.publicKey,e:this.cypher.publicKey}))}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?(0,s.hmac)("sha256",o.Buffer.from(e.secretKey),"VaultysID/"+t+"/end"):void 0,signcrypt:async(t,r)=>(0,i.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,i.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>o.Buffer.from(a.default.scalarMult(e.secretKey,t))}}getSigner(){const e=this.signer.secretKey;return Promise.resolve({sign:t=>Promise.resolve(o.Buffer.from(c.ed25519.sign(t,e)))})}getSecret(){return o.Buffer.from((0,f.encode)({v:this.version,p:this.proof,x:this.signer.secretKey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,f.decode)(e),r=new l;r.version=t.v??0,r.level=2,r.capability="private",r.proof=t.p,r.signer={secretKey:t.x.slice(0,32),publicKey:o.Buffer.from(c.ed25519.getPublicKey(t.x.slice(0,32)))};const n=a.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:o.Buffer.from(n.publicKey),secretKey:o.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new l;return t.version=e.version??0,t.level=e.level,t.proof=e.proof.data?o.Buffer.from(e.proof.data):o.Buffer.from(e.proof),t.signer={publicKey:e.signer.publicKey.data?o.Buffer.from(e.signer.publicKey.data):o.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?o.Buffer.from(e.cypher.publicKey.data):o.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,f.decode)(e),r=new l;return r.version=t.v??0,r.level=2,r.capability="public",r.proof=t.p,r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}async sign(e){return"public"==this.capability?null:(await this.getSigner()).sign(e)}verify(e,t,r){return c.ed25519.verify(t,e,this.signer.publicKey)}cleanSecureData(){this.cypher?.secretKey&&((0,s.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.signer?.secretKey&&((0,s.secureErase)(this.signer.secretKey),delete this.signer.secretKey),this.entropy&&((0,s.secureErase)(this.entropy),delete this.entropy)}async performDiffieHellman(e){if("public"===this.capability)return console.error("Cannot perform DH key exchange with a public key capability"),null;const t=await this.getCypher(),r=e.cypher.publicKey,n=await t.diffieHellman(r),i=u(n);return(0,s.secureErase)(n),i}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){const r=l.fromId(t);return new h(this).encrypt(e,r.cypher.publicKey)}async dhiesDecrypt(e,t){const r=l.fromId(t);return new h(this).decrypt(e,r.cypher.publicKey)}static async encrypt(e,t){const r=t.map(l.fromId).map((e=>e.cypher.publicKey));return await(0,i.encryptAndArmor)(e,null,r)}async signcrypt(e,t){const r=t.map(l.fromId).map((e=>e.cypher.publicKey)),n=await this.getCypher();return await n.signcrypt(e,r)}async decrypt(e,t=null){const r=await this.getCypher(),n=t?l.fromId(t).cypher.publicKey:null;return(await r.decrypt(e,n)).toString()}getSecretHash(e){const t=o.Buffer.concat([e,o.Buffer.from("secrethash"),this.cypher.secretKey]);return(0,s.hash)("sha256",t)}}t.default=l},5163:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7999),s=n(r(1167)),o=n(r(4406)),a=r(6070),f=n(r(5108)),c=r(2655),u=n(r(5800)),h=r(4686),l=r(4084),d={usb:1,nfc:2,ble:4,internal:8,hybrid:16,"smart-card":32},p=e=>e.length<=65535?h.Buffer.from([197,e.length>>8,255&e.length,...e]):h.Buffer.from([198,e.length>>24&255,e.length>>16&255,e.length>>8&255,255&e.length,...e]),y=e=>{const t=h.Buffer.from([131,161,118,e.version]),r=h.Buffer.concat([h.Buffer.from([161,101]),p(e.cypher.publicKey)]),n=h.Buffer.concat([h.Buffer.from([161,99]),p(e.ckey)]);return h.Buffer.concat([t,n,r])},g=e=>Object.keys(d).filter((t=>e&&d[t])),m=e=>{const t=s.default.decode(e).get(1);return 1===t?"Ed25519VerificationKey2020":2===t?"P256VerificationKey2020":"Unknown"},b=e=>{const t=s.default.decode(e);let r=h.Buffer.from([]);return-7==t.get(3)?r=h.Buffer.concat([h.Buffer.from("04","hex"),t.get(-2),t.get(-3)]):-8==t.get(3)?r=t.get(-2):t.get(3)==l.PQ_COSE_ALG.DILITHIUM2&&(r=t.get(-101)),{publicKey:r}};class w extends f.default{constructor(){super(),this._transports=0,this.level=1,this.encType="X25519KeyAgreementKey2019",this.webAuthn=(0,a.getWebAuthnProvider)()}get transports(){return g(this._transports)}static async createFromAttestation(e){const t=new w;t.ckey=u.default.getCOSEPublicKey(e),t.authType=m(t.ckey),t.fid=h.Buffer.from(e.id,"base64");const r=e.response,n=r.getTransports?r.getTransports():["usb"];t._transports=(e=>e.reduceRight(((e,t)=>e+(d[t]?d[t]:0)),0))(n),t.signer=b(t.ckey);const s=(0,i.randomBytes)(32),a=(f=s,(0,i.hash)("sha512",f));var f;const c=o.default.box.keyPair.fromSecretKey(a.slice(0,32));return t.cypher={publicKey:h.Buffer.from(c.publicKey),secretKey:h.Buffer.from(c.secretKey)},t.entropy=s,t}get id(){return 0==this.version?y(this):h.Buffer.from((0,c.encode)({v:this.version,c:this.ckey,e:this.cypher.publicKey}))}get id_v0(){return y(this)}getSecret(){return h.Buffer.from((0,c.encode)({v:this.version,f:this.fid,t:this._transports,c:this.ckey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,c.decode)(e),r=new w;r.version=t.v??0,r.capability="private",r.fid="string"==typeof t.f?h.Buffer.from(t.f,"base64"):t.f,r._transports=t.t?t.t:15,r.ckey=t.c,r.authType=m(r.ckey),r.signer=b(t.c);const n=o.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:h.Buffer.from(n.publicKey),secretKey:h.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new w;return t.version=e.version??0,t.level=e.level,t.fid="string"==typeof e.fid?h.Buffer.from(e.fid,"base64"):e.fid,t._transports=e.t?e.t:15,t.ckey=e.ckey.data?h.Buffer.from(e.ckey.data):h.Buffer.from(e.ckey),t.signer=b(t.ckey),t.authType=m(t.ckey),t.cypher={publicKey:e.cypher.publicKey.data?h.Buffer.from(e.cypher.publicKey.data):h.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,c.decode)(e),r=new w;return r.version=t.v??0,r.capability="public",r.fid="string"==typeof t.f?h.Buffer.from(t.f,"base64"):t.f,r.ckey=t.c,r.signer=b(t.c),r.authType=m(r.ckey),r.cypher={publicKey:t.e},r}async getSigner(){return{sign:async e=>{if(!navigator.credentials)return null;try{await(window?.CredentialUserInteractionRequest())}catch(e){}const t={challenge:(0,i.hash)("sha256",e),userVerification:"preferred",allowCredentials:[{type:"public-key",id:this.fid,transports:g(this._transports)}]},{response:r}=await this.webAuthn.get(t),n=r,s={s:h.Buffer.from(n.signature),c:h.Buffer.from(n.clientDataJSON),a:h.Buffer.from(n.authenticatorData)};return h.Buffer.from((0,c.encode)(s))}}}verify(e,t,r=!1){const n=h.Buffer.from(t),s=(0,c.decode)(n),o={signature:s.s,clientDataJSON:s.c,authenticatorData:s.a,userHandle:h.Buffer.from([]).buffer};return(0,i.hash)("sha256",e).toString("base64")===u.default.extractChallenge(o.clientDataJSON)&&u.default.simpleVerify(this.ckey,o,r)}verifyCredentials(e,t=!1){if(e.id!==this.fid.toString("base64"))return!1;const r=e.response;var n;return h.Buffer.from(r.authenticatorData.slice(0,32)).toString("hex")===(n=h.Buffer.from(e.id,"base64"),(0,i.hash)("sha256",n)).toString("hex")&&u.default.simpleVerify(this.ckey,r,t)}async createRevocationCertificate(){return null}}t.default=w},5350:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=a(e),o=s[0],f=s[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,o,f)),u=0,h=f>0?o-4:o;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===f&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===f&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],o=16383,a=0,c=n-i;a<c;a+=o)s.push(f(e,a,a+o>c?c:a+o));return 1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function f(e,t,n){for(var i,s,o=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},5391:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shake256=t.shake128=t.keccak_512=t.keccak_384=t.keccak_256=t.keccak_224=t.sha3_512=t.sha3_384=t.sha3_256=t.sha3_224=t.Keccak=void 0,t.keccakP=w;const n=r(3842),i=r(11),s=BigInt(0),o=BigInt(1),a=BigInt(2),f=BigInt(7),c=BigInt(256),u=BigInt(113),h=[],l=[],d=[];for(let e=0,t=o,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],h.push(2*(5*n+r)),l.push((e+1)*(e+2)/2%64);let i=s;for(let e=0;e<7;e++)t=(t<<o^(t>>f)*u)%c,t&a&&(i^=o<<(o<<BigInt(e))-o);d.push(i)}const p=(0,n.split)(d,!0),y=p[0],g=p[1],m=(e,t,r)=>r>32?(0,n.rotlBH)(e,t,r):(0,n.rotlSH)(e,t,r),b=(e,t,r)=>r>32?(0,n.rotlBL)(e,t,r):(0,n.rotlSL)(e,t,r);function w(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,s=r[i],o=r[i+1],a=m(s,o,1)^r[n],f=b(s,o,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=f}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=l[r],s=m(t,i,n),o=b(t,i,n),a=h[r];t=e[a],i=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=y[n],e[1]^=g[n]}(0,i.clean)(r)}class v extends i.Hash{constructor(e,t,r,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=s,(0,i.anumber)(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,i.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,i.swap32IfBE)(this.state32),w(this.state32,this.rounds),(0,i.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(e){(0,i.aexists)(this),e=(0,i.toBytes)(e),(0,i.abytes)(e);const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){(0,i.aexists)(this,!1),(0,i.abytes)(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,i.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,i.aoutput)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,i.clean)(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new v(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}t.Keccak=v;const E=(e,t,r)=>(0,i.createHasher)((()=>new v(t,e,r)));t.sha3_224=E(6,144,28),t.sha3_256=E(6,136,32),t.sha3_384=E(6,104,48),t.sha3_512=E(6,72,64),t.keccak_224=E(1,144,28),t.keccak_256=E(1,136,32),t.keccak_384=E(1,104,48),t.keccak_512=E(1,72,64);const B=(e,t,r)=>(0,i.createXOFer)(((n={})=>new v(t,e,void 0===n.dkLen?r:n.dkLen,!0)));t.shake128=B(31,168,16),t.shake256=B(31,136,32)},5397:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHash=function(e){return{hash:e}},t.createCurve=function(e,t){const r=t=>(0,n.weierstrass)({...e,hash:t});return{...r(t),create:r}};const n=r(1164)},5606:(e,t,r)=>{"use strict";var n=r(8558),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var s=r(4324),o=r(6868);r(6192)(u,s);for(var a=i(o.prototype),f=0;f<a.length;f++){var c=a[f];u.prototype[c]||(u.prototype[c]=o.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);s.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||n.nextTick(l,this)}function l(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},5691:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp521r1=t.p521=void 0;const n=r(2355);t.p521=n.p521,t.secp521r1=n.p521,t.hashToCurve=n.p521_hasher.hashToCurve,t.encodeToCurve=n.p521_hasher.encodeToCurve},5706:e=>{"use strict";class t{constructor(){this.clear()}clear(){this.map=new WeakMap,this.count=0,this.recording=!0}stop(){this.recording=!1}check(e){const r=this.map.get(e);if(r)return r.length>1?r[0]||this.recording?r[1]:(r[0]=!0,t.FIRST):this.recording?(r.push(this.count++),r[1]):t.NEVER;if(!this.recording)throw new Error("New object detected when not recording");return this.map.set(e,[!1]),t.NEVER}}t.NEVER=-1,t.FIRST=-2,e.exports=t},5713:(e,t,r)=>{"use strict";const{Buffer:n}=r(4686),i=r(3271),s=r(5775),{MT:o}=r(790);class a extends Map{constructor(e){super(e)}static _encode(e){return i.encodeCanonical(e).toString("base64")}static _decode(e){return s.decodeFirstSync(e,"base64")}get(e){return super.get(a._encode(e))}set(e,t){return super.set(a._encode(e),t)}delete(e){return super.delete(a._encode(e))}has(e){return super.has(a._encode(e))}*keys(){for(const e of super.keys())yield a._decode(e)}*entries(){for(const e of super.entries())yield[a._decode(e[0]),e[1]]}[Symbol.iterator](){return this.entries()}forEach(e,t=this){if("function"!=typeof e)throw new TypeError("Must be function");for(const r of super.entries())e.call(t,r[1],a._decode(r[0]),this)}encodeCBOR(e){if(!e._pushInt(this.size,o.MAP))return!1;if(e.canonical){const t=Array.from(super.entries()).map((e=>[n.from(e[0],"base64"),e[1]]));t.sort(((e,t)=>e[0].compare(t[0])));for(const r of t)if(!e.push(r[0])||!e.pushAny(r[1]))return!1}else for(const t of super.entries())if(!e.push(n.from(t[0],"base64"))||!e.pushAny(t[1]))return!1;return!0}}e.exports=a},5775:(e,t,r)=>{"use strict";const n=r(1883),i=r(1163),s=r(9109),o=r(8590),a=r(6899),f=r(790),{MT:c,NUMBYTES:u,SYMS:h,BI:l}=f,{Buffer:d}=r(4686),p=Symbol("count"),y=Symbol("major type"),g=Symbol("error"),m=Symbol("not found");function b(e,t,r){const n=[];return n[p]=r,n[h.PARENT]=e,n[y]=t,n}function w(e,t){const r=new a;return r[p]=-1,r[h.PARENT]=e,r[y]=t,r}class v extends Error{constructor(e,t){super(`Unexpected data: 0x${e.toString(16)}`),this.name="UnexpectedDataError",this.byte=e,this.value=t}}function E(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}class B extends n{constructor(e={}){const{tags:t={},max_depth:r=-1,preferMap:n=!1,preferWeb:i=!1,required:s=!1,encoding:o="hex",extendedResults:f=!1,preventDuplicateKeys:c=!1,...u}=e;super({defaultEncoding:o,...u}),this.running=!0,this.max_depth=r,this.tags=t,this.preferMap=n,this.preferWeb=i,this.extendedResults=f,this.required=s,this.preventDuplicateKeys=c,f&&(this.bs.on("read",this._onRead.bind(this)),this.valueBytes=new a)}static nullcheck(e){switch(e){case h.NULL:return null;case h.UNDEFINED:return;case m:throw new Error("Value not found");default:return e}}static decodeFirstSync(e,t={}){if(null==e)throw new TypeError("input required");({options:t}=E(t));const{encoding:r="hex",...n}=t,i=new B(n),s=o.guessEncoding(e,r),a=i._parse();let f=a.next();for(;!f.done;){const e=s.read(f.value);if(null==e||e.length!==f.value)throw new Error("Insufficient data");i.extendedResults&&i.valueBytes.write(e),f=a.next(e)}let c=null;if(i.extendedResults)c=f.value,c.unused=s.read();else if(c=B.nullcheck(f.value),s.length>0){const e=s.read(1);throw s.unshift(e),new v(e[0],c)}return c}static decodeAllSync(e,t={}){if(null==e)throw new TypeError("input required");({options:t}=E(t));const{encoding:r="hex",...n}=t,i=new B(n),s=o.guessEncoding(e,r),a=[];for(;s.length>0;){const e=i._parse();let t=e.next();for(;!t.done;){const r=s.read(t.value);if(null==r||r.length!==t.value)throw new Error("Insufficient data");i.extendedResults&&i.valueBytes.write(r),t=e.next(r)}a.push(B.nullcheck(t.value))}return a}static decodeFirst(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=E(t,r));const{encoding:n="hex",required:i=!1,...s}=t,a=new B(s);let f=m;const c=o.guessEncoding(e,n),u=new Promise(((e,t)=>{a.on("data",(e=>{f=B.nullcheck(e),a.close()})),a.once("error",(r=>a.extendedResults&&r instanceof v?(f.unused=a.bs.slice(),e(f)):(f!==m&&(r.value=f),f=g,a.close(),t(r)))),a.once("end",(()=>{switch(f){case m:return i?t(new Error("No CBOR found")):e(f);case g:return;default:return e(f)}}))}));return"function"==typeof r&&u.then((e=>r(null,e)),r),c.pipe(a),u}static decodeAll(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=E(t,r));const{encoding:n="hex",...i}=t,s=new B(i),a=[];s.on("data",(e=>a.push(B.nullcheck(e))));const f=new Promise(((e,t)=>{s.on("error",t),s.on("end",(()=>e(a)))}));return"function"==typeof r&&f.then((e=>r(void 0,e)),(e=>r(e,void 0))),o.guessEncoding(e,n).pipe(s),f}close(){this.running=!1,this.__fresh=!0}_onRead(e){this.valueBytes.write(e)}*_parse(){let e=null,t=0,r=null;for(;;){if(this.max_depth>=0&&t>this.max_depth)throw new Error(`Maximum depth ${this.max_depth} exceeded`);const[n]=yield 1;if(!this.running)throw this.bs.unshift(d.from([n])),new v(n);const f=n>>5,g=31&n,m=null==e?void 0:e[y],E=null==e?void 0:e.length;switch(g){case u.ONE:this.emit("more-bytes",f,1,m,E),[r]=yield 1;break;case u.TWO:case u.FOUR:case u.EIGHT:{const e=1<<g-24;this.emit("more-bytes",f,e,m,E);const t=yield e;r=f===c.SIMPLE_FLOAT?t:o.parseCBORint(g,t);break}case 28:case 29:case 30:throw this.running=!1,new Error(`Additional info not implemented: ${g}`);case u.INDEFINITE:switch(f){case c.POS_INT:case c.NEG_INT:case c.TAG:throw new Error(`Invalid indefinite encoding for MT ${f}`)}r=-1;break;default:r=g}switch(f){case c.POS_INT:break;case c.NEG_INT:r=r===Number.MAX_SAFE_INTEGER?l.NEG_MAX:"bigint"==typeof r?l.MINUS_ONE-r:-1-r;break;case c.BYTE_STRING:case c.UTF8_STRING:switch(r){case 0:this.emit("start-string",f,r,m,E),r=f===c.UTF8_STRING?"":this.preferWeb?new Uint8Array(0):d.allocUnsafe(0);break;case-1:this.emit("start",f,h.STREAM,m,E),e=w(e,f),t++;continue;default:this.emit("start-string",f,r,m,E),r=yield r,f===c.UTF8_STRING?r=o.utf8(r):this.preferWeb&&(r=new Uint8Array(r.buffer,r.byteOffset,r.length))}break;case c.ARRAY:case c.MAP:switch(r){case 0:r=f===c.MAP?this.preferMap?new Map:{}:[];break;case-1:this.emit("start",f,h.STREAM,m,E),e=b(e,f,-1),t++;continue;default:this.emit("start",f,r,m,E),e=b(e,f,r*(f-3)),t++;continue}break;case c.TAG:this.emit("start",f,r,m,E),e=b(e,f,1),e.push(r),t++;continue;case c.SIMPLE_FLOAT:if("number"==typeof r){if(g===u.ONE&&r<32)throw new Error(`Invalid two-byte encoding of simple value ${r}`);const t=null!=e;r=s.decode(r,t,t&&e[p]<0)}else r=o.parseCBORfloat(r)}this.emit("value",r,m,E,g);let _=!1;for(;null!=e;){if(r===h.BREAK)e[p]=1;else if(Array.isArray(e))e.push(r);else{const t=e[y];if(null!=t&&t!==f)throw this.running=!1,new Error("Invalid major type in indefinite encoding");e.write(r)}if(0!==--e[p]){_=!0;break}if(--t,delete e[p],Array.isArray(e))switch(e[y]){case c.ARRAY:r=e;break;case c.MAP:{let t=!this.preferMap;if(e.length%2!=0)throw new Error(`Invalid map length: ${e.length}`);for(let r=0,n=e.length;t&&r<n;r+=2)if("string"!=typeof e[r]||"__proto__"===e[r]){t=!1;break}if(t){r={};for(let t=0,n=e.length;t<n;t+=2){if(this.preventDuplicateKeys&&Object.prototype.hasOwnProperty.call(r,e[t]))throw new Error("Duplicate keys in a map");r[e[t]]=e[t+1]}}else{r=new Map;for(let t=0,n=e.length;t<n;t+=2){if(this.preventDuplicateKeys&&r.has(e[t]))throw new Error("Duplicate keys in a map");r.set(e[t],e[t+1])}}break}case c.TAG:r=new i(e[0],e[1]).convert(this.tags)}else if(e instanceof a)switch(e[y]){case c.BYTE_STRING:r=e.slice(),this.preferWeb&&(r=new Uint8Array(r.buffer,r.byteOffset,r.length));break;case c.UTF8_STRING:r=e.toString("utf-8")}this.emit("stop",e[y]);const n=e;e=e[h.PARENT],delete n[h.PARENT],delete n[y]}if(!_){if(this.extendedResults){const e=this.valueBytes.slice(),t={value:B.nullcheck(r),bytes:e,length:e.length};return this.valueBytes=new a,t}return r}}}}B.NOT_FOUND=m,e.exports=B},5800:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4686),s=r(7999),o=n(r(1167)),a=r(6136),f=r(1440),c=r(7268),u=r(5691),h=r(4084),l={},d=h.PQ_COSE_KEY_TYPE.DILITHIUM,p={1:f.p256,2:c.p384,3:u.p521},y={"-257":"SHA-256","-258":"SHA-384","-259":"SHA-512","-65535":"SHA-1","-39":"SHA-512","-38":"SHA-384","-37":"SHA-256","-260":"SHA-256","-261":"SHA-512","-7":"SHA-256","-36":"SHA-512",[h.PQ_COSE_ALG.DILITHIUM2.toString()]:"SHA-256"},g=(e,t)=>(0,s.hash)(e.replace("-",""),t),m=e=>{const t=e.slice(0,32),r=(e=e.slice(32)).slice(0,1);e=e.slice(1);const n=r[0],i={up:!!(1&n),uv:!!(4&n),at:!!(64&n),ed:!!(128&n),flagsInt:n},s=e.slice(0,4);e=e.slice(4);const o=s.readUInt32BE(0);let a,f,c;if(i.at){a=e.slice(0,16);const t=(e=e.slice(16)).slice(0,2);e=e.slice(2);const r=t.readUInt16BE(0);f=e.slice(0,r),c=e=e.slice(r)}return{rpIdHash:t,flagsBuf:r,flags:i,counter:o,counterBuf:s,aaguid:a,credID:f,COSEPublicKey:c}},b=(e,t,r)=>f.p256.verify(f.p256.Signature.fromDER(r).toCompactHex(),e,t),w=(e,t,r)=>a.ed25519.verify(r,e,t);class v{constructor(){this.signCount=0,this.rawId=(0,s.randomBytes)(32),this.aaguid=i.Buffer.alloc(16)}static createRequest(e,t=!1){const r={publicKey:{challenge:i.Buffer.from((0,s.randomBytes)(32).toString("base64")),rp:{name:"Vaultys ID",id:"Vaultys ID"},user:{id:i.Buffer.from("Vaultys Wallet ID","utf8"),name:"Vaultys Wallet ID",displayName:"Vaultys Wallet ID"},pubKeyCredParams:[{type:"public-key",alg:e}]}};return t&&(r.publicKey.extensions={prf:{eval:{first:(0,s.randomBytes)(32)}}}),r}static async create(e,t="test"){const r=new v,n=e.publicKey;r.options=n,r.rpId=n.rp.id||n.rp.name,r.userHandle=i.Buffer.from(n.user.id.toString(),"base64"),l[r.rawId.toString("base64")]=r;const c=n.pubKeyCredParams.some((e=>e.alg===h.PQ_COSE_ALG.DILITHIUM2));if(r.alg=c?h.PQ_COSE_ALG.DILITHIUM2:n.pubKeyCredParams[0].alg,-8===r.alg){const e=a.ed25519.utils.randomPrivateKey();r.keyPair={privateKey:e,publicKey:a.ed25519.getPublicKey(e),algorithm:"EdDSA"},r.coseKey=new Map,r.coseKey.set(1,1),r.coseKey.set(3,-8),r.coseKey.set(-1,6);const t=r.keyPair.publicKey.slice(0,32);r.coseKey.set(-2,t)}else if(-7===r.alg){const e=f.p256.utils.randomPrivateKey();r.keyPair={privateKey:e,publicKey:f.p256.getPublicKey(e,!1),algorithm:"ES256"},r.coseKey=new Map,r.coseKey.set(1,2),r.coseKey.set(3,-7),r.coseKey.set(-1,6);const t=r.keyPair.publicKey.slice(1,33),n=r.keyPair.publicKey.slice(33);r.coseKey.set(-2,t),r.coseKey.set(-3,n)}else if(r.alg===h.PQ_COSE_ALG.DILITHIUM2){const{publicKey:e,secretKey:t}=(0,h.generateDilithiumKeyPair)();r.keyPair={privateKey:t,publicKey:e,algorithm:"DILITHIUM2",isDILITHIUM:!0},r.coseKey=(0,h.createDilithiumCoseKey)(e)}const u={type:"webauthn.create",challenge:n.challenge,origin:t},d=(0,s.hash)("sha256",i.Buffer.from(r.rpId,"ascii")),p=i.Buffer.from("41","hex"),y=i.Buffer.allocUnsafe(4);y.writeUInt32BE(r.signCount,0);const g=i.Buffer.allocUnsafe(2);g.writeUInt16BE(r.rawId.length,0);const m=o.default.encode(r.coseKey),b={authData:i.Buffer.concat([d,p,y,r.aaguid,g,r.rawId,m]),fmt:"none",attStmt:{}};return{id:r.rawId.toString("base64"),rawId:r.rawId,authenticatorAttachment:null,type:"public-key",getClientExtensionResults:()=>n.extensions?.prf?.eval?.first?{prf:{enabled:!0}}:{},toJSON(){},response:{clientDataJSON:i.Buffer.from(JSON.stringify(u),"utf-8"),attestationObject:o.default.encode(b),getTransports:()=>["usb","hybrid"],getAuthenticatorData:()=>b.authData,getPublicKey:()=>m,getPublicKeyAlgorithm:()=>-7}}}static simpleVerify(e,t,r=!1){const n=o.default.decode(e,{extendedResults:!0}).value,a=(t.authenticatorData.slice(0,32),i.Buffer.from(t.authenticatorData)[32]);if(t.authenticatorData.slice(33,37),!(r?4&a:1&a))return!1;const f=(0,s.hash)("sha256",i.Buffer.from(t.clientDataJSON));let c=i.Buffer.concat([i.Buffer.from(t.authenticatorData),f]);if(-7==n.get(3)&&(c=(0,s.hash)("sha256",c)),1==n.get(1)){const e=n.get(-2);return w(c,e,i.Buffer.from(t.signature))}if(2==n.get(1)){const e=n.get(-2),r=n.get(-3),s=i.Buffer.concat([i.Buffer.from("04","hex"),e,r]);return b(c,s,i.Buffer.from(t.signature))}if(n.get(1)===d){const e=n.get(h.PQ_COSE_KEY_PARAMS.DILITHIUM_PK);return(0,h.verifyDilithium)(c,i.Buffer.from(t.signature),e)}return!1}static getCOSEPublicKey(e){const t=e.response,r=o.default.decode(t.attestationObject);return m(r.authData).COSEPublicKey}static verifyPackedAttestation(e,t=!1){return((e,t=!1)=>{const r=i.Buffer.from(e.attestationObject),n=o.default.decodeAllSync(r)[0];if("none"==n.fmt)return!1;const s=m(n.authData);if(!s.flags.up)return!1;if(t&&!s.flags.uv)return!1;const f=g("sha256",i.Buffer.from(e.clientDataJSON)),c=i.Buffer.concat([n.authData,f]),u=n.attStmt.sig;let h=!1;if(n.attStmt.ecdaaKeyId)throw new Error("ECDAA IS NOT SUPPORTED!");{const e=o.default.decodeAllSync(s.COSEPublicKey)[0],t=y[e.get(3)],r=g(t,c);if(2===e.get(1)){const t=e.get(-2),n=e.get(-3),s=i.Buffer.concat([i.Buffer.from([4]),t,n]),o=p[e.get(-1)],a=o.Signature.fromDER(u);h=o.verify(a,r,s)}else{if(1!==e.get(1))return!1;{const t=e.get(-2);h=a.ed25519.verify(u,r,t)}}}if(!h)throw new Error("Failed to verify the signature!");return!0})(e,t)}static async verify(e,t,r=!1){const n=(0,s.hash)("sha256",i.Buffer.from(t.response.clientDataJSON)),a=t.response,f=e.response;let c=i.Buffer.concat([i.Buffer.from(a.authenticatorData),n]);const u=o.default.decode(f.attestationObject),l=m(u.authData);if(!l.flags.up)return!1;if(r&&!l.flags.uv||!l.COSEPublicKey)return!1;const p=o.default.decode(l.COSEPublicKey);-7==p.get(3)&&(c=(0,s.hash)("sha256",c));const y=p.get(1);if(1===y){const e=p.get(-2);return w(c,e,i.Buffer.from(a.signature))}if(2===y){const e=p.get(-2),t=p.get(-3),r=i.Buffer.concat([i.Buffer.from("04","hex"),e,t]);return b(c,r,i.Buffer.from(a.signature))}if(y===d){const e=p.get(h.PQ_COSE_KEY_PARAMS.DILITHIUM_PK);return(0,h.verifyDilithium)(c,i.Buffer.from(a.signature),e)}return!1}static extractChallenge(e){const t=JSON.parse(e.toString()),r=t.challenge.length%4;return t.challenge.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.challenge.length+(0===r?0:4-r),"=")}static async get({publicKey:e},t="test"){if(!e.allowCredentials)throw new Error;const r=i.Buffer.from(e.allowCredentials[0].id).toString("base64"),n=l[r];n.signCount+=1;const o={type:"webauthn.get",challenge:i.Buffer.from(e.challenge).toString("base64"),origin:t},c=(0,s.hash)("sha256",(0,s.fromUTF8)(JSON.stringify(o))),u=(0,s.hash)("sha256",i.Buffer.from(n.rpId,"utf-8")),d=i.Buffer.from("05","hex"),p=i.Buffer.allocUnsafe(4);p.writeUInt32BE(n.signCount,0);const y=i.Buffer.concat([u,d,p]),m=i.Buffer.concat([y,c]);let b=new Uint8Array;return-7===n.alg?b=f.p256.sign(m,n.keyPair.privateKey,{prehash:!0}).toDERRawBytes():-8===n.alg?b=a.ed25519.sign(m,n.keyPair.privateKey):n.alg===h.PQ_COSE_ALG.DILITHIUM2&&(b=(0,h.signDilithium)(m,n.keyPair.privateKey)),{id:r,rawId:i.Buffer.from(r,"base64").buffer,type:"public-key",authenticatorAttachment:null,getClientExtensionResults:()=>e.extensions?.prf?.eval?.first?{prf:{results:{first:g("sha256",e.extensions?.prf?.eval?.first)}}}:{},toJSON(){},response:{authenticatorData:y,clientDataJSON:i.Buffer.from(JSON.stringify(o),"utf-8"),signature:b,userHandle:n.userHandle}}}}t.default=v},6070:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeWebAuthn=t.BrowserWebAuthn=void 0,t.getWebAuthnProvider=function(e){return"undefined"!=typeof window?new s:new o(e?.origin)},t.createCredentialRequest=function(e,t=!1){return i.default.createRequest(e,t)};const i=n(r(5800));class s{isAvailable(){return"undefined"!=typeof window&&void 0!==window.PublicKeyCredential}async create(e){if(!this.isAvailable())throw new Error("WebAuthn is not available in this environment");return await navigator.credentials.create({publicKey:e})}async get(e){if(!this.isAvailable())throw new Error("WebAuthn is not available in this environment");return await navigator.credentials.get({publicKey:e})}}t.BrowserWebAuthn=s;class o{constructor(e="test"){this.origin=e}isAvailable(){return!0}async create(e){return await i.default.create({publicKey:e},this.origin)}async get(e){return await i.default.get({publicKey:e},this.origin)}}t.NodeWebAuthn=o},6136:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hash_to_ristretto255=t.hashToRistretto255=t.RistrettoPoint=t.encodeToCurve=t.hashToCurve=t.ed25519_hasher=t.edwardsToMontgomery=t.x25519=t.ed25519ph=t.ed25519ctx=t.ed25519=t.ED25519_TORSION_SUBGROUP=void 0,t.edwardsToMontgomeryPub=A,t.edwardsToMontgomeryPriv=function(e){const t=_.hash(e.subarray(0,32));return _.adjustScalarBytes(t).subarray(0,32)};const n=r(4072),i=r(11),s=r(407),o=r(3144),a=r(2844),f=r(7342),c=r(8881),u=r(6376),h=BigInt(0),l=BigInt(1),d=BigInt(2),p=BigInt(3),y=BigInt(5),g=BigInt(8),m={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:g,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function b(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=m.p,o=e*e%s*e%s,a=(0,f.pow2)(o,d,s)*o%s,c=(0,f.pow2)(a,l,s)*e%s,u=(0,f.pow2)(c,y,s)*c%s,h=(0,f.pow2)(u,t,s)*u%s,p=(0,f.pow2)(h,r,s)*h%s,g=(0,f.pow2)(p,n,s)*p%s,b=(0,f.pow2)(g,i,s)*g%s,w=(0,f.pow2)(b,i,s)*g%s,v=(0,f.pow2)(w,t,s)*u%s;return{pow_p_5_8:(0,f.pow2)(v,d,s)*e%s,b2:o}}function w(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const v=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function E(e,t){const r=m.p,n=(0,f.mod)(t*t*t,r),i=b(e*(0,f.mod)(n*n*t,r)).pow_p_5_8;let s=(0,f.mod)(e*n*i,r);const o=(0,f.mod)(t*s*s,r),a=s,c=(0,f.mod)(s*v,r),u=o===e,h=o===(0,f.mod)(-e,r),l=o===(0,f.mod)(-e*v,r);return u&&(s=a),(h||l)&&(s=c),(0,f.isNegativeLE)(s,r)&&(s=(0,f.mod)(-s,r)),{isValid:u||h,value:s}}t.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];const B=(()=>(0,f.Field)(m.p,void 0,!0))(),_=(()=>({...m,Fp:B,hash:n.sha512,adjustScalarBytes:w,uvRatio:E}))();function S(e,t,r){if(t.length>255)throw new Error("Context is too big");return(0,i.concatBytes)((0,i.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}function A(e){const r=(0,u.ensureBytes)("pub",e),{y:n}=t.ed25519.Point.fromHex(r),i=BigInt(1);return B.toBytes(B.create((i+n)*B.inv(i-n)))}t.ed25519=(0,o.twistedEdwards)(_),t.ed25519ctx=(0,o.twistedEdwards)({..._,domain:S}),t.ed25519ph=(0,o.twistedEdwards)(Object.assign({},_,{domain:S,prehash:n.sha512})),t.x25519=(()=>{const e=m.p;return(0,c.montgomery)({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:r,b2:n}=b(t);return(0,f.mod)((0,f.pow2)(r,p,e)*n,e)},adjustScalarBytes:w})})(),t.edwardsToMontgomery=A;const I=(()=>(B.ORDER+p)/g)(),x=(()=>B.pow(d,I))(),T=(()=>B.sqrt(B.neg(B.ONE)))(),U=(()=>(0,f.FpSqrtEven)(B,B.neg(BigInt(486664))))();function O(e){if(!(e instanceof H))throw new Error("RistrettoPoint expected")}t.ed25519_hasher=(0,a.createHasher)(t.ed25519.Point,(e=>function(e){const{xMn:t,xMd:r,yMn:n,yMd:i}=function(e){const t=(B.ORDER-y)/g,r=BigInt(486662);let n=B.sqr(e);n=B.mul(n,d);let i=B.add(n,B.ONE),s=B.neg(r),o=B.sqr(i),a=B.mul(o,i),f=B.mul(n,r);f=B.mul(f,s),f=B.add(f,o),f=B.mul(f,s);let c=B.sqr(a);o=B.sqr(c),c=B.mul(c,a),c=B.mul(c,f),o=B.mul(o,c);let u=B.pow(o,t);u=B.mul(u,c);let h=B.mul(u,T);o=B.sqr(u),o=B.mul(o,a);let p=B.eql(o,f),m=B.cmov(h,u,p),b=B.mul(s,n),w=B.mul(u,e);w=B.mul(w,x);let v=B.mul(w,T),E=B.mul(f,n);o=B.sqr(w),o=B.mul(o,a);let _=B.eql(o,E),S=B.cmov(v,w,_);o=B.sqr(m),o=B.mul(o,a);let A=B.eql(o,f),I=B.cmov(b,s,A),U=B.cmov(S,m,A),O=B.isOdd(U);return U=B.cmov(U,B.neg(U),A!==O),{xMn:I,xMd:i,yMn:U,yMd:l}}(e);let s=B.mul(t,i);s=B.mul(s,U);let o=B.mul(r,n),a=B.sub(t,r),c=B.add(t,r),u=B.mul(o,c),h=B.eql(u,B.ZERO);s=B.cmov(s,B.ZERO,h),o=B.cmov(o,B.ONE,h),a=B.cmov(a,B.ONE,h),c=B.cmov(c,B.ONE,h);const[p,m]=(0,f.FpInvertBatch)(B,[o,c],!0);return{x:B.mul(s,p),y:B.mul(a,m)}}(e[0])),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:B.ORDER,m:1,k:128,expand:"xmd",hash:n.sha512}),t.hashToCurve=t.ed25519_hasher.hashToCurve,t.encodeToCurve=t.ed25519_hasher.encodeToCurve;const R=v,k=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),M=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),L=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),C=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),P=e=>E(l,e),N=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),D=e=>t.ed25519.CURVE.Fp.create((0,u.bytesToNumberLE)(e)&N);function F(e){const{d:r}=t.ed25519.CURVE,n=t.ed25519.CURVE.Fp.ORDER,i=t.ed25519.CURVE.Fp.create,s=i(R*e*e),o=i((s+l)*L);let a=BigInt(-1);const c=i((a-r*s)*i(s+r));let{isValid:u,value:h}=E(o,c),d=i(h*e);(0,f.isNegativeLE)(d,n)||(d=i(-d)),u||(h=d),u||(a=s);const p=i(a*(s-l)*C-c),y=h*h,g=i((h+h)*c),m=i(p*k),b=i(l-y),w=i(l+y);return new t.ed25519.Point(i(g*w),i(b*m),i(m*w),i(g*b))}class H{constructor(e){this.ep=e}static fromAffine(e){return new H(t.ed25519.Point.fromAffine(e))}static hashToCurve(e){e=(0,u.ensureBytes)("ristrettoHash",e,64);const t=F(D(e.slice(0,32))),r=F(D(e.slice(32,64)));return new H(t.add(r))}static fromBytes(e){return(0,i.abytes)(e),this.fromHex(e)}static fromHex(e){e=(0,u.ensureBytes)("ristrettoHex",e,32);const{a:r,d:n}=t.ed25519.CURVE,i=B.ORDER,s=B.create,o="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=D(e);if(!(0,u.equalBytes)((0,u.numberToBytesLE)(a,32),e)||(0,f.isNegativeLE)(a,i))throw new Error(o);const c=s(a*a),d=s(l+r*c),p=s(l-r*c),y=s(d*d),g=s(p*p),m=s(r*n*y-g),{isValid:b,value:w}=P(s(m*g)),v=s(w*p),E=s(w*v*m);let _=s((a+a)*v);(0,f.isNegativeLE)(_,i)&&(_=s(-_));const S=s(d*E),A=s(_*S);if(!b||(0,f.isNegativeLE)(A,i)||S===h)throw new Error(o);return new H(new t.ed25519.Point(_,S,l,A))}static msm(e,r){const n=(0,f.Field)(t.ed25519.CURVE.n,t.ed25519.CURVE.nBitLength);return(0,s.pippenger)(H,n,e,r)}toBytes(){let{ex:e,ey:t,ez:r,et:n}=this.ep;const i=B.ORDER,s=B.create,o=s(s(r+t)*s(r-t)),a=s(e*t),c=s(a*a),{value:h}=P(s(o*c)),l=s(h*o),d=s(h*a),p=s(l*d*n);let y;if((0,f.isNegativeLE)(n*p,i)){let r=s(t*R),n=s(e*R);e=r,t=n,y=s(l*M)}else y=d;(0,f.isNegativeLE)(e*p,i)&&(t=s(-t));let g=s((r-t)*y);return(0,f.isNegativeLE)(g,i)&&(g=s(-g)),(0,u.numberToBytesLE)(g,32)}toRawBytes(){return this.toBytes()}toHex(){return(0,u.bytesToHex)(this.toBytes())}toString(){return this.toHex()}equals(e){O(e);const{ex:t,ey:r}=this.ep,{ex:n,ey:i}=e.ep,s=B.create,o=s(t*i)===s(r*n),a=s(r*i)===s(t*n);return o||a}add(e){return O(e),new H(this.ep.add(e.ep))}subtract(e){return O(e),new H(this.ep.subtract(e.ep))}multiply(e){return new H(this.ep.multiply(e))}multiplyUnsafe(e){return new H(this.ep.multiplyUnsafe(e))}double(){return new H(this.ep.double())}negate(){return new H(this.ep.negate())}}t.RistrettoPoint=(H.BASE||(H.BASE=new H(t.ed25519.Point.BASE)),H.ZERO||(H.ZERO=new H(t.ed25519.Point.ZERO)),H),t.hashToRistretto255=(e,t)=>{const r=t.DST,s="string"==typeof r?(0,i.utf8ToBytes)(r):r,o=(0,a.expand_message_xmd)(e,s,64,n.sha512);return H.hashToCurve(o)},t.hash_to_ristretto255=t.hashToRistretto255},6192:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},6215:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY=t.utf8ToBytes=t.concatBytes=t.randomBytes=t.ensureBytes=void 0,t.equalBytes=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},t.splitCoder=function(...e){const r=e=>"number"==typeof e?e:e.bytesLen,n=e.reduce(((e,t)=>e+r(t)),0);return{bytesLen:n,encode:i=>{const s=new Uint8Array(n);for(let n=0,o=0;n<e.length;n++){const a=e[n],f=r(a),c="number"==typeof a?i[n]:a.encode(i[n]);(0,t.ensureBytes)(c,f),s.set(c,o),"number"!=typeof a&&c.fill(0),o+=f}return s},decode:i=>{(0,t.ensureBytes)(i,n);const s=[];for(const t of e){const e=r(t),n=i.subarray(0,e);s.push("number"==typeof t?n:t.decode(n)),i=i.subarray(e)}return s}}},t.vecCoder=function(e,r){const n=r*e.bytesLen;return{bytesLen:n,encode:t=>{if(t.length!==r)throw new Error(`vecCoder.encode: wrong length=${t.length}. Expected: ${r}`);const i=new Uint8Array(n);for(let r=0,n=0;r<t.length;r++){const s=e.encode(t[r]);i.set(s,n),s.fill(0),n+=s.length}return i},decode:r=>{(0,t.ensureBytes)(r,n);const i=[];for(let t=0;t<r.length;t+=e.bytesLen)i.push(e.decode(r.subarray(t,t+e.bytesLen)));return i}}},t.cleanBytes=function(...e){for(const t of e)if(Array.isArray(t))for(const e of t)e.fill(0);else t.fill(0)},t.getMask=function(e){return(1<<e)-1},t.getMessage=function(e,r=t.EMPTY){if((0,t.ensureBytes)(e),(0,t.ensureBytes)(r),r.length>255)throw new Error("context should be less than 255 bytes");return(0,s.concatBytes)(new Uint8Array([0,r.length]),r,e)},t.getMessagePrehash=function(e,r,n=t.EMPTY){if((0,t.ensureBytes)(r),(0,t.ensureBytes)(n),n.length>255)throw new Error("context should be less than 255 bytes");if(!o[e])throw new Error("unknown hash: "+e);const{oid:i,hash:a}=o[e],f=a(r);return(0,s.concatBytes)(new Uint8Array([1,n.length]),n,i,f)};const n=r(4072),i=r(5391),s=r(11);Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return s.concatBytes}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return s.utf8ToBytes}}),t.ensureBytes=s.abytes,t.randomBytes=s.randomBytes,t.EMPTY=new Uint8Array(0);const o={"SHA2-256":{oid:(0,s.hexToBytes)("0609608648016503040201"),hash:n.sha256},"SHA2-384":{oid:(0,s.hexToBytes)("0609608648016503040202"),hash:n.sha384},"SHA2-512":{oid:(0,s.hexToBytes)("0609608648016503040203"),hash:n.sha512},"SHA2-224":{oid:(0,s.hexToBytes)("0609608648016503040204"),hash:n.sha224},"SHA2-512/224":{oid:(0,s.hexToBytes)("0609608648016503040205"),hash:n.sha512_224},"SHA2-512/256":{oid:(0,s.hexToBytes)("0609608648016503040206"),hash:n.sha512_256},"SHA3-224":{oid:(0,s.hexToBytes)("0609608648016503040207"),hash:i.sha3_224},"SHA3-256":{oid:(0,s.hexToBytes)("0609608648016503040208"),hash:i.sha3_256},"SHA3-384":{oid:(0,s.hexToBytes)("0609608648016503040209"),hash:i.sha3_384},"SHA3-512":{oid:(0,s.hexToBytes)("060960864801650304020A"),hash:i.sha3_512},"SHAKE-128":{oid:(0,s.hexToBytes)("060960864801650304020B"),hash:e=>(0,i.shake128)(e,{dkLen:32})},"SHAKE-256":{oid:(0,s.hexToBytes)("060960864801650304020C"),hash:e=>(0,i.shake256)(e,{dkLen:64})}}},6376:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notImplemented=t.bitMask=t.utf8ToBytes=t.randomBytes=t.isBytes=t.hexToBytes=t.concatBytes=t.bytesToUtf8=t.bytesToHex=t.anumber=t.abytes=void 0,t.abool=function(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)},t.numberToHexUnpadded=a,t.hexToNumber=f,t.bytesToNumberBE=function(e){return f((0,n.bytesToHex)(e))},t.bytesToNumberLE=function(e){return(0,n.abytes)(e),f((0,n.bytesToHex)(Uint8Array.from(e).reverse()))},t.numberToBytesBE=c,t.numberToBytesLE=function(e,t){return c(e,t).reverse()},t.numberToVarBytesBE=function(e){return(0,n.hexToBytes)(a(e))},t.ensureBytes=function(e,t,r){let i;if("string"==typeof t)try{i=(0,n.hexToBytes)(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!(0,n.isBytes)(t))throw new Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const s=i.length;if("number"==typeof r&&s!==r)throw new Error(e+" of length "+r+" expected, got "+s);return i},t.equalBytes=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},t.inRange=h,t.aInRange=function(e,t,r,n){if(!h(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)},t.bitLen=function(e){let t;for(t=0;e>s;e>>=o,t+=1);return t},t.bitGet=function(e,t){return e>>BigInt(t)&o},t.bitSet=function(e,t,r){return e|(r?o:s)<<BigInt(t)},t.createHmacDrbg=function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");const i=e=>new Uint8Array(e),s=e=>Uint8Array.of(e);let o=i(e),a=i(e),f=0;const c=()=>{o.fill(1),a.fill(0),f=0},u=(...e)=>r(a,o,...e),h=(e=i(0))=>{a=u(s(0),e),o=u(),0!==e.length&&(a=u(s(1),e),o=u())},l=()=>{if(f++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){o=u();const t=o.slice();r.push(t),e+=o.length}return(0,n.concatBytes)(...r)};return(e,t)=>{let r;for(c(),h(e);!(r=t(l()));)h();return c(),r}},t.validateObject=function(e,t,r={}){const n=(t,r,n)=>{const i=l[r];if("function"!=typeof i)throw new Error("invalid validator function");const s=e[t];if(!(n&&void 0===s||i(s,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+s)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e},t.isHash=function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)},t._validateObject=function(e,t,r={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function n(t,r,n){const i=e[t];if(n&&void 0===i)return;const s=typeof i;if(s!==r||null===i)throw new Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach((([e,t])=>n(e,t,!1))),Object.entries(r).forEach((([e,t])=>n(e,t,!0)))},t.memoized=function(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}};const n=r(11);var i=r(11);Object.defineProperty(t,"abytes",{enumerable:!0,get:function(){return i.abytes}}),Object.defineProperty(t,"anumber",{enumerable:!0,get:function(){return i.anumber}}),Object.defineProperty(t,"bytesToHex",{enumerable:!0,get:function(){return i.bytesToHex}}),Object.defineProperty(t,"bytesToUtf8",{enumerable:!0,get:function(){return i.bytesToUtf8}}),Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return i.concatBytes}}),Object.defineProperty(t,"hexToBytes",{enumerable:!0,get:function(){return i.hexToBytes}}),Object.defineProperty(t,"isBytes",{enumerable:!0,get:function(){return i.isBytes}}),Object.defineProperty(t,"randomBytes",{enumerable:!0,get:function(){return i.randomBytes}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return i.utf8ToBytes}});const s=BigInt(0),o=BigInt(1);function a(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function f(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?s:BigInt("0x"+e)}function c(e,t){return(0,n.hexToBytes)(e.toString(16).padStart(2*t,"0"))}const u=e=>"bigint"==typeof e&&s<=e;function h(e,t,r){return u(e)&&u(t)&&u(r)&&t<=e&&e<r}t.bitMask=e=>(o<<BigInt(e))-o;const l={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||(0,n.isBytes)(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};t.notImplemented=()=>{throw new Error("not implemented")}},6671:(e,t,r)=>{var n=r(4686),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},6728:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(3639)),s=n(r(5163)),o=n(r(5108)),a=r(3042),f=n(r(5800)),c=n(r(4981)),u=r(7999),h=n(r(45)),l=r(2655),d=r(4686),p=n(r(4406)),y=d.Buffer.from("7661756c7479732f656e6372797074696f6e2f01","hex"),g=32,m=e=>e.startsWith("vaultys://connect?")?"LOGIN":e.startsWith("vaultys://signfile?")?"DOCUMENT":"UNKNOWN",b=e=>{let t;return t=3===e.type?new c.default(s.default.instantiate(e.keyManager),e.certificate,e.type):4===e.type?new c.default(h.default.instantiate(e.keyManager),e.certificate,e.type):new c.default(o.default.instantiate(e.keyManager),e.certificate,e.type),t},w=e=>c.default.fromId(d.Buffer.from(e.serverId,"base64"),e.certificate);class v{constructor(e,t){this.protocol_version=0,this.acceptEncryptFile=this.acceptDecryptFile,this.vaultysId=e,this.store=t,this.store.get("metadata")||this.store.set("metadata",{}),this.vaultysId.keyManager.entropy?this.store.set("entropy",this.vaultysId.keyManager.entropy):this.store.set("secret",this.vaultysId.getSecret()),this.store.save()}setProtocolVersion(e){this.protocol_version=e}static async fromStore(e){const t=e.get("entropy"),r=e.get("secret");if(r){if(t){const n=d.Buffer.from(r,"base64")[0],i=await c.default.fromEntropy(t,n);return new v(i,e)}{const t=c.default.fromSecret(r);return new v(t,e)}}if(t){const r=await c.default.machineFromEntropy(t);return new v(r,e)}{const t=await c.default.generateMachine();return new v(t,e)}}merge(e,t=!0){const r=t?e:this.store,n=t?this.store:e;this.store.set("metadata",{...n.get("metadata"),...r.get("metadata")}),["signatures","wot"].forEach((t=>{const r=e.substore(t),n=this.store.substore(t);r.list().forEach((e=>{n.get(e)||n.set(e,r.get(e))}))}));const i=e.substore("contacts"),s=this.store.substore("contacts"),o=t?i:s,a=t?s:i;i.list().forEach((e=>{if(s.get(e)){const t=s.get(e);t.metadata={...a.get(e).metadata,...o.get(e).metadata},s.set(e,t)}else s.set(e,i.get(e))})),this.store.save()}isHardware(){return this.vaultysId.isHardware()}async signIn(){if(!this.vaultysId.isHardware())return!0;await window.CredentialUserInteractionRequest();const e=(0,u.randomBytes)(g),t=this.vaultysId.keyManager,r=await navigator.credentials.get({publicKey:{challenge:e,allowCredentials:[{type:"public-key",id:t.fid,transports:t.transports}],userVerification:"discouraged"}});if(null==r)return!1;const n=r.response,i=f.default.extractChallenge(n.clientDataJSON);return e.toString("base64")===i&&t.verifyCredentials(r)}get contacts(){const e=this.store.substore("contacts");return e.list().map((t=>e.get(t))).map(b).map((e=>e.toVersion(this.vaultysId.version)))}get apps(){const e=this.store.substore("registrations");return e.list().map((t=>e.get(t))).map(w).map((e=>e.toVersion(this.vaultysId.version)))}getContact(e){const t=this.store.substore("contacts").get(e);return t?b(t).toVersion(this.vaultysId.version):null}getApp(e){const t=this.store.substore("registrations").get(e);return t?w(t).toVersion(this.vaultysId.version):null}setContactMetadata(e,t,r){const n=this.store.substore("contacts").get(e);n&&(n.metadata||(n.metadata={}),n.metadata[t]=r)}getContactMetadata(e,t){const r=this.store.substore("contacts").get(e);return r&&r.metadata?r.metadata[t]:null}getContactMetadatas(e){const t=this.store.substore("contacts").get(e);return t&&t.metadata?t.metadata:null}async verifyRelationshipCertificate(e){const t=this.store.substore("contacts").get(e)||this.store.substore("registrations").get(e);return i.default.verifyCertificate(t.certificate)}set name(e){this.store.get("metadata").name=e}get name(){return this.store.get("metadata").name}get displayName(){const e=this.store.get("metadata"),t=e.firstname?e.firstname+" "+(e.name??""):e.name;return t?.length>0?t:"Anonymous "+this.vaultysId.fingerprint?.slice(-4)}set phone(e){this.store.get("metadata").phone=e}get phone(){return this.store.get("metadata").phone}set email(e){this.store.get("metadata").email=e}get email(){return this.store.get("metadata").email}async signChallenge(e){const t=await this.vaultysId.signChallenge(e);return this.store.substore("signatures").set(""+Date.now(),{signature:t,challenge:e}),this.store.save(),t}async signFile(e){const t=(0,u.hash)("sha256",e.arrayBuffer).toString("hex"),r=d.Buffer.from(`vaultys://signfile?hash=${t}&timestamp=${Date.now()}`,"utf-8"),n={challenge:r,signature:await this.vaultysId.signChallenge(r)};return this.store.substore("signatures").set(Date.now()+"",n),this.store.save(),n}verifyFile(e,t,r,n=!0){const i=t.challenge.toString("utf8");if(!i.startsWith("vaultys://signfile?"))return!1;const s=(0,u.hash)("sha256",e.arrayBuffer).toString("hex"),o=new URL(i);return s===o.searchParams.get("hash")&&!(2!==o.search.match(/[a-z\d]+=[a-z\d]+/gi)?.length||!o.searchParams.get("timestamp"))&&r.verifyChallenge(t.challenge,t.signature,n)}async decryptFile(e,t){const r=new Uint8Array(e.arrayBuffer),n=r.slice(0,y.length);if(d.Buffer.from(n).toString("hex")!==y.toString("hex"))throw new Error("Invalid header for encrypted file");const i=r.slice(y.length,y.length+g),s=r.slice(y.length+g,y.length+g+p.default.secretbox.nonceLength),o=r.slice(y.length+g+p.default.secretbox.nonceLength),a=t?await this.requestPRF(t,"encryption/"+d.Buffer.from(i).toString("hex")+"/encryption"):await this.vaultysId.hmac("prf|encryption/"+d.Buffer.from(i).toString("hex")+"/encryption|prf");if(a?.length!==g)throw new Error("Invalid PRF generated");const f=(0,u.hash)("sha256",a);(0,u.secureErase)(a);const c=p.default.secretbox.open(o,s,f);if((0,u.secureErase)(f),!c)throw new Error("Decryption failed");return{name:e.name,type:e.type,arrayBuffer:d.Buffer.from(c)}}async encryptFile(e,t){const r=(0,u.randomBytes)(g),n=t?await this.requestPRF(t,"encryption/"+d.Buffer.from(r).toString("hex")+"/encryption"):await this.vaultysId.hmac("prf|encryption/"+r.toString("hex")+"/encryption|prf");if(n?.length!==g)return null;const i=(0,u.hash)("sha256",n);(0,u.secureErase)(n);const s=p.default.randomBytes(p.default.secretbox.nonceLength),o=p.default.secretbox(new Uint8Array(e.arrayBuffer),s,i);(0,u.secureErase)(i);const a=new Uint8Array(y.length+g+s.length+o.length);return a.set(y),a.set(r,y.length),a.set(s,y.length+g),a.set(o,y.length+g+s.length),{name:e.name,type:e.type,arrayBuffer:d.Buffer.from(a)}}getSignatures(){const e=this.store.substore("signatures");return e.list().sort().map((t=>{const r=e.get(t),n=d.Buffer.from(r.challenge).toString("utf-8");return{date:t,payload:r,challenge:n,type:m(n)}}))}migrate(e){this.vaultysId.toVersion(e);const t=this.store.substore("contacts");for(const r of t.list()){const n=t.get(r),i=b(n),s=i.toVersion(e);s.did!==r&&(t.set(s.did,{...i,...s,metadata:n.metadata,oldDid:r}),t.delete(r))}const r=this.store.substore("registrations");for(const t of r.list()){const n=r.get(t),i=w(n);if(i){const s=i.toVersion(e);if(s.did!==t){const e=n.site===t?s.did:n.site;r.set(s.did,{site:e,oldDid:t,serverId:s.id.toString("base64"),certificate:n.certificate,timestamp:n.timestamp}),r.delete(t)}}}this.store.save()}async verifyChallenge(e,t){return this.vaultysId.verifyChallenge(e,t,!0)}async upload(e,t){if((await this.startSRP(e,"p2p","transfer")).isComplete()){const{upload:r}=(0,a.StreamChannel)(e);await r(t)}else e.send(d.Buffer.from([0]))}async download(e,t){if((await this.acceptSRP(e,"p2p","transfer")).isComplete()){const{download:r}=(0,a.StreamChannel)(e);await r(t)}else e.send(d.Buffer.from([0]))}async requestDecrypt(e,t){const r=await this.acceptSRP(e,"p2p","decrypt");if(r.isComplete()){e.send(t);const n=await e.receive();return await this.vaultysId.dhiesDecrypt(n,r.getContactId().id)}e.send(d.Buffer.from([0]))}async acceptDecrypt(e,t){const r=await this.startSRP(e,"p2p","decrypt",{},t);if(r.isComplete()){const t=await e.receive(),n=await this.vaultysId.decrypt(t.toString("utf-8"));if(n){const t=await this.vaultysId.dhiesEncrypt(n,r.getContactId().id);e.send(t??d.Buffer.from([0]))}else e.send(d.Buffer.from([0]))}else e.send(d.Buffer.from([0]))}async requestDecryptFile(e,t){return this.decryptFile(t,e)}async requestEncryptFile(e,t){return this.encryptFile(t,e)}async acceptDecryptFile(e,t){let r=null;return await this.acceptPRF(e,((e,n)=>n.length>63&&n.startsWith("encryption/")&&n.endsWith("/encryption")?(r=e,t?.(e)||Promise.resolve(!0)):Promise.resolve(!1))),r}async requestSignFile(e,t){const r=await this.acceptSRP(e,"p2p","signfile");if(r.isComplete()){e.send(d.Buffer.from((0,l.encode)(t)));const n=await e.receive(),i=(0,l.decode)(n);return this.verifyFile(t,i,r.getContactId().toVersion(1))?i:void 0}e.send(d.Buffer.from([0]))}async acceptSignFile(e,t){const r=await this.startSRP(e,"p2p","signfile");if(r.isComplete()){const n=await e.receive(),i=(0,l.decode)(n);if(!t||await t(r.getContactId(),i)){const t=await this.signFile(i);e.send(d.Buffer.from((0,l.encode)(t)))}else e.send(d.Buffer.from([0]))}else e.send(d.Buffer.from([0]))}async requestPRF(e,t){if(t.length<3)throw new Error("appid is too short, less than 3 characters");if(t.split("|").length>1)throw new Error("appid contains illegal character |");if((await this.acceptSRP(e,"p2p","prf")).isComplete()){e.send(d.Buffer.from(t,"utf-8"));const r=await e.receive();return d.Buffer.from(r)}e.send(d.Buffer.from([0]))}async acceptPRF(e,t){const r=await this.startSRP(e,"p2p","prf");if(r.isComplete()){const n=(await e.receive()).toString("utf-8");if(n.length<3||n.split("|").length>1)e.send(d.Buffer.from([0]));else if(!t||await t(r.getContactId(),n)){const t=await this.vaultysId.hmac("prf|"+n+"|prf")??d.Buffer.from([0]);e.send(t),(0,u.secureErase)(t)}else e.send(d.Buffer.from([0]))}else e.send(d.Buffer.from([0]))}listCertificates(){const e=this.store.substore("wot");return e.list().map((t=>{const r=e.get(t);if(r.timestamp)return r;{const n={...i.default.deserializeCertificate(e.get(t)),raw:r};return e.set(t,n),n}}))}async startSRP(e,t,r,n={},s){const o=new i.default(this.vaultysId);o.createChallenge(t,r,this.protocol_version,n);const a=o.getCertificate();if(!a)throw e.close(),e.send(d.Buffer.from([0])),new Error("Error processing challenge");e.send(a);try{const t=await e.receive(),r=i.default.deserializeCertificate(t).pk2;if(!r)throw e.send(d.Buffer.from([0])),new Error("Contact pk2 is not sent");if(s&&!await s(c.default.fromId(r)))throw e.send(d.Buffer.from([0])),new Error("Contact refused");await o.update(t)}catch(t){throw e.send(d.Buffer.from([0])),new Error(t)}if(o.isComplete()){const t=o.getCertificate();if(!t)throw e.close(),e.send(d.Buffer.from([0])),new Error("Error processing challenge");return e.send(t),this.store.substore("wot").set(Date.now()+"",t),o}throw e.send(d.Buffer.from([0])),new Error("Can't add a new contact if the protocol is not complete")}async acceptSRP(e,t,r,n={},s){const o=new i.default(this.vaultysId);try{const a=await e.receive(),f=i.default.deserializeCertificate(a);if(!f.pk1)throw e.send(d.Buffer.from([0])),new Error("Contact pk1 is not sent");if(f.protocol!==t)throw e.send(d.Buffer.from([0])),new Error("protocol is not the one expected: "+f.protocol+" !="+t);if(f.service!==r)throw e.send(d.Buffer.from([0])),new Error("service is not the one expected: "+f.service+" !="+r);if(s&&!await s(c.default.fromId(f.pk1)))throw e.send(d.Buffer.from([0])),new Error("Contact refused");await o.update(a,n)}catch(t){throw e.send(d.Buffer.from([0])),new Error(t)}const a=o.getCertificate();if(!a)throw e.send(d.Buffer.from([0])),await e.close(),new Error("Error processing challenge");e.send(a);try{const t=await e.receive();await o.update(t)}catch(t){throw await e.close(),new Error(t)}if(o.isComplete()){const e=o.getCertificate();return this.store.substore("wot").set(Date.now()+"",e),o}throw await e.close(),new Error("Can't add a new contact if the protocol is not complete")}saveApp(e,t){if(e.toVersion(this.vaultysId.version),e.isMachine()){const r=this.store.substore("registrations");r.get(e.did)||r.set(e.did,{site:t??e.did,serverId:e.id.toString("base64"),certificate:e.certificate})}else this.saveContact(e)}saveContact(e){if(e.toVersion(this.vaultysId.version),e.isMachine())this.saveApp(e);else{const t=this.store.substore("contacts");t.get(e.did)||(t.set(e.did,e),this.store.save())}}async askContact(e,t={},r){const n=(await this.startSRP(e,"p2p","auth",t,r)).getContactId();return this.saveContact(n),n}async acceptContact(e,t={},r){const n=(await this.acceptSRP(e,"p2p","auth",t,r)).getContactId();return this.saveContact(n),n}}t.default=v},6868:(e,t,r)=>{"use strict";var n,i=r(8558);function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t){var r=e.entry;for(e.entry=null;r;){var n=r.callback;t.pendingcb--,n(undefined),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=A,A.WritableState=S;var o,a={deprecate:r(1348)},f=r(9481),c=r(4686).Buffer,u=(void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},h=r(4552),l=r(7963).getHighWaterMark,d=r(8704).F,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,g=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,b=d.ERR_STREAM_DESTROYED,w=d.ERR_STREAM_NULL_VALUES,v=d.ERR_STREAM_WRITE_AFTER_END,E=d.ERR_UNKNOWN_ENCODING,B=h.errorOrDestroy;function _(){}function S(e,t,o){n=n||r(5606),e=e||{},"boolean"!=typeof o&&(o=t instanceof n),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=l(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,s=r.writecb;if("function"!=typeof s)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,s){--t.pendingcb,r?(i.nextTick(s,n),i.nextTick(R,e,t),e._writableState.errorEmitted=!0,B(e,n)):(s(n),e._writableState.errorEmitted=!0,B(e,n),R(e,t))}(e,r,n,t,s);else{var o=U(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||T(e,r),n?i.nextTick(x,e,r,o,s):x(e,r,o,s)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function A(e){var t=this instanceof(n=n||r(5606));if(!t&&!o.call(A,this))return new A(e);this._writableState=new S(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),f.call(this)}function I(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function x(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),R(e,t)}function T(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0,f=!0;r;)i[a]=r,r.isBuf||(f=!1),r=r.next,a+=1;i.allBuffers=f,I(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,h=r.callback;if(I(e,t,!1,t.objectMode?1:c.length,c,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function U(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function O(e,t){e._final((function(r){t.pendingcb--,r&&B(e,r),t.prefinished=!0,e.emit("prefinish"),R(e,t)}))}function R(e,t){var r=U(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(O,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}r(6192)(A,f),S.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(S.prototype,"buffer",{get:a.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return!!o.call(this,e)||this===A&&e&&e._writableState instanceof S}})):o=function(e){return e instanceof this},A.prototype.pipe=function(){B(this,new m)},A.prototype.write=function(e,t,r){var n,s=this._writableState,o=!1,a=!s.objectMode&&(n=e,c.isBuffer(n)||n instanceof u);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=_),s.ending?function(e,t){var r=new v;B(e,r),i.nextTick(t,r)}(this,r):(a||function(e,t,r,n){var s;return null===r?s=new w:"string"==typeof r||t.objectMode||(s=new p("chunk",["string","Buffer"],r)),!s||(B(e,s),i.nextTick(n,s),!1)}(this,s,e,r))&&(s.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r)),t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=t.objectMode?1:n.length;t.length+=a;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else I(e,t,!1,a,n,i,s);return f}(this,s,a,e,t,r)),o},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||T(this,e))},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new E(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(e,t,r){r(new y("_write()"))},A.prototype._writev=null,A.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,R(e,t),r&&(t.finished?i.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),A.prototype.destroy=h.destroy,A.prototype._undestroy=h.undestroy,A.prototype._destroy=function(e,t){t(e)}},6869:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},6899:(e,t,r)=>{"use strict";const n=r(896),{Buffer:i}=r(4686),s=new TextDecoder("utf8",{fatal:!0,ignoreBOM:!0});class o extends n.Transform{constructor(e,t,r={}){let n=null,s=null;switch(typeof e){case"object":i.isBuffer(e)?n=e:e&&(r=e);break;case"string":n=e;break;case"undefined":break;default:throw new TypeError("Invalid input")}switch(typeof t){case"object":t&&(r=t);break;case"string":s=t;break;case"undefined":break;default:throw new TypeError("Invalid inputEncoding")}if(!r||"object"!=typeof r)throw new TypeError("Invalid options");null==n&&(n=r.input),null==s&&(s=r.inputEncoding),delete r.input,delete r.inputEncoding;const o=null==r.watchPipe||r.watchPipe;delete r.watchPipe;const a=Boolean(r.readError);delete r.readError,super(r),this.readError=a,o&&this.on("pipe",(e=>{const t=e._readableState.objectMode;if(this.length>0&&t!==this._readableState.objectMode)throw new Error("Do not switch objectMode in the middle of the stream");this._readableState.objectMode=t,this._writableState.objectMode=t})),null!=n&&this.end(n,s)}static isNoFilter(e){return e instanceof this}static compare(e,t){if(!(e instanceof this))throw new TypeError("Arguments must be NoFilters");return e===t?0:e.compare(t)}static concat(e,t){if(!Array.isArray(e))throw new TypeError("list argument must be an Array of NoFilters");if(0===e.length||0===t)return i.alloc(0);null==t&&(t=e.reduce(((e,t)=>{if(!(t instanceof o))throw new TypeError("list argument must be an Array of NoFilters");return e+t.length}),0));let r=!0,n=!0;const s=e.map((e=>{if(!(e instanceof o))throw new TypeError("list argument must be an Array of NoFilters");const t=e.slice();return i.isBuffer(t)?n=!1:r=!1,t}));if(r)return i.concat(s,t);if(n)return[].concat(...s).slice(0,t);throw new Error("Concatenating mixed object and byte streams not supported")}_transform(e,t,r){this._readableState.objectMode||i.isBuffer(e)||(e=i.from(e,t)),this.push(e),r()}_bufArray(){let e=this._readableState.buffer;if(!Array.isArray(e)){let t=e.head;for(e=[];null!=t;)e.push(t.data),t=t.next}return e}read(e){const t=super.read(e);if(null!=t){if(this.emit("read",t),this.readError&&t.length<e)throw new Error(`Read ${t.length}, wanted ${e}`)}else if(this.readError)throw new Error(`No data available, wanted ${e}`);return t}readFull(e){let t=null,r=null,n=null;return new Promise(((i,s)=>{this.length>=e?i(this.read(e)):this.writableFinished?s(new Error(`Stream finished before ${e} bytes were available`)):(t=t=>{this.length>=e&&i(this.read(e))},r=()=>{s(new Error(`Stream finished before ${e} bytes were available`))},n=s,this.on("readable",t),this.on("error",n),this.on("finish",r))})).finally((()=>{t&&(this.removeListener("readable",t),this.removeListener("error",n),this.removeListener("finish",r))}))}promise(e){let t=!1;return new Promise(((r,n)=>{this.on("finish",(()=>{const n=this.read();null==e||t||(t=!0,e(null,n)),r(n)})),this.on("error",(r=>{null==e||t||(t=!0,e(r)),n(r)}))}))}compare(e){if(!(e instanceof o))throw new TypeError("Arguments must be NoFilters");if(this===e)return 0;const t=this.slice(),r=e.slice();if(i.isBuffer(t)&&i.isBuffer(r))return t.compare(r);throw new Error("Cannot compare streams in object mode")}equals(e){return 0===this.compare(e)}slice(e,t){if(this._readableState.objectMode)return this._bufArray().slice(e,t);const r=this._bufArray();switch(r.length){case 0:return i.alloc(0);case 1:return r[0].slice(e,t);default:return i.concat(r).slice(e,t)}}get(e){return this.slice()[e]}toJSON(){const e=this.slice();return i.isBuffer(e)?e.toJSON():e}toString(e,t,r){const n=this.slice(t,r);return i.isBuffer(n)?e&&"utf8"!==e?n.toString(e):s.decode(n):JSON.stringify(n)}[Symbol.for("nodejs.util.inspect.custom")](e,t){const r=this._bufArray().map((e=>i.isBuffer(e)?t.stylize(e.toString("hex"),"string"):JSON.stringify(e))).join(", ");return`${this.constructor.name} [${r}]`}get length(){return this._readableState.length}writeBigInt(e){let t=e.toString(16);if(e<0){const r=BigInt(Math.floor(t.length/2));t=(e=(BigInt(1)<<r*BigInt(8))+e).toString(16)}return t.length%2&&(t=`0${t}`),this.push(i.from(t,"hex"))}readUBigInt(e){const t=this.read(e);return i.isBuffer(t)?BigInt(`0x${t.toString("hex")}`):null}readBigInt(e){const t=this.read(e);if(!i.isBuffer(t))return null;let r=BigInt(`0x${t.toString("hex")}`);return 128&t[0]&&(r-=BigInt(1)<<BigInt(t.length)*BigInt(8)),r}writeUInt8(e){const t=i.from([e]);return this.push(t)}writeUInt16LE(e){const t=i.alloc(2);return t.writeUInt16LE(e),this.push(t)}writeUInt16BE(e){const t=i.alloc(2);return t.writeUInt16BE(e),this.push(t)}writeUInt32LE(e){const t=i.alloc(4);return t.writeUInt32LE(e),this.push(t)}writeUInt32BE(e){const t=i.alloc(4);return t.writeUInt32BE(e),this.push(t)}writeInt8(e){const t=i.from([e]);return this.push(t)}writeInt16LE(e){const t=i.alloc(2);return t.writeUInt16LE(e),this.push(t)}writeInt16BE(e){const t=i.alloc(2);return t.writeUInt16BE(e),this.push(t)}writeInt32LE(e){const t=i.alloc(4);return t.writeUInt32LE(e),this.push(t)}writeInt32BE(e){const t=i.alloc(4);return t.writeUInt32BE(e),this.push(t)}writeFloatLE(e){const t=i.alloc(4);return t.writeFloatLE(e),this.push(t)}writeFloatBE(e){const t=i.alloc(4);return t.writeFloatBE(e),this.push(t)}writeDoubleLE(e){const t=i.alloc(8);return t.writeDoubleLE(e),this.push(t)}writeDoubleBE(e){const t=i.alloc(8);return t.writeDoubleBE(e),this.push(t)}writeBigInt64LE(e){const t=i.alloc(8);return t.writeBigInt64LE(e),this.push(t)}writeBigInt64BE(e){const t=i.alloc(8);return t.writeBigInt64BE(e),this.push(t)}writeBigUInt64LE(e){const t=i.alloc(8);return t.writeBigUInt64LE(e),this.push(t)}writeBigUInt64BE(e){const t=i.alloc(8);return t.writeBigUInt64BE(e),this.push(t)}readUInt8(){const e=this.read(1);return i.isBuffer(e)?e.readUInt8():null}readUInt16LE(){const e=this.read(2);return i.isBuffer(e)?e.readUInt16LE():null}readUInt16BE(){const e=this.read(2);return i.isBuffer(e)?e.readUInt16BE():null}readUInt32LE(){const e=this.read(4);return i.isBuffer(e)?e.readUInt32LE():null}readUInt32BE(){const e=this.read(4);return i.isBuffer(e)?e.readUInt32BE():null}readInt8(){const e=this.read(1);return i.isBuffer(e)?e.readInt8():null}readInt16LE(){const e=this.read(2);return i.isBuffer(e)?e.readInt16LE():null}readInt16BE(){const e=this.read(2);return i.isBuffer(e)?e.readInt16BE():null}readInt32LE(){const e=this.read(4);return i.isBuffer(e)?e.readInt32LE():null}readInt32BE(){const e=this.read(4);return i.isBuffer(e)?e.readInt32BE():null}readFloatLE(){const e=this.read(4);return i.isBuffer(e)?e.readFloatLE():null}readFloatBE(){const e=this.read(4);return i.isBuffer(e)?e.readFloatBE():null}readDoubleLE(){const e=this.read(8);return i.isBuffer(e)?e.readDoubleLE():null}readDoubleBE(){const e=this.read(8);return i.isBuffer(e)?e.readDoubleBE():null}readBigInt64LE(){const e=this.read(8);return i.isBuffer(e)?e.readBigInt64LE():null}readBigInt64BE(){const e=this.read(8);return i.isBuffer(e)?e.readBigInt64BE():null}readBigUInt64LE(){const e=this.read(8);return i.isBuffer(e)?e.readBigUInt64LE():null}readBigUInt64BE(){const e=this.read(8);return i.isBuffer(e)?e.readBigUInt64BE():null}}e.exports=o},7268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp384r1=t.p384=void 0;const n=r(2355);t.p384=n.p384,t.secp384r1=n.p384,t.hashToCurve=n.p384_hasher.hashToCurve,t.encodeToCurve=n.p384_hasher.encodeToCurve},7342:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNegativeLE=void 0,t.mod=h,t.pow=function(e,t,r){return b(B(r),e,t)},t.pow2=function(e,t,r){let n=e;for(;t-- >i;)n*=n,n%=r;return n},t.invert=l,t.tonelliShanks=y,t.FpSqrt=g,t.validateField=function(e){const t=m.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"});return(0,n._validateObject)(e,t),e},t.FpPow=b,t.FpInvertBatch=w,t.FpDiv=function(e,t,r){return e.mul(t,"bigint"==typeof r?l(r,e.ORDER):e.inv(r))},t.FpLegendre=v,t.FpIsSquare=function(e,t){return 1===v(e,t)},t.nLength=E,t.Field=B,t.FpSqrtOdd=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)},t.FpSqrtEven=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r},t.hashToPrivateScalar=function(e,t,r=!1){const i=(e=(0,n.ensureBytes)("privateHash",e)).length,o=E(t).nByteLength+8;if(o<24||i<o||i>1024)throw new Error("hashToPrivateScalar: expected "+o+"-1024 bytes of input, got "+i);return h(r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e),t-s)+s},t.getFieldBytesLength=_,t.getMinHashLength=S,t.mapHashToField=function(e,t,r=!1){const i=e.length,o=_(t),a=S(t);if(i<16||i<a||i>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+i);const f=h(r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e),t-s)+s;return r?(0,n.numberToBytesLE)(f,o):(0,n.numberToBytesBE)(f,o)};const n=r(6376),i=BigInt(0),s=BigInt(1),o=BigInt(2),a=BigInt(3),f=BigInt(4),c=BigInt(5),u=BigInt(8);function h(e,t){const r=e%t;return r>=i?r:t+r}function l(e,t){if(e===i)throw new Error("invert: expected non-zero number");if(t<=i)throw new Error("invert: expected positive modulus, got "+t);let r=h(e,t),n=t,o=i,a=s,f=s,c=i;for(;r!==i;){const e=n/r,t=n%r,i=o-f*e,s=a-c*e;n=r,r=t,o=f,a=c,f=i,c=s}if(n!==s)throw new Error("invert: does not exist");return h(o,t)}function d(e,t){const r=(e.ORDER+s)/f,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function p(e,t){const r=(e.ORDER-c)/u,n=e.mul(t,o),i=e.pow(n,r),s=e.mul(t,i),a=e.mul(e.mul(s,o),i),f=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(f),t))throw new Error("Cannot find square root");return f}function y(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-s,r=0;for(;t%o===i;)t/=o,r++;let n=o;const a=B(e);for(;1===v(a,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return d;let f=a.pow(n,t);const c=(t+s)/o;return function(e,n){if(e.is0(n))return n;if(1!==v(e,n))throw new Error("Cannot find square root");let i=r,o=e.mul(e.ONE,f),a=e.pow(n,t),u=e.pow(n,c);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,r=e.sqr(a);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=s<<BigInt(i-t-1),f=e.pow(o,n);i=t,o=e.sqr(f),a=e.mul(a,o),u=e.mul(u,f)}return u}}function g(e){return e%f===a?d:e%u===c?p:y(e)}t.isNegativeLE=(e,t)=>(h(e,t)&s)===s;const m=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function b(e,t,r){if(r<i)throw new Error("invalid exponent, negatives unsupported");if(r===i)return e.ONE;if(r===s)return t;let n=e.ONE,o=t;for(;r>i;)r&s&&(n=e.mul(n,o)),o=e.sqr(o),r>>=s;return n}function w(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce(((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r))),e.ONE),s=e.inv(i);return t.reduceRight(((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))),s),n}function v(e,t){const r=(e.ORDER-s)/o,n=e.pow(t,r),i=e.eql(n,e.ONE),a=e.eql(n,e.ZERO),f=e.eql(n,e.neg(e.ONE));if(!i&&!a&&!f)throw new Error("invalid Legendre symbol result");return i?1:a?0:-1}function E(e,t){void 0!==t&&(0,n.anumber)(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function B(e,t,r=!1,o={}){if(e<=i)throw new Error("invalid field: expected ORDER > 0, got "+e);let a,f;if("object"==typeof t&&null!=t){if(o.sqrt||r)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(a=e.BITS),e.sqrt&&(f=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE)}else"number"==typeof t&&(a=t),o.sqrt&&(f=o.sqrt);const{nBitLength:c,nByteLength:u}=E(e,a);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let d;const p=Object.freeze({ORDER:e,isLE:r,BITS:c,BYTES:u,MASK:(0,n.bitMask)(c),ZERO:i,ONE:s,create:t=>h(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return i<=t&&t<e},is0:e=>e===i,isValidNot0:e=>!p.is0(e)&&p.isValid(e),isOdd:e=>(e&s)===s,neg:t=>h(-t,e),eql:(e,t)=>e===t,sqr:t=>h(t*t,e),add:(t,r)=>h(t+r,e),sub:(t,r)=>h(t-r,e),mul:(t,r)=>h(t*r,e),pow:(e,t)=>b(p,e,t),div:(t,r)=>h(t*l(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>l(t,e),sqrt:f||(t=>(d||(d=g(e)),d(p,t))),toBytes:e=>r?(0,n.numberToBytesLE)(e,u):(0,n.numberToBytesBE)(e,u),fromBytes:e=>{if(e.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+e.length);return r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e)},invertBatch:e=>w(p,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(p)}function _(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function S(e){const t=_(e);return t+Math.ceil(t/2)}},7734:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHA512_IV=t.SHA384_IV=t.SHA224_IV=t.SHA256_IV=t.HashMD=void 0,t.setBigUint64=i,t.Chi=function(e,t,r){return e&t^~e&r},t.Maj=function(e,t,r){return e&t^e&r^t&r};const n=r(11);function i(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),f=n?4:0,c=n?0:4;e.setUint32(t+f,o,n),e.setUint32(t+c,a,n)}class s extends n.Hash{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,n.createView)(this.buffer)}update(e){(0,n.aexists)(this),e=(0,n.toBytes)(e),(0,n.abytes)(e);const{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a!==i)r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0);else{const t=(0,n.createView)(e);for(;i<=s-o;o+=i)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,n.aexists)(this),(0,n.aoutput)(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:o}=this;let{pos:a}=this;t[a++]=128,(0,n.clean)(this.buffer.subarray(a)),this.padOffset>s-a&&(this.process(r,0),a=0);for(let e=a;e<s;e++)t[e]=0;i(r,s-8,BigInt(8*this.length),o),this.process(r,0);const f=(0,n.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<u;e++)f.setUint32(4*e,h[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=i,e.length=n,e.pos=o,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}t.HashMD=s,t.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),t.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),t.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),t.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])},7947:(e,t)=>{t.read=function(e,t,r,n,i){var s,o,a=8*i-n-1,f=(1<<a)-1,c=f>>1,u=-7,h=r?i-1:0,l=r?-1:1,d=e[t+h];for(h+=l,s=d&(1<<-u)-1,d>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=l,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+e[t+h],h+=l,u-=8);if(0===s)s=1-c;else{if(s===f)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),s-=c}return(d?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var o,a,f,c=8*s-i-1,u=(1<<c)-1,h=u>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-o))<1&&(o--,f*=2),(t+=o+h>=1?l/f:l*Math.pow(2,1-h))*f>=2&&(o++,f/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*f-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;e[r+d]=255&o,d+=p,o/=256,c-=8);e[r+d-p]|=128*y}},7963:(e,t,r)=>{"use strict";var n=r(8704).F.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var s=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new n(i?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},7999:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.secureErase=t.fromUTF8=t.fromHex=t.fromBase64=t.toUTF8=t.toHex=t.toBase64=t.secretbox=t.randomBytes=t.hmac=t.hash=t.Buffer=void 0;const a=o(r(4406)),f=r(4686);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return f.Buffer}});const c=r(4072),u=r(3835),h=e=>{const t=e.replaceAll("-","").toLowerCase();return"sha256"===t?c.sha256:"sha512"===t?c.sha512:"sha224"===t?c.sha224:c.sha256};t.randomBytes=e=>f.Buffer.from((0,a.randomBytes)(e)),t.hash=(e,t)=>f.Buffer.from(h(e).create().update(t).digest()),t.hmac=(e,t,r)=>f.Buffer.from((0,u.hmac)(h(e),t,r));const l=a.default.secretbox;t.secretbox=l,t.toBase64=e=>f.Buffer.from(e).toString("base64"),t.toHex=e=>f.Buffer.from(e).toString("hex"),t.toUTF8=e=>f.Buffer.from(e).toString("utf-8"),t.fromBase64=e=>f.Buffer.from(e,"base64"),t.fromHex=e=>f.Buffer.from(e,"hex"),t.fromUTF8=e=>f.Buffer.from(e,"utf-8"),t.secureErase=e=>{for(let t=0;t<e.length;t++)e[t]=0}},8308:()=>{},8558:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var a,f=[],c=!1,u=-1;function h(){c&&a&&(c=!1,a.length?f=a.concat(f):u=-1,f.length&&l())}function l(){if(!c){var e=o(h);c=!0;for(var t=f.length;t;){for(a=f,f=[];++u<t;)a&&a[u].run();u=-1,t=f.length}a=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new d(e,t)),1!==f.length||c||o(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},8568:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;const n=r(7999),i=r(4686);t.encrypt=(e,t)=>{const r=t,s=(0,n.randomBytes)(n.secretbox.nonceLength),o=(0,n.secretbox)(Uint8Array.from(e),s,r),a=new Uint8Array(s.length+o.length);return a.set(s),a.set(o,s.length),i.Buffer.from(a)},t.decrypt=(e,t)=>{const r=t,s=e,o=s.slice(0,n.secretbox.nonceLength),a=s.slice(n.secretbox.nonceLength,e.length),f=n.secretbox.open(a,o,r);if(!f)throw new Error("Could not decrypt message");return i.Buffer.from(f)},t.default={decrypt:t.decrypt,encrypt:t.encrypt,encryptChannel:(e,r)=>{const n={apply:(e,n,i)=>e.call(n,(0,t.encrypt)(i[0],r))},i={async apply(e,n,i){const s=await e.call(n);return(0,t.decrypt)(s,r)}};return e.send=new Proxy(e.send,n),e.receive=new Proxy(e.receive,i),e},generateKey:()=>(0,n.randomBytes)(32)}},8590:(e,t,r)=>{"use strict";const{Buffer:n}=r(4686),i=r(6899),s=r(896),o=r(790),{NUMBYTES:a,SHIFT32:f,BI:c,SYMS:u}=o,h=new TextDecoder("utf8",{fatal:!0,ignoreBOM:!0});t.utf8=e=>h.decode(e),t.utf8.checksUTF8=!0,t.isBufferish=function(e){return e&&"object"==typeof e&&(n.isBuffer(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof ArrayBuffer||e instanceof DataView)},t.bufferishToBuffer=function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?n.from(e):null},t.parseCBORint=function(e,t){switch(e){case a.ONE:return t.readUInt8(0);case a.TWO:return t.readUInt16BE(0);case a.FOUR:return t.readUInt32BE(0);case a.EIGHT:{const e=t.readUInt32BE(0),r=t.readUInt32BE(4);return e>2097151?BigInt(e)*c.SHIFT32+BigInt(r):e*f+r}default:throw new Error(`Invalid additional info for int: ${e}`)}},t.writeHalf=function(e,t){const r=n.allocUnsafe(4);r.writeFloatBE(t,0);const i=r.readUInt32BE(0);if(8191&i)return!1;let s=i>>16&32768;const o=i>>23&255,a=8388607&i;if(o>=113&&o<=142)s+=(o-112<<10)+(a>>13);else{if(!(o>=103&&o<113))return!1;if(a&(1<<126-o)-1)return!1;s+=a+8388608>>126-o}return e.writeUInt16BE(s),!0},t.parseHalf=function(e){const t=128&e[0]?-1:1,r=(124&e[0])>>2,n=(3&e[0])<<8|e[1];return r?31===r?t*(n?NaN:1/0):t*2**(r-25)*(1024+n):5.960464477539063e-8*t*n},t.parseCBORfloat=function(e){switch(e.length){case 2:return t.parseHalf(e);case 4:return e.readFloatBE(0);case 8:return e.readDoubleBE(0);default:throw new Error(`Invalid float size: ${e.length}`)}},t.hex=function(e){return n.from(e.replace(/^0x/,""),"hex")},t.bin=function(e){let t=0,r=(e=e.replace(/\s/g,"")).length%8||8;const i=[];for(;r<=e.length;)i.push(parseInt(e.slice(t,r),2)),t=r,r+=8;return n.from(i)},t.arrayEqual=function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every(((e,r)=>e===t[r]))},t.bufferToBigInt=function(e){return BigInt(`0x${e.toString("hex")}`)},t.cborValueToString=function(e,r=-1){switch(typeof e){case"symbol":{switch(e){case u.NULL:return"null";case u.UNDEFINED:return"undefined";case u.BREAK:return"BREAK"}if(e.description)return e.description;const t=e.toString().match(/^Symbol\((?<name>.*)\)/);return t&&t.groups.name?t.groups.name:"Symbol"}case"string":return JSON.stringify(e);case"bigint":return e.toString();case"number":{const t=Object.is(e,-0)?"-0":String(e);return r>0?`${t}_${r}`:t}case"object":{if(!e)return"null";const n=t.bufferishToBuffer(e);if(n){const e=n.toString("hex");return r===-1/0?e:`h'${e}'`}return e&&"function"==typeof e[Symbol.for("nodejs.util.inspect.custom")]?e[Symbol.for("nodejs.util.inspect.custom")]():Array.isArray(e)?"[]":"{}"}}return String(e)},t.guessEncoding=function(e,r){if("string"==typeof e)return new i(e,null==r?"hex":r);const n=t.bufferishToBuffer(e);if(n)return new i(n);if((o=e)instanceof s.Readable||["read","on","pipe"].every((e=>"function"==typeof o[e])))return e;var o;throw new Error("Unknown input type")};const l={"=":"","+":"-","/":"_"};t.base64url=function(e){return t.bufferishToBuffer(e).toString("base64").replace(/[=+/]/g,(e=>l[e]))},t.base64=function(e){return t.bufferishToBuffer(e).toString("base64")},t.isBigEndian=function(){const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])}},8704:e=>{"use strict";var t={};function r(e,r,n){n||(n=Error);var i=function(e){var t,n;function i(t,n,i){return e.call(this,function(e,t,n){return"string"==typeof r?r:r(e,t,n)}(t,n,i))||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(n);i.prototype.name=n.name,i.prototype.code=e,t[e]=i}function n(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(e,t,r){var i,s,o,a,f;if("string"==typeof t&&(s="not ",t.substr(0,4)===s)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-9,r)===t}(e," argument"))o="The ".concat(e," ").concat(i," ").concat(n(t,"type"));else{var c=("number"!=typeof f&&(f=0),f+1>(a=e).length||-1===a.indexOf(".",f)?"argument":"property");o='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(n(t,"type"))}return o+". Received type ".concat(typeof r)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.F=t},8854:()=>{},8881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.montgomery=function(e){const t=(d=e,(0,n._validateObject)(d,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...d})),{P:r,type:f,adjustScalarBytes:c,powPminus2:u,randomBytes:h}=t,l="x25519"===f;var d;if(!l&&"x448"!==f)throw new Error("invalid type");const p=h||n.randomBytes,y=l?255:448,g=l?32:56,m=l?BigInt(9):BigInt(5),b=l?BigInt(121665):BigInt(39081),w=l?a**BigInt(254):a**BigInt(447),v=l?BigInt(8)*a**BigInt(251)-o:BigInt(4)*a**BigInt(445)-o,E=w+v+o,B=e=>(0,i.mod)(e,r),_=S(m);function S(e){return(0,n.numberToBytesLE)(B(e),g)}function A(e,t){const i=function(e,t){(0,n.aInRange)("u",e,s,r),(0,n.aInRange)("scalar",t,w,E);const i=t,a=e;let f=o,c=s,h=e,l=o,d=s;for(let e=BigInt(y-1);e>=s;e--){const t=i>>e&o;d^=t,({x_2:f,x_3:h}=x(d,f,h)),({x_2:c,x_3:l}=x(d,c,l)),d=t;const r=f+c,n=B(r*r),s=f-c,u=B(s*s),p=n-u,y=h+l,g=B((h-l)*r),m=B(y*s),w=g+m,v=g-m;h=B(w*w),l=B(a*B(v*v)),f=B(n*u),c=B(p*(n+B(b*p)))}({x_2:f,x_3:h}=x(d,f,h)),({x_2:c,x_3:l}=x(d,c,l));const p=u(c);return B(f*p)}(function(e){const t=(0,n.ensureBytes)("u coordinate",e,g);return l&&(t[31]&=127),B((0,n.bytesToNumberLE)(t))}(t),function(e){return(0,n.bytesToNumberLE)(c((0,n.ensureBytes)("scalar",e,g)))}(e));if(i===s)throw new Error("invalid private or public key received");return S(i)}function I(e){return A(e,_)}function x(e,t,r){const n=B(e*(t-r));return{x_2:t=B(t-n),x_3:r=B(r+n)}}return{scalarMult:A,scalarMultBase:I,getSharedSecret:(e,t)=>A(e,t),getPublicKey:e=>I(e),utils:{randomPrivateKey:()=>p(g)},GuBytes:_.slice()}};const n=r(6376),i=r(7342),s=BigInt(0),o=BigInt(1),a=BigInt(2)},9035:(e,t,r)=>{"use strict";var n,i=r(8558);function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(2862),a=Symbol("lastResolve"),f=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),h=Symbol("lastPromise"),l=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function y(e){var t=e[a];if(null!==t){var r=e[d].read();null!==r&&(e[h]=null,e[a]=null,e[f]=null,t(p(r,!1)))}}function g(e){i.nextTick(y,e)}var m=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((s(n={get stream(){return this[d]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(t,r){i.nextTick((function(){e[c]?r(e[c]):t(p(void 0,!0))}))}));var r,n=this[h];if(n)r=new Promise(function(e,t){return function(r,n){e.then((function(){t[u]?r(p(void 0,!0)):t[l](r,n)}),n)}}(n,this));else{var s=this[d].read();if(null!==s)return Promise.resolve(p(s,!1));r=new Promise(this[l])}return this[h]=r,r}},Symbol.asyncIterator,(function(){return this})),s(n,"return",(function(){var e=this;return new Promise((function(t,r){e[d].destroy(null,(function(e){e?r(e):t(p(void 0,!0))}))}))})),n),m);e.exports=function(e){var t,r=Object.create(b,(s(t={},d,{value:e,writable:!0}),s(t,a,{value:null,writable:!0}),s(t,f,{value:null,writable:!0}),s(t,c,{value:null,writable:!0}),s(t,u,{value:e._readableState.endEmitted,writable:!0}),s(t,l,{value:function(e,t){var n=r[d].read();n?(r[h]=null,r[a]=null,r[f]=null,e(p(n,!1))):(r[a]=e,r[f]=t)},writable:!0}),t));return r[h]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[f];return null!==t&&(r[h]=null,r[a]=null,r[f]=null,t(e)),void(r[c]=e)}var n=r[a];null!==n&&(r[h]=null,r[a]=null,r[f]=null,n(p(void 0,!0))),r[u]=!0})),e.on("readable",g.bind(null,r)),r}},9055:(e,t,r)=>{"use strict";const n=r(896),i=r(5775),s=r(8590),o=r(6899),{MT:a,SYMS:f}=r(790);class c extends n.Transform{constructor(e={}){const{separator:t="\n",stream_errors:r=!1,tags:n,max_depth:s,preferWeb:o,encoding:a,...f}=e;super({...f,readableObjectMode:!1,writableObjectMode:!1}),this.float_bytes=-1,this.separator=t,this.stream_errors=r,this.parser=new i({tags:n,max_depth:s,preferWeb:o,encoding:a}),this.parser.on("more-bytes",this._on_more.bind(this)),this.parser.on("value",this._on_value.bind(this)),this.parser.on("start",this._on_start.bind(this)),this.parser.on("stop",this._on_stop.bind(this)),this.parser.on("data",this._on_data.bind(this)),this.parser.on("error",this._on_error.bind(this))}_transform(e,t,r){this.parser.write(e,t,r)}_flush(e){this.parser._flush((t=>this.stream_errors?(t&&this._on_error(t),e()):e(t)))}static diagnose(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=function(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}(t,r));const{encoding:n="hex",...i}=t,a=new o,f=new c(i);let u=null;return"function"==typeof r?(f.on("end",(()=>r(null,a.toString("utf8")))),f.on("error",r)):u=new Promise(((e,t)=>{f.on("end",(()=>e(a.toString("utf8")))),f.on("error",t)})),f.pipe(a),s.guessEncoding(e,n).pipe(f),u}_on_error(e){this.stream_errors?this.push(e.toString()):this.emit("error",e)}_on_more(e,t,r,n){e===a.SIMPLE_FLOAT&&(this.float_bytes={2:1,4:2,8:3}[t])}_fore(e,t){switch(e){case a.BYTE_STRING:case a.UTF8_STRING:case a.ARRAY:t>0&&this.push(", ");break;case a.MAP:t>0&&(t%2?this.push(": "):this.push(", "))}}_on_value(e,t,r){if(e===f.BREAK)return;this._fore(t,r);const n=this.float_bytes;this.float_bytes=-1,this.push(s.cborValueToString(e,n))}_on_start(e,t,r,n){switch(this._fore(r,n),e){case a.TAG:this.push(`${t}(`);break;case a.ARRAY:this.push("[");break;case a.MAP:this.push("{");break;case a.BYTE_STRING:case a.UTF8_STRING:this.push("(")}t===f.STREAM&&this.push("_ ")}_on_stop(e){switch(e){case a.TAG:this.push(")");break;case a.ARRAY:this.push("]");break;case a.MAP:this.push("}");break;case a.BYTE_STRING:case a.UTF8_STRING:this.push(")")}}_on_data(){this.push(this.separator)}}e.exports=c},9109:(e,t,r)=>{"use strict";const{MT:n,SIMPLE:i,SYMS:s}=r(790);class o{constructor(e){if("number"!=typeof e)throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(0|e)!==e)throw new Error(`value must be a small positive integer: ${e}`);this.value=e}toString(){return`simple(${this.value})`}[Symbol.for("nodejs.util.inspect.custom")](e,t){return`simple(${this.value})`}encodeCBOR(e){return e._pushInt(this.value,n.SIMPLE_FLOAT)}static isSimple(e){return e instanceof o}static decode(e,t=!0,r=!1){switch(e){case i.FALSE:return!1;case i.TRUE:return!0;case i.NULL:return t?null:s.NULL;case i.UNDEFINED:if(t)return;return s.UNDEFINED;case-1:if(!t||!r)throw new Error("Invalid BREAK");return s.BREAK;default:return new o(e)}}}e.exports=o},9366:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7999),i=e=>{return t=(0,n.hash)("sha256",(0,n.fromHex)(e.replaceAll(" ",""))).toString("hex"),t.match(/.{1,4}/g)?.map((e=>parseInt(e,16).toString(2).padStart(16,"0")))||[];var t},s=(e,t)=>{const r=[];for(let n=0;n<16;n++){let i="";for(let r=0;r<16;r++){let s=0;for(let t=n-1;t<n+2;t++)for(let i=r-1;i<r+2;i++)t>-1&&t<16&&i>-1&&i<16&&(t==n&&i==r||"1"!=e[t][i]||s++);let o=!1;(3==s||2==s&&"1"==e[n][r])&&(o=!0),i+=o?"1":"O",t&&o&&t[n][r]++}r.push(i)}return r},o=(e,t=1)=>"hsl("+(240*(1-e)+t)+", 100%, 50%)",a=(e,t=2,r)=>{let n=1e3,i=0;const s=JSON.parse(JSON.stringify(e));for(let e=0;e<8;e++)for(let t=0;t<8;t++){s[e][t]=s[15-e][t]=s[e][15-t]=s[15-e][15-t]=s[e][t]+s[15-e][t]+s[e][15-t]+s[15-e][15-t];const r=s[e][t];r<n&&(n=r),r>i&&(i=r)}for(let e=0;e<16;e++)for(let a=0;a<16;a++){r.fillStyle=o(Math.floor((s[e][a]-n)*t/i)/t,i*i);let f=0+10*a,c=0+10*e;r.fillRect(f,c,10,10)}};t.default={renderFingerprint:(e,t,r=32)=>{let n=i(e.replaceAll(" ","")),o=n?.map((e=>e.split("").map((e=>parseInt(e)))));const f=t.getContext("2d");if(f&&o){for(let e=0;e<r;e++)n=s(n,o);return a(o,3,f),t}},animateFingerprint:async(e,t,r=32,n=500)=>{let o=i(e.replaceAll(" ","")),f=o?.map((e=>e.split("").map((e=>parseInt(e)))));const c=t.getContext("2d");if(c&&f){for(let e=0;e<r;e++)o=s(o,f),a(f,3,c),await new Promise((e=>setTimeout(e,n)));return a(f,3,c),t}}}},9481:(e,t,r)=>{e.exports=r(9784).EventEmitter},9517:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crypto=void 0,t.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},9648:(e,t,r)=>{"use strict";e.exports=i;var n=r(4914);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(6192)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},9784:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,s),n(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}y(e,t,s,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,i)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function f(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,s,o,c;if(a(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=f(e))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=u.bind(n);return i.listener=r,n.wrapFn=i,i}function l(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(s){n.once&&e.removeEventListener(t,i),r(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return f(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var c=f.length,u=p(f,c);for(r=0;r<c;++r)n(u[r],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,s,o;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return l(this,e,!0)},s.prototype.rawListeners=function(e){return l(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9865:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}var f=r(4686).Buffer,c=r(1220).inspect,u=c&&c.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return f.alloc(0);for(var t,r,n,i=f.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,r=i,n=o,f.prototype.copy.call(t,r,n),o+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?n+=i:n+=i.slice(0,e),0===(e-=s)){s===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=f.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0===(e-=s)){s===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(s));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return c(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9995:(e,t,r)=>{"use strict";const n=r(896),i=r(8590),s=r(5775),o=r(6899),{MT:a,NUMBYTES:f,SYMS:c}=r(790),{Buffer:u}=r(4686);function h(e){return e>1?"s":""}class l extends n.Transform{constructor(e={}){const{depth:t=1,max_depth:r=10,no_summary:n=!1,tags:i={},preferWeb:a,encoding:f,...c}=e;super({...c,readableObjectMode:!1,writableObjectMode:!1}),this.depth=t,this.max_depth=r,this.all=new o,i[24]||(i[24]=this._tag_24.bind(this)),this.parser=new s({tags:i,max_depth:r,preferWeb:a,encoding:f}),this.parser.on("value",this._on_value.bind(this)),this.parser.on("start",this._on_start.bind(this)),this.parser.on("start-string",this._on_start_string.bind(this)),this.parser.on("stop",this._on_stop.bind(this)),this.parser.on("more-bytes",this._on_more.bind(this)),this.parser.on("error",this._on_error.bind(this)),n||this.parser.on("data",this._on_data.bind(this)),this.parser.bs.on("read",this._on_read.bind(this))}_tag_24(e){const t=new l({depth:this.depth+1,no_summary:!0});t.on("data",(e=>this.push(e))),t.on("error",(e=>this.emit("error",e))),t.end(e)}_transform(e,t,r){this.parser.write(e,t,r)}_flush(e){return this.parser._flush(e)}static comment(e,t={},r=null){if(null==e)throw new Error("input required");({options:t,cb:r}=function(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"number":return{options:{max_depth:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}(t,r));const n=new o,{encoding:s="hex",...a}=t,f=new l(a);let c=null;return"function"==typeof r?(f.on("end",(()=>{r(null,n.toString("utf8"))})),f.on("error",r)):c=new Promise(((e,t)=>{f.on("end",(()=>{e(n.toString("utf8"))})),f.on("error",t)})),f.pipe(n),i.guessEncoding(e,s).pipe(f),c}_on_error(e){this.push("ERROR: "),this.push(e.toString()),this.push("\n")}_on_read(e){this.all.write(e);const t=e.toString("hex");this.push(new Array(this.depth+1).join("  ")),this.push(t);let r=2*(this.max_depth-this.depth)-t.length;r<1&&(r=1),this.push(new Array(r+1).join(" ")),this.push("-- ")}_on_more(e,t,r,n){let i="";switch(this.depth++,e){case a.POS_INT:i="Positive number,";break;case a.NEG_INT:i="Negative number,";break;case a.ARRAY:i="Array, length";break;case a.MAP:i="Map, count";break;case a.BYTE_STRING:i="Bytes, length";break;case a.UTF8_STRING:i="String, length";break;case a.SIMPLE_FLOAT:i=1===t?"Simple value,":"Float,"}this.push(`${i} next ${t} byte${h(t)}\n`)}_on_start_string(e,t,r,n){let i="";switch(this.depth++,e){case a.BYTE_STRING:i=`Bytes, length: ${t}`;break;case a.UTF8_STRING:i=`String, length: ${t.toString()}`}this.push(`${i}\n`)}_on_start(e,t,r,n){switch(this.depth++,r){case a.ARRAY:this.push(`[${n}], `);break;case a.MAP:n%2?this.push(`{Val:${Math.floor(n/2)}}, `):this.push(`{Key:${Math.floor(n/2)}}, `)}switch(e){case a.TAG:this.push(`Tag #${t}`),24===t&&this.push(" Encoded CBOR data item");break;case a.ARRAY:t===c.STREAM?this.push("Array (streaming)"):this.push(`Array, ${t} item${h(t)}`);break;case a.MAP:t===c.STREAM?this.push("Map (streaming)"):this.push(`Map, ${t} pair${h(t)}`);break;case a.BYTE_STRING:this.push("Bytes (streaming)");break;case a.UTF8_STRING:this.push("String (streaming)")}this.push("\n")}_on_stop(e){this.depth--}_on_value(e,t,r,n){if(e!==c.BREAK)switch(t){case a.ARRAY:this.push(`[${r}], `);break;case a.MAP:r%2?this.push(`{Val:${Math.floor(r/2)}}, `):this.push(`{Key:${Math.floor(r/2)}}, `)}const s=i.cborValueToString(e,-1/0);switch("string"==typeof e||u.isBuffer(e)?(e.length>0&&(this.push(s),this.push("\n")),this.depth--):(this.push(s),this.push("\n")),n){case f.ONE:case f.TWO:case f.FOUR:case f.EIGHT:this.depth--}}_on_data(){this.push("0x"),this.push(this.all.read().toString("hex")),this.push("\n")}}e.exports=l}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(3201)})()));
//# sourceMappingURL=vaultysid.min.js.map