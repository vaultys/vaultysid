/*! For license information please see vaultysid.min.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,()=>(()=>{var e={11:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.Hash=t.nextTick=t.swap32IfBE=t.byteSwapIfBE=t.swap8IfBE=t.isLE=void 0,t.isBytes=i,t.anumber=s,t.abytes=o,t.ahash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");s(e.outputLen),s(e.blockLen)},t.aexists=function(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},t.aoutput=function(e,t){o(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)},t.u8=function(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},t.u32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))},t.clean=function(...e){for(let t=0;t<e.length;t++)e[t].fill(0)},t.createView=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},t.rotr=function(e,t){return e<<32-t|e>>>t},t.rotl=function(e,t){return e<<t|e>>>32-t>>>0},t.byteSwap=a,t.byteSwap32=f,t.bytesToHex=function(e){if(o(e),c)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=h[e[r]];return t},t.hexToBytes=function(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(c)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=l(e.charCodeAt(i)),s=l(e.charCodeAt(i+1));if(void 0===r||void 0===s){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+s}return n},t.asyncLoop=async function(e,r,n){let i=Date.now();for(let s=0;s<e;s++){n(s);const e=Date.now()-i;e>=0&&e<r||(await(0,t.nextTick)(),i+=e)}},t.utf8ToBytes=d,t.bytesToUtf8=function(e){return(new TextDecoder).decode(e)},t.toBytes=p,t.kdfInputToBytes=function(e){return"string"==typeof e&&(e=d(e)),o(e),e},t.concatBytes=function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];o(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r},t.checkOpts=function(e,t){if(void 0!==t&&"[object Object]"!=={}.toString.call(t))throw new Error("options should be object or undefined");return Object.assign(e,t)},t.createHasher=y,t.createOptHasher=b,t.createXOFer=g,t.randomBytes=function(e=32){if(n.crypto&&"function"==typeof n.crypto.getRandomValues)return n.crypto.getRandomValues(new Uint8Array(e));if(n.crypto&&"function"==typeof n.crypto.randomBytes)return Uint8Array.from(n.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")};const n=r(9517);function i(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function s(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function o(e,...t){if(!i(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function f(e){for(let t=0;t<e.length;t++)e[t]=a(e[t]);return e}t.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],t.swap8IfBE=t.isLE?e=>e:e=>a(e),t.byteSwapIfBE=t.swap8IfBE,t.swap32IfBE=t.isLE?e=>e:f;const c=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),h=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),u={_0:48,_9:57,A:65,F:70,a:97,f:102};function l(e){return e>=u._0&&e<=u._9?e-u._0:e>=u.A&&e<=u.F?e-(u.A-10):e>=u.a&&e<=u.f?e-(u.a-10):void 0}function d(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function p(e){return"string"==typeof e&&(e=d(e)),o(e),e}function y(e){const t=t=>e().update(p(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function b(e){const t=(t,r)=>e(r).update(p(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}function g(e){const t=(t,r)=>e(r).update(p(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}t.nextTick=async()=>{},t.Hash=class{},t.wrapConstructor=y,t.wrapConstructorWithOpts=b,t.wrapXOFConstructorWithOpts=g},67:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PrivateKey=t.PublicKey=t.Bip32PublicKey=t.Bip32PrivateKey=void 0;var i=r(2791);Object.defineProperty(t,"Bip32PrivateKey",{enumerable:!0,get:function(){return n(i).default}});var s=r(5781);Object.defineProperty(t,"Bip32PublicKey",{enumerable:!0,get:function(){return n(s).default}});var o=r(7751);Object.defineProperty(t,"PublicKey",{enumerable:!0,get:function(){return n(o).default}});var a=r(9925);Object.defineProperty(t,"PrivateKey",{enumerable:!0,get:function(){return n(a).default}})},110:(e,t,r)=>{"use strict";var n,i=r(8704).F,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function f(e){e()}function c(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var h,u=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var l=t.map(function(e,i){var s=i<t.length-1;return function(e,t,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;e.on("close",function(){a=!0}),void 0===n&&(n=r(2862)),n(e,{readable:t,writable:i},function(e){if(e)return s(e);a=!0,s()});var f=!1;return function(t){if(!a&&!f)return f=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void s(t||new o("pipe"))}}(e,s,i>0,function(e){h||(h=e),e&&l.forEach(f),s||(l.forEach(f),u(h))})});return t.reduce(c)}},134:(e,t,r)=>{"use strict";const n=r(1691),i=r(1362).utils,s=i.assert,o=i.cachedProperty,a=i.parseBytes;function f(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),n.isBN(t.S)&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}o(f,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),o(f,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),o(f,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),o(f,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),f.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},f.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},e.exports=f},148:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encryptInfo=void 0,t.encryptInfo={ALG:"PBKDF2",ITERATIONS:2e7,DERIVED_KEY_TYPE:"AES-GCM",DERIVED_KEY_LENGTH:256,HASH:"SHA-256"}},201:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){}static createFromEntropy(e,t){throw new Error("Method must be implemented by concrete class")}static generate(){throw new Error("Method must be implemented by concrete class")}static fromSecret(e){throw new Error("Method must be implemented by concrete class")}static instantiate(e){throw new Error("Method must be implemented by concrete class")}static fromId(e){throw new Error("Method must be implemented by concrete class")}async sign(e){return"public"==this.capability?null:(await this.getSigner()).sign(e)}static async diffieHellman(e,t){return await e.performDiffieHellman(t)}static encrypt(e,t){throw new Error("Method must be implemented by concrete class")}}},212:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=r(4686),o=n(r(4406)),a=r(2655),f=r(6761),c=n(r(7264));class h extends c.default{constructor(){super(),this.authType="DilithiumVerificationKey2025"}static async createFromEntropy(e){const t=new h;var r;t.entropy=e,t.capability="private",t.seed=(r=e,(0,i.hash)("sha512",r)),t.signer=(0,f.generateDilithiumKeyPair)(t.seed.slice(0,32));const n=o.default.box.keyPair.fromSecretKey(t.seed.slice(32,64));return t.cypher={publicKey:s.Buffer.from(n.publicKey),secretKey:s.Buffer.from(n.secretKey)},t}static generate(){return h.createFromEntropy((0,i.randomBytes)(32))}getSecret(){return s.Buffer.from((0,a.encode)({v:this.version,s:this.seed}))}get id(){return s.Buffer.from((0,a.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,a.decode)(e),r=new h;r.version=t.v??0,r.capability="private",r.seed=s.Buffer.from(t.s),r.signer=(0,f.generateDilithiumKeyPair)(r.seed.slice(0,32));const n=r.seed.slice(32,64),i=o.default.box.keyPair.fromSecretKey(n);return r.cypher={publicKey:s.Buffer.from(i.publicKey),secretKey:s.Buffer.from(i.secretKey)},r}static instantiate(e){const t=new h;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?s.Buffer.from(e.signer.publicKey.data):s.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?s.Buffer.from(e.cypher.publicKey.data):s.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,a.decode)(e),r=new h;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}getSigner(){return this.signer.secretKey,Promise.resolve({sign:e=>Promise.resolve((0,f.signDilithium)(e,this.signer.secretKey))})}verify(e,t,r){return(0,f.verifyDilithium)(e,t,this.signer.publicKey)}}t.default=h},262:(e,t,r)=>{"use strict";var n=r(900),i=r(7984),s=n.rotl32,o=n.sum32,a=n.sum32_3,f=n.sum32_4,c=i.BlockHash;function h(){if(!(this instanceof h))return new h;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function u(e,t,r,n){return e<=15?t^r^n:e<=31?t&r|~t&n:e<=47?(t|~r)^n:e<=63?t&n|r&~n:t^(r|~n)}function l(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function d(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}n.inherits(h,c),t.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(e,t){for(var r=this.h[0],n=this.h[1],i=this.h[2],c=this.h[3],h=this.h[4],m=r,w=n,v=i,_=c,E=h,S=0;S<80;S++){var B=o(s(f(r,u(S,n,i,c),e[p[S]+t],l(S)),b[S]),h);r=h,h=c,c=s(i,10),i=n,n=B,B=o(s(f(m,u(79-S,w,v,_),e[y[S]+t],d(S)),g[S]),E),m=E,E=_,_=s(v,10),v=w,w=B}B=a(this.h[1],i,_),this.h[1]=a(this.h[2],c,E),this.h[2]=a(this.h[3],h,m),this.h[3]=a(this.h[4],r,w),this.h[4]=a(this.h[0],n,v),this.h[0]=B},h.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],y=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},293:(e,t,r)=>{var n,i,s=r(6671).Buffer,o=r(8039),a=r(6552),f=r(4047),c=r(4427),h=r.g.crypto&&r.g.crypto.subtle,u={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},l=[];function d(){return i||(i=r.g.process&&r.g.process.nextTick?r.g.process.nextTick:r.g.queueMicrotask?r.g.queueMicrotask:r.g.setImmediate?r.g.setImmediate:r.g.setTimeout)}function p(e,t,r,n,i){return h.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then(function(e){return h.deriveBits({name:"PBKDF2",salt:t,iterations:r,hash:{name:i}},e,n<<3)}).then(function(e){return s.from(e)})}e.exports=function(e,t,i,y,b,g){"function"==typeof b&&(g=b,b=void 0);var m=u[(b=b||"sha1").toLowerCase()];if(m&&"function"==typeof r.g.Promise){if(o(i,y),e=c(e,a,"Password"),t=c(t,a,"Salt"),"function"!=typeof g)throw new Error("No callback provided to pbkdf2");!function(e,t){e.then(function(e){d()(function(){t(null,e)})},function(e){d()(function(){t(e)})})}(function(e){if(r.g.process&&!r.g.process.browser)return Promise.resolve(!1);if(!h||!h.importKey||!h.deriveBits)return Promise.resolve(!1);if(void 0!==l[e])return l[e];var t=p(n=n||s.alloc(8),n,10,128,e).then(function(){return!0}).catch(function(){return!1});return l[e]=t,t}(m).then(function(r){return r?p(e,t,i,y,m):f(e,t,i,y,b)}),g)}else d()(function(){var r;try{r=f(e,t,i,y,b)}catch(e){return g(e)}g(null,r)})}},347:(e,t,r)=>{var n=r(4686).Buffer,i=r(8558),s=r(5727),o=r(6141),a=r(6192),f=r(4635),c=n.from&&n.from!==Uint8Array.from?n.from([0]):new n([0]),h=function(e,t){e._corked?e.once("uncork",t):t()},u=function(e,t){return function(r){r?function(e,t){e._autoDestroy&&e.destroy(t)}(e,"premature close"===r.message?null:r):t&&!e._ended&&e.end()}},l=function(){},d=function(e,t,r){if(!(this instanceof d))return new d(e,t,r);s.Duplex.call(this,r),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!r||!1!==r.autoDestroy,this._forwardDestroy=!r||!1!==r.destroy,this._forwardEnd=!r||!1!==r.end,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,e&&this.setWritable(e),t&&this.setReadable(t)};a(d,s.Duplex),d.obj=function(e,t,r){return r||(r={}),r.objectMode=!0,r.highWaterMark=16,new d(e,t,r)},d.prototype.cork=function(){1===++this._corked&&this.emit("cork")},d.prototype.uncork=function(){this._corked&&0===--this._corked&&this.emit("uncork")},d.prototype.setWritable=function(e){if(this._unwrite&&this._unwrite(),this.destroyed)e&&e.destroy&&e.destroy();else if(null!==e&&!1!==e){var t=this,r=o(e,{writable:!0,readable:!1},u(this,this._forwardEnd)),n=function(){var e=t._ondrain;t._ondrain=null,e&&e()};this._unwrite&&i.nextTick(n),this._writable=e,this._writable.on("drain",n),this._unwrite=function(){t._writable.removeListener("drain",n),r()},this.uncork()}else this.end()},d.prototype.setReadable=function(e){if(this._unread&&this._unread(),this.destroyed)e&&e.destroy&&e.destroy();else{if(null===e||!1===e)return this.push(null),void this.resume();var t,r=this,n=o(e,{writable:!1,readable:!0},u(this)),i=function(){r._forward()},a=function(){r.push(null)};this._drained=!0,this._readable=e,this._readable2=e._readableState?e:(t=e,new s.Readable({objectMode:!0,highWaterMark:16}).wrap(t)),this._readable2.on("readable",i),this._readable2.on("end",a),this._unread=function(){r._readable2.removeListener("readable",i),r._readable2.removeListener("end",a),n()},this._forward()}},d.prototype._read=function(){this._drained=!0,this._forward()},d.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var e;for(this._forwarding=!0;this._drained&&null!==(e=f(this._readable2));)this.destroyed||(this._drained=this.push(e));this._forwarding=!1}},d.prototype.destroy=function(e,t){if(t||(t=l),this.destroyed)return t(null);this.destroyed=!0;var r=this;i.nextTick(function(){r._destroy(e),t(null)})},d.prototype._destroy=function(e){if(e){var t=this._ondrain;this._ondrain=null,t?t(e):this.emit("error",e)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},d.prototype._write=function(e,t,r){if(!this.destroyed)return this._corked?h(this,this._write.bind(this,e,t,r)):e===c?this._finish(r):this._writable?void(!1===this._writable.write(e)?this._ondrain=r:this.destroyed||r()):r()},d.prototype._finish=function(e){var t=this;this.emit("preend"),h(this,function(){var r,n;n=function(){!1===t._writableState.prefinished&&(t._writableState.prefinished=!0),t.emit("prefinish"),h(t,e)},(r=t._forwardEnd&&t._writable)?r._writableState&&r._writableState.finished?n():r._writableState?r.end(n):(r.end(),n()):n()})},d.prototype.end=function(e,t,r){return"function"==typeof e?this.end(null,null,e):"function"==typeof t?this.end(e,null,t):(this._ended=!0,e&&this.write(e),this._writableState.ending||this._writableState.destroyed||this.write(c),s.Writable.prototype.end.call(this,r))},e.exports=d},360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XOF256=t.XOF128=t.genCrystals=void 0;const n=r(5391),i=r(6215);function s(e,t=8){const r=e.toString(2).padStart(8,"0").slice(-t).padStart(7,"0").split("").reverse().join("");return Number.parseInt(r,2)}t.genCrystals=e=>{const{newPoly:t,N:r,Q:n,F:o,ROOT_OF_UNITY:a,brvBits:f,isKyber:c}=e,h=(e,t=n)=>{const r=e%t|0;return 0|(r>=0?r:t+r)},u=function(){const e=t(r);for(let t=0;t<r;t++){const r=s(t,f),i=BigInt(a)**BigInt(r)%BigInt(n);e[t]=0|Number(i)}return e}(),l=c?128:r,d=c?1:0,p={encode:e=>{for(let t=1,n=128;n>d;n>>=1)for(let i=0;i<r;i+=2*n){const r=u[t++];for(let t=i;t<i+n;t++){const i=h(r*e[t+n]);e[t+n]=0|h(e[t]-i),e[t]=0|h(e[t]+i)}}return e},decode:e=>{for(let t=l-1,n=1+d;n<l+d;n<<=1)for(let i=0;i<r;i+=2*n){const r=u[t--];for(let t=i;t<i+n;t++){const i=e[t];e[t]=h(i+e[t+n]),e[t+n]=h(r*(e[t+n]-i))}}for(let t=0;t<e.length;t++)e[t]=h(o*e[t]);return e}};return{mod:h,smod:(e,t=n)=>{const r=0|h(e,t);return 0|(r>t>>1?r-t:r)},nttZetas:u,NTT:p,bitsCoder:(e,n)=>{const s=(0,i.getMask)(e),o=e*(r/8);return{bytesLen:o,encode:t=>{const r=new Uint8Array(o);for(let o=0,a=0,f=0,c=0;o<t.length;o++)for(a|=(n.encode(t[o])&s)<<f,f+=e;f>=8;f-=8,a>>=8)r[c++]=a&(0,i.getMask)(f);return r},decode:i=>{const o=t(r);for(let t=0,r=0,a=0,f=0;t<i.length;t++)for(r|=i[t]<<a,a+=8;a>=e;a-=e,r>>=e)o[f++]=n.decode(r&s);return o}}}}};const o=e=>(t,r)=>{r||(r=e.blockLen);const n=new Uint8Array(t.length+2);n.set(t);const i=t.length,s=new Uint8Array(r);let o=e.create({}),a=0,f=0;return{stats:()=>({calls:a,xofs:f}),get:(t,r)=>(n[i+0]=t,n[i+1]=r,o.destroy(),o=e.create({}).update(n),a++,()=>(f++,o.xofInto(s))),clean:()=>{o.destroy(),s.fill(0),n.fill(0)}}};t.XOF128=o(n.shake128),t.XOF256=o(n.shake256)},407:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.negateCt=a,t.normalizeZ=function(e,t,r){const n="pz"===t?e=>e.pz:e=>e.ez,s=(0,i.FpInvertBatch)(e.Fp,r.map(n));return r.map((e,t)=>e.toAffine(s[t])).map(e.fromAffine)},t.wNAF=function(e,t){return{constTimeNegate:a,hasPrecomputes:e=>1!==y(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>s;)r&o&&(n=n.add(i)),i=i.double(),r>>=o;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=c(r,t),s=[];let o=e,a=o;for(let e=0;e<n;e++){a=o,s.push(a);for(let e=1;e<i;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(r,n,i){let s=e.ZERO,o=e.BASE;const f=c(r,t);for(let e=0;e<f.windows;e++){const{nextN:t,offset:r,isZero:c,isNeg:u,isNegF:l,offsetF:d}=h(i,e,f);i=t,c?o=o.add(a(l,n[d])):s=s.add(a(u,n[r]))}return b(i),{p:s,f:o}},wNAFUnsafe(r,n,i,o=e.ZERO){const a=c(r,t);for(let e=0;e<a.windows&&i!==s;e++){const{nextN:t,offset:r,isZero:s,isNeg:f}=h(i,e,a);if(i=t,!s){const e=n[r];o=o.add(f?e.negate():e)}}return b(i),o},getPrecomputes(e,t,r){let n=d.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),d.set(t,n))),n},wNAFCached(e,t,r){const n=y(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=y(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){f(r,t),p.set(e,r),d.delete(e)}}},t.mulEndoUnsafe=function(e,t,r,n){let i=t,a=e.ZERO,f=e.ZERO;for(;r>s||n>s;)r&o&&(a=a.add(i)),n&o&&(f=f.add(i)),i=i.double(),r>>=o,n>>=o;return{p1:a,p2:f}},t.pippenger=function(e,t,r,i){u(r,e),l(i,t);const s=r.length,o=i.length;if(s!==o)throw new Error("arrays of points and scalars must have equal length");const a=e.ZERO,f=(0,n.bitLen)(BigInt(s));let c=1;f>12?c=f-3:f>4?c=f-2:f>0&&(c=2);const h=(0,n.bitMask)(c),d=new Array(Number(h)+1).fill(a);let p=a;for(let e=Math.floor((t.BITS-1)/c)*c;e>=0;e-=c){d.fill(a);for(let t=0;t<o;t++){const n=i[t],s=Number(n>>BigInt(e)&h);d[s]=d[s].add(r[t])}let t=a;for(let e=d.length-1,r=a;e>0;e--)r=r.add(d[e]),t=t.add(r);if(p=p.add(t),0!==e)for(let e=0;e<c;e++)p=p.double()}return p},t.precomputeMSMUnsafe=function(e,t,r,i){f(i,t.BITS),u(r,e);const s=e.ZERO,o=2**i-1,a=Math.ceil(t.BITS/i),c=(0,n.bitMask)(i),h=r.map(e=>{const t=[];for(let r=0,n=e;r<o;r++)t.push(n),n=n.add(e);return t});return e=>{if(l(e,t),e.length>r.length)throw new Error("array of scalars must be smaller than array of points");let n=s;for(let t=0;t<a;t++){if(n!==s)for(let e=0;e<i;e++)n=n.double();const r=BigInt(a*i-(t+1)*i);for(let t=0;t<e.length;t++){const i=e[t],s=Number(i>>r&c);s&&(n=n.add(h[t][s-1]))}}return n}},t.validateBasic=function(e){return(0,i.validateField)(e.Fp),(0,n.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,i.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})},t._createCurveFields=function(e,t,r={}){if(!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const r=t[e];if(!("bigint"==typeof r&&r>s))throw new Error(`CURVE.${e} must be positive bigint`)}const n=g(t.p,r.Fp),i=g(t.n,r.Fn),o=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const e of o)if(!n.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}};const n=r(6376),i=r(7342),s=BigInt(0),o=BigInt(1);function a(e,t){const r=t.negate();return e?r:t}function f(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function c(e,t){f(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:(0,n.bitMask)(e),maxNumber:r,shiftBy:BigInt(e)}}function h(e,t,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:a}=r;let f=Number(e&i),c=e>>a;f>n&&(f-=s,c+=o);const h=t*n;return{nextN:c,offset:h+Math.abs(f)-1,isZero:0===f,isNeg:f<0,isNegF:t%2!=0,offsetF:h}}function u(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})}function l(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}const d=new WeakMap,p=new WeakMap;function y(e){return p.get(e)||1}function b(e){if(e!==s)throw new Error("invalid wNAF")}function g(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,i.validateField)(t),t}return(0,i.Field)(e)}},568:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.isBufferOrUint8Array=function(e){return e instanceof n||e instanceof Uint8Array},t.chunkBuffer=function(e,t){if(void 0===e)return e;let r=e instanceof n?e:n.from(e);const i=[];for(;r.length>t;){const e=r.slice(0,t);r=r.slice(t),i.push(e)}return r.length&&i.push(r),i},t.chunkString=function(e,t){const r=[];for(;e.length>t;){const n=e.substr(0,t);e=e.substr(t),r.push(n)}return e.length&&r.push(e),r}},613:(e,t,r)=>{"use strict";var n=t;n.base=r(6160),n.short=r(7695),n.mont=r(5567),n.edwards=r(9861)},664:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7261),i=e=>{return t=(0,n.hash)("sha256",(0,n.fromHex)(e.replaceAll(" ",""))).toString("hex"),t.match(/.{1,4}/g)?.map(e=>parseInt(e,16).toString(2).padStart(16,"0"))||[];var t},s=(e,t)=>{const r=[];for(let n=0;n<16;n++){let i="";for(let r=0;r<16;r++){let s=0;for(let t=n-1;t<n+2;t++)for(let i=r-1;i<r+2;i++)t>-1&&t<16&&i>-1&&i<16&&(t==n&&i==r||"1"!=e[t][i]||s++);let o=!1;(3==s||2==s&&"1"==e[n][r])&&(o=!0),i+=o?"1":"O",t&&o&&t[n][r]++}r.push(i)}return r},o=(e,t=1)=>"hsl("+(240*(1-e)+t)+", 100%, 50%)",a=(e,t=2,r)=>{let n=1e3,i=0;const s=JSON.parse(JSON.stringify(e));for(let e=0;e<8;e++)for(let t=0;t<8;t++){s[e][t]=s[15-e][t]=s[e][15-t]=s[15-e][15-t]=s[e][t]+s[15-e][t]+s[e][15-t]+s[15-e][15-t];const r=s[e][t];r<n&&(n=r),r>i&&(i=r)}for(let e=0;e<16;e++)for(let a=0;a<16;a++){r.fillStyle=o(Math.floor((s[e][a]-n)*t/i)/t,i*i);let f=0+10*a,c=0+10*e;r.fillRect(f,c,10,10)}};t.default={renderFingerprint:(e,t,r=32)=>{let n=i(e.replaceAll(" ","")),o=n?.map(e=>e.split("").map(e=>parseInt(e)));const f=t.getContext("2d");if(f&&o){for(let e=0;e<r;e++)n=s(n,o);return a(o,3,f),t}},animateFingerprint:async(e,t,r=32,n=500)=>{let o=i(e.replaceAll(" ","")),f=o?.map(e=>e.split("").map(e=>parseInt(e)));const c=t.getContext("2d");if(c&&f){for(let e=0;e<r;e++)o=s(o,f),a(f,3,c),await new Promise(e=>setTimeout(e,n));return a(f,3,c),t}}}},756:(e,t,r)=>{"use strict";var n=r(5402),i=r(5138),s=r(8637);function o(e){if(!(this instanceof o))return new o(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=i.toArray(e.entropy,e.entropyEnc||"hex"),r=i.toArray(e.nonce,e.nonceEnc||"hex"),n=i.toArray(e.pers,e.persEnc||"hex");s(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,n)}e.exports=o,o.prototype._init=function(e,t,r){var n=e.concat(t).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},o.prototype._hmac=function(){return new n.hmac(this.hash,this.K)},o.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},o.prototype.reseed=function(e,t,r,n){"string"!=typeof t&&(n=r,r=t,t=null),e=i.toArray(e,t),r=i.toArray(r,n),s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},o.prototype.generate=function(e,t,r,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(n=r,r=t,t=null),r&&(r=i.toArray(r,n||"hex"),this._update(r));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(r),this._reseed++,i.encode(o,t)}},790:(e,t)=>{"use strict";t.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},t.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36,SET:258},t.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},t.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},t.SYMS={NULL:Symbol.for("github.com/hildjj/node-cbor/null"),UNDEFINED:Symbol.for("github.com/hildjj/node-cbor/undef"),PARENT:Symbol.for("github.com/hildjj/node-cbor/parent"),BREAK:Symbol.for("github.com/hildjj/node-cbor/break"),STREAM:Symbol.for("github.com/hildjj/node-cbor/stream")},t.SHIFT32=4294967296,t.BI={MINUS_ONE:BigInt(-1),NEG_MAX:BigInt(-1)-BigInt(Number.MAX_SAFE_INTEGER),MAXINT32:BigInt("0xffffffff"),MAXINT64:BigInt("0xffffffffffffffff"),SHIFT32:BigInt(t.SHIFT32)}},896:(e,t,r)=>{e.exports=i;var n=r(9784).EventEmitter;function i(){n.call(this)}r(6192)(i,n),i.Readable=r(4324),i.Writable=r(6868),i.Duplex=r(5606),i.Transform=r(4914),i.PassThrough=r(9648),i.finished=r(2862),i.pipeline=r(110),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",s),e._isStdio||t&&!1===t.end||(r.on("end",a),r.on("close",f));var o=!1;function a(){o||(o=!0,e.end())}function f(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(h(),0===n.listenerCount(this,"error"))throw e}function h(){r.removeListener("data",i),e.removeListener("drain",s),r.removeListener("end",a),r.removeListener("close",f),r.removeListener("error",c),e.removeListener("error",c),r.removeListener("end",h),r.removeListener("close",h),e.removeListener("close",h)}return r.on("error",c),e.on("error",c),r.on("end",h),r.on("close",h),e.on("close",h),e.emit("pipe",r),e}},900:(e,t,r)=>{"use strict";var n=r(8637),i=r(6192);function s(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function o(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function f(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=i,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var n=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=63&o|128):s(e,i)?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++i)),r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=63&o|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=63&o|128)}else for(i=0;i<e.length;i++)r[i]=0|e[i];return r},t.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=a(e[r].toString(16));return t},t.htonl=o,t.toHex32=function(e,t){for(var r="",n=0;n<e.length;n++){var i=e[n];"little"===t&&(i=o(i)),r+=f(i.toString(16))}return r},t.zero2=a,t.zero8=f,t.join32=function(e,t,r,i){var s=r-t;n(s%4==0);for(var o=new Array(s/4),a=0,f=t;a<o.length;a++,f+=4){var c;c="big"===i?e[f]<<24|e[f+1]<<16|e[f+2]<<8|e[f+3]:e[f+3]<<24|e[f+2]<<16|e[f+1]<<8|e[f],o[a]=c>>>0}return o},t.split32=function(e,t){for(var r=new Array(4*e.length),n=0,i=0;n<e.length;n++,i+=4){var s=e[n];"big"===t?(r[i]=s>>>24,r[i+1]=s>>>16&255,r[i+2]=s>>>8&255,r[i+3]=255&s):(r[i+3]=s>>>24,r[i+2]=s>>>16&255,r[i+1]=s>>>8&255,r[i]=255&s)}return r},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,r){return e+t+r>>>0},t.sum32_4=function(e,t,r,n){return e+t+r+n>>>0},t.sum32_5=function(e,t,r,n,i){return e+t+r+n+i>>>0},t.sum64=function(e,t,r,n){var i=e[t],s=n+e[t+1]>>>0,o=(s<n?1:0)+r+i;e[t]=o>>>0,e[t+1]=s},t.sum64_hi=function(e,t,r,n){return(t+n>>>0<t?1:0)+e+r>>>0},t.sum64_lo=function(e,t,r,n){return t+n>>>0},t.sum64_4_hi=function(e,t,r,n,i,s,o,a){var f=0,c=t;return f+=(c=c+n>>>0)<t?1:0,f+=(c=c+s>>>0)<s?1:0,e+r+i+o+(f+=(c=c+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,r,n,i,s,o,a){return t+n+s+a>>>0},t.sum64_5_hi=function(e,t,r,n,i,s,o,a,f,c){var h=0,u=t;return h+=(u=u+n>>>0)<t?1:0,h+=(u=u+s>>>0)<s?1:0,h+=(u=u+a>>>0)<a?1:0,e+r+i+o+f+(h+=(u=u+c>>>0)<c?1:0)>>>0},t.sum64_5_lo=function(e,t,r,n,i,s,o,a,f,c){return t+n+s+a+c>>>0},t.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},t.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},t.shr64_hi=function(e,t,r){return e>>>r},t.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageType=void 0;const n=r(2655),i=r(4072);var s;!function(e){e[e.ENCRYPTION=0]="ENCRYPTION",e[e.ATTACHED_SIGNING=1]="ATTACHED_SIGNING",e[e.DETACHED_SIGNING=2]="DETACHED_SIGNING",e[e.SIGNCRYPTION=3]="SIGNCRYPTION"}(s||(t.MessageType=s={})),t.default=class{static decode1(e,t=!1){const r=t?e:(0,n.decode)(e),s=i.sha512.create().update(r).digest(),o=(0,n.decode)(r);if(!(o instanceof Array)||o.length<3)throw new Error("Invalid data");const[a,f,c]=o;if("saltpack"!==a)throw new Error("Invalid data");if(!(f instanceof Array)||2!==f.length)throw new Error("Invalid data");if(2!==f[0])throw new Error("Unsupported version");if(0!==f[1])throw new Error("Unsupported version");if("number"!=typeof c)throw new Error("Invalid data");return[s,o]}}},1036:(e,t,r)=>{"use strict";var n=t,i=r(7902),s=r(8637),o=r(5138);n.assert=s,n.toArray=o.toArray,n.zero2=o.zero2,n.toHex=o.toHex,n.encode=o.encode,n.getNAF=function(e,t,r){var n,i=new Array(Math.max(e.bitLength(),r)+1);for(n=0;n<i.length;n+=1)i[n]=0;var s=1<<t+1,o=e.clone();for(n=0;n<i.length;n++){var a,f=o.andln(s-1);o.isOdd()?(a=f>(s>>1)-1?(s>>1)-f:f,o.isubn(a)):a=0,i[n]=a,o.iushrn(1)}return i},n.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n,i=0,s=0;e.cmpn(-i)>0||t.cmpn(-s)>0;){var o,a,f=e.andln(3)+i&3,c=t.andln(3)+s&3;3===f&&(f=-1),3===c&&(c=-1),o=1&f?3!=(n=e.andln(7)+i&7)&&5!==n||2!==c?f:-f:0,r[0].push(o),a=1&c?3!=(n=t.andln(7)+s&7)&&5!==n||2!==f?c:-c:0,r[1].push(a),2*i===o+1&&(i=1-i),2*s===a+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return r},n.cachedProperty=function(e,t,r){var n="_"+t;e.prototype[t]=function(){return void 0!==this[n]?this[n]:this[n]=r.call(this)}},n.parseBytes=function(e){return"string"==typeof e?n.toArray(e,"hex"):e},n.intFromLE=function(e){return new i(e,"hex","le")}},1163:(e,t,r)=>{"use strict";const n=r(790),i=r(8590),s=Symbol("INTERNAL_JSON");function o(e,t){if(i.isBufferish(e))e.toJSON=t;else if(Array.isArray(e))for(const r of e)o(r,t);else if(e&&"object"==typeof e&&(!(e instanceof p)||e.tag<21||e.tag>23))for(const r of Object.values(e))o(r,t)}function a(){return i.base64(this)}function f(){return i.base64url(this)}function c(){return this.toString("hex")}const h={0:e=>new Date(e),1:e=>new Date(1e3*e),2:e=>i.bufferToBigInt(e),3:e=>n.BI.MINUS_ONE-i.bufferToBigInt(e),21:(e,t)=>(i.isBufferish(e)?t[s]=f:o(e,f),t),22:(e,t)=>(i.isBufferish(e)?t[s]=a:o(e,a),t),23:(e,t)=>(i.isBufferish(e)?t[s]=c:o(e,c),t),32:e=>new URL(e),33:(e,t)=>{if(!e.match(/^[a-zA-Z0-9_-]+$/))throw new Error("Invalid base64url characters");const r=e.length%4;if(1===r)throw new Error("Invalid base64url length");if(2===r){if(-1==="AQgw".indexOf(e[e.length-1]))throw new Error("Invalid base64 padding")}else if(3===r&&-1==="AEIMQUYcgkosw048".indexOf(e[e.length-1]))throw new Error("Invalid base64 padding");return t},34:(e,t)=>{const r=e.match(/^[a-zA-Z0-9+/]+(?<padding>={0,2})$/);if(!r)throw new Error("Invalid base64 characters");if(e.length%4!=0)throw new Error("Invalid base64 length");if("="===r.groups.padding){if(-1==="AQgw".indexOf(e[e.length-2]))throw new Error("Invalid base64 padding")}else if("=="===r.groups.padding&&-1==="AEIMQUYcgkosw048".indexOf(e[e.length-3]))throw new Error("Invalid base64 padding");return t},35:e=>new RegExp(e),258:e=>new Set(e)},u={64:Uint8Array,65:Uint16Array,66:Uint32Array,68:Uint8ClampedArray,69:Uint16Array,70:Uint32Array,72:Int8Array,73:Int16Array,74:Int32Array,77:Int16Array,78:Int32Array,81:Float32Array,82:Float64Array,85:Float32Array,86:Float64Array};function l(e,t){if(!i.isBufferish(e))throw new TypeError("val not a buffer");const{tag:r}=t,n=u[r];if(!n)throw new Error(`Invalid typed array tag: ${r}`);const s=2**(((16&r)>>4)+(3&r));return!(4&r)!==i.isBigEndian()&&s>1&&function(e,t,r,n){const i=new DataView(e),[s,o]={2:[i.getUint16,i.setUint16],4:[i.getUint32,i.setUint32],8:[i.getBigUint64,i.setBigUint64]}[t],a=r+n;for(let e=r;e<a;e+=t)o.call(i,e,s.call(i,e,!0))}(e.buffer,s,e.byteOffset,e.byteLength),new n(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}"undefined"!=typeof BigUint64Array&&(u[67]=BigUint64Array,u[71]=BigUint64Array),"undefined"!=typeof BigInt64Array&&(u[75]=BigInt64Array,u[79]=BigInt64Array);for(const e of Object.keys(u))h[e]=l;let d={};class p{constructor(e,t,r){if(this.tag=e,this.value=t,this.err=r,"number"!=typeof this.tag)throw new Error(`Invalid tag type (${typeof this.tag})`);if(this.tag<0||(0|this.tag)!==this.tag)throw new Error(`Tag must be a positive integer: ${this.tag}`)}toJSON(){if(this[s])return this[s].call(this.value);const e={tag:this.tag,value:this.value};return this.err&&(e.err=this.err),e}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){let t=null==e?void 0:e[this.tag];if(null===t)return this;if("function"!=typeof t&&(t=p.TAGS[this.tag],"function"!=typeof t))return this;try{return t.call(this,this.value,this)}catch(e){return e&&e.message&&e.message.length>0?this.err=e.message:this.err=e,this}}static get TAGS(){return d}static set TAGS(e){d=e}static reset(){p.TAGS={...h}}}p.INTERNAL_JSON=s,p.reset(),e.exports=p},1164:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DER=t.DERErr=void 0,t._legacyHelperEquat=p,t._legacyHelperNormPriv=y,t.weierstrassN=b,t.weierstrassPoints=function(e){const{CURVE:t,curveOpts:r}=w(e);return function(e,t){const{Fp:r,Fn:n}=t;const s=p(r,e.a,e.b),o=y(n,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:o,weierstrassEquation:s,isWithinCurveOrder:function(e){return(0,i.inRange)(e,h,n.ORDER)}})}(e,b(t,r))},t.ecdsa=m,t.weierstrass=function(e){const{CURVE:t,curveOpts:r,ecdsaOpts:n}=function(e){const{CURVE:t,curveOpts:r}=w(e);return{CURVE:t,curveOpts:r,ecdsaOpts:{hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}(e);return function(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}(e,m(b(t,r),n,r))},t.SWUFpSqrtRatio=v,t.mapToCurveSimpleSWU=function(e,t){(0,o.validateField)(e);const{A:r,B:n,Z:i}=t;if(!e.isValid(r)||!e.isValid(n)||!e.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const s=v(e,i);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return t=>{let a,f,c,h,u,l,d,p;a=e.sqr(t),a=e.mul(a,i),f=e.sqr(a),f=e.add(f,a),c=e.add(f,e.ONE),c=e.mul(c,n),h=e.cmov(i,e.neg(f),!e.eql(f,e.ZERO)),h=e.mul(h,r),f=e.sqr(c),l=e.sqr(h),u=e.mul(l,r),f=e.add(f,u),f=e.mul(f,c),l=e.mul(l,h),u=e.mul(l,n),f=e.add(f,u),d=e.mul(a,c);const{isValid:y,value:b}=s(f,l);p=e.mul(a,t),p=e.mul(p,b),d=e.cmov(d,c,y),p=e.cmov(p,b,y);const g=e.isOdd(t)===e.isOdd(p);p=e.cmov(e.neg(p),p,g);const m=(0,o.FpInvertBatch)(e,[h],!0)[0];return d=e.mul(d,m),{x:d,y:p}}};const n=r(3835),i=r(6376),s=r(407),o=r(7342);function a(e){void 0!==e.lowS&&(0,i.abool)("lowS",e.lowS),void 0!==e.prehash&&(0,i.abool)("prehash",e.prehash)}class f extends Error{constructor(e=""){super(e)}}t.DERErr=f,t.DER={Err:f,_tlv:{encode:(e,r)=>{const{Err:n}=t.DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&r.length)throw new n("tlv.encode: unpadded data");const s=r.length/2,o=(0,i.numberToHexUnpadded)(s);if(o.length/2&128)throw new n("tlv.encode: long form length too big");const a=s>127?(0,i.numberToHexUnpadded)(o.length/2|128):"";return(0,i.numberToHexUnpadded)(e)+a+o+r},decode(e,r){const{Err:n}=t.DER;let i=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(r.length<2||r[i++]!==e)throw new n("tlv.decode: wrong tlv");const s=r[i++];let o=0;if(128&s){const e=127&s;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const t=r.subarray(i,i+e);if(t.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===t[0])throw new n("tlv.decode(long): zero leftmost byte");for(const e of t)o=o<<8|e;if(i+=e,o<128)throw new n("tlv.decode(long): not minimal encoding")}else o=s;const a=r.subarray(i,i+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:r.subarray(i+o)}}},_int:{encode(e){const{Err:r}=t.DER;if(e<c)throw new r("integer: negative integers are not allowed");let n=(0,i.numberToHexUnpadded)(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new r("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:r}=t.DER;if(128&e[0])throw new r("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new r("invalid signature integer: unnecessary leading zero");return(0,i.bytesToNumberBE)(e)}},toSig(e){const{Err:r,_int:n,_tlv:s}=t.DER,o=(0,i.ensureBytes)("signature",e),{v:a,l:f}=s.decode(48,o);if(f.length)throw new r("invalid signature: left bytes after parsing");const{v:c,l:h}=s.decode(2,a),{v:u,l}=s.decode(2,h);if(l.length)throw new r("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(u)}},hexFromSig(e){const{_tlv:r,_int:n}=t.DER,i=r.encode(2,n.encode(e.r))+r.encode(2,n.encode(e.s));return r.encode(48,i)}};const c=BigInt(0),h=BigInt(1),u=BigInt(2),l=BigInt(3),d=BigInt(4);function p(e,t,r){return function(n){const i=e.sqr(n),s=e.mul(i,n);return e.add(e.add(s,e.mul(n,t)),r)}}function y(e,t,r){const{BYTES:n}=e;return function(s){let o;if("bigint"==typeof s)o=s;else{let r=(0,i.ensureBytes)("private key",s);if(t){if(!t.includes(2*r.length))throw new Error("invalid private key");const e=new Uint8Array(n);e.set(r,e.length-r.length),r=e}try{o=e.fromBytes(r)}catch(e){throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof s}`)}}if(r&&(o=e.create(o)),!e.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}}function b(e,t={}){const{Fp:r,Fn:n}=(0,s._createCurveFields)("weierstrass",e,t),{h:o,n:a}=e;(0,i._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:f}=t;if(f&&(!r.is0(e.a)||"bigint"!=typeof f.beta||"function"!=typeof f.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function u(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const b=t.toBytes||function(e,t,n){const{x:s,y:o}=t.toAffine(),a=r.toBytes(s);if((0,i.abool)("isCompressed",n),n){u();const e=!r.isOdd(o);return(0,i.concatBytes)(g(e),a)}return(0,i.concatBytes)(Uint8Array.of(4),a,r.toBytes(o))},m=t.fromBytes||function(e){(0,i.abytes)(e);const t=r.BYTES,n=t+1,s=2*t+1,o=e.length,a=e[0],f=e.subarray(1);if(o!==n||2!==a&&3!==a){if(o===s&&4===a){const e=r.fromBytes(f.subarray(0*t,1*t)),n=r.fromBytes(f.subarray(1*t,2*t));if(!v(e,n))throw new Error("bad point: is not on curve");return{x:e,y:n}}throw new Error(`bad point: got length ${o}, expected compressed=${n} or uncompressed=${s}`)}{const e=r.fromBytes(f);if(!r.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=w(e);let n;try{n=r.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}return u(),!(1&~a)!==r.isOdd(n)&&(n=r.neg(n)),{x:e,y:n}}},w=p(r,e.a,e.b);function v(e,t){const n=r.sqr(t),i=w(e);return r.eql(n,i)}if(!v(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const _=r.mul(r.pow(e.a,l),d),E=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(_,E)))throw new Error("bad curve params: a or b");function S(e,t,n=!1){if(!r.isValid(t)||n&&r.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function B(e){if(!(e instanceof x))throw new Error("ProjectivePoint expected")}const M=(0,i.memoized)((e,t)=>{const{px:n,py:i,pz:s}=e;if(r.eql(s,r.ONE))return{x:n,y:i};const o=e.is0();null==t&&(t=o?r.ONE:r.inv(s));const a=r.mul(n,t),f=r.mul(i,t),c=r.mul(s,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(c,r.ONE))throw new Error("invZ was invalid");return{x:a,y:f}}),A=(0,i.memoized)(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not field elements");if(!v(n,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function I(e,t,n,i,o){return n=new x(r.mul(n.px,e),n.py,n.pz),t=(0,s.negateCt)(i,t),n=(0,s.negateCt)(o,n),t.add(n)}class x{constructor(e,t,r){this.px=S("x",e),this.py=S("y",t,!0),this.pz=S("z",r),Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof x)throw new Error("projective point not allowed");return r.is0(t)&&r.is0(n)?x.ZERO:new x(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){return(0,s.normalizeZ)(x,"pz",e)}static fromBytes(e){return(0,i.abytes)(e),x.fromHex(e)}static fromHex(e){const t=x.fromAffine(m((0,i.ensureBytes)("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){const r=y(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return x.BASE.multiply(r(e))}static msm(e,t){return(0,s.pippenger)(x,n,e,t)}precompute(e=8,t=!0){return T.setWindowSize(this,e),t||this.multiply(l),this}_setWindowSize(e){this.precompute(e)}assertValidity(){A(this)}hasEvenY(){const{y:e}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){B(e);const{px:t,py:n,pz:i}=this,{px:s,py:o,pz:a}=e,f=r.eql(r.mul(t,a),r.mul(s,i)),c=r.eql(r.mul(n,a),r.mul(o,i));return f&&c}negate(){return new x(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,l),{px:s,py:o,pz:a}=this;let f=r.ZERO,c=r.ZERO,h=r.ZERO,u=r.mul(s,s),d=r.mul(o,o),p=r.mul(a,a),y=r.mul(s,o);return y=r.add(y,y),h=r.mul(s,a),h=r.add(h,h),f=r.mul(t,h),c=r.mul(i,p),c=r.add(f,c),f=r.sub(d,c),c=r.add(d,c),c=r.mul(f,c),f=r.mul(y,f),h=r.mul(i,h),p=r.mul(t,p),y=r.sub(u,p),y=r.mul(t,y),y=r.add(y,h),h=r.add(u,u),u=r.add(h,u),u=r.add(u,p),u=r.mul(u,y),c=r.add(c,u),p=r.mul(o,a),p=r.add(p,p),u=r.mul(p,y),f=r.sub(f,u),h=r.mul(p,d),h=r.add(h,h),h=r.add(h,h),new x(f,c,h)}add(t){B(t);const{px:n,py:i,pz:s}=this,{px:o,py:a,pz:f}=t;let c=r.ZERO,h=r.ZERO,u=r.ZERO;const d=e.a,p=r.mul(e.b,l);let y=r.mul(n,o),b=r.mul(i,a),g=r.mul(s,f),m=r.add(n,i),w=r.add(o,a);m=r.mul(m,w),w=r.add(y,b),m=r.sub(m,w),w=r.add(n,s);let v=r.add(o,f);return w=r.mul(w,v),v=r.add(y,g),w=r.sub(w,v),v=r.add(i,s),c=r.add(a,f),v=r.mul(v,c),c=r.add(b,g),v=r.sub(v,c),u=r.mul(d,w),c=r.mul(p,g),u=r.add(c,u),c=r.sub(b,u),u=r.add(b,u),h=r.mul(c,u),b=r.add(y,y),b=r.add(b,y),g=r.mul(d,g),w=r.mul(p,w),b=r.add(b,g),g=r.sub(y,g),g=r.mul(d,g),w=r.add(w,g),y=r.mul(b,w),h=r.add(h,y),y=r.mul(v,w),c=r.mul(m,c),c=r.sub(c,y),y=r.mul(m,b),u=r.mul(v,u),u=r.add(u,y),new x(c,h,u)}subtract(e){return this.add(e.negate())}is0(){return this.equals(x.ZERO)}multiply(e){const{endo:r}=t;if(!n.isValidNot0(e))throw new Error("invalid scalar: out of range");let i,s;const o=e=>T.wNAFCached(this,e,x.normalizeZ);if(r){const{k1neg:t,k1:n,k2neg:a,k2:f}=r.splitScalar(e),{p:c,f:h}=o(n),{p:u,f:l}=o(f);s=h.add(l),i=I(r.beta,c,u,t,a)}else{const{p:t,f:r}=o(e);i=t,s=r}return x.normalizeZ([i,s])[0]}multiplyUnsafe(e){const{endo:r}=t,i=this;if(!n.isValid(e))throw new Error("invalid scalar: out of range");if(e===c||i.is0())return x.ZERO;if(e===h)return i;if(T.hasPrecomputes(this))return this.multiply(e);if(r){const{k1neg:t,k1:n,k2neg:o,k2:a}=r.splitScalar(e),{p1:f,p2:c}=(0,s.mulEndoUnsafe)(x,i,n,a);return I(r.beta,f,c,t,o)}return T.wNAFCachedUnsafe(i,e)}multiplyAndAddUnsafe(e,t,r){const n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(e){return M(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return o===h||(e?e(x,this):T.wNAFCachedUnsafe(this,a).is0())}clearCofactor(){const{clearCofactor:e}=t;return o===h?this:e?e(x,this):this.multiplyUnsafe(o)}toBytes(e=!0){return(0,i.abool)("isCompressed",e),this.assertValidity(),b(x,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return(0,i.bytesToHex)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}x.BASE=new x(e.Gx,e.Gy,r.ONE),x.ZERO=new x(r.ZERO,r.ONE,r.ZERO),x.Fp=r,x.Fn=n;const k=n.BITS,T=(0,s.wNAF)(x,t.endo?Math.ceil(k/2):k);return x}function g(e){return Uint8Array.of(e?2:3)}function m(e,r,s={}){(0,i._validateObject)(r,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const f=r.randomBytes||i.randomBytes,l=r.hmac||((e,...t)=>(0,n.hmac)(r.hash,e,(0,i.concatBytes)(...t))),{Fp:d,Fn:p}=e,{ORDER:b,BITS:m}=p;function w(e){return e>b>>h}function v(e,t){if(!p.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..CURVE.n`)}class _{constructor(e,t,r){v("r",e),v("s",t),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){const t=p.BYTES,r=(0,i.ensureBytes)("compactSignature",e,2*t);return new _(p.fromBytes(r.subarray(0,t)),p.fromBytes(r.subarray(t,2*t)))}static fromDER(e){const{r,s:n}=t.DER.toSig((0,i.ensureBytes)("DER",e));return new _(r,n)}assertValidity(){}addRecoveryBit(e){return new _(this.r,this.s,e)}recoverPublicKey(t){const r=d.ORDER,{r:n,s,recovery:o}=this;if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");if(b*u<r&&o>1)throw new Error("recovery id is ambiguous for h>1 curve");const a=2===o||3===o?n+b:n;if(!d.isValid(a))throw new Error("recovery id 2 or 3 invalid");const f=d.toBytes(a),c=e.fromHex((0,i.concatBytes)(g(!(1&o)),f)),h=p.inv(a),l=A((0,i.ensureBytes)("msgHash",t)),y=p.create(-l*h),m=p.create(s*h),w=e.BASE.multiplyUnsafe(y).add(c.multiplyUnsafe(m));if(w.is0())throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return w(this.s)}normalizeS(){return this.hasHighS()?new _(this.r,p.neg(this.s),this.recovery):this}toBytes(e){if("compact"===e)return(0,i.concatBytes)(p.toBytes(this.r),p.toBytes(this.s));if("der"===e)return(0,i.hexToBytes)(t.DER.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,i.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,i.bytesToHex)(this.toBytes("compact"))}}const E=y(p,s.allowedPrivateKeyLengths,s.wrapPrivateKey),S={isValidPrivateKey(e){try{return E(e),!0}catch(e){return!1}},normPrivateKeyToScalar:E,randomPrivateKey:()=>{const e=b;return(0,o.mapHashToField)(f((0,o.getMinHashLength)(e)),e)},precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)};function B(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const r=(0,i.ensureBytes)("key",t).length,n=d.BYTES,o=n+1,a=2*n+1;return s.allowedPrivateKeyLengths||p.BYTES===o?void 0:r===o||r===a}const M=r.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=(0,i.bytesToNumberBE)(e),r=8*e.length-m;return r>0?t>>BigInt(r):t},A=r.bits2int_modN||function(e){return p.create(M(e))},I=(0,i.bitMask)(m);function x(e){return(0,i.aInRange)("num < 2^"+m,e,c,I),p.toBytes(e)}const k={lowS:r.lowS,prehash:!1},T={lowS:r.lowS,prehash:!1};return e.BASE.precompute(8),Object.freeze({getPublicKey:function(t,r=!0){return e.fromPrivateKey(t).toBytes(r)},getSharedSecret:function(t,r,n=!0){if(!0===B(t))throw new Error("first arg must be private key");if(!1===B(r))throw new Error("second arg must be public key");return e.fromHex(r).multiply(E(t)).toBytes(n)},sign:function(t,n,s=k){const{seed:o,k2sig:u}=function(t,n,s=k){if(["recovered","canonical"].some(e=>e in s))throw new Error("sign() legacy options not supported");const{hash:o}=r;let{lowS:u,prehash:l,extraEntropy:y}=s;null==u&&(u=!0),t=(0,i.ensureBytes)("msgHash",t),a(s),l&&(t=(0,i.ensureBytes)("prehashed msgHash",o(t)));const b=A(t),g=E(n),m=[x(g),x(b)];if(null!=y&&!1!==y){const e=!0===y?f(d.BYTES):y;m.push((0,i.ensureBytes)("extraEntropy",e))}const v=(0,i.concatBytes)(...m),S=b;return{seed:v,k2sig:function(t){const r=M(t);if(!p.isValidNot0(r))return;const n=p.inv(r),i=e.BASE.multiply(r).toAffine(),s=p.create(i.x);if(s===c)return;const o=p.create(n*p.create(S+s*g));if(o===c)return;let a=(i.x===s?0:2)|Number(i.y&h),f=o;return u&&w(o)&&(f=function(e){return w(e)?p.neg(e):e}(o),a^=1),new _(s,f,a)}}}(t,n,s);return(0,i.createHmacDrbg)(r.hash.outputLen,p.BYTES,l)(o,u)},verify:function(n,s,o,f=T){const c=n;s=(0,i.ensureBytes)("msgHash",s),o=(0,i.ensureBytes)("publicKey",o),a(f);const{lowS:h,prehash:u,format:l}=f;if("strict"in f)throw new Error("options.strict was renamed to lowS");if(void 0!==l&&!["compact","der","js"].includes(l))throw new Error('format must be "compact", "der" or "js"');const d="string"==typeof c||(0,i.isBytes)(c),y=!d&&!l&&"object"==typeof c&&null!==c&&"bigint"==typeof c.r&&"bigint"==typeof c.s;if(!d&&!y)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let b,g;try{if(y){if(void 0!==l&&"js"!==l)throw new Error("invalid format");b=new _(c.r,c.s)}if(d){try{"compact"!==l&&(b=_.fromDER(c))}catch(e){if(!(e instanceof t.DER.Err))throw e}b||"der"===l||(b=_.fromCompact(c))}g=e.fromHex(o)}catch(e){return!1}if(!b)return!1;if(h&&b.hasHighS())return!1;u&&(s=r.hash(s));const{r:m,s:w}=b,v=A(s),E=p.inv(w),S=p.create(v*E),B=p.create(m*E),M=e.BASE.multiplyUnsafe(S).add(g.multiplyUnsafe(B));return!M.is0()&&p.create(M.x)===m},utils:S,Point:e,Signature:_})}function w(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:(0,o.Field)(t.n,e.nBitLength),allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}function v(e,t){const r=e.ORDER;let n=c;for(let e=r-h;e%u===c;e/=u)n+=h;const i=n,s=u<<i-h-h,o=s*u,a=(r-h)/o,f=(a-h)/u,p=o-h,y=s,b=e.pow(t,a),g=e.pow(t,(a+h)/u);let m=(t,r)=>{let n=b,s=e.pow(r,p),o=e.sqr(s);o=e.mul(o,r);let a=e.mul(t,o);a=e.pow(a,f),a=e.mul(a,s),s=e.mul(a,r),o=e.mul(a,t);let c=e.mul(o,s);a=e.pow(c,y);let l=e.eql(a,e.ONE);s=e.mul(o,g),a=e.mul(c,n),o=e.cmov(s,o,l),c=e.cmov(a,c,l);for(let t=i;t>h;t--){let r=t-u;r=u<<r-h;let i=e.pow(c,r);const a=e.eql(i,e.ONE);s=e.mul(o,n),n=e.mul(n,n),i=e.mul(c,n),o=e.cmov(s,o,a),c=e.cmov(i,c,a)}return{isValid:l,value:o}};if(e.ORDER%d===l){const r=(e.ORDER-l)/d,n=e.sqrt(e.neg(t));m=(t,i)=>{let s=e.sqr(i);const o=e.mul(t,i);s=e.mul(s,o);let a=e.pow(s,r);a=e.mul(a,o);const f=e.mul(a,n),c=e.mul(e.sqr(a),i),h=e.eql(c,t);return{isValid:h,value:e.cmov(f,a,h)}}}return m}},1167:(e,t,r)=>{"use strict";const n=r(9995),i=r(9055),s=r(5775),o=r(3271),a=r(9109),f=r(1163),c=r(5713),h=r(3105);e.exports={Commented:n,Diagnose:i,Decoder:s,Encoder:o,Simple:a,Tagged:f,Map:c,SharedValueEncoder:h,comment:n.comment,decodeAll:s.decodeAll,decodeFirst:s.decodeFirst,decodeAllSync:s.decodeAllSync,decodeFirstSync:s.decodeFirstSync,diagnose:i.diagnose,encode:o.encode,encodeCanonical:o.encodeCanonical,encodeOne:o.encodeOne,encodeAsync:o.encodeAsync,decode:s.decodeFirstSync,leveldb:{decode:s.decodeFirstSync,encode:o.encode,buffer:!0,name:"cbor"},reset(){o.reset(),f.reset()}}},1198:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.HARDENED_OFFSET=t.sha512=t.hmac512=t.hash28=void 0;const o=r(4686),a=r(4523),f=s(r(5402));t.hash28=function(e){const t=a.blake2b(e,void 0,28);return o.Buffer.from(t)},t.hmac512=function(e,t){const r=f.hmac(f.sha512,e).update(t).digest();return o.Buffer.from(r)},t.sha512=function(e){const t=f.sha512().update(e).digest();return o.Buffer.from(t)},t.HARDENED_OFFSET=2147483648},1220:()=>{},1323:(e,t,r)=>{"use strict";var n=r(6671).Buffer,i=r(896).Transform;function s(e){i.call(this),this._block=n.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}r(6192)(s,i),s.prototype._transform=function(e,t,r){var n=null;try{this.update(e,t)}catch(e){n=e}r(n)},s.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)};var o="undefined"!=typeof Uint8Array,a="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&ArrayBuffer.isView&&(n.prototype instanceof Uint8Array||n.TYPED_ARRAY_SUPPORT);s.prototype.update=function(e,t){if(this._finalized)throw new Error("Digest already called");e=function(e,t){if(e instanceof n)return e;if("string"==typeof e)return n.from(e,t);if(a&&ArrayBuffer.isView(e)){if(0===e.byteLength)return n.alloc(0);var r=n.from(e.buffer,e.byteOffset,e.byteLength);if(r.byteLength===e.byteLength)return r}if(o&&e instanceof Uint8Array)return n.from(e);if(n.isBuffer(e)&&e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e))return n.from(e);throw new TypeError('The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView.')}(e,t);for(var r=this._block,i=0;this._blockOffset+e.length-i>=this._blockSize;){for(var s=this._blockOffset;s<this._blockSize;)r[s++]=e[i++];this._update(),this._blockOffset=0}for(;i<e.length;)r[this._blockOffset++]=e[i++];for(var f=0,c=8*e.length;c>0;++f)this._length[f]+=c,(c=this._length[f]/4294967296|0)>0&&(this._length[f]-=4294967296*c);return this},s.prototype._update=function(){throw new Error("_update is not implemented")},s.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var r=0;r<4;++r)this._length[r]=0;return t},s.prototype._digest=function(){throw new Error("_digest is not implemented")},e.exports=s},1339:(e,t,r)=>{"use strict";var n=r(900).rotr32;function i(e,t,r){return e&t^~e&r}function s(e,t,r){return e&t^e&r^t&r}function o(e,t,r){return e^t^r}t.ft_1=function(e,t,r,n){return 0===e?i(t,r,n):1===e||3===e?o(t,r,n):2===e?s(t,r,n):void 0},t.ch32=i,t.maj32=s,t.p32=o,t.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},t.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},t.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},t.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},1348:(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return!1}catch(e){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},1362:(e,t,r)=>{"use strict";var n=t;n.version=r(3453).rE,n.utils=r(1036),n.rand=r(3569),n.curve=r(613),n.curves=r(4797),n.ec=r(2710),n.eddsa=r(7265)},1366:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.storagify=t.MessagePackStore=t.MemoryStore=t.MessagePackStorage=t.LocalStorage=t.MemoryStorage=t.deserialize=t.serialize=void 0;const n=r(2655),i=r(4686),s=(e,t)=>t?"certificate"===e||"publicKey"===e||"secretKey"===e?"_bx_"+i.Buffer.from(t).toString("base64"):"Buffer"===t.constructor.name?"_bx_"+t.toString("base64"):"Buffer"===t.type?"_bx_"+i.Buffer.from(t.data).toString("base64"):"Array"===t.constructor.name||"Uint8Array"===t.constructor.name?"_bx_"+i.Buffer.from(t).toString("base64"):t:t,o=(e,t)=>{if("string"==typeof t){if(t.startsWith("__C__"))return i.Buffer.from(t.slice(5),"base64");if(t.startsWith("_bx_"))return i.Buffer.from(t.slice(4),"base64")}return t};t.serialize=e=>JSON.stringify(e,s),t.deserialize=e=>JSON.parse(e,o),t.MemoryStorage=e=>{let r={};return e||(e=()=>(0,t.serialize)(r)),(0,t.storagify)(r,e,()=>"")},t.LocalStorage=(e="vaultysStorage")=>{let r={};return localStorage[e]?r=(0,t.deserialize)(localStorage[e]):localStorage[e]="{}",(0,t.storagify)(r,()=>localStorage.setItem(e,(0,t.serialize)(r)),()=>localStorage.removeItem(e))},t.MessagePackStorage=(e="vaultysStorage")=>{let r={};return localStorage[e]?r=(0,n.decode)(localStorage[e]):localStorage[e]=i.Buffer.from((0,n.encode)({})).toString("base64"),(0,t.storagify)(r,()=>localStorage.setItem(e,i.Buffer.from((0,n.encode)(r)).toString("base64")),()=>localStorage.removeItem(e))};class a{constructor(e){this._raw=e}save(){}destroy(){}toString(){return i.Buffer.from((0,n.encode)(this._raw)).toString("base64")}toJSON(){return(0,n.decode)((0,n.encode)(this._raw))}fromJSON(e,t,r){return new a(e)}fromString(e,t,r){return new a((0,n.decode)(i.Buffer.from(e,"base64")))}set(e,t){this._raw[e]=t}delete(e){delete this._raw[e]}get(e){return this._raw[e]}list(){return Object.keys(this._raw).filter(e=>!e.startsWith("!"))}listSubstores(){return Object.keys(this._raw).filter(e=>e.startsWith("!")).map(e=>e.slice(1))}deleteSubstore(e){delete this._raw["!"+e]}renameSubstore(e,t){e===t||this._raw["!"+t]||(this._raw["!"+t]=this._raw["!"+e],delete this._raw["!"+e])}substore(e){return this._raw["!"+e]||(this._raw["!"+e]={}),new a(this._raw["!"+e])}}t.MemoryStore=class extends a{},t.MessagePackStore=class extends a{},t.storagify=(e,r=()=>{},n=()=>{})=>{const i={_raw:e};return{...i,destroy:n,save:r,toString:()=>(0,t.serialize)(i._raw),toJSON:()=>(0,t.deserialize)((0,t.serialize)(i._raw)),fromJSON:(e,r,n)=>(0,t.storagify)(e,r,n),fromString:(e,r,n)=>(0,t.storagify)((0,t.deserialize)(e),r,n),set:(e,t)=>i._raw[e]=t,delete:e=>delete i._raw[e],get:e=>i._raw[e],list:()=>Object.keys(i._raw).filter(e=>!e.startsWith("!")),listSubstores:()=>Object.keys(i._raw).filter(e=>e.startsWith("!")).map(e=>e.slice(1)),deleteSubstore:e=>delete i._raw["!"+e],renameSubstore:(e,t)=>{e===t||i._raw["!"+t]||(i._raw["!"+t]=i._raw["!"+e],delete i._raw["!"+e])},substore:e=>(i._raw["!"+e]||(i._raw["!"+e]={}),(0,t.storagify)(i._raw["!"+e],r,n))}}},1413:(e,t,r)=>{"use strict";var n=r(900),i=r(7984),s=r(1339),o=r(8637),a=n.sum32,f=n.sum32_4,c=n.sum32_5,h=s.ch32,u=s.maj32,l=s.s0_256,d=s.s1_256,p=s.g0_256,y=s.g1_256,b=i.BlockHash,g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function m(){if(!(this instanceof m))return new m;b.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g,this.W=new Array(64)}n.inherits(m,b),e.exports=m,m.blockSize=512,m.outSize=256,m.hmacStrength=192,m.padLength=64,m.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=f(y(r[n-2]),r[n-7],p(r[n-15]),r[n-16]);var i=this.h[0],s=this.h[1],b=this.h[2],g=this.h[3],m=this.h[4],w=this.h[5],v=this.h[6],_=this.h[7];for(o(this.k.length===r.length),n=0;n<r.length;n++){var E=c(_,d(m),h(m,w,v),this.k[n],r[n]),S=a(l(i),u(i,s,b));_=v,v=w,w=m,m=a(g,E),g=b,b=s,s=i,i=a(E,S)}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],b),this.h[3]=a(this.h[3],g),this.h[4]=a(this.h[4],m),this.h[5]=a(this.h[5],w),this.h[6]=a(this.h[6],v),this.h[7]=a(this.h[7],_)},m.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},1440:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp256r1=t.p256=void 0;const n=r(2355);t.p256=n.p256,t.secp256r1=n.p256,t.hashToCurve=n.p256_hasher.hashToCurve,t.encodeToCurve=n.p256_hasher.encodeToCurve},1449:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=n(r(1167)),o=n(r(4406)),a=r(7165),f=r(2655),c=n(r(7961)),h=r(4686),u=r(6761),l=n(r(7264)),d={usb:1,nfc:2,ble:4,internal:8,hybrid:16,"smart-card":32},p=e=>Object.keys(d).filter(t=>e&&d[t]),y=e=>{const t=s.default.decode(e).get(1);return 1===t?"Ed25519VerificationKey2020":2===t?"P256VerificationKey2020":"Unknown"},b=e=>{const t=s.default.decode(e);let r=h.Buffer.from([]);return-7==t.get(3)?r=h.Buffer.concat([h.Buffer.from("04","hex"),t.get(-2),t.get(-3)]):-8==t.get(3)?r=t.get(-2):t.get(3)==u.PQ_COSE_ALG.DILITHIUM2&&(r=t.get(-101)),{publicKey:r}};class g extends l.default{constructor(){super(),this._transports=0,this.encType="X25519KeyAgreementKey2019",this.webAuthn=(0,a.getWebAuthnProvider)()}get transports(){return p(this._transports)}static async createFromAttestation(e){const t=new g;t.ckey=c.default.getCOSEPublicKey(e),t.authType=y(t.ckey),t.fid=h.Buffer.from(e.id,"base64");const r=e.response,n=r.getTransports?r.getTransports():["usb"];t._transports=(e=>e.reduceRight((e,t)=>e+(d[t]?d[t]:0),0))(n),t.signer=b(t.ckey);const s=(0,i.randomBytes)(32),a=(f=s,(0,i.hash)("sha512",f));var f;const u=o.default.box.keyPair.fromSecretKey(a.slice(0,32));return t.cypher={publicKey:h.Buffer.from(u.publicKey),secretKey:h.Buffer.from(u.secretKey)},t.entropy=s,t}get id(){return h.Buffer.from((0,f.encode)({v:this.version,c:this.ckey,e:this.cypher.publicKey}))}getSecret(){return h.Buffer.from((0,f.encode)({v:this.version,f:this.fid,t:this._transports,c:this.ckey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,f.decode)(e),r=new g;r.version=t.v??0,r.capability="private",r.fid="string"==typeof t.f?h.Buffer.from(t.f,"base64"):t.f,r._transports=t.t?t.t:15,r.ckey=t.c,r.authType=y(r.ckey),r.signer=b(t.c);const n=o.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:h.Buffer.from(n.publicKey),secretKey:h.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new g;return t.version=e.version??0,t.fid="string"==typeof e.fid?h.Buffer.from(e.fid,"base64"):e.fid,t._transports=e.t?e.t:15,t.ckey=e.ckey.data?h.Buffer.from(e.ckey.data):h.Buffer.from(e.ckey),t.signer=b(t.ckey),t.authType=y(t.ckey),t.cypher={publicKey:e.cypher.publicKey.data?h.Buffer.from(e.cypher.publicKey.data):h.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,f.decode)(e),r=new g;return r.version=t.v??0,r.capability="public",r.fid="string"==typeof t.f?h.Buffer.from(t.f,"base64"):t.f,r.ckey=t.c,r.signer=b(t.c),r.authType=y(r.ckey),r.cypher={publicKey:t.e},r}async getSigner(){return{sign:async e=>{if(!navigator.credentials)return null;try{await(window?.CredentialUserInteractionRequest())}catch(e){}const t={challenge:(0,i.hash)("sha256",e),userVerification:"preferred",allowCredentials:[{type:"public-key",id:this.fid,transports:p(this._transports)}]},{response:r}=await this.webAuthn.get(t),n=r,s={s:h.Buffer.from(n.signature),c:h.Buffer.from(n.clientDataJSON),a:h.Buffer.from(n.authenticatorData)};return h.Buffer.from((0,f.encode)(s))}}}verify(e,t,r=!1){const n=h.Buffer.from(t),s=(0,f.decode)(n),o={signature:s.s,clientDataJSON:s.c,authenticatorData:s.a,userHandle:h.Buffer.from([]).buffer};return(0,i.hash)("sha256",e).toString("base64")===c.default.extractChallenge(o.clientDataJSON)&&c.default.simpleVerify(this.ckey,o,r)}verifyCredentials(e,t=!1){if(e.id!==this.fid.toString("base64"))return!1;const r=e.response;var n;return h.Buffer.from(r.authenticatorData.slice(0,32)).toString("hex")===(n=h.Buffer.from(e.id,"base64"),(0,i.hash)("sha256",n)).toString("hex")&&c.default.simpleVerify(this.ckey,r,t)}async createRevocationCertificate(){return null}}t.default=g},1498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCrypto=void 0;const n=r(5325),i=r(2248);t.NodeCrypto={webauthn:new i.NodeWebAuthn,pbkdf2:{encrypt:n.encrypt,decrypt:n.decrypt}}},1553:()=>{},1609:(e,t,r)=>{"use strict";var n=r(4686).Buffer,i=r(6192),s=r(1323),o=new Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],f=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],h=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],u=[0,1518500249,1859775393,2400959708,2840853838],l=[1352829926,1548603684,1836072691,2053994217,0];function d(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(e,t){return e<<t|e>>>32-t}function y(e,t,r,n,i,s,o,a){return p(e+(t^r^n)+s+o|0,a)+i|0}function b(e,t,r,n,i,s,o,a){return p(e+(t&r|~t&n)+s+o|0,a)+i|0}function g(e,t,r,n,i,s,o,a){return p(e+((t|~r)^n)+s+o|0,a)+i|0}function m(e,t,r,n,i,s,o,a){return p(e+(t&n|r&~n)+s+o|0,a)+i|0}function w(e,t,r,n,i,s,o,a){return p(e+(t^(r|~n))+s+o|0,a)+i|0}i(d,s),d.prototype._update=function(){for(var e=o,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var r=0|this._a,n=0|this._b,i=0|this._c,s=0|this._d,d=0|this._e,v=0|this._a,_=0|this._b,E=0|this._c,S=0|this._d,B=0|this._e,M=0;M<80;M+=1){var A,I;M<16?(A=y(r,n,i,s,d,e[a[M]],u[0],c[M]),I=w(v,_,E,S,B,e[f[M]],l[0],h[M])):M<32?(A=b(r,n,i,s,d,e[a[M]],u[1],c[M]),I=m(v,_,E,S,B,e[f[M]],l[1],h[M])):M<48?(A=g(r,n,i,s,d,e[a[M]],u[2],c[M]),I=g(v,_,E,S,B,e[f[M]],l[2],h[M])):M<64?(A=m(r,n,i,s,d,e[a[M]],u[3],c[M]),I=b(v,_,E,S,B,e[f[M]],l[3],h[M])):(A=w(r,n,i,s,d,e[a[M]],u[4],c[M]),I=y(v,_,E,S,B,e[f[M]],l[4],h[M])),r=d,d=s,s=p(i,10),i=n,n=A,v=B,B=S,S=p(E,10),E=_,_=I}var x=this._b+i+S|0;this._b=this._c+s+B|0,this._c=this._d+d+v|0,this._d=this._e+r+_|0,this._e=this._a+n+E|0,this._a=x},d.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=n.alloc?n.alloc(20):new n(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},e.exports=d},1661:(e,t,r)=>{var n=r(5709);function i(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function s(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}e.exports=n(i),e.exports.strict=n(s),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return s(this)},configurable:!0})})},1691:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var o;"object"==typeof e?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(3514).Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function f(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function c(e,t,r,i){for(var s=0,o=0,a=Math.min(e.length,r),f=t;f<a;f++){var c=e.charCodeAt(f)-48;s*=i,o=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&o<i,"Invalid character"),s+=o}return s}function h(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return e.cmp(t)<0?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,o,a=0;if("be"===r)for(i=e.length-1,s=0;i>=0;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(i=0,s=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this._strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,o=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=f(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=f(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;this._strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,o=s%n,a=Math.min(s,s-o)+r,f=0,h=r;h<a;h+=n)f=c(e,h,h+n,t),this.imuln(i),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(0!==o){var u=1;for(f=c(e,h,e.length,t),h=0;h<o;h++)u*=t;this.imuln(u),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this._strip()},s.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype._move=function(e){h(e,this)},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=u}catch(e){s.prototype.inspect=u}else s.prototype.inspect=u;function u(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function y(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],o=i*s,a=67108863&o,f=o/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var h=f>>>26,u=67108863&f,l=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=l;d++){var p=c-d|0;h+=(o=(i=0|e.words[p])*(s=0|t.words[d])+u)/67108864|0,u=67108863&o}r.words[c]=0|u,f=0|h}return 0!==f?r.words[c]=0|f:r.length--,r._strip()}s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,s=0,o=0;o<this.length;o++){var a=this.words[o],f=(16777215&(a<<i|s)).toString(16);s=a>>>24-i&16777215,(i+=2)>=26&&(i-=26,o--),r=0!==s||o!==this.length-1?l[6-f.length]+f+r:f+r}for(0!==s&&(r=s.toString(16)+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],h=p[e];r="";var u=this.clone();for(u.negative=0;!u.isZero();){var y=u.modrn(h).toString(e);r=(u=u.idivn(h)).isZero()?y+r:l[c-y.length]+y+r}for(this.isZero()&&(r="0"+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(e,t){return this.toArrayLike(o,e,t)}),s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),s=r||Math.max(1,i);n(i<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0");var o=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,s);return this["_toArrayLike"+("le"===t?"LE":"BE")](o,i),o},s.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r++]=255&o,r<e.length&&(e[r++]=o>>8&255),r<e.length&&(e[r++]=o>>16&255),6===s?(r<e.length&&(e[r++]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},s.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r--]=255&o,r>=0&&(e[r--]=o>>8&255),r>=0&&(e[r--]=o>>16&255),6===s?(r>=0&&(e[r--]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 8191&t||(r+=13,t>>>=13),127&t||(r+=7,t>>>=7),15&t||(r+=4,t>>>=4),3&t||(r+=2,t>>>=2),1&t||r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},s.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},s.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},s.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},s.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,o=0;o<n.length;o++)s=(t=(0|r.words[o])-(0|n.words[o])+s)>>26,this.words[o]=67108863&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=67108863&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var b=function(e,t,r){var n,i,s,o=e.words,a=t.words,f=r.words,c=0,h=0|o[0],u=8191&h,l=h>>>13,d=0|o[1],p=8191&d,y=d>>>13,b=0|o[2],g=8191&b,m=b>>>13,w=0|o[3],v=8191&w,_=w>>>13,E=0|o[4],S=8191&E,B=E>>>13,M=0|o[5],A=8191&M,I=M>>>13,x=0|o[6],k=8191&x,T=x>>>13,P=0|o[7],O=8191&P,R=P>>>13,K=0|o[8],C=8191&K,U=K>>>13,D=0|o[9],L=8191&D,N=D>>>13,H=0|a[0],F=8191&H,j=H>>>13,z=0|a[1],q=8191&z,V=z>>>13,G=0|a[2],W=8191&G,Y=G>>>13,$=0|a[3],Z=8191&$,X=$>>>13,J=0|a[4],Q=8191&J,ee=J>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],se=8191&ie,oe=ie>>>13,ae=0|a[7],fe=8191&ae,ce=ae>>>13,he=0|a[8],ue=8191&he,le=he>>>13,de=0|a[9],pe=8191&de,ye=de>>>13;r.negative=e.negative^t.negative,r.length=19;var be=(c+(n=Math.imul(u,F))|0)+((8191&(i=(i=Math.imul(u,j))+Math.imul(l,F)|0))<<13)|0;c=((s=Math.imul(l,j))+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(p,F),i=(i=Math.imul(p,j))+Math.imul(y,F)|0,s=Math.imul(y,j);var ge=(c+(n=n+Math.imul(u,q)|0)|0)+((8191&(i=(i=i+Math.imul(u,V)|0)+Math.imul(l,q)|0))<<13)|0;c=((s=s+Math.imul(l,V)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),i=(i=Math.imul(g,j))+Math.imul(m,F)|0,s=Math.imul(m,j),n=n+Math.imul(p,q)|0,i=(i=i+Math.imul(p,V)|0)+Math.imul(y,q)|0,s=s+Math.imul(y,V)|0;var me=(c+(n=n+Math.imul(u,W)|0)|0)+((8191&(i=(i=i+Math.imul(u,Y)|0)+Math.imul(l,W)|0))<<13)|0;c=((s=s+Math.imul(l,Y)|0)+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(v,F),i=(i=Math.imul(v,j))+Math.imul(_,F)|0,s=Math.imul(_,j),n=n+Math.imul(g,q)|0,i=(i=i+Math.imul(g,V)|0)+Math.imul(m,q)|0,s=s+Math.imul(m,V)|0,n=n+Math.imul(p,W)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(y,W)|0,s=s+Math.imul(y,Y)|0;var we=(c+(n=n+Math.imul(u,Z)|0)|0)+((8191&(i=(i=i+Math.imul(u,X)|0)+Math.imul(l,Z)|0))<<13)|0;c=((s=s+Math.imul(l,X)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(S,F),i=(i=Math.imul(S,j))+Math.imul(B,F)|0,s=Math.imul(B,j),n=n+Math.imul(v,q)|0,i=(i=i+Math.imul(v,V)|0)+Math.imul(_,q)|0,s=s+Math.imul(_,V)|0,n=n+Math.imul(g,W)|0,i=(i=i+Math.imul(g,Y)|0)+Math.imul(m,W)|0,s=s+Math.imul(m,Y)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,X)|0)+Math.imul(y,Z)|0,s=s+Math.imul(y,X)|0;var ve=(c+(n=n+Math.imul(u,Q)|0)|0)+((8191&(i=(i=i+Math.imul(u,ee)|0)+Math.imul(l,Q)|0))<<13)|0;c=((s=s+Math.imul(l,ee)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(A,F),i=(i=Math.imul(A,j))+Math.imul(I,F)|0,s=Math.imul(I,j),n=n+Math.imul(S,q)|0,i=(i=i+Math.imul(S,V)|0)+Math.imul(B,q)|0,s=s+Math.imul(B,V)|0,n=n+Math.imul(v,W)|0,i=(i=i+Math.imul(v,Y)|0)+Math.imul(_,W)|0,s=s+Math.imul(_,Y)|0,n=n+Math.imul(g,Z)|0,i=(i=i+Math.imul(g,X)|0)+Math.imul(m,Z)|0,s=s+Math.imul(m,X)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(y,Q)|0,s=s+Math.imul(y,ee)|0;var _e=(c+(n=n+Math.imul(u,re)|0)|0)+((8191&(i=(i=i+Math.imul(u,ne)|0)+Math.imul(l,re)|0))<<13)|0;c=((s=s+Math.imul(l,ne)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(k,F),i=(i=Math.imul(k,j))+Math.imul(T,F)|0,s=Math.imul(T,j),n=n+Math.imul(A,q)|0,i=(i=i+Math.imul(A,V)|0)+Math.imul(I,q)|0,s=s+Math.imul(I,V)|0,n=n+Math.imul(S,W)|0,i=(i=i+Math.imul(S,Y)|0)+Math.imul(B,W)|0,s=s+Math.imul(B,Y)|0,n=n+Math.imul(v,Z)|0,i=(i=i+Math.imul(v,X)|0)+Math.imul(_,Z)|0,s=s+Math.imul(_,X)|0,n=n+Math.imul(g,Q)|0,i=(i=i+Math.imul(g,ee)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(y,re)|0,s=s+Math.imul(y,ne)|0;var Ee=(c+(n=n+Math.imul(u,se)|0)|0)+((8191&(i=(i=i+Math.imul(u,oe)|0)+Math.imul(l,se)|0))<<13)|0;c=((s=s+Math.imul(l,oe)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(O,F),i=(i=Math.imul(O,j))+Math.imul(R,F)|0,s=Math.imul(R,j),n=n+Math.imul(k,q)|0,i=(i=i+Math.imul(k,V)|0)+Math.imul(T,q)|0,s=s+Math.imul(T,V)|0,n=n+Math.imul(A,W)|0,i=(i=i+Math.imul(A,Y)|0)+Math.imul(I,W)|0,s=s+Math.imul(I,Y)|0,n=n+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,X)|0)+Math.imul(B,Z)|0,s=s+Math.imul(B,X)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,ee)|0,n=n+Math.imul(g,re)|0,i=(i=i+Math.imul(g,ne)|0)+Math.imul(m,re)|0,s=s+Math.imul(m,ne)|0,n=n+Math.imul(p,se)|0,i=(i=i+Math.imul(p,oe)|0)+Math.imul(y,se)|0,s=s+Math.imul(y,oe)|0;var Se=(c+(n=n+Math.imul(u,fe)|0)|0)+((8191&(i=(i=i+Math.imul(u,ce)|0)+Math.imul(l,fe)|0))<<13)|0;c=((s=s+Math.imul(l,ce)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(C,F),i=(i=Math.imul(C,j))+Math.imul(U,F)|0,s=Math.imul(U,j),n=n+Math.imul(O,q)|0,i=(i=i+Math.imul(O,V)|0)+Math.imul(R,q)|0,s=s+Math.imul(R,V)|0,n=n+Math.imul(k,W)|0,i=(i=i+Math.imul(k,Y)|0)+Math.imul(T,W)|0,s=s+Math.imul(T,Y)|0,n=n+Math.imul(A,Z)|0,i=(i=i+Math.imul(A,X)|0)+Math.imul(I,Z)|0,s=s+Math.imul(I,X)|0,n=n+Math.imul(S,Q)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(B,Q)|0,s=s+Math.imul(B,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(_,re)|0,s=s+Math.imul(_,ne)|0,n=n+Math.imul(g,se)|0,i=(i=i+Math.imul(g,oe)|0)+Math.imul(m,se)|0,s=s+Math.imul(m,oe)|0,n=n+Math.imul(p,fe)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(y,fe)|0,s=s+Math.imul(y,ce)|0;var Be=(c+(n=n+Math.imul(u,ue)|0)|0)+((8191&(i=(i=i+Math.imul(u,le)|0)+Math.imul(l,ue)|0))<<13)|0;c=((s=s+Math.imul(l,le)|0)+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,n=Math.imul(L,F),i=(i=Math.imul(L,j))+Math.imul(N,F)|0,s=Math.imul(N,j),n=n+Math.imul(C,q)|0,i=(i=i+Math.imul(C,V)|0)+Math.imul(U,q)|0,s=s+Math.imul(U,V)|0,n=n+Math.imul(O,W)|0,i=(i=i+Math.imul(O,Y)|0)+Math.imul(R,W)|0,s=s+Math.imul(R,Y)|0,n=n+Math.imul(k,Z)|0,i=(i=i+Math.imul(k,X)|0)+Math.imul(T,Z)|0,s=s+Math.imul(T,X)|0,n=n+Math.imul(A,Q)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,ee)|0,n=n+Math.imul(S,re)|0,i=(i=i+Math.imul(S,ne)|0)+Math.imul(B,re)|0,s=s+Math.imul(B,ne)|0,n=n+Math.imul(v,se)|0,i=(i=i+Math.imul(v,oe)|0)+Math.imul(_,se)|0,s=s+Math.imul(_,oe)|0,n=n+Math.imul(g,fe)|0,i=(i=i+Math.imul(g,ce)|0)+Math.imul(m,fe)|0,s=s+Math.imul(m,ce)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,le)|0)+Math.imul(y,ue)|0,s=s+Math.imul(y,le)|0;var Me=(c+(n=n+Math.imul(u,pe)|0)|0)+((8191&(i=(i=i+Math.imul(u,ye)|0)+Math.imul(l,pe)|0))<<13)|0;c=((s=s+Math.imul(l,ye)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(L,q),i=(i=Math.imul(L,V))+Math.imul(N,q)|0,s=Math.imul(N,V),n=n+Math.imul(C,W)|0,i=(i=i+Math.imul(C,Y)|0)+Math.imul(U,W)|0,s=s+Math.imul(U,Y)|0,n=n+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,X)|0)+Math.imul(R,Z)|0,s=s+Math.imul(R,X)|0,n=n+Math.imul(k,Q)|0,i=(i=i+Math.imul(k,ee)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,ee)|0,n=n+Math.imul(A,re)|0,i=(i=i+Math.imul(A,ne)|0)+Math.imul(I,re)|0,s=s+Math.imul(I,ne)|0,n=n+Math.imul(S,se)|0,i=(i=i+Math.imul(S,oe)|0)+Math.imul(B,se)|0,s=s+Math.imul(B,oe)|0,n=n+Math.imul(v,fe)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(_,fe)|0,s=s+Math.imul(_,ce)|0,n=n+Math.imul(g,ue)|0,i=(i=i+Math.imul(g,le)|0)+Math.imul(m,ue)|0,s=s+Math.imul(m,le)|0;var Ae=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ye)|0)+Math.imul(y,pe)|0))<<13)|0;c=((s=s+Math.imul(y,ye)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(L,W),i=(i=Math.imul(L,Y))+Math.imul(N,W)|0,s=Math.imul(N,Y),n=n+Math.imul(C,Z)|0,i=(i=i+Math.imul(C,X)|0)+Math.imul(U,Z)|0,s=s+Math.imul(U,X)|0,n=n+Math.imul(O,Q)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(R,Q)|0,s=s+Math.imul(R,ee)|0,n=n+Math.imul(k,re)|0,i=(i=i+Math.imul(k,ne)|0)+Math.imul(T,re)|0,s=s+Math.imul(T,ne)|0,n=n+Math.imul(A,se)|0,i=(i=i+Math.imul(A,oe)|0)+Math.imul(I,se)|0,s=s+Math.imul(I,oe)|0,n=n+Math.imul(S,fe)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(B,fe)|0,s=s+Math.imul(B,ce)|0,n=n+Math.imul(v,ue)|0,i=(i=i+Math.imul(v,le)|0)+Math.imul(_,ue)|0,s=s+Math.imul(_,le)|0;var Ie=(c+(n=n+Math.imul(g,pe)|0)|0)+((8191&(i=(i=i+Math.imul(g,ye)|0)+Math.imul(m,pe)|0))<<13)|0;c=((s=s+Math.imul(m,ye)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(L,Z),i=(i=Math.imul(L,X))+Math.imul(N,Z)|0,s=Math.imul(N,X),n=n+Math.imul(C,Q)|0,i=(i=i+Math.imul(C,ee)|0)+Math.imul(U,Q)|0,s=s+Math.imul(U,ee)|0,n=n+Math.imul(O,re)|0,i=(i=i+Math.imul(O,ne)|0)+Math.imul(R,re)|0,s=s+Math.imul(R,ne)|0,n=n+Math.imul(k,se)|0,i=(i=i+Math.imul(k,oe)|0)+Math.imul(T,se)|0,s=s+Math.imul(T,oe)|0,n=n+Math.imul(A,fe)|0,i=(i=i+Math.imul(A,ce)|0)+Math.imul(I,fe)|0,s=s+Math.imul(I,ce)|0,n=n+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,le)|0)+Math.imul(B,ue)|0,s=s+Math.imul(B,le)|0;var xe=(c+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ye)|0)+Math.imul(_,pe)|0))<<13)|0;c=((s=s+Math.imul(_,ye)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(L,Q),i=(i=Math.imul(L,ee))+Math.imul(N,Q)|0,s=Math.imul(N,ee),n=n+Math.imul(C,re)|0,i=(i=i+Math.imul(C,ne)|0)+Math.imul(U,re)|0,s=s+Math.imul(U,ne)|0,n=n+Math.imul(O,se)|0,i=(i=i+Math.imul(O,oe)|0)+Math.imul(R,se)|0,s=s+Math.imul(R,oe)|0,n=n+Math.imul(k,fe)|0,i=(i=i+Math.imul(k,ce)|0)+Math.imul(T,fe)|0,s=s+Math.imul(T,ce)|0,n=n+Math.imul(A,ue)|0,i=(i=i+Math.imul(A,le)|0)+Math.imul(I,ue)|0,s=s+Math.imul(I,le)|0;var ke=(c+(n=n+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,ye)|0)+Math.imul(B,pe)|0))<<13)|0;c=((s=s+Math.imul(B,ye)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(L,re),i=(i=Math.imul(L,ne))+Math.imul(N,re)|0,s=Math.imul(N,ne),n=n+Math.imul(C,se)|0,i=(i=i+Math.imul(C,oe)|0)+Math.imul(U,se)|0,s=s+Math.imul(U,oe)|0,n=n+Math.imul(O,fe)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(R,fe)|0,s=s+Math.imul(R,ce)|0,n=n+Math.imul(k,ue)|0,i=(i=i+Math.imul(k,le)|0)+Math.imul(T,ue)|0,s=s+Math.imul(T,le)|0;var Te=(c+(n=n+Math.imul(A,pe)|0)|0)+((8191&(i=(i=i+Math.imul(A,ye)|0)+Math.imul(I,pe)|0))<<13)|0;c=((s=s+Math.imul(I,ye)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(L,se),i=(i=Math.imul(L,oe))+Math.imul(N,se)|0,s=Math.imul(N,oe),n=n+Math.imul(C,fe)|0,i=(i=i+Math.imul(C,ce)|0)+Math.imul(U,fe)|0,s=s+Math.imul(U,ce)|0,n=n+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,le)|0)+Math.imul(R,ue)|0,s=s+Math.imul(R,le)|0;var Pe=(c+(n=n+Math.imul(k,pe)|0)|0)+((8191&(i=(i=i+Math.imul(k,ye)|0)+Math.imul(T,pe)|0))<<13)|0;c=((s=s+Math.imul(T,ye)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(L,fe),i=(i=Math.imul(L,ce))+Math.imul(N,fe)|0,s=Math.imul(N,ce),n=n+Math.imul(C,ue)|0,i=(i=i+Math.imul(C,le)|0)+Math.imul(U,ue)|0,s=s+Math.imul(U,le)|0;var Oe=(c+(n=n+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,ye)|0)+Math.imul(R,pe)|0))<<13)|0;c=((s=s+Math.imul(R,ye)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(L,ue),i=(i=Math.imul(L,le))+Math.imul(N,ue)|0,s=Math.imul(N,le);var Re=(c+(n=n+Math.imul(C,pe)|0)|0)+((8191&(i=(i=i+Math.imul(C,ye)|0)+Math.imul(U,pe)|0))<<13)|0;c=((s=s+Math.imul(U,ye)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863;var Ke=(c+(n=Math.imul(L,pe))|0)+((8191&(i=(i=Math.imul(L,ye))+Math.imul(N,pe)|0))<<13)|0;return c=((s=Math.imul(N,ye))+(i>>>13)|0)+(Ke>>>26)|0,Ke&=67108863,f[0]=be,f[1]=ge,f[2]=me,f[3]=we,f[4]=ve,f[5]=_e,f[6]=Ee,f[7]=Se,f[8]=Be,f[9]=Me,f[10]=Ae,f[11]=Ie,f[12]=xe,f[13]=ke,f[14]=Te,f[15]=Pe,f[16]=Oe,f[17]=Re,f[18]=Ke,0!==c&&(f[19]=c,r.length++),r};function g(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var o=i;i=0;for(var a=67108863&n,f=Math.min(s,t.length-1),c=Math.max(0,s-e.length+1);c<=f;c++){var h=s-c,u=(0|e.words[h])*(0|t.words[c]),l=67108863&u;a=67108863&(l=l+a|0),i+=(o=(o=o+(u/67108864|0)|0)+(l>>>26)|0)>>>26,o&=67108863}r.words[s]=a,n=o,o=i}return 0!==n?r.words[s]=n:r.length--,r._strip()}function m(e,t,r){return g(e,t,r)}function w(e,t){this.x=e,this.y=t}Math.imul||(b=y),s.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?b(this,e,t):r<63?y(this,e,t):r<1024?g(this,e,t):m(this,e,t)},w.prototype.makeRBT=function(e){for(var t=new Array(e),r=s.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},w.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},w.prototype.permute=function(e,t,r,n,i,s){for(var o=0;o<s;o++)n[o]=t[e[o]],i[o]=r[e[o]]},w.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var o=1;o<i;o<<=1)for(var a=o<<1,f=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var u=f,l=c,d=0;d<o;d++){var p=r[h+d],y=n[h+d],b=r[h+d+o],g=n[h+d+o],m=u*b-l*g;g=u*g+l*b,b=m,r[h+d]=p+b,n[h+d]=y+g,r[h+d+o]=p-b,n[h+d+o]=y-g,d!==a&&(m=f*u-c*l,l=f*l+c*u,u=m)}},w.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},w.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},w.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},w.prototype.convert13b=function(e,t,r,i){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<i;++o)r[o]=0;n(0===s),n(!(-8192&s))},w.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},w.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),f=new Array(n),c=new Array(n),h=new Array(n),u=new Array(n),l=r.words;l.length=n,this.convert13b(e.words,e.length,o,n),this.convert13b(t.words,t.length,c,n),this.transform(o,s,a,f,n,i),this.transform(c,s,h,u,n,i);for(var d=0;d<n;d++){var p=a[d]*h[d]-f[d]*u[d];f[d]=a[d]*u[d]+f[d]*h[d],a[d]=p}return this.conjugate(a,f,n),this.transform(a,f,l,s,n,i),this.conjugate(l,s,n),this.normalize13b(l,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),m(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,o=(67108863&s)+(67108863&r);r>>=26,r+=s/67108864|0,r+=o>>>26,this.words[i]=67108863&o}return 0!==r&&(this.words[i]=r,this.length++),this.length=0===e?1:this.length,t?this.ineg():this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new s(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},s.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,f=(0|this.words[t])-a<<r;this.words[t]=f|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},s.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,o=Math.min((e-s)/26,this.length),a=67108863^67108863>>>s<<s,f=r;if(i-=o,i=Math.max(0,i),f){for(var c=0;c<o;c++)f.words[c]=this.words[c];f.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=i);c--){var u=0|this.words[c];this.words[c]=h<<26-s|u>>>s,h=u&a}return f&&0!==h&&(f.words[f.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r||!(this.words[r]&i))},s.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var i,s,o=e.length+r;this._expand(o);var a=0;for(i=0;i<e.length;i++){s=(0|this.words[i+r])+a;var f=(0|e.words[i])*t;a=((s-=67108863&f)>>26)-(f/67108864|0),this.words[i+r]=67108863&s}for(;i<this.length-r;i++)a=(s=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&s;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(s=-(0|this.words[i])+a)>>26,this.words[i]=67108863&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,o=0|i.words[i.length-1];0!=(r=26-this._countBits(o))&&(i=i.ushln(r),n.iushln(r),o=0|i.words[i.length-1]);var a,f=n.length-i.length;if("mod"!==t){(a=new s(null)).length=f+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var h=n.clone()._ishlnsubmul(i,1,f);0===h.negative&&(n=h,a&&(a.words[f]=1));for(var u=f-1;u>=0;u--){var l=67108864*(0|n.words[i.length+u])+(0|n.words[i.length+u-1]);for(l=Math.min(l/o|0,67108863),n._ishlnsubmul(i,l,u);0!==n.negative;)l--,n.negative=0,n._ishlnsubmul(i,1,u),n.isZero()||(n.negative^=1);a&&(a.words[u]=l)}return a&&a._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},s.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,o,a},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,s=this.length-1;s>=0;s--)i=(r*i+(0|this.words[s]))%e;return t?-i:i},s.prototype.modn=function(e){return this.modrn(e)},s.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*r;this.words[i]=s/e|0,r=s%e}return this._strip(),t?this.ineg():this},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new s(1),o=new s(0),a=new s(0),f=new s(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),u=t.clone();!t.isZero();){for(var l=0,d=1;0===(t.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(t.iushrn(l);l-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(h),o.isub(u)),i.iushrn(1),o.iushrn(1);for(var p=0,y=1;0===(r.words[0]&y)&&p<26;++p,y<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||f.isOdd())&&(a.iadd(h),f.isub(u)),a.iushrn(1),f.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),o.isub(f)):(r.isub(t),a.isub(i),f.isub(o))}return{a,b:f,gcd:r.iushln(c)}},s.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,o=new s(1),a=new s(0),f=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0===(t.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(t.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(f),o.iushrn(1);for(var u=0,l=1;0===(r.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(r.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(f),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return(i=0===t.cmpn(1)?o:a).cmpn(0)<0&&i.iadd(e),i},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return!(1&this.words[0])},s.prototype.isOdd=function(){return!(1&~this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var s=i,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return-1===this.cmpn(e)},s.prototype.lt=function(e){return-1===this.cmp(e)},s.prototype.lten=function(e){return this.cmpn(e)<=0},s.prototype.lte=function(e){return this.cmp(e)<=0},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new A(e)},s.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function B(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function M(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function I(e){A.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new s(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},i(E,_),E.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=s&r,i=10;i<e.length;i++){var o=0|e.words[i];e.words[i-10]=(o&r)<<4|s>>>22,s=o}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(S,_),i(B,_),i(M,_),M.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){if(v[e])return v[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new S;else if("p192"===e)t=new B;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new M}return v[e]=t,t},A.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},A.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},A.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(h(e,e.umod(this.m)._forceRed(this)),e)},A.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},A.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},A.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},A.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},A.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},A.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},A.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},A.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},A.prototype.isqr=function(e){return this.imul(e,e.clone())},A.prototype.sqr=function(e){return this.mul(e,e)},A.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);n(!i.isZero());var a=new s(1).toRed(this),f=a.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);0!==this.pow(h,c).cmp(f);)h.redIAdd(f);for(var u=this.pow(h,i),l=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=o;0!==d.cmp(a);){for(var y=d,b=0;0!==y.cmp(a);b++)y=y.redSqr();n(b<p);var g=this.pow(u,new s(1).iushln(p-b-1));l=l.redMul(g),u=g.redSqr(),d=d.redMul(u),p=b}return l},A.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},A.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],o=0,a=0,f=t.bitLength()%26;for(0===f&&(f=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],h=f-1;h>=0;h--){var u=c>>h&1;i!==r[0]&&(i=this.sqr(i)),0!==u||0!==o?(o<<=1,o|=u,(4===++a||0===n&&0===h)&&(i=this.mul(i,r[o]),a=0,o=0)):a=0}f=26}return i},A.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},A.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new I(e)},i(I,A),I.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},I.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},I.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},I.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},I.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},1729:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=void 0,t.isNode="undefined"==typeof window,t.isBrowser=!t.isNode},1863:(e,t,r)=>{var n=r(6192),i=r(9113),s=r(6671).Buffer,o=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function f(){this.init(),this._w=a,i.call(this,128,112)}function c(e,t,r){return r^e&(t^r)}function h(e,t,r){return e&t|r&(e|t)}function u(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function l(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function d(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function y(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function b(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function g(e,t){return e>>>0<t>>>0?1:0}n(f,i),f.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},f.prototype._update=function(e){for(var t=this._w,r=0|this._ah,n=0|this._bh,i=0|this._ch,s=0|this._dh,a=0|this._eh,f=0|this._fh,m=0|this._gh,w=0|this._hh,v=0|this._al,_=0|this._bl,E=0|this._cl,S=0|this._dl,B=0|this._el,M=0|this._fl,A=0|this._gl,I=0|this._hl,x=0;x<32;x+=2)t[x]=e.readInt32BE(4*x),t[x+1]=e.readInt32BE(4*x+4);for(;x<160;x+=2){var k=t[x-30],T=t[x-30+1],P=d(k,T),O=p(T,k),R=y(k=t[x-4],T=t[x-4+1]),K=b(T,k),C=t[x-14],U=t[x-14+1],D=t[x-32],L=t[x-32+1],N=O+U|0,H=P+C+g(N,O)|0;H=(H=H+R+g(N=N+K|0,K)|0)+D+g(N=N+L|0,L)|0,t[x]=H,t[x+1]=N}for(var F=0;F<160;F+=2){H=t[F],N=t[F+1];var j=h(r,n,i),z=h(v,_,E),q=u(r,v),V=u(v,r),G=l(a,B),W=l(B,a),Y=o[F],$=o[F+1],Z=c(a,f,m),X=c(B,M,A),J=I+W|0,Q=w+G+g(J,I)|0;Q=(Q=(Q=Q+Z+g(J=J+X|0,X)|0)+Y+g(J=J+$|0,$)|0)+H+g(J=J+N|0,N)|0;var ee=V+z|0,te=q+j+g(ee,V)|0;w=m,I=A,m=f,A=M,f=a,M=B,a=s+Q+g(B=S+J|0,S)|0,s=i,S=E,i=n,E=_,n=r,_=v,r=Q+te+g(v=J+ee|0,J)|0}this._al=this._al+v|0,this._bl=this._bl+_|0,this._cl=this._cl+E|0,this._dl=this._dl+S|0,this._el=this._el+B|0,this._fl=this._fl+M|0,this._gl=this._gl+A|0,this._hl=this._hl+I|0,this._ah=this._ah+r+g(this._al,v)|0,this._bh=this._bh+n+g(this._bl,_)|0,this._ch=this._ch+i+g(this._cl,E)|0,this._dh=this._dh+s+g(this._dl,S)|0,this._eh=this._eh+a+g(this._el,B)|0,this._fh=this._fh+f+g(this._fl,M)|0,this._gh=this._gh+m+g(this._gl,A)|0,this._hh=this._hh+w+g(this._hl,I)|0},f.prototype._hash=function(){var e=s.allocUnsafe(64);function t(t,r,n){e.writeInt32BE(t,n),e.writeInt32BE(r,n+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=f},1866:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyMaterial=u,t.getKey=l,t.decrypt=async function(e,t){if(!e.encryptInfo)return e.data;try{const r=await u(t),n=c.Buffer.from(e.encryptInfo.salt,"base64"),i=c.Buffer.from(e.encryptInfo.iv,"base64"),s=await l(r,n),o=a.createDecipheriv("aes-256-gcm",s,i),f=16,h=e.data.subarray(0,e.data.length-f),d=e.data.subarray(e.data.length-f);return o.setAuthTag(d),c.Buffer.concat([o.update(h),o.final()])}catch(e){return console.error("Decryption error:",e),null}},t.encrypt=async function(e,t){if(!e)return;const r=(0,h.randomBytes)(16),n=(0,h.randomBytes)(12),i=await u(e),s=await l(i,r),o=a.createCipheriv("aes-256-gcm",s,n),d=c.Buffer.concat([o.update(t),o.final()]),p=o.getAuthTag(),y=c.Buffer.concat([d,p]);return{version:1,encryptInfo:{...f.encryptInfo,iv:n.toString("base64"),salt:r.toString("base64")},data:y}};const a=o(r(4203)),f=r(5617),c=r(4686),h=r(5598);function u(e){const t=c.Buffer.from(e,"utf-8");return Promise.resolve(a.createSecretKey(t))}function l(e,t){return new Promise(r=>{const n=a.pbkdf2Sync(e.export(),t,f.encryptInfo.ITERATIONS,f.encryptInfo.DERIVED_KEY_LENGTH/8,f.encryptInfo.HASH.replace("-","").toLowerCase());r(c.Buffer.from(n))})}},1868:(e,t,r)=>{var n=r(5916);e.exports=function(e){return(new n).update(e).digest()}},1883:(e,t,r)=>{"use strict";const n=r(896),i=r(6899);class s extends n.Transform{constructor(e){super(e),this._writableState.objectMode=!1,this._readableState.objectMode=!0,this.bs=new i,this.__restart()}_transform(e,t,r){for(this.bs.write(e);this.bs.length>=this.__needed;){let e=null;const t=null===this.__needed?void 0:this.bs.read(this.__needed);try{e=this.__parser.next(t)}catch(e){return r(e)}this.__needed&&(this.__fresh=!1),e.done?(this.push(e.value),this.__restart()):this.__needed=e.value||1/0}return r()}*_parse(){throw new Error("Must be implemented in subclass")}__restart(){this.__needed=null,this.__parser=this._parse(),this.__fresh=!0}_flush(e){e(this.__fresh?null:new Error("unexpected end of input"))}}e.exports=s},2114:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(2655),s=r(5598),o=n(r(5550)),a=r(4686),f=-2,c=-1,h=(e,t)=>a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii"),a.Buffer.from([160+t.length]),a.Buffer.from(t,"ascii")]),u=(e,t)=>{const r=a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii")]);let n;return n=t.length<=65535?a.Buffer.from([197,t.length>>8&255,255&t.length]):a.Buffer.from([198,t.length>>24&255,t.length>>16&255,t.length>>8&255,255&t.length]),a.Buffer.concat([r,n,t])},l=(e,t)=>{const r=a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii")]);let n;if(t>=0&&t<=127)n=a.Buffer.from([t]);else if(t<0&&t>=-32)n=a.Buffer.from([t]);else if(t>0&&t<=255)n=a.Buffer.from([204,t]);else if(t>=-128&&t<=127)n=a.Buffer.from([208,t]);else if(t>0&&t<=65535)n=a.Buffer.from([205,t>>>8,t]);else if(t>=-32768&&t<=32767)n=a.Buffer.from([209,t>>>8,t]);else if(t>0&&t<=4294967295)n=a.Buffer.from([206,t>>>24,t>>>16,t>>>8,t]);else if(t>=-2147483648&&t<=2147483647)n=a.Buffer.from([210,t>>>24,t>>>16,t>>>8,t]);else if(t>0&&t<=0xffffffffffffffffn){const e=t/2**32,r=t%2**32;n=a.Buffer.from([211,e>>>24,e>>>16,e>>>8,e,r>>>24,r>>>16,r>>>8,r])}else n=a.Buffer.from([0]);return a.Buffer.concat([r,n])},d=e=>{const t=(0,i.decode)(a.Buffer.from(e)),r={state:f,error:""};t.version||(t.version=0);const n={...t,...r};try{if(n.timestamp&&n.protocol&&n.service)if(n.pk2||!n.pk1||n.sign1||n.sign2||16!==n.nonce?.length){if(!n.sign1&&32===n.nonce?.length&&n.pk1&&n.pk2&&n.sign2){n.state=1;const e=o.default.fromId(n.pk2),t=p(n);e.verifyChallenge(t,n.sign2,!0)||e.verifyChallenge_v0(t,n.sign2,!0,n.pk2)||(n.state=f,n.error="[STEP1] failed the verification of pk2")}else if(n.sign1&&32===n.nonce?.length&&n.pk1&&n.pk2&&n.sign2){n.state=2;const e=o.default.fromId(n.pk1),r=o.default.fromId(n.pk2);e.version===t.version&&r.version===t.version||(n.state=f,n.error="[COMPLETE] pk1 and pk2 are using different serialization version");const i=p(n);r.verifyChallenge(i,n.sign2,!0)||r.verifyChallenge_v0(i,n.sign2,!0,n.pk2)||(n.state=f,n.error="[COMPLETE] failed the verification of pk2"),e.verifyChallenge(i,n.sign1,!0)||e.verifyChallenge_v0(i,n.sign1,!0,n.pk1)||(n.state=f,n.error="[COMPLETE] failed the verification of pk1")}}else n.state=0;else n.state=f,n.error="[ERROR] Challenge is missing values"}catch(e){throw n.error="["+n.state+" -> ERROR] "+e,n.state=f,e}return n},p=e=>{const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,metadata:d}=e,p={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,metadata:d};return 0===t?(({version:e,protocol:t,service:r,timestamp:n,pk1:i,pk2:s,nonce:o,metadata:f})=>a.Buffer.concat([a.Buffer.from([135]),h("protocol",t),h("service",r),l("timestamp",n),u("pk1",i),u("pk2",s),u("nonce",o),a.Buffer.from([168]),a.Buffer.from("metadata","ascii"),a.Buffer.from([128])]))(p):a.Buffer.from((0,i.encode)(p))},y=(e,t,r=Date.now())=>e.timestamp>r-t&&e.timestamp<r+t;class b{constructor(e,t=6e4){this.version=0,this.state=c,this.vaultysId=o.default.fromSecret(e.getSecret()),this.liveliness=t}static async verifyCertificate(e){return 2===d(e).state}static async fromCertificate(e,t){const r=d(e);if(r.version||(r.version=0),0===r.state){const e=new b(o.default.fromId(r.pk1).toVersion(r.version),t);e.challenge=r,e.mykey=r.pk1,e.state=0}else if(1===r.state){const e=new b(o.default.fromId(r.pk2).toVersion(r.version),t);return e.challenge=r,e.mykey=r.pk2,e.hisKey=r.pk1,e.state=1,e}}async setChallenge(e){if(this.state!==c)throw this.state=f,new Error("Challenger already initialised, can't reset the state");if(this.challenge=d(e),this.version=this.challenge.version,!y(this.challenge,this.liveliness))throw this.state=f,this.challenge.error="challenge timestamp failed the liveliness at first signature",new Error(this.challenge.error);if(this.challenge.state===f)throw this.state=f,new Error(this.challenge.error);if(0===this.challenge.state){this.mykey=this.vaultysId.id,this.challenge.pk2=this.mykey,this.hisKey=this.challenge.pk1,this.challenge.nonce=a.Buffer.concat([this.challenge.nonce||new Uint8Array,(0,s.randomBytes)(16)]);const e=this.getUnsignedChallenge();if(!e)throw new Error("Error processing Challenge");this.challenge.sign2=await this.vaultysId.signChallenge(e)||void 0,this.challenge.state=this.state=1}else{if(2!==this.challenge.state)throw new Error("Challenge is from a protocol already launched, this is completely unsafe");if(this.mykey=this.vaultysId.id,!this.challenge.pk1?.equals(this.mykey)&&!this.challenge.pk1?.equals(this.mykey))throw this.state=f,new Error("Can't link the vaultys id to this challenge");this.state=2}}getContext(){return{protocol:this.challenge?.protocol,service:this.challenge?.service,metadata:this.challenge?.metadata}}createChallenge(e,t,r=0,n){if(this.version=r,this.state!=c)throw this.state=f,new Error("Challenger already initialised, can't reset the state");this.mykey=this.vaultysId.toVersion(r).id,this.challenge={version:r,protocol:e,service:t,metadata:n?{pk1:n}:{},timestamp:Date.now(),pk1:this.mykey,nonce:(0,s.randomBytes)(16),state:0},this.state=0}getCertificate(){return this.challenge&&(e=>{if(0==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,nonce:f,metadata:c}=e,h={version:t,protocol:r,service:n,timestamp:s,pk1:o,nonce:f,metadata:c},u=(0,i.encode)(h);return a.Buffer.from(u)}if(1==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign2:h,metadata:u}=e,l={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign2:h,metadata:u},d=(0,i.encode)(l);return a.Buffer.from(d)}if(2==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign1:h,sign2:u,metadata:l}=e,d={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign1:h,sign2:u,metadata:l},p=(0,i.encode)(d);return a.Buffer.from(p)}return null})(this.challenge)||a.Buffer.from([])}getUnsignedChallenge(){return p(this.challenge)}getContactDid(){return this.hisKey?o.default.fromId(this.hisKey).did:null}getContactId(){if(this.isComplete())return o.default.fromId(this.hisKey,this.getCertificate()||void 0);throw new Error("The challenge is not COMPLETE, it is unsafe to get the Contact ID before")}static fromString(e,t){const r=new b(e);return r.setChallenge(t),r}hasFailed(){return this.state==f}isComplete(){return 2==this.state}async init(e){if(this.state!==c)throw new Error("Can't init INITIALISED challenge");const t=d(e);if(this.version=t.version=t.version?1:0,this.vaultysId.toVersion(this.version),0===t.state){if(t.pk2?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");return this.challenge=t,this.version=t.version,this.mykey=this.challenge.pk2=this.vaultysId.id,this.hisKey=this.challenge.pk1,void(this.challenge.state=this.state=0)}if(1===t.state){if(t.pk2?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");return this.challenge=t,this.version=t.version,this.mykey=this.challenge.pk2,this.hisKey=this.challenge.pk1,void(this.state=this.challenge.state=1)}}async update(e,t){if(this.state===f)throw new Error("Can't update errorneous challenge");if(2===this.state)throw new Error("Can't update COMPLETE challenge");{const r=d(e);if(!r)throw this.state=f,new Error("Can't read the new incoming challenge");if(r.state===f)throw this.state=f,new Error(r.error);if(!y(r,this.liveliness))throw this.state=f,new Error("challenge timestamp failed the liveliness");if(this.version=r.version,this.vaultysId.toVersion(this.version),this.state===c&&0===r.state){if(r.metadata.pk2)throw this.state=f,new Error("Metadata is malformed: pk2 is already set");this.challenge=r,this.mykey=this.challenge.pk2=this.vaultysId.id,this.hisKey=this.challenge.pk1,t&&(this.challenge.metadata.pk2=t),this.challenge.nonce=a.Buffer.concat([this.challenge.nonce,(0,s.randomBytes)(16)]);const e=this.getUnsignedChallenge();return this.challenge.sign2=await this.vaultysId.signChallenge(e),void(this.challenge.state=this.state=1)}if(this.state===c&&1===r.state){if(r.pk1?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");const e=p(r);return r.sign1=await this.vaultysId.signChallenge(e),this.challenge=r,this.mykey=this.challenge.pk1,this.hisKey=this.challenge.pk2,void(this.state=this.challenge.state=2)}if(this.state===c&&2===r.state)return void console.log("COMPLETE case?!!");if(r.protocol!==this.challenge.protocol||r.service!==this.challenge.service)throw this.state=f,new Error(`The challenge was expecting protocol '${this.challenge.protocol}' and service '${this.challenge.service}', received '${r.protocol}' and '${r.service}'`);if(0===this.state&&1===r.state){if(!r.nonce?.subarray(0,16).equals(this.challenge.nonce.subarray(0,16)))throw this.state=f,new Error("Nonce has been tampered with");if(r.timestamp!==this.challenge?.timestamp)throw this.state=f,new Error("Timestamp has been tampered with");if(!this.mykey?.equals(r.pk1))throw this.state=f,new Error(`The challenge has been tampered with. Received pk1 = '${r.pk1}', expected pk1 = '${this.mykey}'`);const e=p(r);if(!e)throw this.state=f,new Error("Error processing Challenge");r.sign1=await this.vaultysId.signChallenge(e),this.challenge=r,this.hisKey=r.pk2,this.state=this.challenge.state=2}else{if(1!==this.state||2!==r.state){const e=`The challenge is in an expected state. Received state = '${r.state}', expected state = '${this.state+1}'`;throw this.state=f,new Error(e)}if(r.protocol!==this.challenge.protocol||r.service!==this.challenge.service)throw this.state=f,new Error(`The challenge was expecting protocol '${this.challenge.protocol}' and service '${this.challenge.service}', received '${r.protocol}' and '${r.service}'`);if(!r.nonce?.subarray(16,32).equals(this.challenge.nonce.subarray(16,32)))throw this.state=f,new Error("Nonce has been tampered with");if(r.timestamp!==this.challenge?.timestamp)throw this.state=f,new Error("Timestamp has been tampered with");if(!this.mykey.equals(r.pk2))throw this.state=f,new Error("The challenge pk2 has been tampered with");this.challenge=r,this.state=2}}}}b.deserializeCertificate=d,b.serializeCertificate_v0=({version:e,protocol:t,service:r,timestamp:n,pk1:i,pk2:s,nonce:o,sign1:f,sign2:c,metadata:d})=>a.Buffer.concat([a.Buffer.from([137]),h("protocol",t),h("service",r),l("timestamp",n),u("pk1",i),u("pk2",s),u("nonce",o),u("sign1",f),u("sign2",c),a.Buffer.from([168]),a.Buffer.from("metadata","ascii"),a.Buffer.from([128])]),b.serializeCertificate=p,t.default=b},2248:function(e,t,r){"use strict";var n,i=this&&this.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},s=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeWebAuthn=t.BrowserWebAuthn=void 0,t.getWebAuthnProvider=function(e){return"undefined"!=typeof window?new f:new c(e?.origin)},t.createCredentialRequest=function(e,t=!1){return a.default.createRequest(e,t)};const a=o(r(8886));class f{constructor(e="test"){this.origin=e}isAvailable(){return"undefined"!=typeof window&&void 0!==window.PublicKeyCredential}async create(e){if(!this.isAvailable())throw new Error("WebAuthn is not available in this environment");return await navigator.credentials.create({publicKey:e})}async get(e){if(!this.isAvailable())throw new Error("WebAuthn is not available in this environment");return await navigator.credentials.get({publicKey:e})}}t.BrowserWebAuthn=f;class c{constructor(e="test"){n.set(this,void 0),i(this,n,e,"f")}isAvailable(){return!0}async create(e){return await a.default.create({publicKey:e},s(this,n,"f"))}async get(e){return await a.default.get({publicKey:e},s(this,n,"f"))}}t.NodeWebAuthn=c,n=new WeakMap},2355:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p521_hasher=t.secp521r1=t.p521=t.p384_hasher=t.secp384r1=t.p384=t.p256_hasher=t.secp256r1=t.p256=void 0;const n=r(4072),i=r(5397),s=r(2844),o=r(7342),a=r(1164),f={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},c={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},h={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},u=(0,o.Field)(f.p),l=(0,o.Field)(c.p),d=(0,o.Field)(h.p);function p(e,t){const r=(0,a.mapToCurveSimpleSWU)(e,t);return e=>r(e[0])}t.p256=(0,i.createCurve)({...f,Fp:u,lowS:!1},n.sha256),t.secp256r1=t.p256,t.p256_hasher=(0,s.createHasher)(t.p256.Point,p(u,{A:f.a,B:f.b,Z:u.create(BigInt("-10"))}),{DST:"P256_XMD:SHA-256_SSWU_RO_",encodeDST:"P256_XMD:SHA-256_SSWU_NU_",p:f.p,m:1,k:128,expand:"xmd",hash:n.sha256}),t.p384=(0,i.createCurve)({...c,Fp:l,lowS:!1},n.sha384),t.secp384r1=t.p384,t.p384_hasher=(0,s.createHasher)(t.p384.Point,p(l,{A:c.a,B:c.b,Z:l.create(BigInt("-12"))}),{DST:"P384_XMD:SHA-384_SSWU_RO_",encodeDST:"P384_XMD:SHA-384_SSWU_NU_",p:c.p,m:1,k:192,expand:"xmd",hash:n.sha384}),t.p521=(0,i.createCurve)({...h,Fp:d,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},n.sha512),t.secp521r1=t.p521,t.p521_hasher=(0,s.createHasher)(t.p521.Point,p(d,{A:h.a,B:h.b,Z:d.create(BigInt("-4"))}),{DST:"P521_XMD:SHA-512_SSWU_RO_",encodeDST:"P521_XMD:SHA-512_SSWU_NU_",p:h.p,m:1,k:256,expand:"xmd",hash:n.sha512})},2404:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ml_dsa87=t.ml_dsa65=t.ml_dsa44=t.PARAMS=void 0;const n=r(5391),i=r(360),s=r(6215),o=256,a=8380417,f=0|Math.floor(95232),c=0|Math.floor(261888);t.PARAMS={2:{K:4,L:4,D:13,GAMMA1:2**17,GAMMA2:f,TAU:39,ETA:2,OMEGA:80},3:{K:6,L:5,D:13,GAMMA1:2**19,GAMMA2:c,TAU:49,ETA:4,OMEGA:55},5:{K:8,L:7,D:13,GAMMA1:2**19,GAMMA2:c,TAU:60,ETA:2,OMEGA:75}};const h=e=>new Int32Array(e),{mod:u,smod:l,NTT:d,bitsCoder:p}=(0,i.genCrystals)({N:o,Q:a,F:8347681,ROOT_OF_UNITY:1753,newPoly:h,isKyber:!1,brvBits:8}),y=e=>e,b=(e,t=y,r=y)=>p(e,{encode:e=>t(r(e)),decode:e=>r(t(e))}),g=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=u(e[r]+t[r]);return e},m=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=u(e[r]-t[r]);return e},w=e=>{for(let t=0;t<o;t++)e[t]<<=13;return e},v=(e,t)=>{for(let r=0;r<o;r++)if(Math.abs(l(e[r]))>=t)return!0;return!1},_=(e,t)=>{const r=h(o);for(let n=0;n<e.length;n++)r[n]=u(e[n]*t[n]);return r};function E(e){const t=h(o);for(let r=0;r<o;){const n=e();if(n.length%3)throw new Error("RejNTTPoly: unaligned block");for(let e=0;r<o&&e<=n.length-3;e+=3){const i=8388607&(n[e+0]|n[e+1]<<8|n[e+2]<<16);i<a&&(t[r++]=i)}}return t}function S(e){const{K:t,L:r,GAMMA1:i,GAMMA2:p,TAU:y,ETA:S,OMEGA:B}=e,{CRH_BYTES:M,TR_BYTES:A,C_TILDE_BYTES:I,XOF128:x,XOF256:k}=e;if(![2,4].includes(S))throw new Error("Wrong ETA");if(![1<<17,1<<19].includes(i))throw new Error("Wrong GAMMA1");if(![f,c].includes(p))throw new Error("Wrong GAMMA2");const T=y*S,P=e=>{const t=u(e),r=0|l(t,2*p);return t-r===a-1?{r1:0,r0:r-1|0}:{r1:0|Math.floor((t-r)/(2*p)),r0:r}},O=e=>P(e).r1,R=e=>P(e).r0,K=(e,t)=>e<=p||e>a-p||e===a-p&&0===t?0:1,C=(e,t)=>{const r=Math.floor((a-1)/(2*p)),{r1:n,r0:i}=P(t);return 1===e?i>0?0|u(n+1,r):0|u(n-1,r):0|n},U=e=>{const t=u(e),r=0|l(t,8192);return{r1:0|Math.floor((t-r)/8192),r0:r}},D={bytesLen:B+t,encode:e=>{if(!1===e)throw new Error("hint.encode: hint is false");const r=new Uint8Array(B+t);for(let n=0,i=0;n<t;n++){for(let t=0;t<o;t++)0!==e[n][t]&&(r[i++]=t);r[B+n]=i}return r},decode:e=>{const r=[];let n=0;for(let i=0;i<t;i++){const t=h(o);if(e[B+i]<n||e[B+i]>B)return!1;for(let r=n;r<e[B+i];r++){if(r>n&&e[r]<=e[r-1])return!1;t[e[r]]=1}n=e[B+i],r.push(t)}for(let t=n;t<B;t++)if(0!==e[t])return!1;return r}},L=b(2===S?3:4,e=>S-e,e=>{if(!(-S<=e&&e<=S))throw new Error(`malformed key s1/s3 ${e} outside of ETA range [${-S}, ${S}]`);return e}),N=b(13,e=>4096-e),H=b(10),F=b(i===1<<17?18:20,e=>l(i-e)),j=b(p===f?6:4),z=(0,s.vecCoder)(j,t),q=(0,s.splitCoder)(32,(0,s.vecCoder)(H,t)),V=(0,s.splitCoder)(32,32,A,(0,s.vecCoder)(L,r),(0,s.vecCoder)(L,t),(0,s.vecCoder)(N,t)),G=(0,s.splitCoder)(I,(0,s.vecCoder)(F,r),D),W=2===S?e=>e<15&&2-e%5:e=>e<9&&4-e;function Y(e){const t=h(o);for(let r=0;r<o;){const n=e();for(let e=0;r<o&&e<n.length;e+=1){const i=W(15&n[e]),s=W(n[e]>>4&15);!1!==i&&(t[r++]=i),r<o&&!1!==s&&(t[r++]=s)}}return t}const $=e=>{const t=h(o),r=n.shake256.create({}).update(e),i=new Uint8Array(n.shake256.blockLen);r.xofInto(i);const s=i.slice(0,8);for(let e=o-y,a=8,f=0,c=0;e<o;e++){let o=e+1;for(;o>e;)o=i[a++],a<n.shake256.blockLen||(r.xofInto(i),a=0);t[e]=t[o],t[o]=1-((s[f]>>c++&1)<<1),c>=8&&(f++,c=0)}return t},Z=e=>{const t=h(o),r=h(o);for(let n=0;n<e.length;n++){const{r0:i,r1:s}=U(e[n]);t[n]=i,r[n]=s}return{r0:t,r1:r}},X=(e,t)=>{for(let r=0;r<o;r++)e[r]=C(t[r],e[r]);return e},J=(e,t)=>{const r=h(o);let n=0;for(let i=0;i<o;i++){const s=K(e[i],t[i]);r[i]=s,n+=s}return{v:r,cnt:n}},Q=(0,s.splitCoder)(32,64,32),ee={signRandBytes:32,keygen:e=>{const i=new Uint8Array(34),a=void 0===e;a&&(e=(0,s.randomBytes)(32)),(0,s.ensureBytes)(e,32),i.set(e),a&&e.fill(0),i[32]=t,i[33]=r;const[f,c,u]=Q.decode((0,n.shake256)(i,{dkLen:Q.bytesLen})),l=k(c),p=[];for(let e=0;e<r;e++)p.push(Y(l.get(255&e,e>>8&255)));const y=[];for(let e=r;e<r+t;e++)y.push(Y(l.get(255&e,e>>8&255)));const b=p.map(e=>d.encode(e.slice())),m=[],w=[],v=x(f),S=h(o);for(let e=0;e<t;e++){S.fill(0);for(let t=0;t<r;t++){const r=E(v.get(t,e));g(S,_(r,b[t]))}d.decode(S);const{r0:t,r1:n}=Z(g(S,y[e]));m.push(t),w.push(n)}const B=q.encode([f,w]),M=(0,n.shake256)(B,{dkLen:A}),I=V.encode([f,u,M,p,y,m]);return v.clean(),l.clean(),(0,s.cleanBytes)(f,c,u,p,y,b,S,m,w,M,i),{publicKey:B,secretKey:I}},sign:(e,a,f,c=!1)=>{const[u,l,y,b,w,S]=V.decode(e),A=[],P=x(u);for(let e=0;e<t;e++){const t=[];for(let n=0;n<r;n++)t.push(E(P.get(n,e)));A.push(t)}P.clean();for(let e=0;e<r;e++)d.encode(b[e]);for(let e=0;e<t;e++)d.encode(w[e]),d.encode(S[e]);const K=c?a:n.shake256.create({dkLen:M}).update(y).update(a).digest(),C=f||new Uint8Array(32);(0,s.ensureBytes)(C);const U=n.shake256.create({dkLen:M}).update(l).update(C).update(K).digest();(0,s.ensureBytes)(U,M);const D=k(U,F.bytesLen);e:for(let e=0;;){const a=[];for(let t=0;t<r;t++,e++)a.push(F.decode(D.get(255&e,e>>8)()));const f=a.map(e=>d.encode(e.slice())),c=[];for(let e=0;e<t;e++){const t=h(o);for(let n=0;n<r;n++)g(t,_(A[e][n],f[n]));d.decode(t),c.push(t)}const u=c.map(e=>e.map(O)),l=n.shake256.create({dkLen:I}).update(K).update(z.encode(u)).digest(),y=d.encode($(l)),E=b.map(e=>_(e,y));for(let e=0;e<r;e++)if(g(d.decode(E[e]),a[e]),v(E[e],i-T))continue e;let M=0;const x=[];for(let e=0;e<t;e++){const t=d.decode(_(w[e],y)),r=m(c[e],t).map(R);if(v(r,p-T))continue e;const n=d.decode(_(S[e],y));if(v(n,p))continue e;g(r,n);const i=J(r,u[e]);x.push(i.v),M+=i.cnt}if(M>B)continue;D.clean();const k=G.encode([l,E,x]);return(0,s.cleanBytes)(l,E,x,y,u,c,f,a,U,K,b,w,S,...A),k}throw new Error("Unreachable code path reached, report this error")},verify:(e,a,f,c=!1)=>{const[u,l]=q.decode(e),p=(0,n.shake256)(e,{dkLen:A});if(f.length!==G.bytesLen)return!1;const[y,b,S]=G.decode(f);if(!1===S)return!1;for(let e=0;e<r;e++)if(v(b[e],i-T))return!1;const k=c?a:n.shake256.create({dkLen:M}).update(p).update(a).digest(),P=d.encode($(y)),O=b.map(e=>e.slice());for(let e=0;e<r;e++)d.encode(O[e]);const R=[],K=x(u);for(let e=0;e<t;e++){const t=_(d.encode(w(l[e])),P),n=h(o);for(let t=0;t<r;t++){const r=E(K.get(t,e));g(n,_(r,O[t]))}const i=d.decode(m(n,t));R.push(X(i,S[e]))}K.clean();const C=n.shake256.create({dkLen:I}).update(k).update(z.encode(R)).digest();for(const e of S)if(!(e.reduce((e,t)=>e+t,0)<=B))return!1;for(const e of b)if(v(e,i-T))return!1;return(0,s.equalBytes)(y,C)}};return{internal:ee,keygen:ee.keygen,signRandBytes:ee.signRandBytes,sign:(e,t,r=s.EMPTY,n)=>{const i=(0,s.getMessage)(t,r),o=ee.sign(e,i,n);return i.fill(0),o},verify:(e,t,r,n=s.EMPTY)=>ee.verify(e,(0,s.getMessage)(t,n),r),prehash:e=>({sign:(t,r,n=s.EMPTY,i)=>{const o=(0,s.getMessagePrehash)(e,r,n),a=ee.sign(t,o,i);return o.fill(0),a},verify:(t,r,n,i=s.EMPTY)=>ee.verify(t,(0,s.getMessagePrehash)(e,r,i),n)})}}t.ml_dsa44=S({...t.PARAMS[2],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:32,XOF128:i.XOF128,XOF256:i.XOF256}),t.ml_dsa65=S({...t.PARAMS[3],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:48,XOF128:i.XOF128,XOF256:i.XOF256}),t.ml_dsa87=S({...t.PARAMS[5],CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:64,XOF128:i.XOF128,XOF256:i.XOF256})},2496:(e,t,r)=>{var n=r(6192),i=r(9113),s=r(6671).Buffer,o=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function f(){this.init(),this._w=a,i.call(this,64,56)}function c(e){return e<<1|e>>>31}function h(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function l(e,t,r,n){return 0===e?t&r|~t&n:2===e?t&r|t&n|r&n:t^r^n}n(f,i),f.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},f.prototype._update=function(e){for(var t=this._w,r=0|this._a,n=0|this._b,i=0|this._c,s=0|this._d,a=0|this._e,f=0;f<16;++f)t[f]=e.readInt32BE(4*f);for(;f<80;++f)t[f]=c(t[f-3]^t[f-8]^t[f-14]^t[f-16]);for(var d=0;d<80;++d){var p=~~(d/20),y=h(r)+l(p,n,i,s)+a+t[d]+o[p]|0;a=s,s=i,i=u(n),n=r,r=y}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=a+this._e|0},f.prototype._hash=function(){var e=s.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=f},2521:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(9750),s=r(7261),o=r(4686),a=n(r(4406)),f=r(2655),c=r(6136),h=n(r(8887));c.ed25519.CURVE={...c.ed25519.CURVE},c.ed25519.CURVE.adjustScalarBytes=e=>(e[0]&=248,e[31]&=63,e[31]|=64,e);class u extends h.default{constructor(){super(),this.version=1,this.capability="private",this.authType="Ed25519VerificationKey2020"}static async createFromEntropy(e){const t=new u;t.entropy=e,t.capability="private";const r=(n=e,(0,s.hash)("sha512",n));var n;t.signer={publicKey:o.Buffer.from(c.ed25519.getPublicKey(r.slice(0,32))),secretKey:r.slice(0,32)};const i=a.default.box.keyPair.fromSecretKey(r.slice(32,64));return t.cypher={publicKey:o.Buffer.from(i.publicKey),secretKey:o.Buffer.from(i.secretKey)},t}static generate(){return u.createFromEntropy((0,s.randomBytes)(32))}get id(){return o.Buffer.from((0,f.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?(0,s.hmac)("sha256",o.Buffer.from(e.secretKey),"VaultysID/"+t+"/end"):void 0,signcrypt:async(t,r)=>(0,i.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,i.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>o.Buffer.from(a.default.scalarMult(e.secretKey,t))}}getSigner(){const e=this.signer.secretKey;return Promise.resolve({sign:t=>Promise.resolve(o.Buffer.from(c.ed25519.sign(t,e)))})}getSecret(){return o.Buffer.from((0,f.encode)({v:this.version,x:this.signer.secretKey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,f.decode)(e),r=new u;r.version=t.v??0,r.capability="private",r.signer={secretKey:t.x.slice(0,32),publicKey:o.Buffer.from(c.ed25519.getPublicKey(t.x.slice(0,32)))};const n=a.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:o.Buffer.from(n.publicKey),secretKey:o.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new u;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?o.Buffer.from(e.signer.publicKey.data):o.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?o.Buffer.from(e.cypher.publicKey.data):o.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,f.decode)(e),r=new u;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}verify(e,t,r){return c.ed25519.verify(t,e,this.signer.publicKey)}cleanSecureData(){this.cypher?.secretKey&&((0,s.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.signer?.secretKey&&((0,s.secureErase)(this.signer.secretKey),delete this.signer.secretKey),this.entropy&&((0,s.secureErase)(this.entropy),delete this.entropy)}}t.default=u},2655:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DecodeError:()=>a,Decoder:()=>K,EXT_TIMESTAMP:()=>u,Encoder:()=>E,ExtData:()=>o,ExtensionCodec:()=>v,decode:()=>C,decodeArrayStream:()=>N,decodeAsync:()=>L,decodeMulti:()=>U,decodeMultiStream:()=>H,decodeTimestampExtension:()=>m,decodeTimestampToTimeSpec:()=>g,encode:()=>S,encodeDateToTimeSpec:()=>y,encodeTimeSpecToTimestamp:()=>p,encodeTimestampExtension:()=>b});const n=new TextEncoder;function i(e,t,r){let n=t;const i=n+r,s=[];let o="";for(;n<i;){const t=e[n++];if(128&t)if(192==(224&t)){const r=63&e[n++];s.push((31&t)<<6|r)}else if(224==(240&t)){const r=63&e[n++],i=63&e[n++];s.push((31&t)<<12|r<<6|i)}else if(240==(248&t)){let r=(7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];r>65535&&(r-=65536,s.push(r>>>10&1023|55296),r=56320|1023&r),s.push(r)}else s.push(t);else s.push(t);s.length>=4096&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}const s=new TextDecoder;class o{constructor(e,t){this.type=e,this.data=t}}class a extends Error{constructor(e){super(e);const t=Object.create(a.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:a.name})}}const f=4294967295;function c(e,t,r){const n=Math.floor(r/4294967296),i=r;e.setUint32(t,n),e.setUint32(t+4,i)}function h(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}const u=-1,l=4294967295,d=17179869183;function p({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=d){if(0===t&&e<=l){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}{const r=e/4294967296,n=4294967295&e,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,t<<2|3&r),s.setUint32(4,n),i}}{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,t),c(n,4,e),r}}function y(e){const t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),i=Math.floor(n/1e9);return{sec:r+i,nsec:n-1e9*i}}function b(e){return e instanceof Date?p(y(e)):null}function g(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const e=t.getUint32(0);return{sec:4294967296*(3&e)+t.getUint32(4),nsec:e>>>2}}case 12:return{sec:h(t,4),nsec:t.getUint32(0)};default:throw new a(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}function m(e){const t=g(e);return new Date(1e3*t.sec+t.nsec/1e6)}const w={type:u,encode:b,decode:m};class v{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(w)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{const n=-1-e;this.builtInEncoders[n]=t,this.builtInDecoders[n]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){const n=this.builtInEncoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new o(-1-r,i)}}for(let r=0;r<this.encoders.length;r++){const n=this.encoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new o(r,i)}}return e instanceof o?e:null}decode(e,t,r){const n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new o(t,e)}}function _(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):function(e){return e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}(e)?new Uint8Array(e):Uint8Array.from(e)}v.defaultCodec=new v;class E{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??v.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??100,this.initialBufferSize=e?.initialBufferSize??2048,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new E({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){const t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){!1===e?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error(`Too long string: ${e} bytes in UTF-8`);this.writeU8(219),this.writeU32(e)}}encodeString(e){const t=function(e){const t=e.length;let r=0,n=0;for(;n<t;){let i=e.charCodeAt(n++);if(4294967168&i)if(4294965248&i){if(i>=55296&&i<=56319&&n<t){const t=e.charCodeAt(n);56320==(64512&t)&&(++n,i=((1023&i)<<10)+(1023&t)+65536)}r+=4294901760&i?4:3}else r+=2;else r++}return r}(e);var r,i,s;this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),r=e,i=this.bytes,s=this.pos,r.length>50?function(e,t,r){n.encodeInto(e,t.subarray(r))}(r,i,s):function(e,t,r){const n=e.length;let i=r,s=0;for(;s<n;){let r=e.charCodeAt(s++);if(4294967168&r){if(4294965248&r){if(r>=55296&&r<=56319&&s<n){const t=e.charCodeAt(s);56320==(64512&t)&&(++s,r=((1023&r)<<10)+(1023&t)+65536)}4294901760&r?(t[i++]=r>>18&7|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128):(t[i++]=r>>12&15|224,t[i++]=r>>6&63|128)}else t[i++]=r>>6&31|192;t[i++]=63&r|128}else t[i++]=r}}(r,i,s),this.pos+=t}encodeObject(e,t){const r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`);this.encodeMap(e,t)}}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large binary: ${t}`);this.writeU8(198),this.writeU32(t)}const r=_(e);this.writeU8a(r)}encodeArray(e,t){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error(`Too large array: ${r}`);this.writeU8(221),this.writeU32(r)}for(const r of e)this.doEncode(r,t+1)}countWithoutUndefined(e,t){let r=0;for(const n of t)void 0!==e[n]&&r++;return r}encodeMap(e,t){const r=Object.keys(e);this.sortKeys&&r.sort();const n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error(`Too large map object: ${n}`);this.writeU8(223),this.writeU32(n)}for(const n of r){const r=e[n];this.ignoreUndefined&&void 0===r||(this.encodeString(n),this.doEncode(r,t+1))}}encodeExtension(e){if("function"==typeof e.data){const t=e.data(this.pos+6),r=t.length;if(r>=4294967296)throw new Error(`Too large extension object: ${r}`);return this.writeU8(201),this.writeU32(r),this.writeI8(e.type),void this.writeU8a(t)}const t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large extension object: ${t}`);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),function(e,t,r){const n=r/4294967296,i=r;e.setUint32(t,n),e.setUint32(t+4,i)}(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),c(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function S(e,t){return new E(t).encodeSharedRef(e)}function B(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}const M="array",A="map_key",I="map_value",x=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new a("The type of key must be string or number but "+typeof e)};class k{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=M,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=A,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===M){const t=e;t.size=0,t.array=void 0,t.position=0,t.type=void 0}if(e.type===A||e.type===I){const t=e;t.size=0,t.map=void 0,t.readCount=0,t.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const T=new DataView(new ArrayBuffer(0)),P=new Uint8Array(T.buffer);try{T.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const O=new RangeError("Insufficient data"),R=new class{constructor(e=16,t=16){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let e=0;e<this.maxKeyLength;e++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){const n=this.caches[r-1];e:for(const i of n){const n=i.bytes;for(let i=0;i<r;i++)if(n[i]!==e[t+i])continue e;return i.str}return null}store(e,t){const r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)}decode(e,t,r){const n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;const s=i(e,t,r),o=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(o,s),s}};class K{constructor(e){this.totalPos=0,this.pos=0,this.view=T,this.bytes=P,this.headByte=-1,this.stack=new k,this.entered=!1,this.extensionCodec=e?.extensionCodec??v.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??f,this.maxBinLength=e?.maxBinLength??f,this.maxArrayLength=e?.maxArrayLength??f,this.maxMapLength=e?.maxMapLength??f,this.maxExtLength=e?.maxExtLength??f,this.keyDecoder=void 0!==e?.keyDecoder?e.keyDecoder:R,this.mapKeyConverter=e?.mapKeyConverter??x}clone(){return new K({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){const t=_(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){const t=this.bytes.subarray(this.pos),r=_(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:r}=this;return new RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){const t=this.clone();return void(yield*t.decodeMulti(e))}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let t,r=!1;for await(const n of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(n);try{t=this.doDecodeSync(),r=!0}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return t}const{headByte:n,pos:i,totalPos:s}=this;throw new RangeError(`Insufficient data in parsing ${B(n)} at ${s} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){const r=this.clone();return void(yield*r.decodeMultiAsync(e,t))}try{this.entered=!0;let r=t,n=-1;for await(const i of e){if(t&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(n=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),0!==--n;);}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const r=e-128;if(0!==r){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){const r=e-144;if(0!==r){this.pushArrayState(r),this.complete();continue e}t=[]}else{const r=e-160;t=this.decodeString(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){const e=this.lookU8();t=this.decodeString(e,1)}else if(218===e){const e=this.lookU16();t=this.decodeString(e,2)}else if(219===e){const e=this.lookU32();t=this.decodeString(e,4)}else if(220===e){const e=this.readU16();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(221===e){const e=this.readU32();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(222===e){const e=this.readU16();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(223===e){const e=this.readU32();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(196===e){const e=this.lookU8();t=this.decodeBinary(e,1)}else if(197===e){const e=this.lookU16();t=this.decodeBinary(e,2)}else if(198===e){const e=this.lookU32();t=this.decodeBinary(e,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){const e=this.lookU8();t=this.decodeExtension(e,1)}else if(200===e){const e=this.lookU16();t=this.decodeExtension(e,2)}else{if(201!==e)throw new a(`Unrecognized type byte: ${B(e)}`);{const e=this.lookU32();t=this.decodeExtension(e,4)}}this.complete();const r=this.stack;for(;r.length>0;){const e=r.top();if(e.type===M){if(e.array[e.position]=t,e.position++,e.position!==e.size)continue e;t=e.array,r.release(e)}else{if(e.type===A){if("__proto__"===t)throw new a("The key __proto__ is not allowed");e.key=this.mapKeyConverter(t),e.type=I;continue e}if(e.map[e.key]=t,e.readCount++,e.readCount!==e.size){e.key=null,e.type=A;continue e}t=e.map,r.release(e)}}return t}}readHeadByte(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new a(`Unrecognized array type byte: ${B(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new a(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new a(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){if(e>this.maxStrLength)throw new a(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw O;const r=this.pos+t;let n;return n=this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?this.keyDecoder.decode(this.bytes,r,e):function(e,t,r){return r>200?function(e,t,r){const n=e.subarray(t,t+r);return s.decode(n)}(e,t,r):i(e,t,r)}(this.bytes,r,e),this.pos+=t+e,n}stateIsMapKey(){return this.stack.length>0&&this.stack.top().type===A}decodeBinary(e,t){if(e>this.maxBinLength)throw new a(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw O;const r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n}decodeExtension(e,t){if(e>this.maxExtLength)throw new a(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=(t=this.view,r=this.pos,4294967296*t.getUint32(r)+t.getUint32(r+4));var t,r;return this.pos+=8,e}readI64(){const e=h(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function C(e,t){return new K(t).decode(e)}function U(e,t){return new K(t).decodeMulti(e)}function D(e){return null!=e[Symbol.asyncIterator]?e:async function*(e){const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)return;yield r}}finally{t.releaseLock()}}(e)}async function L(e,t){const r=D(e);return new K(t).decodeAsync(r)}function N(e,t){const r=D(e);return new K(t).decodeArrayStream(r)}function H(e,t){const r=D(e);return new K(t).decodeStream(r)}},2710:(e,t,r)=>{"use strict";var n=r(7902),i=r(756),s=r(1036),o=r(4797),a=r(3569),f=s.assert,c=r(7185),h=r(3544);function u(e){if(!(this instanceof u))return new u(e);"string"==typeof e&&(f(Object.prototype.hasOwnProperty.call(o,e),"Unknown curve "+e),e=o[e]),e instanceof o.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=u,u.prototype.keyPair=function(e){return new c(this,e)},u.prototype.keyFromPrivate=function(e,t){return c.fromPrivate(this,e,t)},u.prototype.keyFromPublic=function(e,t){return c.fromPublic(this,e,t)},u.prototype.genKeyPair=function(e){e||(e={});for(var t=new i({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),s=this.n.sub(new n(2));;){var o=new n(t.generate(r));if(!(o.cmp(s)>0))return o.iaddn(1),this.keyFromPrivate(o)}},u.prototype._truncateToN=function(e,t,r){var i;if(n.isBN(e)||"number"==typeof e)i=(e=new n(e,16)).byteLength();else if("object"==typeof e)i=e.length,e=new n(e,16);else{var s=e.toString();i=s.length+1>>>1,e=new n(s,16)}"number"!=typeof r&&(r=8*i);var o=r-this.n.bitLength();return o>0&&(e=e.ushrn(o)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},u.prototype.sign=function(e,t,r,s){if("object"==typeof r&&(s=r,r=null),s||(s={}),"string"!=typeof e&&"number"!=typeof e&&!n.isBN(e)){f("object"==typeof e&&e&&"number"==typeof e.length,"Expected message to be an array-like, a hex string, or a BN instance"),f(e.length>>>0===e.length);for(var o=0;o<e.length;o++)f((255&e[o])===e[o])}t=this.keyFromPrivate(t,r),e=this._truncateToN(e,!1,s.msgBitLength),f(!e.isNeg(),"Can not sign a negative message");var a=this.n.byteLength(),c=t.getPrivate().toArray("be",a),u=e.toArray("be",a);f(new n(u).eq(e),"Can not sign message");for(var l=new i({hash:this.hash,entropy:c,nonce:u,pers:s.pers,persEnc:s.persEnc||"utf8"}),d=this.n.sub(new n(1)),p=0;;p++){var y=s.k?s.k(p):new n(l.generate(this.n.byteLength()));if(!((y=this._truncateToN(y,!0)).cmpn(1)<=0||y.cmp(d)>=0)){var b=this.g.mul(y);if(!b.isInfinity()){var g=b.getX(),m=g.umod(this.n);if(0!==m.cmpn(0)){var w=y.invm(this.n).mul(m.mul(t.getPrivate()).iadd(e));if(0!==(w=w.umod(this.n)).cmpn(0)){var v=(b.getY().isOdd()?1:0)|(0!==g.cmp(m)?2:0);return s.canonical&&w.cmp(this.nh)>0&&(w=this.n.sub(w),v^=1),new h({r:m,s:w,recoveryParam:v})}}}}}},u.prototype.verify=function(e,t,r,n,i){i||(i={}),e=this._truncateToN(e,!1,i.msgBitLength),r=this.keyFromPublic(r,n);var s=(t=new h(t,"hex")).r,o=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a,f=o.invm(this.n),c=f.mul(e).umod(this.n),u=f.mul(s).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(c,r.getPublic(),u)).isInfinity()&&a.eqXToP(s):!(a=this.g.mulAdd(c,r.getPublic(),u)).isInfinity()&&0===a.getX().umod(this.n).cmp(s)},u.prototype.recoverPubKey=function(e,t,r,i){f((3&r)===r,"The recovery param is more than two bits"),t=new h(t,i);var s=this.n,o=new n(e),a=t.r,c=t.s,u=1&r,l=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");a=l?this.curve.pointFromX(a.add(this.curve.n),u):this.curve.pointFromX(a,u);var d=t.r.invm(s),p=s.sub(o).mul(d).umod(s),y=c.mul(d).umod(s);return this.g.mulAdd(p,a,y)},u.prototype.getKeyRecoveryParam=function(e,t,r,n){if(null!==(t=new h(t,n)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch(e){continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}},2739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5598),i=e=>{return t=(0,n.hash)("sha256",(0,n.fromHex)(e.replaceAll(" ",""))).toString("hex"),t.match(/.{1,4}/g)?.map(e=>parseInt(e,16).toString(2).padStart(16,"0"))||[];var t},s=(e,t)=>{const r=[];for(let n=0;n<16;n++){let i="";for(let r=0;r<16;r++){let s=0;for(let t=n-1;t<n+2;t++)for(let i=r-1;i<r+2;i++)t>-1&&t<16&&i>-1&&i<16&&(t==n&&i==r||"1"!=e[t][i]||s++);let o=!1;(3==s||2==s&&"1"==e[n][r])&&(o=!0),i+=o?"1":"O",t&&o&&t[n][r]++}r.push(i)}return r},o=(e,t=1)=>"hsl("+(240*(1-e)+t)+", 100%, 50%)",a=(e,t=2,r)=>{let n=1e3,i=0;const s=JSON.parse(JSON.stringify(e));for(let e=0;e<8;e++)for(let t=0;t<8;t++){s[e][t]=s[15-e][t]=s[e][15-t]=s[15-e][15-t]=s[e][t]+s[15-e][t]+s[e][15-t]+s[15-e][15-t];const r=s[e][t];r<n&&(n=r),r>i&&(i=r)}for(let e=0;e<16;e++)for(let a=0;a<16;a++){r.fillStyle=o(Math.floor((s[e][a]-n)*t/i)/t,i*i);let f=0+10*a,c=0+10*e;r.fillRect(f,c,10,10)}};t.default={renderFingerprint:(e,t,r=32)=>{let n=i(e.replaceAll(" ","")),o=n?.map(e=>e.split("").map(e=>parseInt(e)));const f=t.getContext("2d");if(f&&o){for(let e=0;e<r;e++)n=s(n,o);return a(o,3,f),t}},animateFingerprint:async(e,t,r=32,n=500)=>{let o=i(e.replaceAll(" ","")),f=o?.map(e=>e.split("").map(e=>parseInt(e)));const c=t.getContext("2d");if(c&&f){for(let e=0;e<r;e++)o=s(o,f),a(f,3,c),await new Promise(e=>setTimeout(e,n));return a(f,3,c),t}}}},2791:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4686),s=n(r(1691)),o=r(8045),a=n(r(5781)),f=n(r(9925)),c=r(1198),h=new(r(4872));class u{constructor(e){this.xprv=e}static fromEntropy(e){return new Promise((t,r)=>{o.pbkdf2("",e,4096,96,"sha512",(e,n)=>{e&&r(e),n[0]&=248,n[31]&=31,n[31]|=64,t(new u(n))})})}derive(e){const t=this.xprv.slice(0,32),r=this.xprv.slice(32,64),n=this.xprv.slice(64,96);let o,a;if(e<c.HARDENED_OFFSET){const r=i.Buffer.allocUnsafe(37);r.writeUInt32LE(e,33);const s=h.keyFromSecret(t.toString("hex"));i.Buffer.from(s.pubBytes()).copy(r,1),r[0]=2,o=c.hmac512(n,r),r[0]=3,a=c.hmac512(n,r)}else{const s=i.Buffer.allocUnsafe(69);s.writeUInt32LE(e,65),t.copy(s,1),r.copy(s,33),s[0]=0,o=c.hmac512(n,s),s[0]=1,a=c.hmac512(n,s)}const f=a.slice(32,64),l=o.slice(0,32),d=o.slice(32,64),p=new s.default(t,16,"le").add(new s.default(l.slice(0,28),16,"le").mul(new s.default(8))).toArrayLike(i.Buffer,"le",32);let y=new s.default(r,16,"le").add(new s.default(d,16,"le")).toArrayLike(i.Buffer,"le").slice(0,32);32!==y.length&&(y=i.Buffer.from(y.toString("hex").padEnd(32,"0"),"hex"));const b=i.Buffer.concat([p,y,f]);return new u(b)}deriveHardened(e){return this.derive(e+c.HARDENED_OFFSET)}derivePath(e){return e.split("/").reduce((e,t,r)=>{if(0===r&&"m"===t)return e;if("'"===t.slice(-1)){const r=parseInt(t.slice(0,-1),10);return e.deriveHardened(r)}const n=parseInt(t,10);return e.derive(n)},this)}toBip32PublicKey(){const e=h.keyFromSecret(this.xprv.slice(0,32).toString("hex")),t=i.Buffer.from(e.pubBytes());return new a.default(i.Buffer.concat([t,this.xprv.slice(64,96)]))}toBytes(){return this.xprv}toPrivateKey(){const e=h.keyFromSecret(this.xprv.slice(0,64));return new f.default(i.Buffer.from(e.privBytes()))}}t.default=u},2810:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Ed25519Manager=t.Fido2PRFManager=t.Fido2Manager=t.DilithiumManager=t.HybridManager=void 0;const i=n(r(212));t.DilithiumManager=i.default;const s=n(r(7603));t.HybridManager=s.default;const o=n(r(1449));t.Fido2Manager=o.default;const a=n(r(9463));t.Fido2PRFManager=a.default;const f=n(r(8676));t.Ed25519Manager=f.default;const c=n(r(3616));t.default=c.default},2844:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expand_message_xmd=c,t.expand_message_xof=h,t.hash_to_field=u,t.isogenyMap=function(e,t){const r=t.map(e=>Array.from(e).reverse());return(t,n)=>{const[s,o,a,f]=r.map(r=>r.reduce((r,n)=>e.add(e.mul(r,t),n))),[c,h]=(0,i.FpInvertBatch)(e,[o,f],!0);return t=e.mul(s,c),n=e.mul(n,e.mul(a,h)),{x:t,y:n}}},t.createHasher=function(e,t,r){if("function"!=typeof t)throw new Error("mapToCurve() must be defined");function n(r){return e.fromAffine(t(r))}function i(t){const r=t.clearCofactor();return r.equals(e.ZERO)?e.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(e,t){const s=r.DST?r.DST:{},o=u(e,2,Object.assign({},r,s,t)),a=n(o[0]),f=n(o[1]);return i(a.add(f))},encodeToCurve(e,t){const s=r.encodeDST?r.encodeDST:{};return i(n(u(e,1,Object.assign({},r,s,t))[0]))},mapToCurve(e){if(!Array.isArray(e))throw new Error("expected array of bigints");for(const t of e)if("bigint"!=typeof t)throw new Error("expected array of bigints");return i(n(e))}}};const n=r(6376),i=r(7342),s=n.bytesToNumberBE;function o(e,t){if(f(e),f(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=255&e,e>>>=8;return new Uint8Array(r)}function a(e,t){const r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}function f(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function c(e,t,r,i){(0,n.abytes)(e),(0,n.abytes)(t),f(r),t.length>255&&(t=i((0,n.concatBytes)((0,n.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));const{outputLen:s,blockLen:c}=i,h=Math.ceil(r/s);if(r>65535||h>255)throw new Error("expand_message_xmd: invalid lenInBytes");const u=(0,n.concatBytes)(t,o(t.length,1)),l=o(0,c),d=o(r,2),p=new Array(h),y=i((0,n.concatBytes)(l,e,d,o(0,1),u));p[0]=i((0,n.concatBytes)(y,o(1,1),u));for(let e=1;e<=h;e++){const t=[a(y,p[e-1]),o(e+1,1),u];p[e]=i((0,n.concatBytes)(...t))}return(0,n.concatBytes)(...p).slice(0,r)}function h(e,t,r,i,s){if((0,n.abytes)(e),(0,n.abytes)(t),f(r),t.length>255){const e=Math.ceil(2*i/8);t=s.create({dkLen:e}).update((0,n.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:r}).update(e).update(o(r,2)).update(t).update(o(t.length,1)).digest()}function u(e,t,r){(0,n._validateObject)(r,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:o,k:a,m:u,hash:l,expand:d,DST:p}=r;if(!(0,n.isBytes)(p)&&"string"!=typeof p)throw new Error("DST must be string or uint8array");if(!(0,n.isHash)(r.hash))throw new Error("expected valid hash");(0,n.abytes)(e),f(t);const y="string"==typeof p?(0,n.utf8ToBytes)(p):p,b=o.toString(2).length,g=Math.ceil((b+a)/8),m=t*u*g;let w;if("xmd"===d)w=c(e,y,m,l);else if("xof"===d)w=h(e,y,m,a,l);else{if("_internal_pass"!==d)throw new Error('expand must be "xmd" or "xof"');w=e}const v=new Array(t);for(let e=0;e<t;e++){const t=new Array(u);for(let r=0;r<u;r++){const n=g*(r+e*u),a=w.subarray(n,n+g);t[r]=(0,i.mod)(s(a),o)}v[e]=t}return v}},2862:(e,t,r)=>{"use strict";var n=r(8704).F.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(s||i);var o=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,f=function(){t.writable||h()},c=t._writableState&&t._writableState.finished,h=function(){a=!1,c=!0,o||s.call(t)},u=t._readableState&&t._readableState.endEmitted,l=function(){o=!1,u=!0,a||s.call(t)},d=function(e){s.call(t,e)},p=function(){var e;return o&&!u?(t._readableState&&t._readableState.ended||(e=new n),s.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new n),s.call(t,e)):void 0},y=function(){t.req.on("finish",h)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",h),t.on("abort",p),t.req?y():t.on("request",y)):a&&!t._writableState&&(t.on("end",f),t.on("close",f)),t.on("end",l),t.on("finish",h),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",h),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",h),t.removeListener("end",f),t.removeListener("close",f),t.removeListener("finish",h),t.removeListener("end",l),t.removeListener("error",d),t.removeListener("close",p)}}},2991:(e,t,r)=>{"use strict";t.sha1=r(7267),t.sha224=r(8496),t.sha256=r(1413),t.sha384=r(9281),t.sha512=r(9952)},3004:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryChannel=void 0,t.pipeChannels=function(e,t){let r=!0;return(async()=>{try{for(await e.start(),await t.start(),console.log("pipe1to2");r;)try{const n=await e.receive();if(console.log("pipe1to2",n),!r||0===n.length)break;t.send(n)}catch(e){r&&console.error("Error in pipe1to2:",e);break}}catch(e){console.error("Fatal error in pipe1to2:",e)}})(),(async()=>{try{for(;r;){console.log("pipe2to1");try{const n=await t.receive();if(console.log("pipe2to1",n),!r||0===n.length)break;e.send(n)}catch(e){r&&console.error("Error in pipe2to1:",e);break}}}catch(e){console.error("Fatal error in pipe2to1:",e)}})(),async()=>{r=!1,await Promise.all([e.close(),t.close()])}},t.unpipeChannels=async function(e,t){await Promise.all([e.close(),t.close()])},t.StreamChannel=function(e){const t=()=>new s.Stream.Writable({write:(t,r,n)=>{e.send(t),n()}}),r=async r=>new Promise(n=>{const i=t();r.pipe(i).once("finish",()=>{e.send(o.Buffer.from("EOF","utf-8")),i.end(),n()})}),n=()=>{let t,r;const n=new s.Stream.Readable({read(){t=e=>this.push(e)}});return(async t=>{let r=await e.receive();for(;r;){if(t(r),"EOF"===r.toString("utf-8"))return;r=await e.receive()}})(e=>{3===e.length&&"EOF"===e.toString("utf-8")&&t&&(r&&t(r),t(null),n.destroy()),r=r?o.Buffer.concat([r,e]):e,t&&(!t(r)&&(t=null),r=null)}),n};return{getReadStream:n,getWriteStream:t,upload:r,uploadData:async e=>{const t=s.Readable.from(e);await r(t)},download:async e=>{const t=n(),r=new Promise(e=>t.on("end",()=>{e()}));t.pipe(e),await r},downloadData:async()=>{const e=n(),t=[],r=new Promise(r=>e.on("end",()=>{r(o.Buffer.concat(t))})),i=new s.Stream.Writable({write:(e,r,n)=>{t.push(e),n()}});return e.pipe(i),r}}},t.convertWebWritableStreamToNodeWritable=function(e){const t=e.getWriter();return new s.Writable({async write(e,r,n){try{await t.write(e),t.releaseLock(),n()}catch(e){n()}},async final(t){try{const r=e.getWriter();await r.close(),r.releaseLock(),t()}catch(e){t()}},async destroy(t,r){try{const n=e.getWriter();await n.abort(t),n.releaseLock(),r(t)}catch(e){r(null)}}})},t.convertWebReadableStreamToNodeReadable=function(e){const t=e.getReader();return new s.Readable({async read(){try{for(;;){const{done:e,value:r}=await t.read();if(e){this.push(null);break}this.push(o.Buffer.from(r))}}catch(e){this.destroy()}}})};const i=n(r(9910)),s=r(896),o=r(4686);class a{constructor(){this.messageQueue=[],this.waitingResolvers=[],this.connected=!1,this.connectedCallbacks=[],this.closed=!1}setChannel(e,t){this.name=t,this.otherend=e}static createBidirectionnal(){const e=new a,t=new a;return e.setChannel(t),t.setChannel(e),e}onConnected(e){this.connected?e():this.connectedCallbacks.push(e)}static createEncryptedBidirectionnal(e=i.default.generateKey()){const t=i.default.encryptChannel(new a,e),r=i.default.encryptChannel(new a,e);return t.setChannel(r),r.setChannel(t),t}getConnectionString(){return"vaultys://memory"}fromConnectionString(e){return"vaultys://memory"===e?new a:null}setLogger(e){this.logger=e}setInjector(e){this.injector=e}async start(){this.connected=!0,this.connectedCallbacks.forEach(e=>e()),this.connectedCallbacks=[]}async send(e){if(this.closed)throw new Error("Cannot send on closed channel");if(!this.otherend)throw new Error("No other end connected to this channel");this.logger&&this.logger(e);let t=e;this.injector&&(t=await this.injector(e)),this.connected||await this.start(),this.otherend.deliverMessage(t)}deliverMessage(e){this.waitingResolvers.length>0?this.waitingResolvers.shift()(e):this.messageQueue.push(e)}async receive(){if(this.closed)throw new Error("Cannot receive on closed channel");return this.messageQueue.length>0?this.messageQueue.shift():new Promise(e=>{this.waitingResolvers.push(e)})}async close(){for(this.closed=!0;this.waitingResolvers.length>0;)this.waitingResolvers.shift()(o.Buffer.alloc(0));this.messageQueue=[]}}t.MemoryChannel=a},3019:(e,t,r)=>{"use strict";const n=r(1362).utils,i=n.assert,s=n.parseBytes,o=n.cachedProperty;function a(e,t){this.eddsa=e,this._secret=s(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=s(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret.slice(0,32)},o(a,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),o(a,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.kl())}),o(a,"privBytes",function(){return this._secret}),o(a,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),o(a,"kl",function(){return this.eddsa.decodeInt(this.privBytes().slice(0,32))}),o(a,"messagePrefix",function(){return this._secret.slice(32,64)}),a.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.signExtended(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},e.exports=a},3028:()=>{},3051:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.SymmetricKeyRecipient=void 0;const i=r(4406),s=r(568),o=r(3835),a=r(4072);t.SymmetricKeyRecipient=class{constructor(e,t){this.recipient_identifier=e,this.key=t}};class f{constructor(e,t,r){if(!(0,s.isBufferOrUint8Array)(e)||32!==e.length)throw new TypeError("recipient_identifier must be a 32 byte Uint8Array");if(!(0,s.isBufferOrUint8Array)(t)||48!==t.length)throw new TypeError("payload_key_box must be a 48 byte Uint8Array");if("bigint"!=typeof r)throw new TypeError("index must be a bigint");this.recipient_identifier=e,this.encrypted_payload_key=t,this.index=r,this.recipient_index=f.generateRecipientIndex(r)}static create(e,t,r,n){"number"==typeof n&&(n=BigInt(n));const s=this.generateRecipientIndex(n),{shared_symmetric_key:o,recipient_identifier:a}=this.generateRecipientIdentifierForSender(e,t,s);return new this(a,(0,i.secretbox)(Uint8Array.from(r),Uint8Array.from(s),Uint8Array.from(o)),n)}static createSymmetric(e,t,r,s,f){"number"==typeof f&&(f=BigInt(f));const c=n.from((0,o.hmac)(a.sha512,this.HMAC_KEY_SYMMETRIC,n.concat([r,e])).slice(0,32)),h=this.generateRecipientIndex(f);return new this(t,(0,i.secretbox)(Uint8Array.from(s),Uint8Array.from(h),Uint8Array.from(c)),f)}static from(e,t,r){return"number"==typeof r&&(r=BigInt(r)),new this(e,t,r)}static generateRecipientIndex(e){const t=n.alloc(8);return t.writeBigUInt64BE(e),n.concat([this.PAYLOAD_KEY_BOX_NONCE_PREFIX_V2,t])}decryptPayloadKey(e){return i.secretbox.open(Uint8Array.from(this.encrypted_payload_key),Uint8Array.from(this.recipient_index),Uint8Array.from(e))}static generateRecipientIdentifierForSender(e,t,r){const s=n.from((0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(this.SHARED_KEY_NONCE),Uint8Array.from(e),Uint8Array.from(t))).slice(-32);return{shared_symmetric_key:s,recipient_identifier:n.from((0,o.hmac)(a.sha512,this.HMAC_KEY,n.concat([s,r])).slice(0,32))}}static generateRecipientIdentifierForRecipient(e,t,r){const s=n.from((0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(this.SHARED_KEY_NONCE),Uint8Array.from(e),Uint8Array.from(t))).slice(-32);return{shared_symmetric_key:s,recipient_identifier:n.from((0,o.hmac)(a.sha512,this.HMAC_KEY,n.concat([s,r])).slice(0,32))}}}f.SHARED_KEY_NONCE=n.from("saltpack_derived_sboxkey"),f.HMAC_KEY=n.from("saltpack signcryption box key identifier"),f.HMAC_KEY_SYMMETRIC=n.from("saltpack signcryption derived symmetric key"),f.PAYLOAD_KEY_BOX_NONCE_PREFIX_V2=n.from("saltpack_recipsb"),t.default=f},3061:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryChannel=void 0,t.pipeChannels=function(e,t){let r=!0;return(async()=>{try{for(await e.start(),await t.start(),console.log("pipe1to2");r;)try{const n=await e.receive();if(console.log("pipe1to2",n),!r||0===n.length)break;t.send(n)}catch(e){r&&console.error("Error in pipe1to2:",e);break}}catch(e){console.error("Fatal error in pipe1to2:",e)}})(),(async()=>{try{for(;r;){console.log("pipe2to1");try{const n=await t.receive();if(console.log("pipe2to1",n),!r||0===n.length)break;e.send(n)}catch(e){r&&console.error("Error in pipe2to1:",e);break}}}catch(e){console.error("Fatal error in pipe2to1:",e)}})(),async()=>{r=!1,await Promise.all([e.close(),t.close()])}},t.unpipeChannels=async function(e,t){await Promise.all([e.close(),t.close()])},t.StreamChannel=function(e){const t=()=>new s.Stream.Writable({write:(t,r,n)=>{e.send(t),n()}}),r=async r=>new Promise(n=>{const i=t();r.pipe(i).once("finish",()=>{e.send(o.Buffer.from("EOF","utf-8")),i.end(),n()})}),n=()=>{let t,r;const n=new s.Stream.Readable({read(){t=e=>this.push(e)}});return(async t=>{let r=await e.receive();for(;r;){if(t(r),"EOF"===r.toString("utf-8"))return;r=await e.receive()}})(e=>{3===e.length&&"EOF"===e.toString("utf-8")&&t&&(r&&t(r),t(null),n.destroy()),r=r?o.Buffer.concat([r,e]):e,t&&(!t(r)&&(t=null),r=null)}),n};return{getReadStream:n,getWriteStream:t,upload:r,uploadData:async e=>{const t=s.Readable.from(e);await r(t)},download:async e=>{const t=n(),r=new Promise(e=>t.on("end",()=>{e()}));t.pipe(e),await r},downloadData:async()=>{const e=n(),t=[],r=new Promise(r=>e.on("end",()=>{r(o.Buffer.concat(t))})),i=new s.Stream.Writable({write:(e,r,n)=>{t.push(e),n()}});return e.pipe(i),r}}},t.convertWebWritableStreamToNodeWritable=function(e){const t=e.getWriter();return new s.Writable({async write(e,r,n){try{await t.write(e),t.releaseLock(),n()}catch(e){n()}},async final(t){try{const r=e.getWriter();await r.close(),r.releaseLock(),t()}catch(e){t()}},async destroy(t,r){try{const n=e.getWriter();await n.abort(t),n.releaseLock(),r(t)}catch(e){r(null)}}})},t.convertWebReadableStreamToNodeReadable=function(e){const t=e.getReader();return new s.Readable({async read(){try{for(;;){const{done:e,value:r}=await t.read();if(e){this.push(null);break}this.push(o.Buffer.from(r))}}catch(e){this.destroy()}}})};const i=n(r(4015)),s=r(896),o=r(4686);class a{constructor(){this.messageQueue=[],this.waitingResolvers=[],this.connected=!1,this.connectedCallbacks=[],this.closed=!1}setChannel(e,t){this.name=t,this.otherend=e}static createBidirectionnal(){const e=new a,t=new a;return e.setChannel(t),t.setChannel(e),e}onConnected(e){this.connected?e():this.connectedCallbacks.push(e)}static createEncryptedBidirectionnal(e=i.default.generateKey()){const t=i.default.encryptChannel(new a,e),r=i.default.encryptChannel(new a,e);return t.setChannel(r),r.setChannel(t),t}getConnectionString(){return"vaultys://memory"}fromConnectionString(e){return"vaultys://memory"===e?new a:null}setLogger(e){this.logger=e}setInjector(e){this.injector=e}async start(){this.connected=!0,this.connectedCallbacks.forEach(e=>e()),this.connectedCallbacks=[]}async send(e){if(this.closed)throw new Error("Cannot send on closed channel");if(!this.otherend)throw new Error("No other end connected to this channel");this.logger&&this.logger(e);let t=e;this.injector&&(t=await this.injector(e)),this.connected||await this.start(),this.otherend.deliverMessage(t)}deliverMessage(e){this.waitingResolvers.length>0?this.waitingResolvers.shift()(e):this.messageQueue.push(e)}async receive(){if(this.closed)throw new Error("Cannot receive on closed channel");return this.messageQueue.length>0?this.messageQueue.shift():new Promise(e=>{this.waitingResolvers.push(e)})}async close(){for(this.closed=!0;this.waitingResolvers.length>0;)this.waitingResolvers.shift()(o.Buffer.alloc(0));this.messageQueue=[]}}t.MemoryChannel=a},3105:(e,t,r)=>{"use strict";const n=r(3271),i=r(5706),{Buffer:s}=r(4686);class o extends n{constructor(e){super(e),this.valueSharing=new i}_pushObject(e,t){if(null!==e){const t=this.valueSharing.check(e);switch(t){case i.FIRST:this._pushTag(28);break;case i.NEVER:break;default:return this._pushTag(29)&&this._pushIntNum(t)}}return super._pushObject(e,t)}stopRecording(){this.valueSharing.stop()}clearRecording(){this.valueSharing.clear()}static encode(...e){const t=new o;t.on("data",()=>{});for(const r of e)t.pushAny(r);return t.stopRecording(),t.removeAllListeners("data"),t._encodeAll(e)}static encodeCanonical(...e){throw new Error("Cannot encode canonically in a SharedValueEncoder, which serializes objects multiple times.")}static encodeOne(e,t){const r=new o(t);return r.on("data",()=>{}),r.pushAny(e),r.stopRecording(),r.removeAllListeners("data"),r._encodeAll([e])}static encodeAsync(e,t){return new Promise((r,n)=>{const i=[],a=new o(t);a.on("data",()=>{}),a.on("error",n),a.on("finish",()=>r(s.concat(i))),a.pushAny(e),a.stopRecording(),a.removeAllListeners("data"),a.on("data",e=>i.push(e)),a.pushAny(e),a.end()})}}e.exports=o},3127:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.platformCrypto=void 0;const n=r(4048),i=r(9071),s=r(9495);t.platformCrypto=n.isNode?i.NodeCrypto:s.BrowserCrypto},3144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.edwards=u,t.eddsa=l,t.twistedEdwards=function(e){const{CURVE:t,curveOpts:r,eddsaOpts:n}=function(e){const t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:(0,s.Field)(t.n,e.nBitLength,!0),uvRatio:e.uvRatio},eddsaOpts:{hash:e.hash,randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve}}}(e);return function(e,t){return Object.assign({},t,{ExtendedPoint:t.Point,CURVE:e})}(e,l(u(t,r),n))};const n=r(6376),i=r(407),s=r(7342),o=BigInt(0),a=BigInt(1),f=BigInt(2),c=BigInt(8),h={zip215:!0};function u(e,t={}){const{Fp:r,Fn:s}=(0,i._createCurveFields)("edwards",e,t),{h,n:u}=e;(0,n._validateObject)(t,{},{uvRatio:"function"});const l=f<<BigInt(8*s.BYTES)-a,d=e=>r.create(e),p=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(r.div(e,t))}}catch(e){return{isValid:!1,value:o}}});if(!function(e,t,r,n){const i=e.sqr(r),s=e.sqr(n),o=e.add(e.mul(t.a,i),s),a=e.add(e.ONE,e.mul(t.d,e.mul(i,s)));return e.eql(o,a)}(r,e,e.Gx,e.Gy))throw new Error("bad curve params: generator point");function y(e,t,r=!1){const i=r?a:o;return(0,n.aInRange)("coordinate "+e,t,i,l),t}function b(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}const g=(0,n.memoized)((e,t)=>{const{ex:n,ey:i,ez:s}=e,f=e.is0();null==t&&(t=f?c:r.inv(s));const h=d(n*t),u=d(i*t),l=d(s*t);if(f)return{x:o,y:a};if(l!==a)throw new Error("invZ was invalid");return{x:h,y:u}}),m=(0,n.memoized)(t=>{const{a:r,d:n}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:s,ez:o,et:a}=t,f=d(i*i),c=d(s*s),h=d(o*o),u=d(h*h),l=d(f*r);if(d(h*d(l+c))!==d(u+d(n*d(f*c))))throw new Error("bad point: equation left != right (1)");if(d(i*s)!==d(o*a))throw new Error("bad point: equation left != right (2)");return!0});class w{constructor(e,t,r,n){this.ex=y("x",e),this.ey=y("y",t),this.ez=y("z",r,!0),this.et=y("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return y("x",t),y("y",r),new w(t,r,a,d(t*r))}static normalizeZ(e){return(0,i.normalizeZ)(w,"ez",e)}static msm(e,t){return(0,i.pippenger)(w,s,e,t)}_setWindowSize(e){this.precompute(e)}precompute(e=8,t=!0){return v.setWindowSize(this,e),t||this.multiply(f),this}assertValidity(){m(this)}equals(e){b(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:s,ez:o}=e,a=d(t*o),f=d(i*n),c=d(r*o),h=d(s*n);return a===f&&c===h}is0(){return this.equals(w.ZERO)}negate(){return new w(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,s=d(r*r),o=d(n*n),a=d(f*d(i*i)),c=d(t*s),h=r+n,u=d(d(h*h)-s-o),l=c+o,p=l-a,y=c-o,b=d(u*p),g=d(l*y),m=d(u*y),v=d(p*l);return new w(b,g,v,m)}add(t){b(t);const{a:r,d:n}=e,{ex:i,ey:s,ez:o,et:a}=this,{ex:f,ey:c,ez:h,et:u}=t,l=d(i*f),p=d(s*c),y=d(a*n*u),g=d(o*h),m=d((i+s)*(f+c)-l-p),v=g-y,_=g+y,E=d(p-r*l),S=d(m*v),B=d(_*E),M=d(m*E),A=d(v*_);return new w(S,B,A,M)}subtract(e){return this.add(e.negate())}multiply(e){const t=e;(0,n.aInRange)("scalar",t,a,u);const{p:r,f:i}=v.wNAFCached(this,t,w.normalizeZ);return w.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=w.ZERO){const r=e;return(0,n.aInRange)("scalar",r,o,u),r===o?w.ZERO:this.is0()||r===a?this:v.wNAFCachedUnsafe(this,r,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(h).is0()}isTorsionFree(){return v.wNAFCachedUnsafe(this,u).is0()}toAffine(e){return g(this,e)}clearCofactor(){return h===a?this:this.multiplyUnsafe(h)}static fromBytes(e,t=!1){return(0,n.abytes)(e),this.fromHex(e,t)}static fromHex(t,i=!1){const{d:s,a:f}=e,c=r.BYTES;t=(0,n.ensureBytes)("pointHex",t,c),(0,n.abool)("zip215",i);const h=t.slice(),u=t[c-1];h[c-1]=-129&u;const y=(0,n.bytesToNumberLE)(h),b=i?l:r.ORDER;(0,n.aInRange)("pointHex.y",y,o,b);const g=d(y*y),m=d(g-a),v=d(s*g-f);let{isValid:_,value:E}=p(m,v);if(!_)throw new Error("Point.fromHex: invalid y coordinate");const S=(E&a)===a,B=!!(128&u);if(!i&&E===o&&B)throw new Error("Point.fromHex: x=0 and x_0=1");return B!==S&&(E=d(-E)),w.fromAffine({x:E,y})}static fromPrivateScalar(e){return w.BASE.multiply(e)}toBytes(){const{x:e,y:t}=this.toAffine(),i=(0,n.numberToBytesLE)(t,r.BYTES);return i[i.length-1]|=e&a?128:0,i}toRawBytes(){return this.toBytes()}toHex(){return(0,n.bytesToHex)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}w.BASE=new w(e.Gx,e.Gy,a,d(e.Gx*e.Gy)),w.ZERO=new w(o,a,a,o),w.Fp=r,w.Fn=s;const v=(0,i.wNAF)(w,8*s.BYTES);return w}function l(e,t){(0,n._validateObject)(t,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:r,hash:i}=t,{BASE:s,Fp:a,Fn:f}=e,c=f.ORDER,u=t.randomBytes||n.randomBytes,l=t.adjustScalarBytes||(e=>e),d=t.domain||((e,t,r)=>{if((0,n.abool)("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function p(e){return f.create(e)}function y(e){return p((0,n.bytesToNumberLE)(e))}function b(e){const{head:t,prefix:r,scalar:o}=function(e){const t=a.BYTES;e=(0,n.ensureBytes)("private key",e,t);const r=(0,n.ensureBytes)("hashed private key",i(e),2*t),s=l(r.slice(0,t));return{head:s,prefix:r.slice(t,2*t),scalar:y(s)}}(e),f=s.multiply(o),c=f.toBytes();return{head:t,prefix:r,scalar:o,point:f,pointBytes:c}}function g(e=Uint8Array.of(),...t){const s=(0,n.concatBytes)(...t);return y(i(d(s,(0,n.ensureBytes)("context",e),!!r)))}const m=h;return s.precompute(8),{getPublicKey:function(e){return b(e).pointBytes},sign:function(e,t,i={}){e=(0,n.ensureBytes)("message",e),r&&(e=r(e));const{prefix:f,scalar:h,pointBytes:u}=b(t),l=g(i.context,f,e),d=s.multiply(l).toBytes(),y=p(l+g(i.context,d,u,e)*h);(0,n.aInRange)("signature.s",y,o,c);const m=a.BYTES,w=(0,n.concatBytes)(d,(0,n.numberToBytesLE)(y,m));return(0,n.ensureBytes)("result",w,2*m)},verify:function(t,i,o,f=m){const{context:c,zip215:h}=f,u=a.BYTES;t=(0,n.ensureBytes)("signature",t,2*u),i=(0,n.ensureBytes)("message",i),o=(0,n.ensureBytes)("publicKey",o,u),void 0!==h&&(0,n.abool)("zip215",h),r&&(i=r(i));const l=(0,n.bytesToNumberLE)(t.slice(u,2*u));let d,p,y;try{d=e.fromHex(o,h),p=e.fromHex(t.slice(0,u),h),y=s.multiplyUnsafe(l)}catch(e){return!1}if(!h&&d.isSmallOrder())return!1;const b=g(c,p.toBytes(),d.toBytes(),i);return p.add(d.multiplyUnsafe(b)).subtract(y).clearCofactor().is0()},utils:{getExtendedPublicKey:b,randomPrivateKey:()=>u(a.BYTES),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},Point:e}}},3170:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pinEncryptInfo=void 0,t.getKeyMaterial=s,t.getKey=o,t.decrypt=async function(e,t){if(!e.encryptInfo)return e.data;try{const r=await s(t),n=await o(r,i.Buffer.from(e.encryptInfo.salt,"base64")),a=await window.crypto.subtle.decrypt({name:e.encryptInfo.DERIVED_KEY_TYPE,iv:i.Buffer.from(e.encryptInfo.iv,"base64")},n,e.data);return i.Buffer.from(a)}catch(e){return console.error(e),null}},t.encrypt=async function(e,t){if(!e)return;const r=window.crypto.getRandomValues(new Uint8Array(16)),o=window.crypto.getRandomValues(new Uint8Array(12)),a=await s(e),f=await window.crypto.subtle.deriveKey({name:n.encryptInfo.ALG,salt:r,iterations:n.encryptInfo.ITERATIONS,hash:n.encryptInfo.HASH},a,{name:n.encryptInfo.DERIVED_KEY_TYPE,length:n.encryptInfo.DERIVED_KEY_LENGTH},!0,["encrypt","decrypt"]),c=await window.crypto.subtle.encrypt({name:n.encryptInfo.DERIVED_KEY_TYPE,iv:o},f,t);return{version:1,encryptInfo:{...n.encryptInfo,iv:i.Buffer.from(o).toString("base64"),salt:i.Buffer.from(r).toString("base64")},data:i.Buffer.from(c)}};const n=r(5617),i=r(4686);function s(e){const t=new TextEncoder;return window.crypto.subtle.importKey("raw",t.encode(e),n.encryptInfo.ALG,!1,["deriveBits","deriveKey"])}function o(e,t){return window.crypto.subtle.deriveKey({name:n.encryptInfo.ALG,salt:t,iterations:n.encryptInfo.ITERATIONS,hash:n.encryptInfo.HASH},e,{name:n.encryptInfo.DERIVED_KEY_TYPE,length:n.encryptInfo.DERIVED_KEY_LENGTH},!0,["encrypt","decrypt"])}t.pinEncryptInfo={ALG:"PBKDF2",ITERATIONS:1e5,DERIVED_KEY_TYPE:"AES-GCM",DERIVED_KEY_LENGTH:256,HASH:"SHA-256",SALT_LENGTH:16,IV_LENGTH:12}},3176:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserCrypto=void 0;const n=r(6863),i=r(2248);t.BrowserCrypto={webauthn:new i.BrowserWebAuthn,pbkdf2:{encrypt:n.encrypt,decrypt:n.decrypt}}},3271:(e,t,r)=>{"use strict";const n=r(896),i=r(6899),s=r(8590),o=r(790),{MT:a,NUMBYTES:f,SHIFT32:c,SIMPLE:h,SYMS:u,TAG:l,BI:d}=o,{Buffer:p}=r(4686),y=a.SIMPLE_FLOAT<<5|f.TWO,b=a.SIMPLE_FLOAT<<5|f.FOUR,g=a.SIMPLE_FLOAT<<5|f.EIGHT,m=a.SIMPLE_FLOAT<<5|h.TRUE,w=a.SIMPLE_FLOAT<<5|h.FALSE,v=a.SIMPLE_FLOAT<<5|h.UNDEFINED,_=a.SIMPLE_FLOAT<<5|h.NULL,E=p.from([255]),S=p.from("f97e00","hex"),B=p.from("f9fc00","hex"),M=p.from("f97c00","hex"),A=p.from("f98000","hex"),I={};let x={};class k extends n.Transform{constructor(e={}){const{canonical:t=!1,encodeUndefined:r,disallowUndefinedKeys:n=!1,dateType:i="number",collapseBigIntegers:s=!1,detectLoops:o=!1,omitUndefinedProperties:a=!1,genTypes:f=[],...c}=e;if(super({...c,readableObjectMode:!1,writableObjectMode:!0}),this.canonical=t,this.encodeUndefined=r,this.disallowUndefinedKeys=n,this.dateType=function(e){if(!e)return"number";switch(e.toLowerCase()){case"number":return"number";case"float":return"float";case"int":case"integer":return"int";case"string":return"string"}throw new TypeError(`dateType invalid, got "${e}"`)}(i),this.collapseBigIntegers=!!this.canonical||s,this.detectLoops=void 0,"boolean"==typeof o)o&&(this.detectLoops=new WeakSet);else{if(!(o instanceof WeakSet))throw new TypeError("detectLoops must be boolean or WeakSet");this.detectLoops=o}if(this.omitUndefinedProperties=a,this.semanticTypes={...k.SEMANTIC_TYPES},Array.isArray(f))for(let e=0,t=f.length;e<t;e+=2)this.addSemanticType(f[e],f[e+1]);else for(const[e,t]of Object.entries(f))this.addSemanticType(e,t)}_transform(e,t,r){r(!1===this.pushAny(e)?new Error("Push Error"):void 0)}_flush(e){e()}_pushUInt8(e){const t=p.allocUnsafe(1);return t.writeUInt8(e,0),this.push(t)}_pushUInt16BE(e){const t=p.allocUnsafe(2);return t.writeUInt16BE(e,0),this.push(t)}_pushUInt32BE(e){const t=p.allocUnsafe(4);return t.writeUInt32BE(e,0),this.push(t)}_pushFloatBE(e){const t=p.allocUnsafe(4);return t.writeFloatBE(e,0),this.push(t)}_pushDoubleBE(e){const t=p.allocUnsafe(8);return t.writeDoubleBE(e,0),this.push(t)}_pushNaN(){return this.push(S)}_pushInfinity(e){const t=e<0?B:M;return this.push(t)}_pushFloat(e){if(this.canonical){const t=p.allocUnsafe(2);if(s.writeHalf(t,e))return this._pushUInt8(y)&&this.push(t)}return Math.fround(e)===e?this._pushUInt8(b)&&this._pushFloatBE(e):this._pushUInt8(g)&&this._pushDoubleBE(e)}_pushInt(e,t,r){const n=t<<5;if(e<24)return this._pushUInt8(n|e);if(e<=255)return this._pushUInt8(n|f.ONE)&&this._pushUInt8(e);if(e<=65535)return this._pushUInt8(n|f.TWO)&&this._pushUInt16BE(e);if(e<=4294967295)return this._pushUInt8(n|f.FOUR)&&this._pushUInt32BE(e);let i=Number.MAX_SAFE_INTEGER;return t===a.NEG_INT&&i--,e<=i?this._pushUInt8(n|f.EIGHT)&&this._pushUInt32BE(Math.floor(e/c))&&this._pushUInt32BE(e%c):t===a.NEG_INT?this._pushFloat(r):this._pushFloat(e)}_pushIntNum(e){return Object.is(e,-0)?this.push(A):e<0?this._pushInt(-e-1,a.NEG_INT,e):this._pushInt(e,a.POS_INT)}_pushNumber(e){return isNaN(e)?this._pushNaN():isFinite(e)?Math.round(e)===e?this._pushIntNum(e):this._pushFloat(e):this._pushInfinity(e)}_pushString(e){const t=p.byteLength(e,"utf8");return this._pushInt(t,a.UTF8_STRING)&&this.push(e,"utf8")}_pushBoolean(e){return this._pushUInt8(e?m:w)}_pushUndefined(e){switch(typeof this.encodeUndefined){case"undefined":return this._pushUInt8(v);case"function":return this.pushAny(this.encodeUndefined(e));case"object":{const e=s.bufferishToBuffer(this.encodeUndefined);if(e)return this.push(e)}}return this.pushAny(this.encodeUndefined)}_pushNull(e){return this._pushUInt8(_)}_pushTag(e){return this._pushInt(e,a.TAG)}_pushJSBigint(e){let t=a.POS_INT,r=l.POS_BIGINT;if(e<0&&(e=-e+d.MINUS_ONE,t=a.NEG_INT,r=l.NEG_BIGINT),this.collapseBigIntegers&&e<=d.MAXINT64)return e<=4294967295?this._pushInt(Number(e),t):this._pushUInt8(t<<5|f.EIGHT)&&this._pushUInt32BE(Number(e/d.SHIFT32))&&this._pushUInt32BE(Number(e%d.SHIFT32));let n=e.toString(16);n.length%2&&(n=`0${n}`);const i=p.from(n,"hex");return this._pushTag(r)&&k._pushBuffer(this,i)}_pushObject(e,t){if(!e)return this._pushNull(e);if(!(t={indefinite:!1,skipTypes:!1,...t}).indefinite&&this.detectLoops){if(this.detectLoops.has(e))throw new Error("Loop detected while CBOR encoding.\nCall removeLoopDetectors before resuming.");this.detectLoops.add(e)}if(!t.skipTypes){const t=e.encodeCBOR;if("function"==typeof t)return t.call(e,this);const r=this.semanticTypes[e.constructor.name];if(r)return r.call(e,this,e)}const r=Object.keys(e).filter(t=>{const r=typeof e[t];return"function"!==r&&(!this.omitUndefinedProperties||"undefined"!==r)}),n={};if(this.canonical&&r.sort((e,t)=>{const r=n[e]||(n[e]=k.encode(e)),i=n[t]||(n[t]=k.encode(t));return r.compare(i)}),t.indefinite){if(!this._pushUInt8(a.MAP<<5|f.INDEFINITE))return!1}else if(!this._pushInt(r.length,a.MAP))return!1;let i=null;for(let t=0,s=r.length;t<s;t++){const s=r[t];if(this.canonical&&(i=n[s])){if(!this.push(i))return!1}else if(!this._pushString(s))return!1;if(!this.pushAny(e[s]))return!1}if(t.indefinite){if(!this.push(E))return!1}else this.detectLoops&&this.detectLoops.delete(e);return!0}_encodeAll(e){const t=new i({highWaterMark:this.readableHighWaterMark});this.pipe(t);for(const t of e)this.pushAny(t);return this.end(),t.read()}addSemanticType(e,t){const r="string"==typeof e?e:e.name,n=this.semanticTypes[r];if(t){if("function"!=typeof t)throw new TypeError("fun must be of type function");this.semanticTypes[r]=t}else n&&delete this.semanticTypes[r];return n}pushAny(e){switch(typeof e){case"number":return this._pushNumber(e);case"bigint":return this._pushJSBigint(e);case"string":return this._pushString(e);case"boolean":return this._pushBoolean(e);case"undefined":return this._pushUndefined(e);case"object":return this._pushObject(e);case"symbol":switch(e){case u.NULL:return this._pushNull(null);case u.UNDEFINED:return this._pushUndefined(void 0);default:throw new TypeError(`Unknown symbol: ${e.toString()}`)}default:throw new TypeError(`Unknown type: ${typeof e}, ${"function"==typeof e.toString?e.toString():""}`)}}static pushArray(e,t,r){r={indefinite:!1,...r};const n=t.length;if(r.indefinite){if(!e._pushUInt8(a.ARRAY<<5|f.INDEFINITE))return!1}else if(!e._pushInt(n,a.ARRAY))return!1;for(let r=0;r<n;r++)if(!e.pushAny(t[r]))return!1;return!(r.indefinite&&!e.push(E))}removeLoopDetectors(){return!!this.detectLoops&&(this.detectLoops=new WeakSet,!0)}static _pushDate(e,t){switch(e.dateType){case"string":return e._pushTag(l.DATE_STRING)&&e._pushString(t.toISOString());case"int":return e._pushTag(l.DATE_EPOCH)&&e._pushIntNum(Math.round(t.getTime()/1e3));case"float":return e._pushTag(l.DATE_EPOCH)&&e._pushFloat(t.getTime()/1e3);default:return e._pushTag(l.DATE_EPOCH)&&e.pushAny(t.getTime()/1e3)}}static _pushBuffer(e,t){return e._pushInt(t.length,a.BYTE_STRING)&&e.push(t)}static _pushNoFilter(e,t){return k._pushBuffer(e,t.slice())}static _pushRegexp(e,t){return e._pushTag(l.REGEXP)&&e.pushAny(t.source)}static _pushSet(e,t){if(!e._pushTag(l.SET))return!1;if(!e._pushInt(t.size,a.ARRAY))return!1;for(const r of t)if(!e.pushAny(r))return!1;return!0}static _pushURL(e,t){return e._pushTag(l.URI)&&e.pushAny(t.toString())}static _pushBoxed(e,t){return e.pushAny(t.valueOf())}static _pushMap(e,t,r){r={indefinite:!1,...r};let n=[...t.entries()];if(e.omitUndefinedProperties&&(n=n.filter(([e,t])=>void 0!==t)),r.indefinite){if(!e._pushUInt8(a.MAP<<5|f.INDEFINITE))return!1}else if(!e._pushInt(n.length,a.MAP))return!1;if(e.canonical){const t=new k({genTypes:e.semanticTypes,canonical:e.canonical,detectLoops:Boolean(e.detectLoops),dateType:e.dateType,disallowUndefinedKeys:e.disallowUndefinedKeys,collapseBigIntegers:e.collapseBigIntegers}),r=new i({highWaterMark:e.readableHighWaterMark});t.pipe(r),n.sort(([e],[n])=>{t.pushAny(e);const i=r.read();t.pushAny(n);const s=r.read();return i.compare(s)});for(const[t,r]of n){if(e.disallowUndefinedKeys&&void 0===t)throw new Error("Invalid Map key: undefined");if(!e.pushAny(t)||!e.pushAny(r))return!1}}else for(const[t,r]of n){if(e.disallowUndefinedKeys&&void 0===t)throw new Error("Invalid Map key: undefined");if(!e.pushAny(t)||!e.pushAny(r))return!1}return!(r.indefinite&&!e.push(E))}static _pushTypedArray(e,t){let r=64,n=t.BYTES_PER_ELEMENT;const{name:i}=t.constructor;return i.startsWith("Float")?(r|=16,n/=2):i.includes("U")||(r|=8),(i.includes("Clamped")||1!==n&&!s.isBigEndian())&&(r|=4),r|={1:0,2:1,4:2,8:3}[n],!!e._pushTag(r)&&k._pushBuffer(e,p.from(t.buffer,t.byteOffset,t.byteLength))}static _pushArrayBuffer(e,t){return k._pushBuffer(e,p.from(t))}static encodeIndefinite(e,t,r={}){if(null==t){if(null==this)throw new Error("No object to encode");t=this}const{chunkSize:n=4096}=r;let i=!0;const o=typeof t;let c=null;if("string"===o){i=i&&e._pushUInt8(a.UTF8_STRING<<5|f.INDEFINITE);let r=0;for(;r<t.length;){const s=r+n;i=i&&e._pushString(t.slice(r,s)),r=s}i=i&&e.push(E)}else if(c=s.bufferishToBuffer(t)){i=i&&e._pushUInt8(a.BYTE_STRING<<5|f.INDEFINITE);let t=0;for(;t<c.length;){const r=t+n;i=i&&k._pushBuffer(e,c.slice(t,r)),t=r}i=i&&e.push(E)}else if(Array.isArray(t))i=i&&k.pushArray(e,t,{indefinite:!0});else if(t instanceof Map)i=i&&k._pushMap(e,t,{indefinite:!0});else{if("object"!==o)throw new Error("Invalid indefinite encoding");i=i&&e._pushObject(t,{indefinite:!0,skipTypes:!0})}return i}static encode(...e){return(new k)._encodeAll(e)}static encodeCanonical(...e){return new k({canonical:!0})._encodeAll(e)}static encodeOne(e,t){return new k(t)._encodeAll([e])}static encodeAsync(e,t){return new Promise((r,n)=>{const i=[],s=new k(t);s.on("data",e=>i.push(e)),s.on("error",n),s.on("finish",()=>r(p.concat(i))),s.pushAny(e),s.end()})}static get SEMANTIC_TYPES(){return x}static set SEMANTIC_TYPES(e){x=e}static reset(){k.SEMANTIC_TYPES={...I}}}Object.assign(I,{Array:k.pushArray,Date:k._pushDate,Buffer:k._pushBuffer,[p.name]:k._pushBuffer,Map:k._pushMap,NoFilter:k._pushNoFilter,[i.name]:k._pushNoFilter,RegExp:k._pushRegexp,Set:k._pushSet,ArrayBuffer:k._pushArrayBuffer,Uint8ClampedArray:k._pushTypedArray,Uint8Array:k._pushTypedArray,Uint16Array:k._pushTypedArray,Uint32Array:k._pushTypedArray,Int8Array:k._pushTypedArray,Int16Array:k._pushTypedArray,Int32Array:k._pushTypedArray,Float32Array:k._pushTypedArray,Float64Array:k._pushTypedArray,URL:k._pushURL,Boolean:k._pushBoxed,Number:k._pushBoxed,String:k._pushBoxed}),"undefined"!=typeof BigUint64Array&&(I[BigUint64Array.name]=k._pushTypedArray),"undefined"!=typeof BigInt64Array&&(I[BigInt64Array.name]=k._pushTypedArray),k.reset(),e.exports=k},3274:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CryptoChannel=t.GameOfLifeIcon=t.KeyManager=t.IdManager=t.LocalStorage=t.convertWebWritableStreamToNodeWritable=t.convertWebReadableStreamToNodeReadable=t.StreamChannel=t.MemoryStorage=t.MemoryChannel=t.Challenger=t.VaultysId=t.Buffer=t.crypto=void 0;const f=a(r(2114));t.Challenger=f.default;const c=a(r(5079));t.IdManager=c.default;const h=a(r(2810));t.KeyManager=h.default;const u=a(r(5550));t.VaultysId=u.default;const l=r(3061);Object.defineProperty(t,"MemoryChannel",{enumerable:!0,get:function(){return l.MemoryChannel}}),Object.defineProperty(t,"StreamChannel",{enumerable:!0,get:function(){return l.StreamChannel}}),Object.defineProperty(t,"convertWebReadableStreamToNodeReadable",{enumerable:!0,get:function(){return l.convertWebReadableStreamToNodeReadable}}),Object.defineProperty(t,"convertWebWritableStreamToNodeWritable",{enumerable:!0,get:function(){return l.convertWebWritableStreamToNodeWritable}});const d=r(3903);Object.defineProperty(t,"MemoryStorage",{enumerable:!0,get:function(){return d.MemoryStorage}}),Object.defineProperty(t,"LocalStorage",{enumerable:!0,get:function(){return d.LocalStorage}});const p=a(r(2739));t.GameOfLifeIcon=p.default;const y=a(r(4015));t.CryptoChannel=y.default;const b=o(r(5598));t.crypto=b;const g=b.Buffer;t.Buffer=g,void 0===Symbol.dispose&&(Symbol.dispose=Symbol("Symbol.dispose"))},3321:function(e,t,r){"use strict";var n=r(4686).Buffer,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DearmorStream=t.ArmorStream=t.MessageType=t.debug=void 0,t.armor=function(e,t){const r=Object.assign({},p,t);"number"==typeof r.message_type&&(r.message_type=d(r.message_type));const n=(0,o.chunkBuffer)(e,r.block_size);let i="";for(const e of n)i+=_(e,r.alphabet,r.shift);if(r.raw)return(0,o.chunkString)(i,43).join(" ");const s=(0,o.chunkString)(i,15),a=(0,f.default)(s,200).map(e=>e.join(" ")).join("\n"),c=r.app_name?" "+r.app_name:"";return"BEGIN"+c+" SALTPACK "+r.message_type+". "+a+(". END"+c+" SALTPACK "+r.message_type+".")},t.dearmor=function(e,t){var r;const i=Object.assign({},p,t);let s,a,f,c=null,l=null;if(!i.raw){if([s,e,a,l]=e.split(".",4),l=n.from(l),!(f=s.match(h)))throw new Error("Invalid header");if(c={message_type:f[3],app_name:null!==(r=f[2])&&void 0!==r?r:null},!(f=a.match(u)))throw new Error("Invalid footer");if(c.message_type!==f[3]||c.app_name!=f[2])throw new Error("Footer doesn't match header")}e=e.replace(/[>\n\r\t ]/g,"");const d=(0,o.chunkString)(e,i.char_block_size).map(e=>E(e,i.alphabet,i.shift)),y=n.concat(d);return Object.assign(y,{remaining:l,header_info:c})},t.encodeBlock=_,t.decodeBlock=E,t.efficientCharsSizes=function(e,t=50){const r=[];let n=0;for(let i=1;i<t;i++){const t=g(e,i),s=t/i;s>n&&(r.push([i,t,s]),n=s)}return r};const s=r(931),o=r(568),a=r(896),f=i(r(9399));t.debug=!1;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",h=/^[>\n\r\t ]*BEGIN[>\n\r\t ]+(([a-zA-Z0-9]+)[>\n\r\t ]+)?SALTPACK[>\n\r\t ]+(MESSAGE|ENCRYPTED[>\n\r\t ]+MESSAGE|SIGNED[>\n\r\t ]+MESSAGE|DETACHED[>\n\r\t ]+SIGNATURE)[>\n\r\t ]*$/,u=/^[>\n\r\t ]*END[>\n\r\t ]+(([a-zA-Z0-9]+)[>\n\r\t ]+)?SALTPACK[>\n\r\t ]+(MESSAGE|ENCRYPTED[>\n\r\t ]+MESSAGE|SIGNED[>\n\r\t ]+MESSAGE|DETACHED[>\n\r\t ]+SIGNATURE)[>\n\r\t ]*$/;var l;function d(e){switch(e){case s.MessageType.ENCRYPTION:return l.ENCRYPTED_MESSAGE;case s.MessageType.ATTACHED_SIGNING:return l.SIGNED_MESSAGE;case s.MessageType.DETACHED_SIGNING:return l.DETACHED_SIGNATURE;case s.MessageType.SIGNCRYPTION:return l.ENCRYPTED_MESSAGE;default:return"MESSAGE"}}!function(e){e.ENCRYPTED_MESSAGE="ENCRYPTED MESSAGE",e.SIGNED_MESSAGE="SIGNED MESSAGE",e.DETACHED_SIGNATURE="DETACHED SIGNATURE"}(l||(t.MessageType=l={}));const p={alphabet:c,block_size:32,char_block_size:43,raw:!1,shift:!1,message_type:"MESSAGE",app_name:null};function y(e,t){const r=e.indexOf(t);if(-1===r)throw new Error("Could not find "+t+" in alphabet "+e);return r}function b(e,t){return Math.ceil(8*t/Math.log2(e))}function g(e,t){return Math.floor(Math.log2(e)/8*t)}function m(e,t,r){return Math.floor(Math.log2(e)*t)-8*r}class w extends a.Transform{constructor(e){super(),this.in_buffer=n.alloc(0),this.out_buffer="",this.words=0,this.i=0,this.armor_options=Object.assign({},p,e),"number"==typeof this.armor_options.message_type&&(this.armor_options.message_type=d(this.armor_options.message_type));const t=this.armor_options.app_name?" "+this.armor_options.app_name:"";this.armor_header="BEGIN"+t+" SALTPACK "+this.armor_options.message_type+". ",this.armor_footer=". END"+t+" SALTPACK "+this.armor_options.message_type+".",this.armor_options.raw||this.push(this.armor_header)}_transform(e,r,i){for(t.debug&&console.log("Processing chunk #%d: %O",this.i++,e),this.in_buffer=n.concat([this.in_buffer,e]);this.in_buffer.length>this.armor_options.block_size;){const e=this.in_buffer.slice(0,this.armor_options.block_size);this.in_buffer=this.in_buffer.slice(this.armor_options.block_size),this.out_buffer+=_(e,this.armor_options.alphabet,this.armor_options.shift)}if(this.armor_options.raw)for(;this.out_buffer.length>43;)this.push(this.out_buffer.substr(0,43)+" "),this.out_buffer=this.out_buffer.substr(43);else for(;this.out_buffer.length>15;){const e=this.out_buffer.substr(0,15);this.out_buffer=this.out_buffer.substr(15),this.words++,this.words>=200?(this.push(e+"\n"),this.words=0):this.push(e+" ")}i()}_flush(e){if(this.in_buffer.length>0&&(this.out_buffer+=_(this.in_buffer,this.armor_options.alphabet,this.armor_options.shift),this.in_buffer=n.alloc(0)),this.armor_options.raw)for(;this.out_buffer.length>43;)this.push(this.out_buffer.substr(0,43)+" "),this.out_buffer=this.out_buffer.substr(43);else for(;this.out_buffer.length>15;){const e=this.out_buffer.substr(0,15);this.out_buffer=this.out_buffer.substr(15),this.words++,this.words>=200?(this.push(e+"\n"),this.words=0):this.push(e+" ")}this.push(this.out_buffer),this.armor_options.raw||this.push(this.armor_footer),e()}}t.ArmorStream=w;class v extends a.Transform{get header(){if(this.armor_options.raw)throw new Error("Header isn't available when decoding raw armored data");if(!this.armor_header)throw new Error("Header hasn't been decoded yet");return this.armor_header}get footer(){if(this.armor_options.raw)throw new Error("Footer isn't available when decoding raw armored data");if(!this.armor_footer)throw new Error("Footer hasn't been decoded yet");return this.armor_footer}get info(){if(this.armor_options.raw)throw new Error("Header isn't available when decoding raw armored data");if(!this.armor_header_info)throw new Error("Header hasn't been decoded yet");return this.armor_header_info}constructor(e){super(),this.in_buffer=n.alloc(0),this.out_buffer="",this.armor_header_info=null,this.armor_header=null,this.armor_footer=null,this.words=0,this.i=0,this.armor_options=Object.assign({},p,e)}_transform(e,r,i){var s;if(t.debug&&console.log("Processing chunk #%d: %O",this.i++,e),!this.armor_options.raw&&null===this.armor_header){this.in_buffer=n.concat([this.in_buffer,e]);const r=this.in_buffer.indexOf(".");if(-1===r)return i();this.armor_header=this.in_buffer.slice(0,r).toString(),e=this.in_buffer.slice(r+1);const o=this.armor_header.match(h);if(!o){const e=new Error("Invalid header");throw i(e),e}this.armor_header_info={message_type:o[3],app_name:null!==(s=o[2])&&void 0!==s?s:null},t.debug&&console.log("Read header: %s",this.armor_header)}if(!this.armor_options.raw&&null!==this.armor_footer){this.armor_footer+=e.toString();const t=this.armor_footer.indexOf(".");if(-1!==t)return this.armor_footer=this.armor_footer.substr(0,t),i()}if(!this.armor_options.raw&&null===this.armor_footer){const t=e.indexOf(".");if(-1!==t){this.armor_footer=e.slice(t+1).toString(),e=e.slice(0,t),this.out_buffer=e.toString().replace(/[>\n\r\t ]/g,"");const r=this.armor_footer.indexOf(".");return-1!==r?(this.armor_footer=this.armor_footer.substr(0,r),i()):i()}}if(this.armor_options.raw||null===this.armor_footer)for(this.out_buffer+=e.toString().replace(/[>\n\r\t ]/g,"");this.out_buffer.length>this.armor_options.char_block_size;){const e=this.out_buffer.substr(0,this.armor_options.char_block_size);this.out_buffer=this.out_buffer.substr(this.armor_options.char_block_size),this.push(E(e,this.armor_options.alphabet,this.armor_options.shift))}i()}_flush(e){for(var r;this.out_buffer.length>this.armor_options.char_block_size;){const e=this.out_buffer.substr(0,this.armor_options.char_block_size);this.out_buffer=this.out_buffer.substr(this.armor_options.char_block_size),this.push(E(e,this.armor_options.alphabet,this.armor_options.shift))}if(this.out_buffer.length>0&&(this.push(E(this.out_buffer,this.armor_options.alphabet,this.armor_options.shift)),this.out_buffer=""),!this.armor_options.raw&&null===this.armor_footer){const t=new Error("Input stream doesn't contain a valid header and footer");throw e(t),t}if(!this.armor_options.raw){const e=null===(r=this.armor_footer)||void 0===r?void 0:r.match(u);if(!e)throw new Error("Invalid footer");if(this.armor_header_info.message_type!==e[3]||this.armor_header_info.app_name!=e[2])throw new Error("Footer doesn't match header");t.debug&&console.log("Read footer: %s",this.armor_footer)}e()}}function _(e,t=c,r=!1){const n=b(t.length,e.length),i=m(t.length,n,e.length);let s=BigInt("0x"+e.toString("hex"));r&&(s<<=BigInt(i));const o=BigInt(t.length),a=[];for(let e=0;e<n;e++){const e=parseInt((s%o).toString());a.unshift(e),s/=o}return a.map(e=>t[e]).join("")}function E(e,t=c,r=!1){const i=g(t.length,e.length),s=b(t.length,i);if(e.length!==s)throw new TypeError("Illegal block size "+e.length+", expected "+s);const o=m(t.length,e.length,i);let a=BigInt(y(t,e[0]));for(let r=1;r<e.length;r++)a*=BigInt(t.length),a+=BigInt(y(t,e[r]));return r&&(a>>=BigInt(o)),n.from(a.toString(16).padStart(2*i,"0").slice(0,2*i),"hex")}t.DearmorStream=v},3381:(e,t,r)=>{const n=r(8115);function i(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function s(e,t,r,n,i,s){c[e]=c[e]+c[t]+i,c[n]=o(c[n]^c[e],16),c[r]=c[r]+c[n],c[t]=o(c[t]^c[r],12),c[e]=c[e]+c[t]+s,c[n]=o(c[n]^c[e],8),c[r]=c[r]+c[n],c[t]=o(c[t]^c[r],7)}function o(e,t){return e>>>t^e<<32-t}const a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),f=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),c=new Uint32Array(16),h=new Uint32Array(16);function u(e,t){let r=0;for(r=0;r<8;r++)c[r]=e.h[r],c[r+8]=a[r];for(c[12]^=e.t,c[13]^=e.t/4294967296,t&&(c[14]=~c[14]),r=0;r<16;r++)h[r]=i(e.b,4*r);for(r=0;r<10;r++)s(0,4,8,12,h[f[16*r+0]],h[f[16*r+1]]),s(1,5,9,13,h[f[16*r+2]],h[f[16*r+3]]),s(2,6,10,14,h[f[16*r+4]],h[f[16*r+5]]),s(3,7,11,15,h[f[16*r+6]],h[f[16*r+7]]),s(0,5,10,15,h[f[16*r+8]],h[f[16*r+9]]),s(1,6,11,12,h[f[16*r+10]],h[f[16*r+11]]),s(2,7,8,13,h[f[16*r+12]],h[f[16*r+13]]),s(3,4,9,14,h[f[16*r+14]],h[f[16*r+15]]);for(r=0;r<8;r++)e.h[r]^=c[r]^c[r+8]}function l(e,t){if(!(e>0&&e<=32))throw new Error("Incorrect output length, should be in [1, 32]");const r=t?t.length:0;if(t&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");const n={h:new Uint32Array(a),b:new Uint8Array(64),c:0,t:0,outlen:e};return n.h[0]^=16842752^r<<8^e,r>0&&(d(n,t),n.c=64),n}function d(e,t){for(let r=0;r<t.length;r++)64===e.c&&(e.t+=e.c,u(e,!1),e.c=0),e.b[e.c++]=t[r]}function p(e){for(e.t+=e.c;e.c<64;)e.b[e.c++]=0;u(e,!0);const t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r)&255;return t}function y(e,t,r){r=r||32,e=n.normalizeInput(e);const i=l(r,t);return d(i,e),p(i)}e.exports={blake2s:y,blake2sHex:function(e,t,r){const i=y(e,t,r);return n.toHex(i)},blake2sInit:l,blake2sUpdate:d,blake2sFinal:p}},3453:e=>{"use strict";e.exports={rE:"6.6.1"}},3474:function(e,t,r){"use strict";var n=r(4686).Buffer,i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{f(n.next(e))}catch(e){s(e)}}function a(e){try{f(n.throw(e))}catch(e){s(e)}}function f(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}f((n=n.apply(e,t||[])).next())})},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VerifyStream=t.SignStream=t.CHUNK_LENGTH=void 0,t.sign=function(e,r){const i=(0,c.chunkBuffer)(e,t.CHUNK_LENGTH),s=a.default.create(r.publicKey,!0),o=[];for(const e in i){const t=i[e],n=i.length===parseInt(e)+1,a=f.default.create(s,r.secretKey,t,BigInt(e),n);o.push(a)}return n.concat([s.encoded,n.concat(o.map(e=>e.encoded))])},t.verify=function(e,t){return i(this,void 0,void 0,function*(){var r,i,o,c;const l=new h.Readable;l.push(e),l.push(null);const d=[];try{for(var p,y=!0,b=s((0,u.decodeMultiStream)(l));!(r=(p=yield b.next()).done);y=!0){c=p.value,y=!1;const e=c;d.push(e)}}catch(e){i={error:e}}finally{try{y||r||!(o=b.return)||(yield o.call(b))}finally{if(i)throw i.error}}const g=d.shift(),m=a.default.decode(g,!0);if(t&&!n.from(m.public_key).equals(t))throw new Error("Sender public key doesn't match");let w=n.alloc(0);for(const e in d){const t=d[e],r=d.length===parseInt(e)+1,i=f.default.decode(t,!0);if(i.verify(m,m.public_key,BigInt(e)),i.final&&!r)throw new Error("Found payload with invalid final flag, message extended?");if(!i.final&&r)throw new Error("Found payload with invalid final flag, message truncated?");w=n.concat([w,i.data])}if(!d.length)throw new Error("No signed payloads, message truncated?");return Object.assign(w,{public_key:new Uint8Array(m.public_key)})})},t.signDetached=function(e,t){const r=a.default.create(t.publicKey,!1);return n.concat([r.encoded,(0,u.encode)(r.signDetached(n.from(e),t.secretKey))])},t.verifyDetached=function(e,t,r){return i(this,void 0,void 0,function*(){var i,o,f,c;const l=new h.Readable;l.push(e),l.push(null);const d=[];try{for(var p,y=!0,b=s((0,u.decodeMultiStream)(l));!(i=(p=yield b.next()).done);y=!0){c=p.value,y=!1;const e=c;d.push(e)}}catch(e){o={error:e}}finally{try{y||i||!(f=b.return)||(yield f.call(b))}finally{if(o)throw o.error}}const[g,m]=d,w=a.default.decode(g,!0);if(r&&!n.from(w.public_key).equals(r))throw new Error("Sender public key doesn't match");return w.verifyDetached(m,n.from(t),w.public_key),{public_key:new Uint8Array(w.public_key)}})};const a=o(r(7981)),f=o(r(6760)),c=r(568),h=r(896),u=r(2655);t.CHUNK_LENGTH=1048576;class l extends h.Transform{constructor(e){super(),this.keypair=e,this.in_buffer=n.alloc(0),this.payload_index=BigInt(0),this.header=a.default.create(e.publicKey,!0),this.push(this.header.encoded)}_transform(e,r,i){for(this.in_buffer=n.concat([this.in_buffer,e]);this.in_buffer.length>t.CHUNK_LENGTH;){const e=this.in_buffer.slice(0,t.CHUNK_LENGTH);this.in_buffer=this.in_buffer.slice(t.CHUNK_LENGTH);const r=f.default.create(this.header,this.keypair.secretKey,e,this.payload_index,!1);this.push(r.encoded),this.payload_index++}i()}_flush(e){for(;this.in_buffer.length>=t.CHUNK_LENGTH;){const e=this.in_buffer.slice(0,t.CHUNK_LENGTH);this.in_buffer=this.in_buffer.slice(t.CHUNK_LENGTH);const r=!this.in_buffer.length,n=f.default.create(this.header,this.keypair.secretKey,e,this.payload_index,r);this.push(n.encoded),this.payload_index++}if(this.in_buffer.length){const e=this.in_buffer;this.in_buffer=n.alloc(0);const t=!this.in_buffer.length,r=f.default.create(this.header,this.keypair.secretKey,e,this.payload_index,t);this.push(r.encoded),this.payload_index++}e()}}t.SignStream=l;class d extends h.Transform{constructor(e){super(),this.decoder=new u.Decoder,this.header_data=null,this.last_payload=null,this.payload_index=BigInt(-1),this.i=0,this._public_key=null!=e?e:null}get header(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data}get public_key(){return this.header.public_key}_transform(e,t,r){this.decoder.appendBuffer(e);try{let e;for(;e=this.decoder.doDecodeSync();){const t=n.from(this.decoder.bytes).slice(this.decoder.pos);this.decoder.setBuffer(t),this._handleMessage(e)}}catch(e){}r()}_handleMessage(e){if(this.header_data){if(this.payload_index++,this.last_payload){if(this.last_payload.final)throw new Error("Found payload with invalid final flag, message extended?");this.push(this.last_payload.data)}const t=f.default.decode(e,!0);t.verify(this.header,this.header.public_key,this.payload_index),this.last_payload=t}else{const t=a.default.decode(e,!0);if(this._public_key&&!n.from(t.public_key).equals(this._public_key))throw new Error("Sender public key doesn't match");this.header_data=t,t.public_key=new Uint8Array(t.public_key)}}_flush(e){try{if(this.last_payload){if(!this.last_payload.final)throw new Error("Found payload with invalid final flag, message truncated?");this.push(this.last_payload.data)}if(!this.last_payload)throw new Error("No signed payloads, message truncated?")}catch(t){return e(t)}e()}}t.VerifyStream=d},3514:()=>{},3544:(e,t,r)=>{"use strict";var n=r(7902),i=r(1036),s=i.assert;function o(e,t){if(e instanceof o)return e;this._importDER(e,t)||(s(e.r&&e.s,"Signature without r or s"),this.r=new n(e.r,16),this.s=new n(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function f(e,t){var r=e[t.place++];if(!(128&r))return r;var n=15&r;if(0===n||n>4)return!1;if(0===e[t.place])return!1;for(var i=0,s=0,o=t.place;s<n;s++,o++)i<<=8,i|=e[o],i>>>=0;return!(i<=127)&&(t.place=o,i)}function c(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function h(e,t){if(t<128)e.push(t);else{var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}}e.exports=o,o.prototype._importDER=function(e,t){e=i.toArray(e,t);var r=new a;if(48!==e[r.place++])return!1;var s=f(e,r);if(!1===s)return!1;if(s+r.place!==e.length)return!1;if(2!==e[r.place++])return!1;var o=f(e,r);if(!1===o)return!1;if(128&e[r.place])return!1;var c=e.slice(r.place,o+r.place);if(r.place+=o,2!==e[r.place++])return!1;var h=f(e,r);if(!1===h)return!1;if(e.length!==h+r.place)return!1;if(128&e[r.place])return!1;var u=e.slice(r.place,h+r.place);if(0===c[0]){if(!(128&c[1]))return!1;c=c.slice(1)}if(0===u[0]){if(!(128&u[1]))return!1;u=u.slice(1)}return this.r=new n(c),this.s=new n(u),this.recoveryParam=null,!0},o.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=c(t),r=c(r);!(r[0]||128&r[1]);)r=r.slice(1);var n=[2];h(n,t.length),(n=n.concat(t)).push(2),h(n,r.length);var s=n.concat(r),o=[48];return h(o,s.length),o=o.concat(s),i.encode(o,e)}},3548:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(4406),s=r(2655),o=r(3835),a=r(4072);class f{constructor(e,t,r){this.final=e,this.authenticators=t,this.payload_secretbox=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data}static create(e,t,r,s,f=!1){const c=n.alloc(8);c.writeBigUInt64BE(s);const h=n.concat([this.PAYLOAD_NONCE_PREFIX,c]),u=(0,i.secretbox)(Uint8Array.from(r),Uint8Array.from(h),Uint8Array.from(t)),l=this.generateAuthenticatorHash(e.hash,u,h,f);return new this(f,e.recipients.map((e,t)=>{if(!e.mac_key)throw new Error("Recipient #"+t+" doesn't have a MAC key set");return n.from((0,o.hmac)(a.sha512,e.mac_key,l).slice(0,32))}),u)}static generateAuthenticatorHash(e,t,r,i){return n.from(a.sha512.create().update(e).update(r).update(i?"":"\0").update(t).digest())}encode(){return f.encodePayload(this.final,this.authenticators,this.payload_secretbox)}static encodePayload(e,t,r){const i=[e,t,r];return n.from((0,s.encode)(i))}static decode(e,t=!1){const r=t?e:(0,s.decode)(e);if(r.length<3)throw new Error("Invalid data");const[n,i,o]=r;return new this(n,i,o)}decrypt(e,t,r,s){if(!t.mac_key)throw new Error("Recipient doesn't have a MAC key set");const c=this.authenticators[t.index],h=n.alloc(8);h.writeBigUInt64BE(s);const u=n.concat([f.PAYLOAD_NONCE_PREFIX,h]),l=f.generateAuthenticatorHash(e.hash,this.payload_secretbox,u,this.final),d=n.from((0,o.hmac)(a.sha512,t.mac_key,l).slice(0,32));if(!c||!d.equals(c))throw new Error("Invalid authenticator");const p=i.secretbox.open(Uint8Array.from(this.payload_secretbox),Uint8Array.from(u),Uint8Array.from(r));if(!p)throw new Error("Failed to decrypt data");return p}}f.PAYLOAD_NONCE_PREFIX=n.from("saltpack_ploadsb"),t.default=f},3569:(e,t,r)=>{var n;function i(e){this.rand=e}if(e.exports=function(e){return n||(n=new i(null)),n.generate(e)},e.exports.Rand=i,i.prototype.generate=function(e){return this._rand(e)},i.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var s=r(9780);if("function"!=typeof s.randomBytes)throw new Error("Not supported");i.prototype._rand=function(e){return s.randomBytes(e)}}catch(e){}},3616:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){}static createFromEntropy(e,t){throw new Error("Method must be implemented by concrete class")}static generate(){throw new Error("Method must be implemented by concrete class")}static fromSecret(e){throw new Error("Method must be implemented by concrete class")}static instantiate(e){throw new Error("Method must be implemented by concrete class")}static fromId(e){throw new Error("Method must be implemented by concrete class")}async sign(e){return"public"==this.capability?null:(await this.getSigner()).sign(e)}static async diffieHellman(e,t){return await e.performDiffieHellman(t)}static encrypt(e,t){throw new Error("Method must be implemented by concrete class")}}},3835:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hmac=t.HMAC=void 0;const n=r(11);class i extends n.Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,n.ahash)(e);const r=(0,n.toBytes)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),(0,n.clean)(s)}update(e){return(0,n.aexists)(this),this.iHash.update(e),this}digestInto(e){(0,n.aexists)(this),(0,n.abytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}t.HMAC=i,t.hmac=(e,t,r)=>new i(e,t).update(r).digest(),t.hmac.create=(e,t)=>new i(e,t)},3842:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toBig=t.shrSL=t.shrSH=t.rotrSL=t.rotrSH=t.rotrBL=t.rotrBH=t.rotr32L=t.rotr32H=t.rotlSL=t.rotlSH=t.rotlBL=t.rotlBH=t.add5L=t.add5H=t.add4L=t.add4H=t.add3L=t.add3H=void 0,t.add=w,t.fromBig=i,t.split=s;const r=BigInt(2**32-1),n=BigInt(32);function i(e,t=!1){return t?{h:Number(e&r),l:Number(e>>n&r)}:{h:0|Number(e>>n&r),l:0|Number(e&r)}}function s(e,t=!1){const r=e.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:a}=i(e[o],t);[n[o],s[o]]=[r,a]}return[n,s]}const o=(e,t)=>BigInt(e>>>0)<<n|BigInt(t>>>0);t.toBig=o;const a=(e,t,r)=>e>>>r;t.shrSH=a;const f=(e,t,r)=>e<<32-r|t>>>r;t.shrSL=f;const c=(e,t,r)=>e>>>r|t<<32-r;t.rotrSH=c;const h=(e,t,r)=>e<<32-r|t>>>r;t.rotrSL=h;const u=(e,t,r)=>e<<64-r|t>>>r-32;t.rotrBH=u;const l=(e,t,r)=>e>>>r-32|t<<64-r;t.rotrBL=l;const d=(e,t)=>t;t.rotr32H=d;const p=(e,t)=>e;t.rotr32L=p;const y=(e,t,r)=>e<<r|t>>>32-r;t.rotlSH=y;const b=(e,t,r)=>t<<r|e>>>32-r;t.rotlSL=b;const g=(e,t,r)=>t<<r-32|e>>>64-r;t.rotlBH=g;const m=(e,t,r)=>e<<r-32|t>>>64-r;function w(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}}t.rotlBL=m;const v=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);t.add3L=v;const _=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;t.add3H=_;const E=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);t.add4L=E;const S=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0;t.add4H=S;const B=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0);t.add5L=B;const M=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0;t.add5H=M;const A={fromBig:i,split:s,toBig:o,shrSH:a,shrSL:f,rotrSH:c,rotrSL:h,rotrBH:u,rotrBL:l,rotr32H:d,rotr32L:p,rotlSH:y,rotlSL:b,rotlBH:g,rotlBL:m,add:w,add3L:v,add3H:_,add4L:E,add4H:S,add5H:M,add5L:B};t.default=A},3852:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.platformCrypto=void 0;const n=r(1729),i=r(1498),s=r(3176);t.platformCrypto=n.isNode?i.NodeCrypto:s.BrowserCrypto},3903:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.storagify=t.MessagePackStore=t.MemoryStore=t.MessagePackStorage=t.LocalStorage=t.MemoryStorage=t.deserialize=t.serialize=void 0;const n=r(2655),i=r(4686),s=(e,t)=>t?"certificate"===e||"publicKey"===e||"secretKey"===e?"_bx_"+i.Buffer.from(t).toString("base64"):"Buffer"===t.constructor.name?"_bx_"+t.toString("base64"):"Buffer"===t.type?"_bx_"+i.Buffer.from(t.data).toString("base64"):"Array"===t.constructor.name||"Uint8Array"===t.constructor.name?"_bx_"+i.Buffer.from(t).toString("base64"):t:t,o=(e,t)=>{if("string"==typeof t){if(t.startsWith("__C__"))return i.Buffer.from(t.slice(5),"base64");if(t.startsWith("_bx_"))return i.Buffer.from(t.slice(4),"base64")}return t};t.serialize=e=>JSON.stringify(e,s),t.deserialize=e=>JSON.parse(e,o),t.MemoryStorage=e=>{let r={};return e||(e=()=>(0,t.serialize)(r)),(0,t.storagify)(r,e,()=>"")},t.LocalStorage=(e="vaultysStorage")=>{let r={};return localStorage[e]?r=(0,t.deserialize)(localStorage[e]):localStorage[e]="{}",(0,t.storagify)(r,()=>localStorage.setItem(e,(0,t.serialize)(r)),()=>localStorage.removeItem(e))},t.MessagePackStorage=(e="vaultysStorage")=>{let r={};return localStorage[e]?r=(0,n.decode)(localStorage[e]):localStorage[e]=i.Buffer.from((0,n.encode)({})).toString("base64"),(0,t.storagify)(r,()=>localStorage.setItem(e,i.Buffer.from((0,n.encode)(r)).toString("base64")),()=>localStorage.removeItem(e))};class a{constructor(e){this._raw=e}save(){}destroy(){}toString(){return i.Buffer.from((0,n.encode)(this._raw)).toString("base64")}toJSON(){return(0,n.decode)((0,n.encode)(this._raw))}fromJSON(e,t,r){return new a(e)}fromString(e,t,r){return new a((0,n.decode)(i.Buffer.from(e,"base64")))}set(e,t){this._raw[e]=t}delete(e){delete this._raw[e]}get(e){return this._raw[e]}list(){return Object.keys(this._raw).filter(e=>!e.startsWith("!"))}listSubstores(){return Object.keys(this._raw).filter(e=>e.startsWith("!")).map(e=>e.slice(1))}deleteSubstore(e){delete this._raw["!"+e]}renameSubstore(e,t){e===t||this._raw["!"+t]||(this._raw["!"+t]=this._raw["!"+e],delete this._raw["!"+e])}substore(e){return this._raw["!"+e]||(this._raw["!"+e]={}),new a(this._raw["!"+e])}}t.MemoryStore=class extends a{},t.MessagePackStore=class extends a{},t.storagify=(e,r=()=>{},n=()=>{})=>{const i={_raw:e};return{...i,destroy:n,save:r,toString:()=>(0,t.serialize)(i._raw),toJSON:()=>(0,t.deserialize)((0,t.serialize)(i._raw)),fromJSON:(e,r,n)=>(0,t.storagify)(e,r,n),fromString:(e,r,n)=>(0,t.storagify)((0,t.deserialize)(e),r,n),set:(e,t)=>i._raw[e]=t,delete:e=>delete i._raw[e],get:e=>i._raw[e],list:()=>Object.keys(i._raw).filter(e=>!e.startsWith("!")),listSubstores:()=>Object.keys(i._raw).filter(e=>e.startsWith("!")).map(e=>e.slice(1)),deleteSubstore:e=>delete i._raw["!"+e],renameSubstore:(e,t)=>{e===t||i._raw["!"+t]||(i._raw["!"+t]=i._raw["!"+e],delete i._raw["!"+e])},substore:e=>(i._raw["!"+e]||(i._raw["!"+e]={}),(0,t.storagify)(i._raw["!"+e],r,n))}}},3990:function(e,t,r){"use strict";var n=r(4686).Buffer,i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{f(n.next(e))}catch(e){s(e)}}function a(e){try{f(n.throw(e))}catch(e){s(e)}}function f(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}f((n=n.apply(e,t||[])).next())})},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DecryptStream=t.EncryptStream=void 0,t.debugSetKey=function(e){y=e},t.debugSetKeypair=function(e){b=e},t.encrypt=function(e,t,r){return i(this,void 0,void 0,function*(){const i=(0,h.chunkBuffer)(e,p),s=null!=y?y:n.from((0,l.randomBytes)(32)),o=null!=b?b:l.box.keyPair();t=null!=t?t:o;const u=r.map((e,t)=>f.default.create(e,o.secretKey,s,t)),d=a.default.create(o.publicKey,s,t.publicKey,u);for(const e of u)e.generateMacKeyForSender(d.hash,o.secretKey,t.secretKey);const g=[];for(const e in i){const t=i[e],r=i.length===parseInt(e)+1,n=c.default.create(d,s,t,BigInt(e),r);g.push(n)}return n.concat([d.encoded,n.concat(g.map(e=>e.encoded))])})},t.decrypt=function(e,t,r){return i(this,void 0,void 0,function*(){var i,o,f,h;const l=new u.Readable;l.push(e),l.push(null);const p=[];try{for(var y,b=!0,g=s((0,d.decodeMultiStream)(l));!(i=(y=yield g.next()).done);b=!0){h=y.value,b=!1;const e=h;p.push(e)}}catch(e){o={error:e}}finally{try{b||i||!(f=g.return)||(yield f.call(g))}finally{if(o)throw o.error}}const m=p.shift(),w=a.default.decode(m,!0),[v,_]=w.decryptPayloadKey(t),E=w.decryptSender(v);if(r&&!n.from(E).equals(r))throw new Error("Sender public key doesn't match");_.generateMacKeyForRecipient(w.hash,w.public_key,E,t.secretKey);let S=n.alloc(0);for(const e in p){const t=p[e],r=c.default.decode(t,!0),i=p.length===parseInt(e)+1;if(r.final&&!i)throw new Error("Found payload with invalid final flag, message extended?");if(!r.final&&i)throw new Error("Found payload with invalid final flag, message truncated?");S=n.concat([S,r.decrypt(w,_,v,BigInt(e))])}if(!p.length)throw new Error("No encrypted payloads, message truncated?");return Object.assign(S,{sender_public_key:E})})};const a=o(r(9913)),f=o(r(9981)),c=o(r(3548)),h=r(568),u=r(896),l=r(4406),d=r(2655),p=1048576;let y=null,b=null;class g extends u.Transform{constructor(e,t){super(),this.in_buffer=n.alloc(0),this.payload_index=BigInt(0),this.i=0,this.payload_key=null!=y?y:n.from((0,l.randomBytes)(32)),this.ephemeral_keypair=null!=b?b:l.box.keyPair(),this.keypair=null!=e?e:this.ephemeral_keypair;const r=t.map((e,t)=>f.default.create(e,this.ephemeral_keypair.secretKey,this.payload_key,t));this.header=a.default.create(this.ephemeral_keypair.publicKey,this.payload_key,this.keypair.publicKey,r),this.push(this.header.encoded);for(const e of r)e.generateMacKeyForSender(this.header.hash,this.ephemeral_keypair.secretKey,this.keypair.secretKey)}_transform(e,t,r){for(this.in_buffer=n.concat([this.in_buffer,e]);this.in_buffer.length>p;){const e=this.in_buffer.slice(0,p);this.in_buffer=this.in_buffer.slice(p);const t=c.default.create(this.header,this.payload_key,e,this.payload_index,!1);this.push(t.encoded),this.payload_index++}r()}_flush(e){for(;this.in_buffer.length>=p;){const e=this.in_buffer.slice(0,p);this.in_buffer=this.in_buffer.slice(p);const t=!this.in_buffer.length,r=c.default.create(this.header,this.payload_key,e,this.payload_index,t);this.push(r.encoded),this.payload_index++}if(this.in_buffer.length){const e=this.in_buffer;this.in_buffer=n.alloc(0);const t=!this.in_buffer.length,r=c.default.create(this.header,this.payload_key,e,this.payload_index,t);this.push(r.encoded),this.payload_index++}e()}}t.EncryptStream=g;class m extends u.Transform{constructor(e,t){super(),this.keypair=e,this.decoder=new d.Decoder({extensionCodec:void 0}),this.header_data=null,this.last_payload=null,this.payload_index=BigInt(-1),this.i=0,this.sender=null!=t?t:null}get header(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[0]}get payload_key(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[1]}get recipient(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[2]}get sender_public_key(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[3]}_transform(e,t,r){this.decoder.appendBuffer(e);try{let e;for(;e=this.decoder.doDecodeSync();){const t=n.from(this.decoder.bytes).slice(this.decoder.pos);this.decoder.setBuffer(t),this._handleMessage(e)}}catch(e){}r()}_handleMessage(e){if(this.header_data){if(this.payload_index++,this.last_payload){if(this.last_payload.final)throw new Error("Found payload with invalid final flag, message extended?");this.push(this.last_payload.decrypt(this.header,this.recipient,this.payload_key,this.payload_index-BigInt(1)))}const t=c.default.decode(e,!0);this.last_payload=t}else{const t=a.default.decode(e,!0),[r,i]=t.decryptPayloadKey(this.keypair),s=t.decryptSender(r);if(this.sender&&!n.from(s).equals(this.sender))throw new Error("Sender public key doesn't match");i.generateMacKeyForRecipient(t.hash,t.public_key,s,this.keypair.secretKey),this.header_data=[t,r,i,s]}}_flush(e){try{if(this.last_payload){if(!this.last_payload.final)throw new Error("Found payload with invalid final flag, message truncated?");this.push(this.last_payload.decrypt(this.header,this.recipient,this.payload_key,this.payload_index))}if(!this.last_payload)throw new Error("No encrypted payloads, message truncated?")}catch(t){return e(t)}e()}}t.DecryptStream=m},4015:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;const n=r(5598),i=r(4686);t.encrypt=(e,t)=>{const r=t,s=(0,n.randomBytes)(n.secretbox.nonceLength),o=(0,n.secretbox)(Uint8Array.from(e),s,r),a=new Uint8Array(s.length+o.length);return a.set(s),a.set(o,s.length),i.Buffer.from(a)},t.decrypt=(e,t)=>{const r=t,s=e,o=s.slice(0,n.secretbox.nonceLength),a=s.slice(n.secretbox.nonceLength,e.length),f=n.secretbox.open(a,o,r);if(!f)throw new Error("Could not decrypt message");return i.Buffer.from(f)},t.default={decrypt:t.decrypt,encrypt:t.encrypt,encryptChannel:(e,r)=>{const n={apply:(e,n,i)=>e.call(n,(0,t.encrypt)(i[0],r))},i={async apply(e,n,i){const s=await e.call(n);return(0,t.decrypt)(s,r)}};return e.send=new Proxy(e.send,n),e.receive=new Proxy(e.receive,i),e},generateKey:()=>(0,n.randomBytes)(32)}},4047:(e,t,r)=>{var n=r(1868),i=r(1609),s=r(9273),o=r(6671).Buffer,a=r(8039),f=r(6552),c=r(4427),h=o.alloc(128),u={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function l(e,t,r){var a=function(e){return"rmd160"===e||"ripemd160"===e?function(e){return(new i).update(e).digest()}:"md5"===e?n:function(t){return s(e).update(t).digest()}}(e),f="sha512"===e||"sha384"===e?128:64;t.length>f?t=a(t):t.length<f&&(t=o.concat([t,h],f));for(var c=o.allocUnsafe(f+u[e]),l=o.allocUnsafe(f+u[e]),d=0;d<f;d++)c[d]=54^t[d],l[d]=92^t[d];var p=o.allocUnsafe(f+r+4);c.copy(p,0,0,f),this.ipad1=p,this.ipad2=c,this.opad=l,this.alg=e,this.blocksize=f,this.hash=a,this.size=u[e]}l.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},e.exports=function(e,t,r,n,i){a(r,n);var s=new l(i=i||"sha1",e=c(e,f,"Password"),(t=c(t,f,"Salt")).length),h=o.allocUnsafe(n),d=o.allocUnsafe(t.length+4);t.copy(d,0,0,t.length);for(var p=0,y=u[i],b=Math.ceil(n/y),g=1;g<=b;g++){d.writeUInt32BE(g,t.length);for(var m=s.run(d,s.ipad1),w=m,v=1;v<r;v++){w=s.run(w,s.ipad2);for(var _=0;_<y;_++)m[_]^=w[_]}m.copy(h,p),p+=y}return h}},4048:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=void 0,t.isNode="undefined"==typeof window,t.isBrowser=!t.isNode},4072:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sha512_224=t.sha512_256=t.sha384=t.sha512=t.sha224=t.sha256=t.SHA512_256=t.SHA512_224=t.SHA384=t.SHA512=t.SHA224=t.SHA256=void 0;const n=r(7734),i=r(3842),s=r(11),o=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array(64);class f extends n.HashMD{constructor(e=32){super(64,e,8,!1),this.A=0|n.SHA256_IV[0],this.B=0|n.SHA256_IV[1],this.C=0|n.SHA256_IV[2],this.D=0|n.SHA256_IV[3],this.E=0|n.SHA256_IV[4],this.F=0|n.SHA256_IV[5],this.G=0|n.SHA256_IV[6],this.H=0|n.SHA256_IV[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)a[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=a[e-15],r=a[e-2],n=(0,s.rotr)(t,7)^(0,s.rotr)(t,18)^t>>>3,i=(0,s.rotr)(r,17)^(0,s.rotr)(r,19)^r>>>10;a[e]=i+a[e-7]+n+a[e-16]|0}let{A:r,B:i,C:f,D:c,E:h,F:u,G:l,H:d}=this;for(let e=0;e<64;e++){const t=d+((0,s.rotr)(h,6)^(0,s.rotr)(h,11)^(0,s.rotr)(h,25))+(0,n.Chi)(h,u,l)+o[e]+a[e]|0,p=((0,s.rotr)(r,2)^(0,s.rotr)(r,13)^(0,s.rotr)(r,22))+(0,n.Maj)(r,i,f)|0;d=l,l=u,u=h,h=c+t|0,c=f,f=i,i=r,r=t+p|0}r=r+this.A|0,i=i+this.B|0,f=f+this.C|0,c=c+this.D|0,h=h+this.E|0,u=u+this.F|0,l=l+this.G|0,d=d+this.H|0,this.set(r,i,f,c,h,u,l,d)}roundClean(){(0,s.clean)(a)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,s.clean)(this.buffer)}}t.SHA256=f;class c extends f{constructor(){super(28),this.A=0|n.SHA224_IV[0],this.B=0|n.SHA224_IV[1],this.C=0|n.SHA224_IV[2],this.D=0|n.SHA224_IV[3],this.E=0|n.SHA224_IV[4],this.F=0|n.SHA224_IV[5],this.G=0|n.SHA224_IV[6],this.H=0|n.SHA224_IV[7]}}t.SHA224=c;const h=(()=>i.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),u=(()=>h[0])(),l=(()=>h[1])(),d=new Uint32Array(80),p=new Uint32Array(80);class y extends n.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=0|n.SHA512_IV[0],this.Al=0|n.SHA512_IV[1],this.Bh=0|n.SHA512_IV[2],this.Bl=0|n.SHA512_IV[3],this.Ch=0|n.SHA512_IV[4],this.Cl=0|n.SHA512_IV[5],this.Dh=0|n.SHA512_IV[6],this.Dl=0|n.SHA512_IV[7],this.Eh=0|n.SHA512_IV[8],this.El=0|n.SHA512_IV[9],this.Fh=0|n.SHA512_IV[10],this.Fl=0|n.SHA512_IV[11],this.Gh=0|n.SHA512_IV[12],this.Gl=0|n.SHA512_IV[13],this.Hh=0|n.SHA512_IV[14],this.Hl=0|n.SHA512_IV[15]}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:f,El:c,Fh:h,Fl:u,Gh:l,Gl:d,Hh:p,Hl:y}=this;return[e,t,r,n,i,s,o,a,f,c,h,u,l,d,p,y]}set(e,t,r,n,i,s,o,a,f,c,h,u,l,d,p,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|f,this.El=0|c,this.Fh=0|h,this.Fl=0|u,this.Gh=0|l,this.Gl=0|d,this.Hh=0|p,this.Hl=0|y}process(e,t){for(let r=0;r<16;r++,t+=4)d[r]=e.getUint32(t),p[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|d[e-15],r=0|p[e-15],n=i.rotrSH(t,r,1)^i.rotrSH(t,r,8)^i.shrSH(t,r,7),s=i.rotrSL(t,r,1)^i.rotrSL(t,r,8)^i.shrSL(t,r,7),o=0|d[e-2],a=0|p[e-2],f=i.rotrSH(o,a,19)^i.rotrBH(o,a,61)^i.shrSH(o,a,6),c=i.rotrSL(o,a,19)^i.rotrBL(o,a,61)^i.shrSL(o,a,6),h=i.add4L(s,c,p[e-7],p[e-16]),u=i.add4H(h,n,f,d[e-7],d[e-16]);d[e]=0|u,p[e]=0|h}let{Ah:r,Al:n,Bh:s,Bl:o,Ch:a,Cl:f,Dh:c,Dl:h,Eh:y,El:b,Fh:g,Fl:m,Gh:w,Gl:v,Hh:_,Hl:E}=this;for(let e=0;e<80;e++){const t=i.rotrSH(y,b,14)^i.rotrSH(y,b,18)^i.rotrBH(y,b,41),S=i.rotrSL(y,b,14)^i.rotrSL(y,b,18)^i.rotrBL(y,b,41),B=y&g^~y&w,M=b&m^~b&v,A=i.add5L(E,S,M,l[e],p[e]),I=i.add5H(A,_,t,B,u[e],d[e]),x=0|A,k=i.rotrSH(r,n,28)^i.rotrBH(r,n,34)^i.rotrBH(r,n,39),T=i.rotrSL(r,n,28)^i.rotrBL(r,n,34)^i.rotrBL(r,n,39),P=r&s^r&a^s&a,O=n&o^n&f^o&f;_=0|w,E=0|v,w=0|g,v=0|m,g=0|y,m=0|b,({h:y,l:b}=i.add(0|c,0|h,0|I,0|x)),c=0|a,h=0|f,a=0|s,f=0|o,s=0|r,o=0|n;const R=i.add3L(x,T,O);r=i.add3H(R,I,k,P),n=0|R}({h:r,l:n}=i.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:s,l:o}=i.add(0|this.Bh,0|this.Bl,0|s,0|o)),({h:a,l:f}=i.add(0|this.Ch,0|this.Cl,0|a,0|f)),({h:c,l:h}=i.add(0|this.Dh,0|this.Dl,0|c,0|h)),({h:y,l:b}=i.add(0|this.Eh,0|this.El,0|y,0|b)),({h:g,l:m}=i.add(0|this.Fh,0|this.Fl,0|g,0|m)),({h:w,l:v}=i.add(0|this.Gh,0|this.Gl,0|w,0|v)),({h:_,l:E}=i.add(0|this.Hh,0|this.Hl,0|_,0|E)),this.set(r,n,s,o,a,f,c,h,y,b,g,m,w,v,_,E)}roundClean(){(0,s.clean)(d,p)}destroy(){(0,s.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}t.SHA512=y;class b extends y{constructor(){super(48),this.Ah=0|n.SHA384_IV[0],this.Al=0|n.SHA384_IV[1],this.Bh=0|n.SHA384_IV[2],this.Bl=0|n.SHA384_IV[3],this.Ch=0|n.SHA384_IV[4],this.Cl=0|n.SHA384_IV[5],this.Dh=0|n.SHA384_IV[6],this.Dl=0|n.SHA384_IV[7],this.Eh=0|n.SHA384_IV[8],this.El=0|n.SHA384_IV[9],this.Fh=0|n.SHA384_IV[10],this.Fl=0|n.SHA384_IV[11],this.Gh=0|n.SHA384_IV[12],this.Gl=0|n.SHA384_IV[13],this.Hh=0|n.SHA384_IV[14],this.Hl=0|n.SHA384_IV[15]}}t.SHA384=b;const g=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),m=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class w extends y{constructor(){super(28),this.Ah=0|g[0],this.Al=0|g[1],this.Bh=0|g[2],this.Bl=0|g[3],this.Ch=0|g[4],this.Cl=0|g[5],this.Dh=0|g[6],this.Dl=0|g[7],this.Eh=0|g[8],this.El=0|g[9],this.Fh=0|g[10],this.Fl=0|g[11],this.Gh=0|g[12],this.Gl=0|g[13],this.Hh=0|g[14],this.Hl=0|g[15]}}t.SHA512_224=w;class v extends y{constructor(){super(32),this.Ah=0|m[0],this.Al=0|m[1],this.Bh=0|m[2],this.Bl=0|m[3],this.Ch=0|m[4],this.Cl=0|m[5],this.Dh=0|m[6],this.Dl=0|m[7],this.Eh=0|m[8],this.El=0|m[9],this.Fh=0|m[10],this.Fl=0|m[11],this.Gh=0|m[12],this.Gl=0|m[13],this.Hh=0|m[14],this.Hl=0|m[15]}}t.SHA512_256=v,t.sha256=(0,s.createHasher)(()=>new f),t.sha224=(0,s.createHasher)(()=>new c),t.sha512=(0,s.createHasher)(()=>new y),t.sha384=(0,s.createHasher)(()=>new b),t.sha512_256=(0,s.createHasher)(()=>new v),t.sha512_224=(0,s.createHasher)(()=>new w)},4105:(e,t,r)=>{"use strict";var n=r(6671).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=f,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=h,this.end=u,t=3;break;default:return this.write=l,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function f(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function h(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function u(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function l(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.I=s,s.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=o(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},4203:()=>{},4324:(e,t,r)=>{"use strict";var n,i=r(8558);e.exports=M,M.ReadableState=B,r(9784).EventEmitter;var s,o=function(e,t){return e.listeners(t).length},a=r(9481),f=r(4686).Buffer,c=(void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},h=r(8854);s=h&&h.debuglog?h.debuglog("stream"):function(){};var u,l,d,p=r(9865),y=r(4552),b=r(7963).getHighWaterMark,g=r(8704).F,m=g.ERR_INVALID_ARG_TYPE,w=g.ERR_STREAM_PUSH_AFTER_EOF,v=g.ERR_METHOD_NOT_IMPLEMENTED,_=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(6192)(M,a);var E=y.errorOrDestroy,S=["error","close","destroy","pause","resume"];function B(e,t,i){n=n||r(5606),e=e||{},"boolean"!=typeof i&&(i=t instanceof n),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=b(this,e,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(u||(u=r(4105).I),this.decoder=new u(e.encoding),this.encoding=e.encoding)}function M(e){if(n=n||r(5606),!(this instanceof M))return new M(e);var t=this instanceof n;this._readableState=new B(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function A(e,t,r,n,i){s("readableAddChunk",t);var o,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(s("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?T(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,P(e)))}}(e,a);else if(i||(o=function(e,t){var r,n;return n=t,f.isBuffer(n)||n instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new m("chunk",["string","Buffer","Uint8Array"],t)),r}(a,t)),o)E(e,o);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===f.prototype||(t=function(e){return f.from(e)}(t)),n)a.endEmitted?E(e,new _):I(e,a,t,!0);else if(a.ended)E(e,new w);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?I(e,a,t,!1):O(e,a)):I(e,a,t,!1)}else n||(a.reading=!1,O(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function I(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&T(e)),O(e,t)}Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),M.prototype.destroy=y.destroy,M.prototype._undestroy=y.undestroy,M.prototype._destroy=function(e,t){t(e)},M.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=f.from(e,t),t=""),r=!0),A(this,e,t,!1,r)},M.prototype.unshift=function(e){return A(this,e,null,!0,!1)},M.prototype.isPaused=function(){return!1===this._readableState.flowing},M.prototype.setEncoding=function(e){u||(u=r(4105).I);var t=new u(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var x=1073741824;function k(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=x?e=x:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function T(e){var t=e._readableState;s("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(s("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(P,e))}function P(e){var t=e._readableState;s("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function O(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(R,e,t))}function R(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(s("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function K(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function C(e){s("readable nexttick read 0"),e.read(0)}function U(e,t){s("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(s("flow",t.flowing);t.flowing&&null!==e.read(););}function L(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function N(e){var t=e._readableState;s("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(H,t,e))}function H(e,t){if(s("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function F(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}M.prototype.read=function(e){s("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return s("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?N(this):T(this),null;if(0===(e=k(e,t))&&t.ended)return 0===t.length&&N(this),null;var n,i=t.needReadable;return s("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&s("length less than watermark",i=!0),t.ended||t.reading?s("reading or ended",i=!1):i&&(s("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=k(r,t))),null===(n=e>0?L(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&N(this)),null!==n&&this.emit("data",n),n},M.prototype._read=function(e){E(this,new v("_read()"))},M.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,s("pipe count=%d opts=%j",n.pipesCount,t);var a=t&&!1===t.end||e===i.stdout||e===i.stderr?y:f;function f(){s("onend"),e.end()}n.endEmitted?i.nextTick(a):r.once("end",a),e.on("unpipe",function t(i,o){s("onunpipe"),i===r&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,s("cleanup"),e.removeListener("close",d),e.removeListener("finish",p),e.removeListener("drain",c),e.removeListener("error",l),e.removeListener("unpipe",t),r.removeListener("end",f),r.removeListener("end",y),r.removeListener("data",u),h=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||c())});var c=function(e){return function(){var t=e._readableState;s("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,D(e))}}(r);e.on("drain",c);var h=!1;function u(t){s("ondata");var i=e.write(t);s("dest.write",i),!1===i&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==F(n.pipes,e))&&!h&&(s("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function l(t){s("onerror",t),y(),e.removeListener("error",l),0===o(e,"error")&&E(e,t)}function d(){e.removeListener("finish",p),y()}function p(){s("onfinish"),e.removeListener("close",d),y()}function y(){s("unpipe"),r.unpipe(e)}return r.on("data",u),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",l),e.once("close",d),e.once("finish",p),e.emit("pipe",r),n.flowing||(s("pipe resume"),r.resume()),e},M.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=F(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},M.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,s("on readable",n.length,n.reading),n.length?T(this):n.reading||i.nextTick(C,this))),r},M.prototype.addListener=M.prototype.on,M.prototype.removeListener=function(e,t){var r=a.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(K,this),r},M.prototype.removeAllListeners=function(e){var t=a.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(K,this),t},M.prototype.resume=function(){var e=this._readableState;return e.flowing||(s("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(U,e,t))}(this,e)),e.paused=!1,this},M.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},M.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",function(){if(s("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){s("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<S.length;o++)e.on(S[o],this.emit.bind(this,S[o]));return this._read=function(t){s("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(M.prototype[Symbol.asyncIterator]=function(){return void 0===l&&(l=r(9035)),l(this)}),Object.defineProperty(M.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(M.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(M.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),M._fromList=L,Object.defineProperty(M.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(M.from=function(e,t){return void 0===d&&(d=r(6869)),d(M,e,t)})},4406:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var o=t(),a=t([1]),f=t([56129,1]),c=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function y(e,t,r,n,i){var s,o=0;for(s=0;s<i;s++)o|=e[t+s]^r[n+s];return(1&o-1>>>8)-1}function b(e,t,r,n){return y(e,t,r,n,16)}function g(e,t,r,n){return y(e,t,r,n,32)}function m(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,c=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,h=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,u=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,b=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,v=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=s,E=o,S=a,B=f,M=c,A=h,I=u,x=l,k=d,T=p,P=y,O=b,R=g,K=m,C=w,U=v,D=0;D<20;D+=2)_^=(i=(R^=(i=(k^=(i=(M^=(i=_+R|0)<<7|i>>>25)+_|0)<<9|i>>>23)+M|0)<<13|i>>>19)+k|0)<<18|i>>>14,A^=(i=(E^=(i=(K^=(i=(T^=(i=A+E|0)<<7|i>>>25)+A|0)<<9|i>>>23)+T|0)<<13|i>>>19)+K|0)<<18|i>>>14,P^=(i=(I^=(i=(S^=(i=(C^=(i=P+I|0)<<7|i>>>25)+P|0)<<9|i>>>23)+C|0)<<13|i>>>19)+S|0)<<18|i>>>14,U^=(i=(O^=(i=(x^=(i=(B^=(i=U+O|0)<<7|i>>>25)+U|0)<<9|i>>>23)+B|0)<<13|i>>>19)+x|0)<<18|i>>>14,_^=(i=(B^=(i=(S^=(i=(E^=(i=_+B|0)<<7|i>>>25)+_|0)<<9|i>>>23)+E|0)<<13|i>>>19)+S|0)<<18|i>>>14,A^=(i=(M^=(i=(x^=(i=(I^=(i=A+M|0)<<7|i>>>25)+A|0)<<9|i>>>23)+I|0)<<13|i>>>19)+x|0)<<18|i>>>14,P^=(i=(T^=(i=(k^=(i=(O^=(i=P+T|0)<<7|i>>>25)+P|0)<<9|i>>>23)+O|0)<<13|i>>>19)+k|0)<<18|i>>>14,U^=(i=(C^=(i=(K^=(i=(R^=(i=U+C|0)<<7|i>>>25)+U|0)<<9|i>>>23)+R|0)<<13|i>>>19)+K|0)<<18|i>>>14;_=_+s|0,E=E+o|0,S=S+a|0,B=B+f|0,M=M+c|0,A=A+h|0,I=I+u|0,x=x+l|0,k=k+d|0,T=T+p|0,P=P+y|0,O=O+b|0,R=R+g|0,K=K+m|0,C=C+w|0,U=U+v|0,e[0]=_>>>0&255,e[1]=_>>>8&255,e[2]=_>>>16&255,e[3]=_>>>24&255,e[4]=E>>>0&255,e[5]=E>>>8&255,e[6]=E>>>16&255,e[7]=E>>>24&255,e[8]=S>>>0&255,e[9]=S>>>8&255,e[10]=S>>>16&255,e[11]=S>>>24&255,e[12]=B>>>0&255,e[13]=B>>>8&255,e[14]=B>>>16&255,e[15]=B>>>24&255,e[16]=M>>>0&255,e[17]=M>>>8&255,e[18]=M>>>16&255,e[19]=M>>>24&255,e[20]=A>>>0&255,e[21]=A>>>8&255,e[22]=A>>>16&255,e[23]=A>>>24&255,e[24]=I>>>0&255,e[25]=I>>>8&255,e[26]=I>>>16&255,e[27]=I>>>24&255,e[28]=x>>>0&255,e[29]=x>>>8&255,e[30]=x>>>16&255,e[31]=x>>>24&255,e[32]=k>>>0&255,e[33]=k>>>8&255,e[34]=k>>>16&255,e[35]=k>>>24&255,e[36]=T>>>0&255,e[37]=T>>>8&255,e[38]=T>>>16&255,e[39]=T>>>24&255,e[40]=P>>>0&255,e[41]=P>>>8&255,e[42]=P>>>16&255,e[43]=P>>>24&255,e[44]=O>>>0&255,e[45]=O>>>8&255,e[46]=O>>>16&255,e[47]=O>>>24&255,e[48]=R>>>0&255,e[49]=R>>>8&255,e[50]=R>>>16&255,e[51]=R>>>24&255,e[52]=K>>>0&255,e[53]=K>>>8&255,e[54]=K>>>16&255,e[55]=K>>>24&255,e[56]=C>>>0&255,e[57]=C>>>8&255,e[58]=C>>>16&255,e[59]=C>>>24&255,e[60]=U>>>0&255,e[61]=U>>>8&255,e[62]=U>>>16&255,e[63]=U>>>24&255}(e,t,r,n)}function w(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,c=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,h=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,u=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,b=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,v=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=0;_<20;_+=2)s^=(i=(g^=(i=(d^=(i=(c^=(i=s+g|0)<<7|i>>>25)+s|0)<<9|i>>>23)+c|0)<<13|i>>>19)+d|0)<<18|i>>>14,h^=(i=(o^=(i=(m^=(i=(p^=(i=h+o|0)<<7|i>>>25)+h|0)<<9|i>>>23)+p|0)<<13|i>>>19)+m|0)<<18|i>>>14,y^=(i=(u^=(i=(a^=(i=(w^=(i=y+u|0)<<7|i>>>25)+y|0)<<9|i>>>23)+w|0)<<13|i>>>19)+a|0)<<18|i>>>14,v^=(i=(b^=(i=(l^=(i=(f^=(i=v+b|0)<<7|i>>>25)+v|0)<<9|i>>>23)+f|0)<<13|i>>>19)+l|0)<<18|i>>>14,s^=(i=(f^=(i=(a^=(i=(o^=(i=s+f|0)<<7|i>>>25)+s|0)<<9|i>>>23)+o|0)<<13|i>>>19)+a|0)<<18|i>>>14,h^=(i=(c^=(i=(l^=(i=(u^=(i=h+c|0)<<7|i>>>25)+h|0)<<9|i>>>23)+u|0)<<13|i>>>19)+l|0)<<18|i>>>14,y^=(i=(p^=(i=(d^=(i=(b^=(i=y+p|0)<<7|i>>>25)+y|0)<<9|i>>>23)+b|0)<<13|i>>>19)+d|0)<<18|i>>>14,v^=(i=(w^=(i=(m^=(i=(g^=(i=v+w|0)<<7|i>>>25)+v|0)<<9|i>>>23)+g|0)<<13|i>>>19)+m|0)<<18|i>>>14;e[0]=s>>>0&255,e[1]=s>>>8&255,e[2]=s>>>16&255,e[3]=s>>>24&255,e[4]=h>>>0&255,e[5]=h>>>8&255,e[6]=h>>>16&255,e[7]=h>>>24&255,e[8]=y>>>0&255,e[9]=y>>>8&255,e[10]=y>>>16&255,e[11]=y>>>24&255,e[12]=v>>>0&255,e[13]=v>>>8&255,e[14]=v>>>16&255,e[15]=v>>>24&255,e[16]=u>>>0&255,e[17]=u>>>8&255,e[18]=u>>>16&255,e[19]=u>>>24&255,e[20]=l>>>0&255,e[21]=l>>>8&255,e[22]=l>>>16&255,e[23]=l>>>24&255,e[24]=d>>>0&255,e[25]=d>>>8&255,e[26]=d>>>16&255,e[27]=d>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var v=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function _(e,t,r,n,i,s,o){var a,f,c=new Uint8Array(16),h=new Uint8Array(64);for(f=0;f<16;f++)c[f]=0;for(f=0;f<8;f++)c[f]=s[f];for(;i>=64;){for(m(h,c,o,v),f=0;f<64;f++)e[t+f]=r[n+f]^h[f];for(a=1,f=8;f<16;f++)a=a+(255&c[f])|0,c[f]=255&a,a>>>=8;i-=64,t+=64,n+=64}if(i>0)for(m(h,c,o,v),f=0;f<i;f++)e[t+f]=r[n+f]^h[f];return 0}function E(e,t,r,n,i){var s,o,a=new Uint8Array(16),f=new Uint8Array(64);for(o=0;o<16;o++)a[o]=0;for(o=0;o<8;o++)a[o]=n[o];for(;r>=64;){for(m(f,a,i,v),o=0;o<64;o++)e[t+o]=f[o];for(s=1,o=8;o<16;o++)s=s+(255&a[o])|0,a[o]=255&s,s>>>=8;r-=64,t+=64}if(r>0)for(m(f,a,i,v),o=0;o<r;o++)e[t+o]=f[o];return 0}function S(e,t,r,n,i){var s=new Uint8Array(32);w(s,n,i,v);for(var o=new Uint8Array(8),a=0;a<8;a++)o[a]=n[a+16];return E(e,t,r,o,s)}function B(e,t,r,n,i,s,o){var a=new Uint8Array(32);w(a,s,o,v);for(var f=new Uint8Array(8),c=0;c<8;c++)f[c]=s[c+16];return _(e,t,r,n,i,f,a)}var M=function(e){var t,r,n,i,s,o,a,f;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|i<<9),s=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|s<<12),this.r[5]=s>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(s>>>14|o<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|a<<5),f=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|f<<8),this.r[9]=f>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function A(e,t,r,n,i,s){var o=new M(s);return o.update(r,n,i),o.finish(e,t),0}function I(e,t,r,n,i,s){var o=new Uint8Array(16);return A(o,0,r,n,i,s),b(e,t,o,0)}function x(e,t,r,n,i){var s;if(r<32)return-1;for(B(e,0,t,0,r,n,i),A(e,16,e,32,r-32,e),s=0;s<16;s++)e[s]=0;return 0}function k(e,t,r,n,i){var s,o=new Uint8Array(32);if(r<32)return-1;if(S(o,0,32,n,i),0!==I(t,16,t,32,r-32,o))return-1;for(B(e,0,t,0,r,n,i),s=0;s<32;s++)e[s]=0;return 0}function T(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function P(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function O(e,t,r){for(var n,i=~(r-1),s=0;s<16;s++)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function R(e,r){var n,i,s,o=t(),a=t();for(n=0;n<16;n++)a[n]=r[n];for(P(a),P(a),P(a),i=0;i<2;i++){for(o[0]=a[0]-65517,n=1;n<15;n++)o[n]=a[n]-65535-(o[n-1]>>16&1),o[n-1]&=65535;o[15]=a[15]-32767-(o[14]>>16&1),s=o[15]>>16&1,o[14]&=65535,O(a,o,1-s)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function K(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return R(r,e),R(n,t),g(r,0,n,0)}function C(e){var t=new Uint8Array(32);return R(t,e),1&t[0]}function U(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function D(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function L(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function N(e,t,r){var n,i,s=0,o=0,a=0,f=0,c=0,h=0,u=0,l=0,d=0,p=0,y=0,b=0,g=0,m=0,w=0,v=0,_=0,E=0,S=0,B=0,M=0,A=0,I=0,x=0,k=0,T=0,P=0,O=0,R=0,K=0,C=0,U=r[0],D=r[1],L=r[2],N=r[3],H=r[4],F=r[5],j=r[6],z=r[7],q=r[8],V=r[9],G=r[10],W=r[11],Y=r[12],$=r[13],Z=r[14],X=r[15];s+=(n=t[0])*U,o+=n*D,a+=n*L,f+=n*N,c+=n*H,h+=n*F,u+=n*j,l+=n*z,d+=n*q,p+=n*V,y+=n*G,b+=n*W,g+=n*Y,m+=n*$,w+=n*Z,v+=n*X,o+=(n=t[1])*U,a+=n*D,f+=n*L,c+=n*N,h+=n*H,u+=n*F,l+=n*j,d+=n*z,p+=n*q,y+=n*V,b+=n*G,g+=n*W,m+=n*Y,w+=n*$,v+=n*Z,_+=n*X,a+=(n=t[2])*U,f+=n*D,c+=n*L,h+=n*N,u+=n*H,l+=n*F,d+=n*j,p+=n*z,y+=n*q,b+=n*V,g+=n*G,m+=n*W,w+=n*Y,v+=n*$,_+=n*Z,E+=n*X,f+=(n=t[3])*U,c+=n*D,h+=n*L,u+=n*N,l+=n*H,d+=n*F,p+=n*j,y+=n*z,b+=n*q,g+=n*V,m+=n*G,w+=n*W,v+=n*Y,_+=n*$,E+=n*Z,S+=n*X,c+=(n=t[4])*U,h+=n*D,u+=n*L,l+=n*N,d+=n*H,p+=n*F,y+=n*j,b+=n*z,g+=n*q,m+=n*V,w+=n*G,v+=n*W,_+=n*Y,E+=n*$,S+=n*Z,B+=n*X,h+=(n=t[5])*U,u+=n*D,l+=n*L,d+=n*N,p+=n*H,y+=n*F,b+=n*j,g+=n*z,m+=n*q,w+=n*V,v+=n*G,_+=n*W,E+=n*Y,S+=n*$,B+=n*Z,M+=n*X,u+=(n=t[6])*U,l+=n*D,d+=n*L,p+=n*N,y+=n*H,b+=n*F,g+=n*j,m+=n*z,w+=n*q,v+=n*V,_+=n*G,E+=n*W,S+=n*Y,B+=n*$,M+=n*Z,A+=n*X,l+=(n=t[7])*U,d+=n*D,p+=n*L,y+=n*N,b+=n*H,g+=n*F,m+=n*j,w+=n*z,v+=n*q,_+=n*V,E+=n*G,S+=n*W,B+=n*Y,M+=n*$,A+=n*Z,I+=n*X,d+=(n=t[8])*U,p+=n*D,y+=n*L,b+=n*N,g+=n*H,m+=n*F,w+=n*j,v+=n*z,_+=n*q,E+=n*V,S+=n*G,B+=n*W,M+=n*Y,A+=n*$,I+=n*Z,x+=n*X,p+=(n=t[9])*U,y+=n*D,b+=n*L,g+=n*N,m+=n*H,w+=n*F,v+=n*j,_+=n*z,E+=n*q,S+=n*V,B+=n*G,M+=n*W,A+=n*Y,I+=n*$,x+=n*Z,k+=n*X,y+=(n=t[10])*U,b+=n*D,g+=n*L,m+=n*N,w+=n*H,v+=n*F,_+=n*j,E+=n*z,S+=n*q,B+=n*V,M+=n*G,A+=n*W,I+=n*Y,x+=n*$,k+=n*Z,T+=n*X,b+=(n=t[11])*U,g+=n*D,m+=n*L,w+=n*N,v+=n*H,_+=n*F,E+=n*j,S+=n*z,B+=n*q,M+=n*V,A+=n*G,I+=n*W,x+=n*Y,k+=n*$,T+=n*Z,P+=n*X,g+=(n=t[12])*U,m+=n*D,w+=n*L,v+=n*N,_+=n*H,E+=n*F,S+=n*j,B+=n*z,M+=n*q,A+=n*V,I+=n*G,x+=n*W,k+=n*Y,T+=n*$,P+=n*Z,O+=n*X,m+=(n=t[13])*U,w+=n*D,v+=n*L,_+=n*N,E+=n*H,S+=n*F,B+=n*j,M+=n*z,A+=n*q,I+=n*V,x+=n*G,k+=n*W,T+=n*Y,P+=n*$,O+=n*Z,R+=n*X,w+=(n=t[14])*U,v+=n*D,_+=n*L,E+=n*N,S+=n*H,B+=n*F,M+=n*j,A+=n*z,I+=n*q,x+=n*V,k+=n*G,T+=n*W,P+=n*Y,O+=n*$,R+=n*Z,K+=n*X,v+=(n=t[15])*U,o+=38*(E+=n*L),a+=38*(S+=n*N),f+=38*(B+=n*H),c+=38*(M+=n*F),h+=38*(A+=n*j),u+=38*(I+=n*z),l+=38*(x+=n*q),d+=38*(k+=n*V),p+=38*(T+=n*G),y+=38*(P+=n*W),b+=38*(O+=n*Y),g+=38*(R+=n*$),m+=38*(K+=n*Z),w+=38*(C+=n*X),s=(n=(s+=38*(_+=n*D))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=f,e[4]=c,e[5]=h,e[6]=u,e[7]=l,e[8]=d,e[9]=p,e[10]=y,e[11]=b,e[12]=g,e[13]=m,e[14]=w,e[15]=v}function H(e,t){N(e,t,t)}function F(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=253;n>=0;n--)H(i,i),2!==n&&4!==n&&N(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function j(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=250;n>=0;n--)H(i,i),1!==n&&N(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function z(e,r,n){var i,s,o=new Uint8Array(32),a=new Float64Array(80),c=t(),h=t(),u=t(),l=t(),d=t(),p=t();for(s=0;s<31;s++)o[s]=r[s];for(o[31]=127&r[31]|64,o[0]&=248,U(a,n),s=0;s<16;s++)h[s]=a[s],l[s]=c[s]=u[s]=0;for(c[0]=l[0]=1,s=254;s>=0;--s)O(c,h,i=o[s>>>3]>>>(7&s)&1),O(u,l,i),D(d,c,u),L(c,c,u),D(u,h,l),L(h,h,l),H(l,d),H(p,c),N(c,u,c),N(u,h,d),D(d,c,u),L(c,c,u),H(h,c),L(u,l,p),N(c,u,f),D(c,c,l),N(u,u,c),N(c,l,p),N(l,h,a),H(h,d),O(c,h,i),O(u,l,i);for(s=0;s<16;s++)a[s+16]=c[s],a[s+32]=u[s],a[s+48]=h[s],a[s+64]=l[s];var y=a.subarray(32),b=a.subarray(16);return F(y,y),N(b,b,y),R(e,b),0}function q(e,t){return z(e,t,s)}function V(e,t){return n(t,32),q(e,t)}function G(e,t,r){var n=new Uint8Array(32);return z(n,r,t),w(e,i,n,v)}M.prototype.blocks=function(e,t,r){for(var n,i,s,o,a,f,c,h,u,l,d,p,y,b,g,m,w,v,_,E=this.fin?0:2048,S=this.h[0],B=this.h[1],M=this.h[2],A=this.h[3],I=this.h[4],x=this.h[5],k=this.h[6],T=this.h[7],P=this.h[8],O=this.h[9],R=this.r[0],K=this.r[1],C=this.r[2],U=this.r[3],D=this.r[4],L=this.r[5],N=this.r[6],H=this.r[7],F=this.r[8],j=this.r[9];r>=16;)l=u=0,l+=(S+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*R,l+=(B+=8191&(n>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*j),l+=(M+=8191&(i>>>10|(s=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*F),l+=(A+=8191&(s>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*H),u=(l+=(I+=8191&(o>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*N))>>>13,l&=8191,l+=(x+=a>>>1&8191)*(5*L),l+=(k+=8191&(a>>>14|(f=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*D),l+=(T+=8191&(f>>>11|(c=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*U),l+=(P+=8191&(c>>>8|(h=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*C),d=u+=(l+=(O+=h>>>5|E)*(5*K))>>>13,d+=S*K,d+=B*R,d+=M*(5*j),d+=A*(5*F),u=(d+=I*(5*H))>>>13,d&=8191,d+=x*(5*N),d+=k*(5*L),d+=T*(5*D),d+=P*(5*U),u+=(d+=O*(5*C))>>>13,d&=8191,p=u,p+=S*C,p+=B*K,p+=M*R,p+=A*(5*j),u=(p+=I*(5*F))>>>13,p&=8191,p+=x*(5*H),p+=k*(5*N),p+=T*(5*L),p+=P*(5*D),y=u+=(p+=O*(5*U))>>>13,y+=S*U,y+=B*C,y+=M*K,y+=A*R,u=(y+=I*(5*j))>>>13,y&=8191,y+=x*(5*F),y+=k*(5*H),y+=T*(5*N),y+=P*(5*L),b=u+=(y+=O*(5*D))>>>13,b+=S*D,b+=B*U,b+=M*C,b+=A*K,u=(b+=I*R)>>>13,b&=8191,b+=x*(5*j),b+=k*(5*F),b+=T*(5*H),b+=P*(5*N),g=u+=(b+=O*(5*L))>>>13,g+=S*L,g+=B*D,g+=M*U,g+=A*C,u=(g+=I*K)>>>13,g&=8191,g+=x*R,g+=k*(5*j),g+=T*(5*F),g+=P*(5*H),m=u+=(g+=O*(5*N))>>>13,m+=S*N,m+=B*L,m+=M*D,m+=A*U,u=(m+=I*C)>>>13,m&=8191,m+=x*K,m+=k*R,m+=T*(5*j),m+=P*(5*F),w=u+=(m+=O*(5*H))>>>13,w+=S*H,w+=B*N,w+=M*L,w+=A*D,u=(w+=I*U)>>>13,w&=8191,w+=x*C,w+=k*K,w+=T*R,w+=P*(5*j),v=u+=(w+=O*(5*F))>>>13,v+=S*F,v+=B*H,v+=M*N,v+=A*L,u=(v+=I*D)>>>13,v&=8191,v+=x*U,v+=k*C,v+=T*K,v+=P*R,_=u+=(v+=O*(5*j))>>>13,_+=S*j,_+=B*F,_+=M*H,_+=A*N,u=(_+=I*L)>>>13,_&=8191,_+=x*D,_+=k*U,_+=T*C,_+=P*K,S=l=8191&(u=(u=((u+=(_+=O*R)>>>13)<<2)+u|0)+(l&=8191)|0),B=d+=u>>>=13,M=p&=8191,A=y&=8191,I=b&=8191,x=g&=8191,k=m&=8191,T=w&=8191,P=v&=8191,O=_&=8191,t+=16,r-=16;this.h[0]=S,this.h[1]=B,this.h[2]=M,this.h[3]=A,this.h[4]=I,this.h[5]=x,this.h[6]=k,this.h[7]=T,this.h[8]=P,this.h[9]=O},M.prototype.finish=function(e,t){var r,n,i,s,o=new Uint16Array(10);if(this.leftover){for(s=this.leftover,this.buffer[s++]=1;s<16;s++)this.buffer[s]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,s=2;s<10;s++)this.h[s]+=r,r=this.h[s]>>>13,this.h[s]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this.h[s]+r,r=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,n=(1^r)-1,s=0;s<10;s++)o[s]&=n;for(n=~n,s=0;s<10;s++)this.h[s]=this.h[s]&n|o[s];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,s=1;s<8;s++)i=(this.h[s]+this.pad[s]|0)+(i>>>16)|0,this.h[s]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},M.prototype.update=function(e,t,r){var n,i;if(this.leftover){for((i=16-this.leftover)>r&&(i=r),n=0;n<i;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(i=r-r%16,this.blocks(e,t,i),t+=i,r-=i),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var W=x,Y=k,$=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Z(e,t,r,n){for(var i,s,o,a,f,c,h,u,l,d,p,y,b,g,m,w,v,_,E,S,B,M,A,I,x,k,T=new Int32Array(16),P=new Int32Array(16),O=e[0],R=e[1],K=e[2],C=e[3],U=e[4],D=e[5],L=e[6],N=e[7],H=t[0],F=t[1],j=t[2],z=t[3],q=t[4],V=t[5],G=t[6],W=t[7],Y=0;n>=128;){for(E=0;E<16;E++)S=8*E+Y,T[E]=r[S+0]<<24|r[S+1]<<16|r[S+2]<<8|r[S+3],P[E]=r[S+4]<<24|r[S+5]<<16|r[S+6]<<8|r[S+7];for(E=0;E<80;E++)if(i=O,s=R,o=K,a=C,f=U,c=D,h=L,l=H,d=F,p=j,y=z,b=q,g=V,m=G,A=65535&(M=W),I=M>>>16,x=65535&(B=N),k=B>>>16,A+=65535&(M=(q>>>14|U<<18)^(q>>>18|U<<14)^(U>>>9|q<<23)),I+=M>>>16,x+=65535&(B=(U>>>14|q<<18)^(U>>>18|q<<14)^(q>>>9|U<<23)),k+=B>>>16,A+=65535&(M=q&V^~q&G),I+=M>>>16,x+=65535&(B=U&D^~U&L),k+=B>>>16,A+=65535&(M=$[2*E+1]),I+=M>>>16,x+=65535&(B=$[2*E]),k+=B>>>16,B=T[E%16],I+=(M=P[E%16])>>>16,x+=65535&B,k+=B>>>16,x+=(I+=(A+=65535&M)>>>16)>>>16,A=65535&(M=_=65535&A|I<<16),I=M>>>16,x=65535&(B=v=65535&x|(k+=x>>>16)<<16),k=B>>>16,A+=65535&(M=(H>>>28|O<<4)^(O>>>2|H<<30)^(O>>>7|H<<25)),I+=M>>>16,x+=65535&(B=(O>>>28|H<<4)^(H>>>2|O<<30)^(H>>>7|O<<25)),k+=B>>>16,I+=(M=H&F^H&j^F&j)>>>16,x+=65535&(B=O&R^O&K^R&K),k+=B>>>16,u=65535&(x+=(I+=(A+=65535&M)>>>16)>>>16)|(k+=x>>>16)<<16,w=65535&A|I<<16,A=65535&(M=y),I=M>>>16,x=65535&(B=a),k=B>>>16,I+=(M=_)>>>16,x+=65535&(B=v),k+=B>>>16,R=i,K=s,C=o,U=a=65535&(x+=(I+=(A+=65535&M)>>>16)>>>16)|(k+=x>>>16)<<16,D=f,L=c,N=h,O=u,F=l,j=d,z=p,q=y=65535&A|I<<16,V=b,G=g,W=m,H=w,E%16==15)for(S=0;S<16;S++)B=T[S],A=65535&(M=P[S]),I=M>>>16,x=65535&B,k=B>>>16,B=T[(S+9)%16],A+=65535&(M=P[(S+9)%16]),I+=M>>>16,x+=65535&B,k+=B>>>16,v=T[(S+1)%16],A+=65535&(M=((_=P[(S+1)%16])>>>1|v<<31)^(_>>>8|v<<24)^(_>>>7|v<<25)),I+=M>>>16,x+=65535&(B=(v>>>1|_<<31)^(v>>>8|_<<24)^v>>>7),k+=B>>>16,v=T[(S+14)%16],I+=(M=((_=P[(S+14)%16])>>>19|v<<13)^(v>>>29|_<<3)^(_>>>6|v<<26))>>>16,x+=65535&(B=(v>>>19|_<<13)^(_>>>29|v<<3)^v>>>6),k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,T[S]=65535&x|k<<16,P[S]=65535&A|I<<16;A=65535&(M=H),I=M>>>16,x=65535&(B=O),k=B>>>16,B=e[0],I+=(M=t[0])>>>16,x+=65535&B,k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,e[0]=O=65535&x|k<<16,t[0]=H=65535&A|I<<16,A=65535&(M=F),I=M>>>16,x=65535&(B=R),k=B>>>16,B=e[1],I+=(M=t[1])>>>16,x+=65535&B,k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,e[1]=R=65535&x|k<<16,t[1]=F=65535&A|I<<16,A=65535&(M=j),I=M>>>16,x=65535&(B=K),k=B>>>16,B=e[2],I+=(M=t[2])>>>16,x+=65535&B,k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,e[2]=K=65535&x|k<<16,t[2]=j=65535&A|I<<16,A=65535&(M=z),I=M>>>16,x=65535&(B=C),k=B>>>16,B=e[3],I+=(M=t[3])>>>16,x+=65535&B,k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,e[3]=C=65535&x|k<<16,t[3]=z=65535&A|I<<16,A=65535&(M=q),I=M>>>16,x=65535&(B=U),k=B>>>16,B=e[4],I+=(M=t[4])>>>16,x+=65535&B,k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,e[4]=U=65535&x|k<<16,t[4]=q=65535&A|I<<16,A=65535&(M=V),I=M>>>16,x=65535&(B=D),k=B>>>16,B=e[5],I+=(M=t[5])>>>16,x+=65535&B,k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,e[5]=D=65535&x|k<<16,t[5]=V=65535&A|I<<16,A=65535&(M=G),I=M>>>16,x=65535&(B=L),k=B>>>16,B=e[6],I+=(M=t[6])>>>16,x+=65535&B,k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,e[6]=L=65535&x|k<<16,t[6]=G=65535&A|I<<16,A=65535&(M=W),I=M>>>16,x=65535&(B=N),k=B>>>16,B=e[7],I+=(M=t[7])>>>16,x+=65535&B,k+=B>>>16,k+=(x+=(I+=(A+=65535&M)>>>16)>>>16)>>>16,e[7]=N=65535&x|k<<16,t[7]=W=65535&A|I<<16,Y+=128,n-=128}return n}function X(e,t,r){var n,i=new Int32Array(8),s=new Int32Array(8),o=new Uint8Array(256),a=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,Z(i,s,t,r),r%=128,n=0;n<r;n++)o[n]=t[a-r+n];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,p(o,r-8,a/536870912|0,a<<3),Z(i,s,o,r),n=0;n<8;n++)p(e,8*n,i[n],s[n]);return 0}function J(e,r){var n=t(),i=t(),s=t(),o=t(),a=t(),f=t(),c=t(),u=t(),l=t();L(n,e[1],e[0]),L(l,r[1],r[0]),N(n,n,l),D(i,e[0],e[1]),D(l,r[0],r[1]),N(i,i,l),N(s,e[3],r[3]),N(s,s,h),N(o,e[2],r[2]),D(o,o,o),L(a,i,n),L(f,o,s),D(c,o,s),D(u,i,n),N(e[0],a,f),N(e[1],u,c),N(e[2],c,f),N(e[3],a,u)}function Q(e,t,r){var n;for(n=0;n<4;n++)O(e[n],t[n],r)}function ee(e,r){var n=t(),i=t(),s=t();F(s,r[2]),N(n,r[0],s),N(i,r[1],s),R(e,i),e[31]^=C(n)<<7}function te(e,t,r){var n,i;for(T(e[0],o),T(e[1],a),T(e[2],a),T(e[3],o),i=255;i>=0;--i)Q(e,t,n=r[i/8|0]>>(7&i)&1),J(t,e),J(e,e),Q(e,t,n)}function re(e,r){var n=[t(),t(),t(),t()];T(n[0],u),T(n[1],l),T(n[2],a),N(n[3],u,l),te(e,n,r)}function ne(e,r,i){var s,o=new Uint8Array(64),a=[t(),t(),t(),t()];for(i||n(r,32),X(o,r,32),o[0]&=248,o[31]&=127,o[31]|=64,re(a,o),ee(e,a),s=0;s<32;s++)r[s+32]=e[s];return 0}var ie=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function se(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*ie[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*ie[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*ie[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;se(e,r)}function ae(e,r,n,i){var s,o,a=new Uint8Array(64),f=new Uint8Array(64),c=new Uint8Array(64),h=new Float64Array(64),u=[t(),t(),t(),t()];X(a,i,32),a[0]&=248,a[31]&=127,a[31]|=64;var l=n+64;for(s=0;s<n;s++)e[64+s]=r[s];for(s=0;s<32;s++)e[32+s]=a[32+s];for(X(c,e.subarray(32),n+32),oe(c),re(u,c),ee(e,u),s=32;s<64;s++)e[s]=i[s];for(X(f,e,n+64),oe(f),s=0;s<64;s++)h[s]=0;for(s=0;s<32;s++)h[s]=c[s];for(s=0;s<32;s++)for(o=0;o<32;o++)h[s+o]+=f[s]*a[o];return se(e.subarray(32),h),l}function fe(e,r,n,i){var s,f=new Uint8Array(32),h=new Uint8Array(64),u=[t(),t(),t(),t()],l=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),i=t(),s=t(),f=t(),h=t(),u=t(),l=t();return T(e[2],a),U(e[1],r),H(s,e[1]),N(f,s,c),L(s,s,e[2]),D(f,e[2],f),H(h,f),H(u,h),N(l,u,h),N(n,l,s),N(n,n,f),j(n,n),N(n,n,s),N(n,n,f),N(n,n,f),N(e[0],n,f),H(i,e[0]),N(i,i,f),K(i,s)&&N(e[0],e[0],d),H(i,e[0]),N(i,i,f),K(i,s)?-1:(C(e[0])===r[31]>>7&&L(e[0],o,e[0]),N(e[3],e[0],e[1]),0)}(l,i))return-1;for(s=0;s<n;s++)e[s]=r[s];for(s=0;s<32;s++)e[s+32]=i[s];if(X(h,e,n),oe(h),te(u,l,h),re(l,r.subarray(32)),J(u,l),ee(f,u),n-=64,g(r,0,f,0)){for(s=0;s<n;s++)e[s]=0;return-1}for(s=0;s<n;s++)e[s]=r[s+64];return n}var ce,he=64,ue=32,le=64;function de(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function pe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ye(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:w,crypto_stream_xor:B,crypto_stream:S,crypto_stream_salsa20_xor:_,crypto_stream_salsa20:E,crypto_onetimeauth:A,crypto_onetimeauth_verify:I,crypto_verify_16:b,crypto_verify_32:g,crypto_secretbox:x,crypto_secretbox_open:k,crypto_scalarmult:z,crypto_scalarmult_base:q,crypto_box_beforenm:G,crypto_box_afternm:W,crypto_box:function(e,t,r,n,i,s){var o=new Uint8Array(32);return G(o,i,s),W(e,t,r,n,o)},crypto_box_open:function(e,t,r,n,i,s){var o=new Uint8Array(32);return G(o,i,s),Y(e,t,r,n,o)},crypto_box_keypair:V,crypto_hash:X,crypto_sign:ae,crypto_sign_keypair:ne,crypto_sign_open:fe,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:he,crypto_sign_PUBLICKEYBYTES:ue,crypto_sign_SECRETKEYBYTES:le,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:c,L:ie,pack25519:R,unpack25519:U,M:N,A:D,S:H,Z:L,pow2523:j,add:J,set25519:T,modL:se,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,r){pe(e,t,r),de(r,t);for(var n=new Uint8Array(32+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+32]=e[s];return x(i,n,n.length,t,r),i.subarray(16)},e.secretbox.open=function(e,t,r){pe(e,t,r),de(r,t);for(var n=new Uint8Array(16+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+16]=e[s];return n.length<32||0!==k(i,n,n.length,t,r)?null:i.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(pe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return z(r,e,t),r},e.scalarMult.base=function(e){if(pe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return q(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox(t,r,s)},e.box.before=function(e,t){pe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return G(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox.open(t,r,s)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return V(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(pe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return q(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(pe(e,t),t.length!==le)throw new Error("bad secret key size");var r=new Uint8Array(he+e.length);return ae(r,e,e.length,t),r},e.sign.open=function(e,t){if(pe(e,t),t.length!==ue)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=fe(r,e,e.length,t);if(n<0)return null;for(var i=new Uint8Array(n),s=0;s<i.length;s++)i[s]=r[s];return i},e.sign.detached=function(t,r){for(var n=e.sign(t,r),i=new Uint8Array(he),s=0;s<i.length;s++)i[s]=n[s];return i},e.sign.detached.verify=function(e,t,r){if(pe(e,t,r),t.length!==he)throw new Error("bad signature size");if(r.length!==ue)throw new Error("bad public key size");var n,i=new Uint8Array(he+e.length),s=new Uint8Array(he+e.length);for(n=0;n<he;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+he]=e[n];return fe(s,i,i.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(ue),t=new Uint8Array(le);return ne(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(pe(e),e.length!==le)throw new Error("bad secret key size");for(var t=new Uint8Array(ue),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(pe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(ue),r=new Uint8Array(le),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=ue,e.sign.secretKeyLength=le,e.sign.seedLength=32,e.sign.signatureLength=he,e.hash=function(e){pe(e);var t=new Uint8Array(64);return X(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return pe(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===y(e,0,t,0,e.length)},e.setPRNG=function(e){n=e},(ce="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&ce.getRandomValues?e.setPRNG(function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)ce.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];ye(n)}):(ce=r(8308))&&ce.randomBytes&&e.setPRNG(function(e,t){var r,n=ce.randomBytes(t);for(r=0;r<t;r++)e[r]=n[r];ye(n)})}(e.exports?e.exports:self.nacl=self.nacl||{})},4427:(e,t,r)=>{var n=r(6671).Buffer;e.exports=function(e,t,r){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,t);if(ArrayBuffer.isView(e))return n.from(e.buffer);throw new TypeError(r+" must be a string, a Buffer, a typed array or a DataView")}},4523:(e,t,r)=>{const n=r(4662),i=r(3381);e.exports={blake2b:n.blake2b,blake2bHex:n.blake2bHex,blake2bInit:n.blake2bInit,blake2bUpdate:n.blake2bUpdate,blake2bFinal:n.blake2bFinal,blake2s:i.blake2s,blake2sHex:i.blake2sHex,blake2sInit:i.blake2sInit,blake2sUpdate:i.blake2sUpdate,blake2sFinal:i.blake2sFinal}},4552:(e,t,r)=>{"use strict";var n=r(8558);function i(e,t){o(e,t),s(e)}function s(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,a=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return a||f?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(o,this,e)):n.nextTick(o,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?r._writableState?r._writableState.errorEmitted?n.nextTick(s,r):(r._writableState.errorEmitted=!0,n.nextTick(i,r,e)):n.nextTick(i,r,e):t?(n.nextTick(s,r),t(e)):n.nextTick(s,r)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}},4635:e=>{e.exports=function(e){var t=e._readableState;return t?t.objectMode||"number"==typeof e._duplexState?e.read():e.read(function(e){if(e.buffer.length){var t=e.bufferIndex||0;if(e.buffer.head)return e.buffer.head.data.length;if(e.buffer.length-t>0&&e.buffer[t])return e.buffer[t].length}return e.length}(t)):null}},4656:()=>{},4662:(e,t,r)=>{const n=r(8115);function i(e,t,r){const n=e[t]+e[r];let i=e[t+1]+e[r+1];n>=4294967296&&i++,e[t]=n,e[t+1]=i}function s(e,t,r,n){let i=e[t]+r;r<0&&(i+=4294967296);let s=e[t+1]+n;i>=4294967296&&s++,e[t]=i,e[t+1]=s}function o(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function a(e,t,r,n,o,a){const f=u[o],c=u[o+1],l=u[a],d=u[a+1];i(h,e,t),s(h,e,f,c);let p=h[n]^h[e],y=h[n+1]^h[e+1];h[n]=y,h[n+1]=p,i(h,r,n),p=h[t]^h[r],y=h[t+1]^h[r+1],h[t]=p>>>24^y<<8,h[t+1]=y>>>24^p<<8,i(h,e,t),s(h,e,l,d),p=h[n]^h[e],y=h[n+1]^h[e+1],h[n]=p>>>16^y<<16,h[n+1]=y>>>16^p<<16,i(h,r,n),p=h[t]^h[r],y=h[t+1]^h[r+1],h[t]=y>>>31^p<<1,h[t+1]=p>>>31^y<<1}const f=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),c=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(e){return 2*e})),h=new Uint32Array(32),u=new Uint32Array(32);function l(e,t){let r=0;for(r=0;r<16;r++)h[r]=e.h[r],h[r+16]=f[r];for(h[24]=h[24]^e.t,h[25]=h[25]^e.t/4294967296,t&&(h[28]=~h[28],h[29]=~h[29]),r=0;r<32;r++)u[r]=o(e.b,4*r);for(r=0;r<12;r++)a(0,8,16,24,c[16*r+0],c[16*r+1]),a(2,10,18,26,c[16*r+2],c[16*r+3]),a(4,12,20,28,c[16*r+4],c[16*r+5]),a(6,14,22,30,c[16*r+6],c[16*r+7]),a(0,10,20,30,c[16*r+8],c[16*r+9]),a(2,12,22,24,c[16*r+10],c[16*r+11]),a(4,14,16,26,c[16*r+12],c[16*r+13]),a(6,8,18,28,c[16*r+14],c[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^h[r]^h[r+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function p(e,t,r,n){if(0===e||e>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&16!==r.length)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(n&&16!==n.length)throw new Error("Illegal personal, expected Uint8Array with length is 16");const i={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e};d.fill(0),d[0]=e,t&&(d[1]=t.length),d[2]=1,d[3]=1,r&&d.set(r,32),n&&d.set(n,48);for(let e=0;e<16;e++)i.h[e]=f[e]^o(d,4*e);return t&&(y(i,t),i.c=128),i}function y(e,t){for(let r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,l(e,!1),e.c=0),e.b[e.c++]=t[r]}function b(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;l(e,!0);const t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function g(e,t,r,i,s){r=r||64,e=n.normalizeInput(e),i&&(i=n.normalizeInput(i)),s&&(s=n.normalizeInput(s));const o=p(r,t,i,s);return y(o,e),b(o)}e.exports={blake2b:g,blake2bHex:function(e,t,r,i,s){const o=g(e,t,r,i,s);return n.toHex(o)},blake2bInit:p,blake2bUpdate:y,blake2bFinal:b}},4686:(e,t,r)=>{"use strict";const n=r(5350),i=r(7947),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=f,t.SlowBuffer=function(e){return+e!=e&&(e=0),f.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,f.prototype),t}function f(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!f.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|y(e,t);let n=a(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return l(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return d(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return f.from(n,t,r);const i=function(e){if(f.isBuffer(e)){const t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Z(e.length)?a(0):l(e):"Buffer"===e.type&&Array.isArray(e.data)?l(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return f.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return h(e),a(e<0?0:0|p(e))}function l(e){const t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,f.prototype),n}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function y(e,t){if(f.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(e).length;default:if(i)return n?-1:G(e).length;t=(""+t).toLowerCase(),i=!0}}function b(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return A(this,t,r);case"ascii":return x(this,t,r);case"latin1":case"binary":return k(this,t,r);case"base64":return M(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=f.from(t,n)),f.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,i){let s,o=1,a=e.length,f=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,f/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(c(e,s)===c(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===f)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+f>a&&(r=a-f),s=r;s>=0;s--){let r=!0;for(let n=0;n<f;n++)if(c(e,s+n)!==c(t,n)){r=!1;break}if(r)return s}return-1}function v(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(Z(n))return o;e[r+o]=n}return o}function _(e,t,r,n){return Y(G(t,e.length-r),e,r,n)}function E(e,t,r,n){return Y(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return Y(W(t),e,r,n)}function B(e,t,r,n){return Y(function(e,t){let r,n,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function M(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function A(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,f;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(f=(31&t)<<6|63&r,f>127&&(s=f));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(f=(15&t)<<12|(63&r)<<6|63&n,f>2047&&(f<55296||f>57343)&&(s=f));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(f=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,f>65535&&f<1114112&&(s=f))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}t.kMaxLength=o,f.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),f.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}}),f.poolSize=8192,f.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array),f.alloc=function(e,t,r){return function(e,t,r){return h(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},f.allocUnsafe=function(e){return u(e)},f.allocUnsafeSlow=function(e){return u(e)},f.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==f.prototype},f.compare=function(e,t){if($(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=f.from(t,t.offset,t.byteLength)),!f.isBuffer(e)||!f.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return f.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=f.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if($(t,Uint8Array))i+t.length>n.length?(f.isBuffer(t)||(t=f.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!f.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},f.byteLength=y,f.prototype._isBuffer=!0,f.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},f.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},f.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},f.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?A(this,0,e):b.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===f.compare(this,e)},f.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(f.prototype[s]=f.prototype.inspect),f.prototype.compare=function(e,t,r,n,i){if($(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(s,o),c=this.slice(n,i),h=e.slice(t,r);for(let e=0;e<a;++e)if(c[e]!==h[e]){s=c[e],o=h[e];break}return s<o?-1:o<s?1:0},f.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},f.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},f.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},f.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return _(this,e,t,r);case"ascii":case"latin1":case"binary":return E(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function x(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function k(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function T(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=X[e[n]];return i}function P(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function O(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,i,s){if(!f.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function K(e,t,r,n,i){j(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function C(e,t,r,n,i){j(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function U(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function D(e,t,r,n,s){return t=+t,r>>>=0,s||U(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function L(e,t,r,n,s){return t=+t,r>>>=0,s||U(e,0,r,8),i.write(e,t,r,n,52,8),r+8}f.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,f.prototype),n},f.prototype.readUintLE=f.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},f.prototype.readUintBE=f.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},f.prototype.readUint8=f.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},f.prototype.readBigUInt64LE=J(function(e){z(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))}),f.prototype.readBigUInt64BE=J(function(e){z(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),f.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},f.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},f.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},f.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},f.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},f.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},f.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},f.prototype.readBigInt64LE=J(function(e){z(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),f.prototype.readBigInt64BE=J(function(e){z(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),f.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!0,23,4)},f.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!1,23,4)},f.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!0,52,8)},f.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!1,52,8)},f.prototype.writeUintLE=f.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},f.prototype.writeUint8=f.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,255,0),this[t]=255&e,t+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeBigUInt64LE=J(function(e,t=0){return K(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeBigUInt64BE=J(function(e,t=0){return C(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},f.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},f.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},f.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},f.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},f.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},f.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},f.prototype.writeBigInt64LE=J(function(e,t=0){return K(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeBigInt64BE=J(function(e,t=0){return C(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeFloatLE=function(e,t,r){return D(this,e,t,!0,r)},f.prototype.writeFloatBE=function(e,t,r){return D(this,e,t,!1,r)},f.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},f.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},f.prototype.copy=function(e,t,r,n){if(!f.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},f.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=f.isBuffer(e)?e:f.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%o]}return this};const N={};function H(e,t,r){N[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function F(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function j(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new N.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){z(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||q(t,e.length-(r+1))}(n,i,s)}function z(e,t){if("number"!=typeof e)throw new N.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,r){if(Math.floor(e)!==e)throw z(e,r),new N.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new N.ERR_BUFFER_OUT_OF_BOUNDS;throw new N.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}H("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),H("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),H("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=F(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=F(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);const V=/[^+/0-9A-Za-z-_]/g;function G(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function W(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}const X=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},4797:(e,t,r)=>{"use strict";var n,i=t,s=r(5402),o=r(613),a=r(1036).assert;function f(e){"short"===e.type?this.curve=new o.short(e):"edwards"===e.type?this.curve=new o.edwards(e):this.curve=new o.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(e,t){Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){var r=new f(t);return Object.defineProperty(i,e,{configurable:!0,enumerable:!0,value:r}),r}})}i.PresetCurve=f,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{n=r(6452)}catch(e){n=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",n]})},4872:(e,t,r)=>{"use strict";const n=r(5402),i=r(1362),s=i.utils,o=s.parseBytes,a=r(3019),f=r(134);function c(){if(!(this instanceof c))return new c;const e=i.curves.ed25519.curve;this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=n.sha512}e.exports=c,c.prototype.signExtended=function(e,t){e=o(e);const r=this.keyFromSecret(t),n=this.hashInt(r.messagePrefix(),e),i=this.g.mul(n),s=this.encodePoint(i),a=this.hashInt(s,r.pubBytes(),e).mul(r.kl()),f=n.add(a).umod(this.curve.n);return this.makeSignature({R:i,S:f,Rencoded:s})},c.prototype.verify=function(e,t,r){e=o(e),t=this.makeSignature(t);const n=this.keyFromPublic(r),i=this.hashInt(t.Rencoded(),n.pubBytes(),e),s=this.g.mul(t.S());return t.R().add(n.pub().mul(i)).eq(s)},c.prototype.hashInt=function(){const e=this.hash();for(let t=0;t<arguments.length;t++)e.update(arguments[t]);return s.intFromLE(e.digest()).umod(this.curve.n)},c.prototype.keyFromPublic=function(e){return a.fromPublic(this,s.parseBytes(e))},c.prototype.keyFromSecret=function(e){return a.fromSecret(this,s.parseBytes(e))},c.prototype.makeSignature=function(e){return e instanceof f?e:new f(this,e)},c.prototype.encodePoint=function(e){const t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},c.prototype.decodePoint=function(e){const t=(e=s.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),n=!!(128&e[t]),i=s.intFromLE(r);return this.curve.pointFromY(i,n)},c.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},c.prototype.decodeInt=function(e){return s.intFromLE(e)},c.prototype.isPoint=function(e){return e instanceof this.pointClass}},4914:(e,t,r)=>{"use strict";e.exports=h;var n=r(8704).F,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,f=r(5606);function c(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function h(e){if(!(this instanceof h))return new h(e);f.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",u)}function u(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?l(this,null,null):this._flush(function(t,r){l(e,t,r)})}function l(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}r(6192)(h,f),h.prototype.push=function(e,t){return this._transformState.needTransform=!1,f.prototype.push.call(this,e,t)},h.prototype._transform=function(e,t,r){r(new i("_transform()"))},h.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},h.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},h.prototype._destroy=function(e,t){f.prototype._destroy.call(this,e,function(e){t(e)})}},5079:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.instanciateApp=t.instanciateContact=void 0;const i=n(r(2114)),s=r(2810),o=r(3061),a=r(3903),f=n(r(7961)),c=n(r(5550)),h=r(5598),u=r(2655),l=r(4686),d=n(r(4406)),p=r(3127),y=n(r(7235)),b=r(8123),g=l.Buffer.from("7661756c7479732f656e6372797074696f6e2f01","hex"),m=32,w=e=>e.startsWith("vaultys://connect?")?"LOGIN":e.startsWith("vaultys://signfile?")?"DOCUMENT":"UNKNOWN";t.instanciateContact=e=>{let t;return t=3===e.type?new c.default(s.Fido2Manager.instantiate(e.keyManager),e.certificate,e.type):4===e.type?new c.default(s.Fido2PRFManager.instantiate(e.keyManager),e.certificate,e.type):1952===e.keyManager.signer.publicKey.length?new c.default(s.DilithiumManager.instantiate(e.keyManager),e.certificate,e.type):1984===e.keyManager.signer.publicKey.length?new c.default(s.HybridManager.instantiate(e.keyManager),e.certificate,e.type):e.keyManager.proof?new c.default(y.default.instantiate(e.keyManager),e.certificate,e.type):new c.default(s.Ed25519Manager.instantiate(e.keyManager),e.certificate,e.type),t},t.instanciateApp=e=>c.default.fromId(l.Buffer.from(e.serverId,"base64"),e.certificate);class v{constructor(e,t){this.protocol_version=0,this.acceptEncryptFile=this.acceptDecryptFile,this.vaultysId=e,this.store=t,this.store.get("metadata")||this.store.set("metadata",{}),this.vaultysId.keyManager.entropy?this.store.set("entropy",this.vaultysId.keyManager.entropy):this.store.set("secret",this.vaultysId.getSecret()),this.store.save()}setProtocolVersion(e){this.protocol_version=e}async exportBackup(e){if(e){const t=await p.platformCrypto.pbkdf2.encrypt(e,l.Buffer.from((0,u.encode)(this.store.toJSON())));if(!t)throw new Error("Failed to encrypt backup");return(0,u.encode)(t)}{const e={version:1,data:l.Buffer.from((0,u.encode)(this.store.toJSON()))};return(0,u.encode)(e)}}static async importBackup(e,t){try{const r=(0,u.decode)(e);let n;if(r.encryptInfo){if(!t)throw new Error("Passphrase required for encrypted backup");if(!r.data)throw new Error("Invalid backup format");if(n=await p.platformCrypto.pbkdf2.decrypt(r,t),!n)throw new Error("Failed to decrypt backup. Incorrect passphrase?")}else n=r.data;const i=(0,a.storagify)((0,u.decode)(n),()=>{},()=>{});return await v.fromStore(i)}catch(e){return console.error("Import error:",e),null}}static async fromStore(e){const t=e.get("entropy"),r=e.get("secret");if(r){if(t){const n=l.Buffer.from(r,"base64")[0],i=await c.default.fromEntropy(t,n);return new v(i,e)}{const t=c.default.fromSecret(r);return new v(t,e)}}if(t){const r=await c.default.machineFromEntropy(t);return new v(r,e)}{const t=await c.default.generateMachine();return new v(t,e)}}merge(e,t=!0){const r=t?e:this.store,n=t?this.store:e;this.store.set("metadata",{...n.get("metadata"),...r.get("metadata")}),["signatures","wot"].forEach(t=>{const r=e.substore(t),n=this.store.substore(t);r.list().forEach(e=>{n.get(e)||n.set(e,r.get(e))})});const i=e.substore("contacts"),s=this.store.substore("contacts"),o=t?i:s,a=t?s:i;i.list().forEach(e=>{if(s.get(e)){const t=s.get(e);t.metadata={...a.get(e).metadata,...o.get(e).metadata},s.set(e,t)}else s.set(e,i.get(e))}),this.store.save()}async verifyWebOfTrust(){let e=!0;for(const t of this.store.substore("wot").list()){const r=this.store.substore("wot").get(t);e=e&&await i.default.verifyCertificate(l.Buffer.from(r))}for(const t of this.store.substore("registrations").list()){const r=this.store.substore("registrations").get(t);e=e&&t===c.default.fromId(r.serverId,void 0,"base64").did}for(const t of this.contacts)e=e&&await i.default.verifyCertificate(l.Buffer.from(t.certificate));for(const t of this.apps)e=e&&await i.default.verifyCertificate(l.Buffer.from(t.certificate));return e}isHardware(){return this.vaultysId.isHardware()}async signIn(){if(!this.vaultysId.isHardware())return!0;await window.CredentialUserInteractionRequest();const e=(0,h.randomBytes)(m),t=this.vaultysId.keyManager,r=await navigator.credentials.get({publicKey:{challenge:e,allowCredentials:[{type:"public-key",id:t.fid,transports:t.transports}],userVerification:"discouraged"}});if(null==r)return!1;const n=r.response,i=f.default.extractChallenge(n.clientDataJSON);return e.toString("base64")===i&&t.verifyCredentials(r)}get contacts(){const e=this.store.substore("contacts");return e.list().map(t=>e.get(t)).map(t.instanciateContact).map(e=>e.toVersion(this.vaultysId.version))}get apps(){const e=this.store.substore("registrations");return e.list().map(t=>e.get(t)).map(t.instanciateApp).map(e=>e.toVersion(this.vaultysId.version))}getContact(e){const r=this.store.substore("contacts").get(e);return r?(0,t.instanciateContact)(r).toVersion(this.vaultysId.version):null}getApp(e){const r=this.store.substore("registrations").get(e);return r?(0,t.instanciateApp)(r).toVersion(this.vaultysId.version):null}setContactMetadata(e,t,r){const n=this.store.substore("contacts").get(e);n&&(n.metadata||(n.metadata={}),n.metadata[t]=r)}getContactMetadata(e,t){const r=this.store.substore("contacts").get(e);return r&&r.metadata?r.metadata[t]:null}getContactMetadatas(e){const t=this.store.substore("contacts").get(e);return t&&t.metadata?t.metadata:null}async verifyRelationshipCertificate(e){const t=this.store.substore("contacts").get(e)||this.store.substore("registrations").get(e);return i.default.verifyCertificate(t.certificate)}set name(e){this.store.get("metadata").name=e}get name(){return this.store.get("metadata").name}get displayName(){const e=this.store.get("metadata"),t=e.firstname?e.firstname+" "+(e.name??""):e.name;return t?.length>0?t:"Anonymous "+this.vaultysId.fingerprint?.slice(-4)}set phone(e){this.store.get("metadata").phone=e}get phone(){return this.store.get("metadata").phone}set email(e){this.store.get("metadata").email=e}get email(){return this.store.get("metadata").email}async signChallenge(e){const t=await this.vaultysId.signChallenge(e);return this.store.substore("signatures").set(""+Date.now(),{signature:t,challenge:e}),this.store.save(),t}async signFile(e){const t=(0,h.hash)("sha256",e.arrayBuffer).toString("hex"),r=l.Buffer.from(`vaultys://signfile?hash=${t}&timestamp=${Date.now()}`,"utf-8"),n={challenge:r,signature:await this.vaultysId.signChallenge(r)};return this.store.substore("signatures").set(Date.now()+"",n),this.store.save(),n}verifyFile(e,t,r,n=!0){const i=t.challenge.toString("utf8");if(!i.startsWith("vaultys://signfile?"))return!1;const s=(0,h.hash)("sha256",e.arrayBuffer).toString("hex"),o=new URL(i);return s===o.searchParams.get("hash")&&!(2!==o.search.match(/[a-z\d]+=[a-z\d]+/gi)?.length||!o.searchParams.get("timestamp"))&&r.verifyChallenge(t.challenge,t.signature,n)}async decryptFile(e,t){const r=new Uint8Array(e.arrayBuffer),n=r.slice(0,g.length);if(l.Buffer.from(n).toString("hex")!==g.toString("hex"))throw new Error("Invalid header for encrypted file");const i=r.slice(g.length,g.length+m),s=r.slice(g.length+m,g.length+m+d.default.secretbox.nonceLength),o=r.slice(g.length+m+d.default.secretbox.nonceLength),a=t?await this.requestPRF(t,"encryption/"+l.Buffer.from(i).toString("hex")+"/encryption"):await this.vaultysId.hmac("prf|encryption/"+l.Buffer.from(i).toString("hex")+"/encryption|prf");if(a?.length!==m)throw new Error("Invalid PRF generated");const f=(0,h.hash)("sha256",a);(0,h.secureErase)(a);const c=d.default.secretbox.open(o,s,f);if((0,h.secureErase)(f),!c)throw new Error("Decryption failed");return{name:e.name,type:e.type,arrayBuffer:l.Buffer.from(c)}}async encryptFile(e,t){const r=(0,h.randomBytes)(m),n=t?await this.requestPRF(t,"encryption/"+l.Buffer.from(r).toString("hex")+"/encryption"):await this.vaultysId.hmac("prf|encryption/"+r.toString("hex")+"/encryption|prf");if(n?.length!==m)return null;const i=(0,h.hash)("sha256",n);(0,h.secureErase)(n);const s=d.default.randomBytes(d.default.secretbox.nonceLength),o=d.default.secretbox(new Uint8Array(e.arrayBuffer),s,i);(0,h.secureErase)(i);const a=new Uint8Array(g.length+m+s.length+o.length);return a.set(g),a.set(r,g.length),a.set(s,g.length+m),a.set(o,g.length+m+s.length),{name:e.name,type:e.type,arrayBuffer:l.Buffer.from(a)}}getSignatures(){const e=this.store.substore("signatures");return e.list().sort().map(t=>{const r=e.get(t),n=l.Buffer.from(r.challenge).toString("utf-8");return{date:t,payload:r,challenge:n,type:w(n)}})}migrate(e){this.vaultysId.toVersion(e);const r=this.store.substore("contacts");for(const n of r.list()){const i=r.get(n),s=(0,t.instanciateContact)(i),o=s.toVersion(e);o.did!==n&&(r.set(o.did,{...s,...o,metadata:i.metadata,oldDid:n}),r.delete(n))}const n=this.store.substore("registrations");for(const r of n.list()){const i=n.get(r),s=(0,t.instanciateApp)(i);if(s){const t=s.toVersion(e);if(t.did!==r){const e=i.site===r?t.did:i.site;n.set(t.did,{site:e,oldDid:r,serverId:t.id.toString("base64"),certificate:i.certificate,timestamp:i.timestamp}),n.delete(r)}}}this.store.save()}async verifyChallenge(e,t){return this.vaultysId.verifyChallenge(e,t,!0)}async upload(e,t){if((await this.startSRP(e,"p2p","transfer")).isComplete()){const{upload:r}=(0,o.StreamChannel)(e);await r(t)}else e.send(l.Buffer.from([0]))}async download(e,t){if((await this.acceptSRP(e,"p2p","transfer")).isComplete()){const{download:r}=(0,o.StreamChannel)(e);await r(t)}else e.send(l.Buffer.from([0]))}async requestConnect(e,t){let r=this.getContact(t);if(r||(r=this.getApp(t)),!r)throw new Error(t+" is not in the Web of Trust");const n=b.crypto.randomBytes(16),i=await this.vaultysId.performDiffieHellman(r);if(!i)throw new Error("Unable to perform DH");e.send(n);const s=await e.receive(),o=(0,h.hash)("sha256",d.default.scalarMult(n,i));if(o.toString("base64")===s.toString("base64"))return o;throw new Error("Opening session failed with contact "+t)}async acceptConnect(e,t){let r=this.getContact(t);if(r||(r=this.getApp(t)),!r)throw new Error(t+" is not in the Web of Trust");const n=await this.vaultysId.performDiffieHellman(r);if(!n)throw new Error("Unable to perform DH");const i=await e.receive(),s=l.Buffer.concat([i.slice(0,16),b.crypto.randomBytes(16)]);(0,h.hash)("sha256",d.default.scalarMult(s,n))}async requestDecrypt(e,t){const r=await this.acceptSRP(e,"p2p","decrypt");if(r.isComplete()){e.send(t);const n=await e.receive();return await this.vaultysId.dhiesDecrypt(n,r.getContactId().id)}e.send(l.Buffer.from([0]))}async acceptDecrypt(e,t){const r=await this.startSRP(e,"p2p","decrypt",{},t);if(r.isComplete()){const t=await e.receive(),n=await this.vaultysId.decrypt(t.toString("utf-8"));if(n){const t=await this.vaultysId.dhiesEncrypt(n,r.getContactId().id);e.send(t??l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}async requestDecryptFile(e,t){return this.decryptFile(t,e)}async requestEncryptFile(e,t){return this.encryptFile(t,e)}async acceptDecryptFile(e,t){let r=null;return await this.acceptPRF(e,(e,n)=>n.length>63&&n.startsWith("encryption/")&&n.endsWith("/encryption")?(r=e,t?.(e)||Promise.resolve(!0)):Promise.resolve(!1)),r}async requestSignFile(e,t){const r=await this.acceptSRP(e,"p2p","signfile");if(r.isComplete()){e.send(l.Buffer.from((0,u.encode)(t)));const n=await e.receive(),i=(0,u.decode)(n);return this.verifyFile(t,i,r.getContactId().toVersion(1))?i:void 0}e.send(l.Buffer.from([0]))}async acceptSignFile(e,t){const r=await this.startSRP(e,"p2p","signfile");if(r.isComplete()){const n=await e.receive(),i=(0,u.decode)(n);if(!t||await t(r.getContactId(),i)){const t=await this.signFile(i);e.send(l.Buffer.from((0,u.encode)(t)))}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}async requestPRF(e,t){if(t.length<3)throw new Error("appid is too short, less than 3 characters");if(t.split("|").length>1)throw new Error("appid contains illegal character |");if((await this.acceptSRP(e,"p2p","prf")).isComplete()){e.send(l.Buffer.from(t,"utf-8"));const r=await e.receive();return l.Buffer.from(r)}e.send(l.Buffer.from([0]))}async acceptPRF(e,t){const r=await this.startSRP(e,"p2p","prf");if(r.isComplete()){const n=(await e.receive()).toString("utf-8");if(n.length<3||n.split("|").length>1)e.send(l.Buffer.from([0]));else if(!t||await t(r.getContactId(),n)){const t=await this.vaultysId.hmac("prf|"+n+"|prf")??l.Buffer.from([0]);e.send(t),(0,h.secureErase)(t)}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}listCertificates(){const e=this.store.substore("wot");return e.list().map(t=>{const r=e.get(t);if(r.timestamp)return r;{const n={...i.default.deserializeCertificate(e.get(t)),raw:r};return e.set(t,n),n}})}async startSRP(e,t,r,n={},s){const o=new i.default(this.vaultysId);o.createChallenge(t,r,this.protocol_version,n);const a=o.getCertificate();if(!a)throw e.close(),e.send(l.Buffer.from([0])),new Error("Error processing challenge");e.send(a);try{const t=await e.receive(),r=i.default.deserializeCertificate(t).pk2;if(!r)throw e.send(l.Buffer.from([0])),new Error("Contact pk2 is not sent");if(s&&!await s(c.default.fromId(r)))throw e.send(l.Buffer.from([0])),new Error("Contact refused");await o.update(t)}catch(t){throw e.send(l.Buffer.from([0])),new Error(t)}if(o.isComplete()){const t=o.getCertificate();if(!t)throw e.close(),e.send(l.Buffer.from([0])),new Error("Error processing challenge");return e.send(t),this.store.substore("wot").set(Date.now()+"",t),o}throw e.send(l.Buffer.from([0])),new Error("Can't add a new contact if the protocol is not complete")}async acceptSRP(e,t,r,n={},s){const o=new i.default(this.vaultysId);try{const a=await e.receive(),f=i.default.deserializeCertificate(a);if(!f.pk1)throw e.send(l.Buffer.from([0])),new Error("Contact pk1 is not sent");if(f.protocol!==t)throw e.send(l.Buffer.from([0])),new Error("protocol is not the one expected: "+f.protocol+" !="+t);if(f.service!==r)throw e.send(l.Buffer.from([0])),new Error("service is not the one expected: "+f.service+" !="+r);if(s&&!await s(c.default.fromId(f.pk1)))throw e.send(l.Buffer.from([0])),new Error("Contact refused");await o.update(a,n)}catch(t){throw e.send(l.Buffer.from([0])),new Error(t)}const a=o.getCertificate();if(!a)throw e.send(l.Buffer.from([0])),await e.close(),new Error("Error processing challenge");e.send(a);try{const t=await e.receive();await o.update(t)}catch(t){throw await e.close(),new Error(t)}if(o.isComplete()){const e=o.getCertificate();return this.store.substore("wot").set(Date.now()+"",e),o}throw await e.close(),new Error("Can't add a new contact if the protocol is not complete")}saveApp(e,t){if(e.toVersion(this.vaultysId.version),e.isMachine()){const r=this.store.substore("registrations");r.get(e.did)||r.set(e.did,{site:t??e.did,serverId:e.id.toString("base64"),certificate:e.certificate})}else this.saveContact(e)}saveContact(e){if(e.toVersion(this.vaultysId.version),e.isMachine())this.saveApp(e);else{const t=this.store.substore("contacts");t.get(e.did)||(t.set(e.did,e),this.store.save())}}async askContact(e,t={},r){const n=(await this.startSRP(e,"p2p","auth",t,r)).getContactId();return this.saveContact(n),n}async acceptContact(e,t={},r){const n=(await this.acceptSRP(e,"p2p","auth",t,r)).getContactId();return this.saveContact(n),n}}t.default=v},5138:(e,t)=>{"use strict";var r=t;function n(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",r=0;r<e.length;r++)t+=n(e[r].toString(16));return t}r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var n=0;n<e.length;n++)r[n]=0|e[n];return r}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),n=0;n<e.length;n+=2)r.push(parseInt(e[n]+e[n+1],16));else for(n=0;n<e.length;n++){var i=e.charCodeAt(n),s=i>>8,o=255&i;s?r.push(s,o):r.push(o)}return r},r.zero2=n,r.toHex=i,r.encode=function(e,t){return"hex"===t?i(e):e}},5325:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyMaterial=u,t.getKey=l,t.decrypt=async function(e,t){if(!e.encryptInfo)return e.data;try{const r=await u(t),n=c.Buffer.from(e.encryptInfo.salt,"base64"),i=c.Buffer.from(e.encryptInfo.iv,"base64"),s=await l(r,n),o=a.createDecipheriv("aes-256-gcm",s,i),f=16,h=e.data.subarray(0,e.data.length-f),d=e.data.subarray(e.data.length-f);return o.setAuthTag(d),c.Buffer.concat([o.update(h),o.final()])}catch(e){return console.error("Decryption error:",e),null}},t.encrypt=async function(e,t){if(!e)return;const r=(0,h.randomBytes)(16),n=(0,h.randomBytes)(12),i=await u(e),s=await l(i,r),o=a.createCipheriv("aes-256-gcm",s,n),d=c.Buffer.concat([o.update(t),o.final()]),p=o.getAuthTag(),y=c.Buffer.concat([d,p]);return{version:1,encryptInfo:{...f.encryptInfo,iv:n.toString("base64"),salt:r.toString("base64")},data:y}};const a=o(r(1553)),f=r(148),c=r(4686),h=r(7261);function u(e){const t=c.Buffer.from(e,"utf-8");return Promise.resolve(a.createSecretKey(t))}function l(e,t){return new Promise(r=>{const n=a.pbkdf2Sync(e.export(),t,f.encryptInfo.ITERATIONS,f.encryptInfo.DERIVED_KEY_LENGTH/8,f.encryptInfo.HASH.replace("-","").toLowerCase());r(c.Buffer.from(n))})}},5350:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=a(e),o=s[0],f=s[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,o,f)),h=0,u=f>0?o-4:o;for(r=0;r<u;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[h++]=t>>16&255,c[h++]=t>>8&255,c[h++]=255&t;return 2===f&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[h++]=255&t),1===f&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[h++]=t>>8&255,c[h++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],o=16383,a=0,f=n-i;a<f;a+=o)s.push(c(e,a,a+o>f?f:a+o));return 1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function f(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function c(e,t,r){for(var n,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(f(n));return i.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},5370:(e,t,r)=>{"use strict";var n=r(900),i=r(8637);function s(e,t,r){if(!(this instanceof s))return new s(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(t,r))}e.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},5391:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shake256=t.shake128=t.keccak_512=t.keccak_384=t.keccak_256=t.keccak_224=t.sha3_512=t.sha3_384=t.sha3_256=t.sha3_224=t.Keccak=void 0,t.keccakP=w;const n=r(3842),i=r(11),s=BigInt(0),o=BigInt(1),a=BigInt(2),f=BigInt(7),c=BigInt(256),h=BigInt(113),u=[],l=[],d=[];for(let e=0,t=o,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],u.push(2*(5*n+r)),l.push((e+1)*(e+2)/2%64);let i=s;for(let e=0;e<7;e++)t=(t<<o^(t>>f)*h)%c,t&a&&(i^=o<<(o<<BigInt(e))-o);d.push(i)}const p=(0,n.split)(d,!0),y=p[0],b=p[1],g=(e,t,r)=>r>32?(0,n.rotlBH)(e,t,r):(0,n.rotlSH)(e,t,r),m=(e,t,r)=>r>32?(0,n.rotlBL)(e,t,r):(0,n.rotlSL)(e,t,r);function w(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,s=r[i],o=r[i+1],a=g(s,o,1)^r[n],f=m(s,o,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=f}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=l[r],s=g(t,i,n),o=m(t,i,n),a=u[r];t=e[a],i=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=y[n],e[1]^=b[n]}(0,i.clean)(r)}class v extends i.Hash{constructor(e,t,r,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=s,(0,i.anumber)(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,i.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,i.swap32IfBE)(this.state32),w(this.state32,this.rounds),(0,i.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(e){(0,i.aexists)(this),e=(0,i.toBytes)(e),(0,i.abytes)(e);const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){(0,i.aexists)(this,!1),(0,i.abytes)(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,i.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,i.aoutput)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,i.clean)(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new v(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}t.Keccak=v;const _=(e,t,r)=>(0,i.createHasher)(()=>new v(t,e,r));t.sha3_224=_(6,144,28),t.sha3_256=_(6,136,32),t.sha3_384=_(6,104,48),t.sha3_512=_(6,72,64),t.keccak_224=_(1,144,28),t.keccak_256=_(1,136,32),t.keccak_384=_(1,104,48),t.keccak_512=_(1,72,64);const E=(e,t,r)=>(0,i.createXOFer)((n={})=>new v(t,e,void 0===n.dkLen?r:n.dkLen,!0));t.shake128=E(31,168,16),t.shake256=E(31,136,32)},5397:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHash=function(e){return{hash:e}},t.createCurve=function(e,t){const r=t=>(0,n.weierstrass)({...e,hash:t});return{...r(t),create:r}};const n=r(1164)},5402:(e,t,r)=>{var n=t;n.utils=r(900),n.common=r(7984),n.sha=r(2991),n.ripemd=r(262),n.hmac=r(5370),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160},5466:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(4406),s=r(2655),o=r(4072);class a{constructor(e,t){this.payload_secretbox=e,this.final=t}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data}static create(e,t,r,s,o,a=!1){const f=this.generateNonce(e.hash,o,a),c=r?i.sign.detached(Uint8Array.from(this.generateSignatureData(e.hash,f,a,s)),Uint8Array.from(r)):n.alloc(64);return new this(n.from((0,i.secretbox)(Uint8Array.from(n.concat([c,s])),Uint8Array.from(f),Uint8Array.from(t))),a)}static generateNonce(e,t,r){const i=n.alloc(24,n.from(e));return i[15]=r?1|i[15]:254&i[15],i.writeBigUInt64BE(t,16),i}static generateSignatureData(e,t,r,i){return n.concat([n.from("saltpack encrypted signature"),n.from([0]),e,t,n.from([r?1:0]),o.sha512.create().update(i).digest()])}encode(){return a.encodePayload(this.payload_secretbox,this.final)}static encodePayload(e,t){const r=[e,t];return n.from((0,s.encode)(r))}static decode(e,t=!1){const r=t?e:(0,s.decode)(e);if(r.length<2)throw new Error("Invalid data");const[n,i]=r;return new this(n,i)}decrypt(e,t,r,n){const s=a.generateNonce(e.hash,n,this.final),o=i.secretbox.open(Uint8Array.from(this.payload_secretbox),Uint8Array.from(s),Uint8Array.from(r));if(!o)throw new Error("Failed to decrypt data");const f=o.slice(64);if(t){const r=o.slice(0,64),n=a.generateSignatureData(e.hash,s,this.final,f);if(!i.sign.detached.verify(Uint8Array.from(n),Uint8Array.from(r),Uint8Array.from(t)))throw new Error("Invalid signature")}return f}}a.PAYLOAD_NONCE_PREFIX=n.from("saltpack_ploadsb"),t.default=a},5550:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=r(2810),o=n(r(7961)),a=r(7165),f=r(4686),c=r(6761),h=n(r(7264)),u=n(r(7235)),l=f.Buffer.from("VAULTYS_SIGN","utf8");class d{constructor(e,t,r=0){this.encrypt=d.encrypt,this.type=r,this.keyManager=e,this.certificate=t}static fromId(e,t,r="hex"){let n=e;e.data&&(n=f.Buffer.from(e.data)),e instanceof Uint8Array&&(n=f.Buffer.from(e)),"string"==typeof e&&(n=f.Buffer.from(e,r));const i=n[0];if(3===i){const e=s.Fido2Manager.fromId(n.slice(1));return new d(e,t,i)}if(4===i){const e=s.Fido2PRFManager.fromId(n.slice(1));return new d(e,t,i)}if(1998===n.length){const e=s.DilithiumManager.fromId(n.slice(1));return new d(e,t,i)}if(2030===n.length){const e=s.HybridManager.fromId(n.slice(1));return new d(e,t,i)}if(77===n.length){const e=s.Ed25519Manager.fromId(n.slice(1));return new d(e,t,i)}{const e=u.default.fromId(n.slice(1));return new d(e,t,i)}}static async fromEntropy(e,t,r="ed25519"){const n=e;if("dilithium"===r){const e=await s.DilithiumManager.createFromEntropy(n);return new d(e,void 0,t)}if("dilithium_ed25519"===r){const e=await s.HybridManager.createFromEntropy(n);return new d(e,void 0,t)}{const e=await s.Ed25519Manager.createFromEntropy(n);return new d(e,void 0,t)}}static async createWebauthn(e=!0,t){const r=d.createPublicKeyCredentialCreationOptions(e),n=(0,a.getWebAuthnProvider)(),i=await n.create(r);return i?d.fido2FromAttestation(i,t):null}static async createPQC(){const e=d.createPublicKeyCredentialOptionsPQC(),t=(0,a.getWebAuthnProvider)(),r=await t.create(e);return r?d.fido2FromAttestation(r):null}static async fido2FromAttestation(e,t){if(o.default.verifyPackedAttestation(e.response,!0),!e.getClientExtensionResults().prf?.enabled||t&&!await t()){const t=await s.Fido2Manager.createFromAttestation(e);return new d(t,void 0,3)}{const t=await s.Fido2PRFManager.createFromAttestation(e);return new d(t,void 0,4)}}static async machineFromEntropy(e){return d.fromEntropy(e,0)}static async organizationFromEntropy(e){return d.fromEntropy(e,2)}static async personFromEntropy(e){return d.fromEntropy(e,1)}static fromSecret(e,t="hex"){const r=f.Buffer.from(e,t),n=r[0];if(3==n){const e=s.Fido2Manager.fromSecret(r.slice(1));return new d(e,void 0,n)}if(4==n){const e=s.Fido2PRFManager.fromSecret(r.slice(1));return new d(e,void 0,n)}if(73===r.length){const e=s.DilithiumManager.fromSecret(r.slice(1));return new d(e,void 0,n)}if(84===r.length){const e=s.HybridManager.fromSecret(r.slice(1));return new d(e,void 0,n)}{const e=s.Ed25519Manager.fromSecret(r.slice(1));return new d(e,void 0,n)}}static async generatePerson(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new d(e,void 0,1)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new d(e,void 0,1)}{const e=await s.Ed25519Manager.generate();return new d(e,void 0,1)}}static async generateOrganization(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new d(e,void 0,2)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new d(e,void 0,2)}{const e=await s.Ed25519Manager.generate();return new d(e,void 0,2)}}static async generateMachine(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new d(e,void 0,0)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new d(e,void 0,0)}{const e=await s.Ed25519Manager.generate();return new d(e,void 0,0)}}get relationshipCertificate(){return this.certificate}getSecret(e="hex"){return f.Buffer.concat([f.Buffer.from([this.type]),this.keyManager.getSecret()]).toString(e)}get fingerprint(){return f.Buffer.concat([f.Buffer.from([this.type]),(0,i.hash)("SHA224",this.keyManager.id)]).toString("hex").slice(0,40).toUpperCase().match(/.{1,4}/g).join(" ")}get did(){return`did:vaultys:${f.Buffer.concat([f.Buffer.from([this.type]),(0,i.hash)("SHA224",this.keyManager.id)]).toString("hex").slice(0,40)}`}get didDocument(){return{"@context":["https://www.w3.org/ns/did/v1","https://w3id.org/security/suites/ed25519-2020/v1"],id:this.did,authentication:[{id:`${this.did}#keys-1`,type:this.keyManager.authType,controller:this.did,publicKeyMultibase:"m"+f.Buffer.from(this.keyManager.signer.publicKey).toString("base64")}],keyAgreement:[{id:`${this.did}#keys-2`,type:this.keyManager.encType,controller:this.did,publicKeyMultibase:"m"+f.Buffer.from(this.keyManager.cypher.publicKey).toString("base64")}]}}get id(){return f.Buffer.concat([f.Buffer.from([this.type]),this.keyManager.id])}toVersion(e){return this.keyManager.version=e,this}get version(){return this.keyManager.version}isHardware(){return 3===this.type||4===this.type}isMachine(){return 0===this.type}isPerson(){return 1===this.type}getOTPHmac(e=36e5){const t=Math.floor((new Date).getTime()/e);return this.keyManager.getSecretHash(f.Buffer.from(`OTP-${t}`)).toString("hex")}getOTP(e="password",t=864e5){if(this.certificate){const r=Math.floor((new Date).getTime()/t),n=f.Buffer.concat([f.Buffer.from(e,"utf-8"),f.Buffer.from(this.certificate),f.Buffer.from([r])]);return(0,i.hash)("SHA256",n).toString("hex")}throw new Error("no certificate, cannot derive OTP")}async performDiffieHellman(e){return this.keyManager.performDiffieHellman(e.keyManager)}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){let r;return r="string"==typeof t?f.Buffer.from(t.slice(2),"hex"):t.slice(1),this.keyManager.dhiesEncrypt(e,r)}async dhiesDecrypt(e,t){let r;return r="string"==typeof t?f.Buffer.from(t.slice(2),"hex"):t.slice(1),this.keyManager.dhiesDecrypt(e,r)}async signChallenge_v0(e,t){"string"==typeof e&&(e=f.Buffer.from(e,"hex"));const r=(0,i.hash)("sha256",f.Buffer.concat([t,e])),n=await this.keyManager.sign(r);if(n)return n;throw new Error("Could not sign challenge")}verifyChallenge_v0(e,t,r,n){"string"==typeof e&&(e=f.Buffer.from(e,"hex")),"string"==typeof t&&(t=f.Buffer.from(t,"hex"));const s=(0,i.hash)("sha256",f.Buffer.concat([n,e]));return this.keyManager.verify(s,t,r)}async signChallenge(e){"string"==typeof e&&(e=f.Buffer.from(e,"hex"));const t=(0,i.hash)("sha256",f.Buffer.concat([l,e])),r=await this.keyManager.sign(t);if(r)return r;throw new Error("Could not sign challenge")}verifyChallenge(e,t,r){"string"==typeof e&&(e=f.Buffer.from(e,"hex")),"string"==typeof t&&(t=f.Buffer.from(t,"hex"));const n=(0,i.hash)("sha256",f.Buffer.concat([l,e]));return this.keyManager.verify(n,t,r)}async signcrypt(e,t){return this.keyManager.signcrypt(e,t.map(e=>"string"==typeof e?f.Buffer.from(e.slice(2),"hex"):e.slice(1)))}static async encrypt(e,t){return h.default.encrypt(e,t.map(e=>"string"==typeof e?f.Buffer.from(e.slice(2),"hex"):e.slice(1)))}async decrypt(e,t){let r;return t&&(r="string"==typeof t?f.Buffer.from(t.slice(2)):t.subarray(1)),this.keyManager.decrypt(e,r)}async hmac(e){return(await this.keyManager.getCypher()).hmac(e)}}d.createPublicKeyCredentialOptionsPQC=()=>{const e=/^((?!chrome|android).)*applewebkit/i.test(navigator.userAgent);return{challenge:(0,i.randomBytes)(32),rp:{name:"Vaultys ID"},user:{id:(0,i.randomBytes)(16),name:"Vaultys ID",displayName:"Vaultys Wallet ID"},attestation:e?"none":"direct",authenticatorSelection:{authenticatorAttachment:"cross-platform",residentKey:"discouraged",userVerification:"preferred"},hints:["security-key"],extensions:{prf:{eval:{first:f.Buffer.from("VaultysID salt","utf-8")}}},pubKeyCredParams:[{type:"public-key",alg:c.PQ_COSE_ALG.DILITHIUM2}]}},d.createPublicKeyCredentialCreationOptions=e=>{const t=/^((?!chrome|android).)*applewebkit/i.test(navigator.userAgent),r=e?"client-device":"security-key";return{challenge:(0,i.randomBytes)(32),rp:{name:"Vaultys ID"},user:{id:(0,i.randomBytes)(16),name:"Vaultys ID",displayName:"Vaultys Wallet ID"},attestation:t?"none":"direct",authenticatorSelection:{authenticatorAttachment:e?"platform":"cross-platform",residentKey:e?"required":"discouraged",userVerification:"preferred"},hints:[r],extensions:{prf:{eval:{first:f.Buffer.from("VaultysID salt","utf-8")}}},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-8},{type:"public-key",alg:-257}]}},t.default=d},5567:(e,t,r)=>{"use strict";var n=r(7902),i=r(6192),s=r(6160),o=r(1036);function a(e){s.call(this,"mont",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.i4=new n(4).toRed(this.red).redInvm(),this.two=new n(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function f(e,t,r){s.BasePoint.call(this,e,"projective"),null===t&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new n(t,16),this.z=new n(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(a,s),e.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),n=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return 0===n.redSqrt().redSqr().cmp(n)},i(f,s.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(o.toArray(e,t),1)},a.prototype.point=function(e,t){return new f(this,e,t)},a.prototype.pointFromJSON=function(e){return f.fromJSON(this,e)},f.prototype.precompute=function(){},f.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},f.fromJSON=function(e,t){return new f(e,t[0],t[1]||e.one)},f.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},f.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},f.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),n=e.redMul(t),i=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(n,i)},f.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},f.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),n=this.x.redSub(this.z),i=e.x.redAdd(e.z),s=e.x.redSub(e.z).redMul(r),o=i.redMul(n),a=t.z.redMul(s.redAdd(o).redSqr()),f=t.x.redMul(s.redISub(o).redSqr());return this.curve.point(a,f)},f.prototype.mul=function(e){for(var t=e.clone(),r=this,n=this.curve.point(null,null),i=[];0!==t.cmpn(0);t.iushrn(1))i.push(t.andln(1));for(var s=i.length-1;s>=0;s--)0===i[s]?(r=r.diffAdd(n,this),n=n.dbl()):(n=r.diffAdd(n,this),r=r.dbl());return n},f.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},f.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},f.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},f.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},f.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},5593:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Ed25519Manager=t.Fido2PRFManager=t.Fido2Manager=t.DilithiumManager=t.HybridManager=void 0;const i=n(r(8481));t.DilithiumManager=i.default;const s=n(r(6900));t.HybridManager=s.default;const o=n(r(8580));t.Fido2Manager=o.default;const a=n(r(5860));t.Fido2PRFManager=a.default;const f=n(r(2521));t.Ed25519Manager=f.default;const c=n(r(201));t.default=c.default},5598:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.secureErase=t.fromUTF8=t.fromHex=t.fromBase64=t.toUTF8=t.toHex=t.toBase64=t.secretbox=t.randomBytes=t.hmac=t.hash=t.Buffer=void 0;const a=o(r(4406)),f=r(4686);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return f.Buffer}});const c=r(4072),h=r(3835),u=e=>{const t=e.replaceAll("-","").toLowerCase();return"sha256"===t?c.sha256:"sha512"===t?c.sha512:"sha224"===t?c.sha224:c.sha256};t.randomBytes=e=>f.Buffer.from((0,a.randomBytes)(e)),t.hash=(e,t)=>f.Buffer.from(u(e).create().update(t).digest()),t.hmac=(e,t,r)=>f.Buffer.from((0,h.hmac)(u(e),t,r));const l=a.default.secretbox;t.secretbox=l,t.toBase64=e=>f.Buffer.from(e).toString("base64"),t.toHex=e=>f.Buffer.from(e).toString("hex"),t.toUTF8=e=>f.Buffer.from(e).toString("utf-8"),t.fromBase64=e=>f.Buffer.from(e,"base64"),t.fromHex=e=>f.Buffer.from(e,"hex"),t.fromUTF8=e=>f.Buffer.from(e,"utf-8"),t.secureErase=e=>{for(let t=0;t<e.length;t++)e[t]=0}},5606:(e,t,r)=>{"use strict";var n=r(8558),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=h;var s=r(4324),o=r(6868);r(6192)(h,s);for(var a=i(o.prototype),f=0;f<a.length;f++){var c=a[f];h.prototype[c]||(h.prototype[c]=o.prototype[c])}function h(e){if(!(this instanceof h))return new h(e);s.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||n.nextTick(l,this)}function l(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},5617:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encryptInfo=void 0,t.encryptInfo={ALG:"PBKDF2",ITERATIONS:2e7,DERIVED_KEY_TYPE:"AES-GCM",DERIVED_KEY_LENGTH:256,HASH:"SHA-256"}},5691:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp521r1=t.p521=void 0;const n=r(2355);t.p521=n.p521,t.secp521r1=n.p521,t.hashToCurve=n.p521_hasher.hashToCurve,t.encodeToCurve=n.p521_hasher.encodeToCurve},5706:e=>{"use strict";class t{constructor(){this.clear()}clear(){this.map=new WeakMap,this.count=0,this.recording=!0}stop(){this.recording=!1}check(e){const r=this.map.get(e);if(r)return r.length>1?r[0]||this.recording?r[1]:(r[0]=!0,t.FIRST):this.recording?(r.push(this.count++),r[1]):t.NEVER;if(!this.recording)throw new Error("New object detected when not recording");return this.map.set(e,[!1]),t.NEVER}}t.NEVER=-1,t.FIRST=-2,e.exports=t},5709:e=>{e.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(e){n[e]=t[e]}),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(e){n[e]=i[e]}),n}}},5713:(e,t,r)=>{"use strict";const{Buffer:n}=r(4686),i=r(3271),s=r(5775),{MT:o}=r(790);class a extends Map{constructor(e){super(e)}static _encode(e){return i.encodeCanonical(e).toString("base64")}static _decode(e){return s.decodeFirstSync(e,"base64")}get(e){return super.get(a._encode(e))}set(e,t){return super.set(a._encode(e),t)}delete(e){return super.delete(a._encode(e))}has(e){return super.has(a._encode(e))}*keys(){for(const e of super.keys())yield a._decode(e)}*entries(){for(const e of super.entries())yield[a._decode(e[0]),e[1]]}[Symbol.iterator](){return this.entries()}forEach(e,t=this){if("function"!=typeof e)throw new TypeError("Must be function");for(const r of super.entries())e.call(t,r[1],a._decode(r[0]),this)}encodeCBOR(e){if(!e._pushInt(this.size,o.MAP))return!1;if(e.canonical){const t=Array.from(super.entries()).map(e=>[n.from(e[0],"base64"),e[1]]);t.sort((e,t)=>e[0].compare(t[0]));for(const r of t)if(!e.push(r[0])||!e.pushAny(r[1]))return!1}else for(const t of super.entries())if(!e.push(n.from(t[0],"base64"))||!e.pushAny(t[1]))return!1;return!0}}e.exports=a},5727:(e,t,r)=>{(t=e.exports=r(4324)).Stream=t,t.Readable=t,t.Writable=r(6868),t.Duplex=r(5606),t.Transform=r(4914),t.PassThrough=r(9648),t.finished=r(2862),t.pipeline=r(110)},5766:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.instanciateApp=t.instanciateContact=void 0;const i=n(r(8421)),s=r(5593),o=r(3004),a=r(1366),f=n(r(8886)),c=n(r(7431)),h=r(7261),u=r(2655),l=r(4686),d=n(r(4406)),p=r(3852),y=n(r(9010)),b=r(8123),g=l.Buffer.from("7661756c7479732f656e6372797074696f6e2f01","hex"),m=32,w=e=>e.startsWith("vaultys://connect?")?"LOGIN":e.startsWith("vaultys://signfile?")?"DOCUMENT":"UNKNOWN";t.instanciateContact=e=>{let t;return t=3===e.type?new c.default(s.Fido2Manager.instantiate(e.keyManager),e.certificate,e.type):4===e.type?new c.default(s.Fido2PRFManager.instantiate(e.keyManager),e.certificate,e.type):1952===e.keyManager.signer.publicKey.length?new c.default(s.DilithiumManager.instantiate(e.keyManager),e.certificate,e.type):1984===e.keyManager.signer.publicKey.length?new c.default(s.HybridManager.instantiate(e.keyManager),e.certificate,e.type):e.keyManager.proof?new c.default(y.default.instantiate(e.keyManager),e.certificate,e.type):new c.default(s.Ed25519Manager.instantiate(e.keyManager),e.certificate,e.type),t},t.instanciateApp=e=>c.default.fromId(l.Buffer.from(e.serverId,"base64"),e.certificate);class v{constructor(e,t){this.protocol_version=0,this.acceptEncryptFile=this.acceptDecryptFile,this.vaultysId=e,this.store=t,this.store.get("metadata")||this.store.set("metadata",{}),this.vaultysId.keyManager.entropy?this.store.set("entropy",this.vaultysId.keyManager.entropy):this.store.set("secret",this.vaultysId.getSecret()),this.store.save()}setProtocolVersion(e){this.protocol_version=e}async exportBackup(e){if(e){const t=await p.platformCrypto.pbkdf2.encrypt(e,l.Buffer.from((0,u.encode)(this.store.toJSON())));if(!t)throw new Error("Failed to encrypt backup");return(0,u.encode)(t)}{const e={version:1,data:l.Buffer.from((0,u.encode)(this.store.toJSON()))};return(0,u.encode)(e)}}static async importBackup(e,t){try{const r=(0,u.decode)(e);let n;if(r.encryptInfo){if(!t)throw new Error("Passphrase required for encrypted backup");if(!r.data)throw new Error("Invalid backup format");if(n=await p.platformCrypto.pbkdf2.decrypt(r,t),!n)throw new Error("Failed to decrypt backup. Incorrect passphrase?")}else n=r.data;const i=(0,a.storagify)((0,u.decode)(n),()=>{},()=>{});return await v.fromStore(i)}catch(e){return console.error("Import error:",e),null}}static async fromStore(e){const t=e.get("entropy"),r=e.get("secret");if(r){if(t){const n=l.Buffer.from(r,"base64")[0],i=await c.default.fromEntropy(t,n);return new v(i,e)}{const t=c.default.fromSecret(r);return new v(t,e)}}if(t){const r=await c.default.machineFromEntropy(t);return new v(r,e)}{const t=await c.default.generateMachine();return new v(t,e)}}merge(e,t=!0){const r=t?e:this.store,n=t?this.store:e;this.store.set("metadata",{...n.get("metadata"),...r.get("metadata")}),["signatures","wot"].forEach(t=>{const r=e.substore(t),n=this.store.substore(t);r.list().forEach(e=>{n.get(e)||n.set(e,r.get(e))})});const i=e.substore("contacts"),s=this.store.substore("contacts"),o=t?i:s,a=t?s:i;i.list().forEach(e=>{if(s.get(e)){const t=s.get(e);t.metadata={...a.get(e).metadata,...o.get(e).metadata},s.set(e,t)}else s.set(e,i.get(e))}),this.store.save()}async verifyWebOfTrust(){let e=!0;for(const t of this.store.substore("wot").list()){const r=this.store.substore("wot").get(t);e=e&&await i.default.verifyCertificate(l.Buffer.from(r))}for(const t of this.store.substore("registrations").list()){const r=this.store.substore("registrations").get(t);e=e&&t===c.default.fromId(r.serverId,void 0,"base64").did}for(const t of this.contacts)e=e&&await i.default.verifyCertificate(l.Buffer.from(t.certificate));for(const t of this.apps)e=e&&await i.default.verifyCertificate(l.Buffer.from(t.certificate));return e}isHardware(){return this.vaultysId.isHardware()}async signIn(){if(!this.vaultysId.isHardware())return!0;await window.CredentialUserInteractionRequest();const e=(0,h.randomBytes)(m),t=this.vaultysId.keyManager,r=await navigator.credentials.get({publicKey:{challenge:e,allowCredentials:[{type:"public-key",id:t.fid,transports:t.transports}],userVerification:"discouraged"}});if(null==r)return!1;const n=r.response,i=f.default.extractChallenge(n.clientDataJSON);return e.toString("base64")===i&&t.verifyCredentials(r)}get contacts(){const e=this.store.substore("contacts");return e.list().map(t=>e.get(t)).map(t.instanciateContact).map(e=>e.toVersion(this.vaultysId.version))}get apps(){const e=this.store.substore("registrations");return e.list().map(t=>e.get(t)).map(t.instanciateApp).map(e=>e.toVersion(this.vaultysId.version))}getContact(e){const r=this.store.substore("contacts").get(e);return r?(0,t.instanciateContact)(r).toVersion(this.vaultysId.version):null}getApp(e){const r=this.store.substore("registrations").get(e);return r?(0,t.instanciateApp)(r).toVersion(this.vaultysId.version):null}setContactMetadata(e,t,r){const n=this.store.substore("contacts").get(e);n&&(n.metadata||(n.metadata={}),n.metadata[t]=r)}getContactMetadata(e,t){const r=this.store.substore("contacts").get(e);return r&&r.metadata?r.metadata[t]:null}getContactMetadatas(e){const t=this.store.substore("contacts").get(e);return t&&t.metadata?t.metadata:null}async verifyRelationshipCertificate(e){const t=this.store.substore("contacts").get(e)||this.store.substore("registrations").get(e);return i.default.verifyCertificate(t.certificate)}set name(e){this.store.get("metadata").name=e}get name(){return this.store.get("metadata").name}get displayName(){const e=this.store.get("metadata"),t=e.firstname?e.firstname+" "+(e.name??""):e.name;return t?.length>0?t:"Anonymous "+this.vaultysId.fingerprint?.slice(-4)}set phone(e){this.store.get("metadata").phone=e}get phone(){return this.store.get("metadata").phone}set email(e){this.store.get("metadata").email=e}get email(){return this.store.get("metadata").email}async signChallenge(e){const t=await this.vaultysId.signChallenge(e);return this.store.substore("signatures").set(""+Date.now(),{signature:t,challenge:e}),this.store.save(),t}async signFile(e){const t=(0,h.hash)("sha256",e.arrayBuffer).toString("hex"),r=l.Buffer.from(`vaultys://signfile?hash=${t}&timestamp=${Date.now()}`,"utf-8"),n={challenge:r,signature:await this.vaultysId.signChallenge(r)};return this.store.substore("signatures").set(Date.now()+"",n),this.store.save(),n}verifyFile(e,t,r,n=!0){const i=t.challenge.toString("utf8");if(!i.startsWith("vaultys://signfile?"))return!1;const s=(0,h.hash)("sha256",e.arrayBuffer).toString("hex"),o=new URL(i);return s===o.searchParams.get("hash")&&!(2!==o.search.match(/[a-z\d]+=[a-z\d]+/gi)?.length||!o.searchParams.get("timestamp"))&&r.verifyChallenge(t.challenge,t.signature,n)}async decryptFile(e,t){const r=new Uint8Array(e.arrayBuffer),n=r.slice(0,g.length);if(l.Buffer.from(n).toString("hex")!==g.toString("hex"))throw new Error("Invalid header for encrypted file");const i=r.slice(g.length,g.length+m),s=r.slice(g.length+m,g.length+m+d.default.secretbox.nonceLength),o=r.slice(g.length+m+d.default.secretbox.nonceLength),a=t?await this.requestPRF(t,"encryption/"+l.Buffer.from(i).toString("hex")+"/encryption"):await this.vaultysId.hmac("prf|encryption/"+l.Buffer.from(i).toString("hex")+"/encryption|prf");if(a?.length!==m)throw new Error("Invalid PRF generated");const f=(0,h.hash)("sha256",a);(0,h.secureErase)(a);const c=d.default.secretbox.open(o,s,f);if((0,h.secureErase)(f),!c)throw new Error("Decryption failed");return{name:e.name,type:e.type,arrayBuffer:l.Buffer.from(c)}}async encryptFile(e,t){const r=(0,h.randomBytes)(m),n=t?await this.requestPRF(t,"encryption/"+l.Buffer.from(r).toString("hex")+"/encryption"):await this.vaultysId.hmac("prf|encryption/"+r.toString("hex")+"/encryption|prf");if(n?.length!==m)return null;const i=(0,h.hash)("sha256",n);(0,h.secureErase)(n);const s=d.default.randomBytes(d.default.secretbox.nonceLength),o=d.default.secretbox(new Uint8Array(e.arrayBuffer),s,i);(0,h.secureErase)(i);const a=new Uint8Array(g.length+m+s.length+o.length);return a.set(g),a.set(r,g.length),a.set(s,g.length+m),a.set(o,g.length+m+s.length),{name:e.name,type:e.type,arrayBuffer:l.Buffer.from(a)}}getSignatures(){const e=this.store.substore("signatures");return e.list().sort().map(t=>{const r=e.get(t),n=l.Buffer.from(r.challenge).toString("utf-8");return{date:t,payload:r,challenge:n,type:w(n)}})}migrate(e){this.vaultysId.toVersion(e);const r=this.store.substore("contacts");for(const n of r.list()){const i=r.get(n),s=(0,t.instanciateContact)(i),o=s.toVersion(e);o.did!==n&&(r.set(o.did,{...s,...o,metadata:i.metadata,oldDid:n}),r.delete(n))}const n=this.store.substore("registrations");for(const r of n.list()){const i=n.get(r),s=(0,t.instanciateApp)(i);if(s){const t=s.toVersion(e);if(t.did!==r){const e=i.site===r?t.did:i.site;n.set(t.did,{site:e,oldDid:r,serverId:t.id.toString("base64"),certificate:i.certificate,timestamp:i.timestamp}),n.delete(r)}}}this.store.save()}async verifyChallenge(e,t){return this.vaultysId.verifyChallenge(e,t,!0)}async upload(e,t){if((await this.startSRP(e,"p2p","transfer")).isComplete()){const{upload:r}=(0,o.StreamChannel)(e);await r(t)}else e.send(l.Buffer.from([0]))}async download(e,t){if((await this.acceptSRP(e,"p2p","transfer")).isComplete()){const{download:r}=(0,o.StreamChannel)(e);await r(t)}else e.send(l.Buffer.from([0]))}async requestConnect(e,t){let r=this.getContact(t);if(r||(r=this.getApp(t)),!r)throw new Error(t+" is not in the Web of Trust");const n=b.crypto.randomBytes(16),i=await this.vaultysId.performDiffieHellman(r);if(!i)throw new Error("Unable to perform DH");e.send(n);const s=await e.receive(),o=(0,h.hash)("sha256",d.default.scalarMult(n,i));if(o.toString("base64")===s.toString("base64"))return o;throw new Error("Opening session failed with contact "+t)}async acceptConnect(e,t){let r=this.getContact(t);if(r||(r=this.getApp(t)),!r)throw new Error(t+" is not in the Web of Trust");const n=await this.vaultysId.performDiffieHellman(r);if(!n)throw new Error("Unable to perform DH");const i=await e.receive(),s=l.Buffer.concat([i.slice(0,16),b.crypto.randomBytes(16)]);(0,h.hash)("sha256",d.default.scalarMult(s,n))}async requestDecrypt(e,t){const r=await this.acceptSRP(e,"p2p","decrypt");if(r.isComplete()){e.send(t);const n=await e.receive();return await this.vaultysId.dhiesDecrypt(n,r.getContactId().id)}e.send(l.Buffer.from([0]))}async acceptDecrypt(e,t){const r=await this.startSRP(e,"p2p","decrypt",{},t);if(r.isComplete()){const t=await e.receive(),n=await this.vaultysId.decrypt(t.toString("utf-8"));if(n){const t=await this.vaultysId.dhiesEncrypt(n,r.getContactId().id);e.send(t??l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}async requestDecryptFile(e,t){return this.decryptFile(t,e)}async requestEncryptFile(e,t){return this.encryptFile(t,e)}async acceptDecryptFile(e,t){let r=null;return await this.acceptPRF(e,(e,n)=>n.length>63&&n.startsWith("encryption/")&&n.endsWith("/encryption")?(r=e,t?.(e)||Promise.resolve(!0)):Promise.resolve(!1)),r}async requestSignFile(e,t){const r=await this.acceptSRP(e,"p2p","signfile");if(r.isComplete()){e.send(l.Buffer.from((0,u.encode)(t)));const n=await e.receive(),i=(0,u.decode)(n);return this.verifyFile(t,i,r.getContactId().toVersion(1))?i:void 0}e.send(l.Buffer.from([0]))}async acceptSignFile(e,t){const r=await this.startSRP(e,"p2p","signfile");if(r.isComplete()){const n=await e.receive(),i=(0,u.decode)(n);if(!t||await t(r.getContactId(),i)){const t=await this.signFile(i);e.send(l.Buffer.from((0,u.encode)(t)))}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}async requestPRF(e,t){if(t.length<3)throw new Error("appid is too short, less than 3 characters");if(t.split("|").length>1)throw new Error("appid contains illegal character |");if((await this.acceptSRP(e,"p2p","prf")).isComplete()){e.send(l.Buffer.from(t,"utf-8"));const r=await e.receive();return l.Buffer.from(r)}e.send(l.Buffer.from([0]))}async acceptPRF(e,t){const r=await this.startSRP(e,"p2p","prf");if(r.isComplete()){const n=(await e.receive()).toString("utf-8");if(n.length<3||n.split("|").length>1)e.send(l.Buffer.from([0]));else if(!t||await t(r.getContactId(),n)){const t=await this.vaultysId.hmac("prf|"+n+"|prf")??l.Buffer.from([0]);e.send(t),(0,h.secureErase)(t)}else e.send(l.Buffer.from([0]))}else e.send(l.Buffer.from([0]))}listCertificates(){const e=this.store.substore("wot");return e.list().map(t=>{const r=e.get(t);if(r.timestamp)return r;{const n={...i.default.deserializeCertificate(e.get(t)),raw:r};return e.set(t,n),n}})}async startSRP(e,t,r,n={},s){const o=new i.default(this.vaultysId);o.createChallenge(t,r,this.protocol_version,n);const a=o.getCertificate();if(!a)throw e.close(),e.send(l.Buffer.from([0])),new Error("Error processing challenge");e.send(a);try{const t=await e.receive(),r=i.default.deserializeCertificate(t).pk2;if(!r)throw e.send(l.Buffer.from([0])),new Error("Contact pk2 is not sent");if(s&&!await s(c.default.fromId(r)))throw e.send(l.Buffer.from([0])),new Error("Contact refused");await o.update(t)}catch(t){throw e.send(l.Buffer.from([0])),new Error(t)}if(o.isComplete()){const t=o.getCertificate();if(!t)throw e.close(),e.send(l.Buffer.from([0])),new Error("Error processing challenge");return e.send(t),this.store.substore("wot").set(Date.now()+"",t),o}throw e.send(l.Buffer.from([0])),new Error("Can't add a new contact if the protocol is not complete")}async acceptSRP(e,t,r,n={},s){const o=new i.default(this.vaultysId);try{const a=await e.receive(),f=i.default.deserializeCertificate(a);if(!f.pk1)throw e.send(l.Buffer.from([0])),new Error("Contact pk1 is not sent");if(f.protocol!==t)throw e.send(l.Buffer.from([0])),new Error("protocol is not the one expected: "+f.protocol+" !="+t);if(f.service!==r)throw e.send(l.Buffer.from([0])),new Error("service is not the one expected: "+f.service+" !="+r);if(s&&!await s(c.default.fromId(f.pk1)))throw e.send(l.Buffer.from([0])),new Error("Contact refused");await o.update(a,n)}catch(t){throw e.send(l.Buffer.from([0])),new Error(t)}const a=o.getCertificate();if(!a)throw e.send(l.Buffer.from([0])),await e.close(),new Error("Error processing challenge");e.send(a);try{const t=await e.receive();await o.update(t)}catch(t){throw await e.close(),new Error(t)}if(o.isComplete()){const e=o.getCertificate();return this.store.substore("wot").set(Date.now()+"",e),o}throw await e.close(),new Error("Can't add a new contact if the protocol is not complete")}saveApp(e,t){if(e.toVersion(this.vaultysId.version),e.isMachine()){const r=this.store.substore("registrations");r.get(e.did)||r.set(e.did,{site:t??e.did,serverId:e.id.toString("base64"),certificate:e.certificate})}else this.saveContact(e)}saveContact(e){if(e.toVersion(this.vaultysId.version),e.isMachine())this.saveApp(e);else{const t=this.store.substore("contacts");t.get(e.did)||(t.set(e.did,e),this.store.save())}}async askContact(e,t={},r){const n=(await this.startSRP(e,"p2p","auth",t,r)).getContactId();return this.saveContact(n),n}async acceptContact(e,t={},r){const n=(await this.acceptSRP(e,"p2p","auth",t,r)).getContactId();return this.saveContact(n),n}}t.default=v},5775:(e,t,r)=>{"use strict";const n=r(1883),i=r(1163),s=r(9109),o=r(8590),a=r(6899),f=r(790),{MT:c,NUMBYTES:h,SYMS:u,BI:l}=f,{Buffer:d}=r(4686),p=Symbol("count"),y=Symbol("major type"),b=Symbol("error"),g=Symbol("not found");function m(e,t,r){const n=[];return n[p]=r,n[u.PARENT]=e,n[y]=t,n}function w(e,t){const r=new a;return r[p]=-1,r[u.PARENT]=e,r[y]=t,r}class v extends Error{constructor(e,t){super(`Unexpected data: 0x${e.toString(16)}`),this.name="UnexpectedDataError",this.byte=e,this.value=t}}function _(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}class E extends n{constructor(e={}){const{tags:t={},max_depth:r=-1,preferMap:n=!1,preferWeb:i=!1,required:s=!1,encoding:o="hex",extendedResults:f=!1,preventDuplicateKeys:c=!1,...h}=e;super({defaultEncoding:o,...h}),this.running=!0,this.max_depth=r,this.tags=t,this.preferMap=n,this.preferWeb=i,this.extendedResults=f,this.required=s,this.preventDuplicateKeys=c,f&&(this.bs.on("read",this._onRead.bind(this)),this.valueBytes=new a)}static nullcheck(e){switch(e){case u.NULL:return null;case u.UNDEFINED:return;case g:throw new Error("Value not found");default:return e}}static decodeFirstSync(e,t={}){if(null==e)throw new TypeError("input required");({options:t}=_(t));const{encoding:r="hex",...n}=t,i=new E(n),s=o.guessEncoding(e,r),a=i._parse();let f=a.next();for(;!f.done;){const e=s.read(f.value);if(null==e||e.length!==f.value)throw new Error("Insufficient data");i.extendedResults&&i.valueBytes.write(e),f=a.next(e)}let c=null;if(i.extendedResults)c=f.value,c.unused=s.read();else if(c=E.nullcheck(f.value),s.length>0){const e=s.read(1);throw s.unshift(e),new v(e[0],c)}return c}static decodeAllSync(e,t={}){if(null==e)throw new TypeError("input required");({options:t}=_(t));const{encoding:r="hex",...n}=t,i=new E(n),s=o.guessEncoding(e,r),a=[];for(;s.length>0;){const e=i._parse();let t=e.next();for(;!t.done;){const r=s.read(t.value);if(null==r||r.length!==t.value)throw new Error("Insufficient data");i.extendedResults&&i.valueBytes.write(r),t=e.next(r)}a.push(E.nullcheck(t.value))}return a}static decodeFirst(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=_(t,r));const{encoding:n="hex",required:i=!1,...s}=t,a=new E(s);let f=g;const c=o.guessEncoding(e,n),h=new Promise((e,t)=>{a.on("data",e=>{f=E.nullcheck(e),a.close()}),a.once("error",r=>a.extendedResults&&r instanceof v?(f.unused=a.bs.slice(),e(f)):(f!==g&&(r.value=f),f=b,a.close(),t(r))),a.once("end",()=>{switch(f){case g:return i?t(new Error("No CBOR found")):e(f);case b:return;default:return e(f)}})});return"function"==typeof r&&h.then(e=>r(null,e),r),c.pipe(a),h}static decodeAll(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=_(t,r));const{encoding:n="hex",...i}=t,s=new E(i),a=[];s.on("data",e=>a.push(E.nullcheck(e)));const f=new Promise((e,t)=>{s.on("error",t),s.on("end",()=>e(a))});return"function"==typeof r&&f.then(e=>r(void 0,e),e=>r(e,void 0)),o.guessEncoding(e,n).pipe(s),f}close(){this.running=!1,this.__fresh=!0}_onRead(e){this.valueBytes.write(e)}*_parse(){let e=null,t=0,r=null;for(;;){if(this.max_depth>=0&&t>this.max_depth)throw new Error(`Maximum depth ${this.max_depth} exceeded`);const[n]=yield 1;if(!this.running)throw this.bs.unshift(d.from([n])),new v(n);const f=n>>5,b=31&n,g=null==e?void 0:e[y],_=null==e?void 0:e.length;switch(b){case h.ONE:this.emit("more-bytes",f,1,g,_),[r]=yield 1;break;case h.TWO:case h.FOUR:case h.EIGHT:{const e=1<<b-24;this.emit("more-bytes",f,e,g,_);const t=yield e;r=f===c.SIMPLE_FLOAT?t:o.parseCBORint(b,t);break}case 28:case 29:case 30:throw this.running=!1,new Error(`Additional info not implemented: ${b}`);case h.INDEFINITE:switch(f){case c.POS_INT:case c.NEG_INT:case c.TAG:throw new Error(`Invalid indefinite encoding for MT ${f}`)}r=-1;break;default:r=b}switch(f){case c.POS_INT:break;case c.NEG_INT:r=r===Number.MAX_SAFE_INTEGER?l.NEG_MAX:"bigint"==typeof r?l.MINUS_ONE-r:-1-r;break;case c.BYTE_STRING:case c.UTF8_STRING:switch(r){case 0:this.emit("start-string",f,r,g,_),r=f===c.UTF8_STRING?"":this.preferWeb?new Uint8Array(0):d.allocUnsafe(0);break;case-1:this.emit("start",f,u.STREAM,g,_),e=w(e,f),t++;continue;default:this.emit("start-string",f,r,g,_),r=yield r,f===c.UTF8_STRING?r=o.utf8(r):this.preferWeb&&(r=new Uint8Array(r.buffer,r.byteOffset,r.length))}break;case c.ARRAY:case c.MAP:switch(r){case 0:r=f===c.MAP?this.preferMap?new Map:{}:[];break;case-1:this.emit("start",f,u.STREAM,g,_),e=m(e,f,-1),t++;continue;default:this.emit("start",f,r,g,_),e=m(e,f,r*(f-3)),t++;continue}break;case c.TAG:this.emit("start",f,r,g,_),e=m(e,f,1),e.push(r),t++;continue;case c.SIMPLE_FLOAT:if("number"==typeof r){if(b===h.ONE&&r<32)throw new Error(`Invalid two-byte encoding of simple value ${r}`);const t=null!=e;r=s.decode(r,t,t&&e[p]<0)}else r=o.parseCBORfloat(r)}this.emit("value",r,g,_,b);let S=!1;for(;null!=e;){if(r===u.BREAK)e[p]=1;else if(Array.isArray(e))e.push(r);else{const t=e[y];if(null!=t&&t!==f)throw this.running=!1,new Error("Invalid major type in indefinite encoding");e.write(r)}if(0!==--e[p]){S=!0;break}if(--t,delete e[p],Array.isArray(e))switch(e[y]){case c.ARRAY:r=e;break;case c.MAP:{let t=!this.preferMap;if(e.length%2!=0)throw new Error(`Invalid map length: ${e.length}`);for(let r=0,n=e.length;t&&r<n;r+=2)if("string"!=typeof e[r]||"__proto__"===e[r]){t=!1;break}if(t){r={};for(let t=0,n=e.length;t<n;t+=2){if(this.preventDuplicateKeys&&Object.prototype.hasOwnProperty.call(r,e[t]))throw new Error("Duplicate keys in a map");r[e[t]]=e[t+1]}}else{r=new Map;for(let t=0,n=e.length;t<n;t+=2){if(this.preventDuplicateKeys&&r.has(e[t]))throw new Error("Duplicate keys in a map");r.set(e[t],e[t+1])}}break}case c.TAG:r=new i(e[0],e[1]).convert(this.tags)}else if(e instanceof a)switch(e[y]){case c.BYTE_STRING:r=e.slice(),this.preferWeb&&(r=new Uint8Array(r.buffer,r.byteOffset,r.length));break;case c.UTF8_STRING:r=e.toString("utf-8")}this.emit("stop",e[y]);const n=e;e=e[u.PARENT],delete n[u.PARENT],delete n[y]}if(!S){if(this.extendedResults){const e=this.valueBytes.slice(),t={value:E.nullcheck(r),bytes:e,length:e.length};return this.valueBytes=new a,t}return r}}}}E.NOT_FOUND=g,e.exports=E},5781:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4686),s=n(r(1691)),o=n(r(7751)),a=r(1198),f=new(r(4872));class c{constructor(e){this.xpub=e}derive(e){const t=this.xpub.slice(0,32),r=this.xpub.slice(32,64),n=i.Buffer.allocUnsafe(37);let o,h;if(n.writeUInt32LE(e,33),!(e<a.HARDENED_OFFSET))throw new Error("can not derive hardened public key");t.copy(n,1),n[0]=2,o=a.hmac512(r,n),n[0]=3,h=a.hmac512(r,n);const u=h.slice(32,64),l=o.slice(0,32),d=new s.default(l.slice(0,28),16,"le").mul(new s.default(8)),p=f.g.mul(d),y=f.decodePoint(t.toString("hex")).add(p);return new c(i.Buffer.concat([i.Buffer.from(f.encodePoint(y)),u]))}toPublicKey(){const e=f.keyFromPublic(this.xpub.slice(0,32));return new o.default(i.Buffer.from(e.pubBytes()))}toBytes(){return this.xpub}static fromBytes(e){return new c(e)}}t.default=c},5826:()=>{},5860:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7261),s=n(r(1167)),o=n(r(4406)),a=n(r(8886)),f=r(2655),c=n(r(8580)),h=r(4686),u=r(7466),l={usb:1,nfc:2,ble:4,internal:8,hybrid:16,"smart-card":32},d=e=>{const t=s.default.decode(e,{extendedResults:!0}).value.get(1);return 1===t?"Ed25519VerificationKey2020":2===t?"P256VerificationKey2020":"Unknown"},p=e=>{const t=s.default.decode(e,{extendedResults:!0}).value;let r=h.Buffer.from([]);return-7==t.get(3)?r=h.Buffer.concat([h.Buffer.from("04","hex"),t.get(-2),t.get(-3)]):-8==t.get(3)?r=t.get(-2):t.get(3)==u.PQ_COSE_ALG.DILITHIUM2&&(r=t.get(-101)),{publicKey:r}};class y extends c.default{constructor(){super(),this.prfsalt=h.Buffer.from("VaultysID salt")}static async createFromAttestation(e){const t=new y;t.ckey=a.default.getCOSEPublicKey(e),t.authType=d(t.ckey),t.fid=h.Buffer.from(e.id,"base64");const r=e.response,n=r.getTransports?r.getTransports():["usb"];return t._transports=(e=>e.reduceRight((e,t)=>e+(l[t]?l[t]:0),0))(n),t.signer=p(t.ckey),await t.getCypher(),delete t.cypher.secretKey,t}getSecret(){return h.Buffer.from((0,f.encode)({v:this.version,f:this.fid,t:this._transports,c:this.ckey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,f.decode)(e),r=new y;return r.version=t.v??0,r.capability="private",r.fid="string"==typeof t.f?h.Buffer.from(t.f,"base64"):t.f,r._transports=t.t?t.t:15,r.ckey=t.c,r.authType=d(r.ckey),r.signer=p(t.c),r.cypher={publicKey:t.e},r}cleanSecureData(){this.cypher?.secretKey&&((0,i.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey)}async getCypher(){if(!this.cypher?.secretKey){const t={challenge:h.Buffer.from([]),userVerification:"preferred",allowCredentials:[{type:"public-key",id:this.fid,transports:(e=this._transports,Object.keys(l).filter(t=>e&&l[t]))}],extensions:{prf:{eval:{first:this.prfsalt}}}},r=await this.webAuthn.get(t),{prf:n}=r.getClientExtensionResults(),i=n?.results?.first;if(!i)throw new Error("PRF failed");const s=o.default.box.keyPair.fromSecretKey(new Uint8Array(i));this.cypher={publicKey:h.Buffer.from(s.publicKey),secretKey:h.Buffer.from(s.secretKey)}}var e;return super.getCypher()}async createRevocationCertificate(){return null}}t.default=y},5916:(e,t,r)=>{"use strict";var n=r(6192),i=r(1323),s=r(6671).Buffer,o=new Array(16);function a(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function f(e,t){return e<<t|e>>>32-t}function c(e,t,r,n,i,s,o){return f(e+(t&r|~t&n)+i+s|0,o)+t|0}function h(e,t,r,n,i,s,o){return f(e+(t&n|r&~n)+i+s|0,o)+t|0}function u(e,t,r,n,i,s,o){return f(e+(t^r^n)+i+s|0,o)+t|0}function l(e,t,r,n,i,s,o){return f(e+(r^(t|~n))+i+s|0,o)+t|0}n(a,i),a.prototype._update=function(){for(var e=o,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var r=this._a,n=this._b,i=this._c,s=this._d;r=c(r,n,i,s,e[0],3614090360,7),s=c(s,r,n,i,e[1],3905402710,12),i=c(i,s,r,n,e[2],606105819,17),n=c(n,i,s,r,e[3],3250441966,22),r=c(r,n,i,s,e[4],4118548399,7),s=c(s,r,n,i,e[5],1200080426,12),i=c(i,s,r,n,e[6],2821735955,17),n=c(n,i,s,r,e[7],4249261313,22),r=c(r,n,i,s,e[8],1770035416,7),s=c(s,r,n,i,e[9],2336552879,12),i=c(i,s,r,n,e[10],4294925233,17),n=c(n,i,s,r,e[11],2304563134,22),r=c(r,n,i,s,e[12],1804603682,7),s=c(s,r,n,i,e[13],4254626195,12),i=c(i,s,r,n,e[14],2792965006,17),r=h(r,n=c(n,i,s,r,e[15],1236535329,22),i,s,e[1],4129170786,5),s=h(s,r,n,i,e[6],3225465664,9),i=h(i,s,r,n,e[11],643717713,14),n=h(n,i,s,r,e[0],3921069994,20),r=h(r,n,i,s,e[5],3593408605,5),s=h(s,r,n,i,e[10],38016083,9),i=h(i,s,r,n,e[15],3634488961,14),n=h(n,i,s,r,e[4],3889429448,20),r=h(r,n,i,s,e[9],568446438,5),s=h(s,r,n,i,e[14],3275163606,9),i=h(i,s,r,n,e[3],4107603335,14),n=h(n,i,s,r,e[8],1163531501,20),r=h(r,n,i,s,e[13],2850285829,5),s=h(s,r,n,i,e[2],4243563512,9),i=h(i,s,r,n,e[7],1735328473,14),r=u(r,n=h(n,i,s,r,e[12],2368359562,20),i,s,e[5],4294588738,4),s=u(s,r,n,i,e[8],2272392833,11),i=u(i,s,r,n,e[11],1839030562,16),n=u(n,i,s,r,e[14],4259657740,23),r=u(r,n,i,s,e[1],2763975236,4),s=u(s,r,n,i,e[4],1272893353,11),i=u(i,s,r,n,e[7],4139469664,16),n=u(n,i,s,r,e[10],3200236656,23),r=u(r,n,i,s,e[13],681279174,4),s=u(s,r,n,i,e[0],3936430074,11),i=u(i,s,r,n,e[3],3572445317,16),n=u(n,i,s,r,e[6],76029189,23),r=u(r,n,i,s,e[9],3654602809,4),s=u(s,r,n,i,e[12],3873151461,11),i=u(i,s,r,n,e[15],530742520,16),r=l(r,n=u(n,i,s,r,e[2],3299628645,23),i,s,e[0],4096336452,6),s=l(s,r,n,i,e[7],1126891415,10),i=l(i,s,r,n,e[14],2878612391,15),n=l(n,i,s,r,e[5],4237533241,21),r=l(r,n,i,s,e[12],1700485571,6),s=l(s,r,n,i,e[3],2399980690,10),i=l(i,s,r,n,e[10],4293915773,15),n=l(n,i,s,r,e[1],2240044497,21),r=l(r,n,i,s,e[8],1873313359,6),s=l(s,r,n,i,e[15],4264355552,10),i=l(i,s,r,n,e[6],2734768916,15),n=l(n,i,s,r,e[13],1309151649,21),r=l(r,n,i,s,e[4],4149444226,6),s=l(s,r,n,i,e[11],3174756917,10),i=l(i,s,r,n,e[2],718787259,15),n=l(n,i,s,r,e[9],3951481745,21),this._a=this._a+r|0,this._b=this._b+n|0,this._c=this._c+i|0,this._d=this._d+s|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=s.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},e.exports=a},6136:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hash_to_ristretto255=t.hashToRistretto255=t.RistrettoPoint=t.encodeToCurve=t.hashToCurve=t.ed25519_hasher=t.edwardsToMontgomery=t.x25519=t.ed25519ph=t.ed25519ctx=t.ed25519=t.ED25519_TORSION_SUBGROUP=void 0,t.edwardsToMontgomeryPub=M,t.edwardsToMontgomeryPriv=function(e){const t=S.hash(e.subarray(0,32));return S.adjustScalarBytes(t).subarray(0,32)};const n=r(4072),i=r(11),s=r(407),o=r(3144),a=r(2844),f=r(7342),c=r(8881),h=r(6376),u=BigInt(0),l=BigInt(1),d=BigInt(2),p=BigInt(3),y=BigInt(5),b=BigInt(8),g={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:b,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function m(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=g.p,o=e*e%s*e%s,a=(0,f.pow2)(o,d,s)*o%s,c=(0,f.pow2)(a,l,s)*e%s,h=(0,f.pow2)(c,y,s)*c%s,u=(0,f.pow2)(h,t,s)*h%s,p=(0,f.pow2)(u,r,s)*u%s,b=(0,f.pow2)(p,n,s)*p%s,m=(0,f.pow2)(b,i,s)*b%s,w=(0,f.pow2)(m,i,s)*b%s,v=(0,f.pow2)(w,t,s)*h%s;return{pow_p_5_8:(0,f.pow2)(v,d,s)*e%s,b2:o}}function w(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const v=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function _(e,t){const r=g.p,n=(0,f.mod)(t*t*t,r),i=m(e*(0,f.mod)(n*n*t,r)).pow_p_5_8;let s=(0,f.mod)(e*n*i,r);const o=(0,f.mod)(t*s*s,r),a=s,c=(0,f.mod)(s*v,r),h=o===e,u=o===(0,f.mod)(-e,r),l=o===(0,f.mod)(-e*v,r);return h&&(s=a),(u||l)&&(s=c),(0,f.isNegativeLE)(s,r)&&(s=(0,f.mod)(-s,r)),{isValid:h||u,value:s}}t.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];const E=(()=>(0,f.Field)(g.p,void 0,!0))(),S=(()=>({...g,Fp:E,hash:n.sha512,adjustScalarBytes:w,uvRatio:_}))();function B(e,t,r){if(t.length>255)throw new Error("Context is too big");return(0,i.concatBytes)((0,i.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}function M(e){const r=(0,h.ensureBytes)("pub",e),{y:n}=t.ed25519.Point.fromHex(r),i=BigInt(1);return E.toBytes(E.create((i+n)*E.inv(i-n)))}t.ed25519=(0,o.twistedEdwards)(S),t.ed25519ctx=(0,o.twistedEdwards)({...S,domain:B}),t.ed25519ph=(0,o.twistedEdwards)(Object.assign({},S,{domain:B,prehash:n.sha512})),t.x25519=(()=>{const e=g.p;return(0,c.montgomery)({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:r,b2:n}=m(t);return(0,f.mod)((0,f.pow2)(r,p,e)*n,e)},adjustScalarBytes:w})})(),t.edwardsToMontgomery=M;const A=(()=>(E.ORDER+p)/b)(),I=(()=>E.pow(d,A))(),x=(()=>E.sqrt(E.neg(E.ONE)))(),k=(()=>(0,f.FpSqrtEven)(E,E.neg(BigInt(486664))))();function T(e){if(!(e instanceof H))throw new Error("RistrettoPoint expected")}t.ed25519_hasher=(0,a.createHasher)(t.ed25519.Point,e=>function(e){const{xMn:t,xMd:r,yMn:n,yMd:i}=function(e){const t=(E.ORDER-y)/b,r=BigInt(486662);let n=E.sqr(e);n=E.mul(n,d);let i=E.add(n,E.ONE),s=E.neg(r),o=E.sqr(i),a=E.mul(o,i),f=E.mul(n,r);f=E.mul(f,s),f=E.add(f,o),f=E.mul(f,s);let c=E.sqr(a);o=E.sqr(c),c=E.mul(c,a),c=E.mul(c,f),o=E.mul(o,c);let h=E.pow(o,t);h=E.mul(h,c);let u=E.mul(h,x);o=E.sqr(h),o=E.mul(o,a);let p=E.eql(o,f),g=E.cmov(u,h,p),m=E.mul(s,n),w=E.mul(h,e);w=E.mul(w,I);let v=E.mul(w,x),_=E.mul(f,n);o=E.sqr(w),o=E.mul(o,a);let S=E.eql(o,_),B=E.cmov(v,w,S);o=E.sqr(g),o=E.mul(o,a);let M=E.eql(o,f),A=E.cmov(m,s,M),k=E.cmov(B,g,M),T=E.isOdd(k);return k=E.cmov(k,E.neg(k),M!==T),{xMn:A,xMd:i,yMn:k,yMd:l}}(e);let s=E.mul(t,i);s=E.mul(s,k);let o=E.mul(r,n),a=E.sub(t,r),c=E.add(t,r),h=E.mul(o,c),u=E.eql(h,E.ZERO);s=E.cmov(s,E.ZERO,u),o=E.cmov(o,E.ONE,u),a=E.cmov(a,E.ONE,u),c=E.cmov(c,E.ONE,u);const[p,g]=(0,f.FpInvertBatch)(E,[o,c],!0);return{x:E.mul(s,p),y:E.mul(a,g)}}(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:E.ORDER,m:1,k:128,expand:"xmd",hash:n.sha512}),t.hashToCurve=t.ed25519_hasher.hashToCurve,t.encodeToCurve=t.ed25519_hasher.encodeToCurve;const P=v,O=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),R=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),K=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),C=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),U=e=>_(l,e),D=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),L=e=>t.ed25519.CURVE.Fp.create((0,h.bytesToNumberLE)(e)&D);function N(e){const{d:r}=t.ed25519.CURVE,n=t.ed25519.CURVE.Fp.ORDER,i=t.ed25519.CURVE.Fp.create,s=i(P*e*e),o=i((s+l)*K);let a=BigInt(-1);const c=i((a-r*s)*i(s+r));let{isValid:h,value:u}=_(o,c),d=i(u*e);(0,f.isNegativeLE)(d,n)||(d=i(-d)),h||(u=d),h||(a=s);const p=i(a*(s-l)*C-c),y=u*u,b=i((u+u)*c),g=i(p*O),m=i(l-y),w=i(l+y);return new t.ed25519.Point(i(b*w),i(m*g),i(g*w),i(b*m))}class H{constructor(e){this.ep=e}static fromAffine(e){return new H(t.ed25519.Point.fromAffine(e))}static hashToCurve(e){e=(0,h.ensureBytes)("ristrettoHash",e,64);const t=N(L(e.slice(0,32))),r=N(L(e.slice(32,64)));return new H(t.add(r))}static fromBytes(e){return(0,i.abytes)(e),this.fromHex(e)}static fromHex(e){e=(0,h.ensureBytes)("ristrettoHex",e,32);const{a:r,d:n}=t.ed25519.CURVE,i=E.ORDER,s=E.create,o="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=L(e);if(!(0,h.equalBytes)((0,h.numberToBytesLE)(a,32),e)||(0,f.isNegativeLE)(a,i))throw new Error(o);const c=s(a*a),d=s(l+r*c),p=s(l-r*c),y=s(d*d),b=s(p*p),g=s(r*n*y-b),{isValid:m,value:w}=U(s(g*b)),v=s(w*p),_=s(w*v*g);let S=s((a+a)*v);(0,f.isNegativeLE)(S,i)&&(S=s(-S));const B=s(d*_),M=s(S*B);if(!m||(0,f.isNegativeLE)(M,i)||B===u)throw new Error(o);return new H(new t.ed25519.Point(S,B,l,M))}static msm(e,r){const n=(0,f.Field)(t.ed25519.CURVE.n,t.ed25519.CURVE.nBitLength);return(0,s.pippenger)(H,n,e,r)}toBytes(){let{ex:e,ey:t,ez:r,et:n}=this.ep;const i=E.ORDER,s=E.create,o=s(s(r+t)*s(r-t)),a=s(e*t),c=s(a*a),{value:u}=U(s(o*c)),l=s(u*o),d=s(u*a),p=s(l*d*n);let y;if((0,f.isNegativeLE)(n*p,i)){let r=s(t*P),n=s(e*P);e=r,t=n,y=s(l*R)}else y=d;(0,f.isNegativeLE)(e*p,i)&&(t=s(-t));let b=s((r-t)*y);return(0,f.isNegativeLE)(b,i)&&(b=s(-b)),(0,h.numberToBytesLE)(b,32)}toRawBytes(){return this.toBytes()}toHex(){return(0,h.bytesToHex)(this.toBytes())}toString(){return this.toHex()}equals(e){T(e);const{ex:t,ey:r}=this.ep,{ex:n,ey:i}=e.ep,s=E.create,o=s(t*i)===s(r*n),a=s(r*i)===s(t*n);return o||a}add(e){return T(e),new H(this.ep.add(e.ep))}subtract(e){return T(e),new H(this.ep.subtract(e.ep))}multiply(e){return new H(this.ep.multiply(e))}multiplyUnsafe(e){return new H(this.ep.multiplyUnsafe(e))}double(){return new H(this.ep.double())}negate(){return new H(this.ep.negate())}}t.RistrettoPoint=(H.BASE||(H.BASE=new H(t.ed25519.Point.BASE)),H.ZERO||(H.ZERO=new H(t.ed25519.Point.ZERO)),H),t.hashToRistretto255=(e,t)=>{const r=t.DST,s="string"==typeof r?(0,i.utf8ToBytes)(r):r,o=(0,a.expand_message_xmd)(e,s,64,n.sha512);return H.hashToCurve(o)},t.hash_to_ristretto255=t.hashToRistretto255},6141:(e,t,r)=>{var n=r(8558),i=r(1661),s=function(){},o=r.g.Bare?queueMicrotask:n.nextTick.bind(n),a=function(e,t,r){if("function"==typeof t)return a(e,null,t);t||(t={}),r=i(r||s);var n=e._writableState,f=e._readableState,c=t.readable||!1!==t.readable&&e.readable,h=t.writable||!1!==t.writable&&e.writable,u=!1,l=function(){e.writable||d()},d=function(){h=!1,c||r.call(e)},p=function(){c=!1,h||r.call(e)},y=function(t){r.call(e,t?new Error("exited with error code: "+t):null)},b=function(t){r.call(e,t)},g=function(){o(m)},m=function(){if(!u)return(!c||f&&f.ended&&!f.destroyed)&&(!h||n&&n.ended&&!n.destroyed)?void 0:r.call(e,new Error("premature close"))},w=function(){e.req.on("finish",d)};return function(e){return e.setHeader&&"function"==typeof e.abort}(e)?(e.on("complete",d),e.on("abort",g),e.req?w():e.on("request",w)):h&&!n&&(e.on("end",l),e.on("close",l)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",y),e.on("end",p),e.on("finish",d),!1!==t.error&&e.on("error",b),e.on("close",g),function(){u=!0,e.removeListener("complete",d),e.removeListener("abort",g),e.removeListener("request",w),e.req&&e.req.removeListener("finish",d),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",d),e.removeListener("exit",y),e.removeListener("end",p),e.removeListener("error",b),e.removeListener("close",g)}};e.exports=a},6160:(e,t,r)=>{"use strict";var n=r(7902),i=r(1036),s=i.getNAF,o=i.getJSF,a=i.assert;function f(e,t){this.type=e,this.p=new n(t.p,16),this.red=t.prime?n.red(t.prime):n.mont(this.p),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.n=t.n&&new n(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function c(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=f,f.prototype.point=function(){throw new Error("Not implemented")},f.prototype.validate=function(){throw new Error("Not implemented")},f.prototype._fixedNafMul=function(e,t){a(e.precomputed);var r=e._getDoubles(),n=s(t,1,this._bitLength),i=(1<<r.step+1)-(r.step%2==0?2:1);i/=3;var o,f,c=[];for(o=0;o<n.length;o+=r.step){f=0;for(var h=o+r.step-1;h>=o;h--)f=(f<<1)+n[h];c.push(f)}for(var u=this.jpoint(null,null,null),l=this.jpoint(null,null,null),d=i;d>0;d--){for(o=0;o<c.length;o++)(f=c[o])===d?l=l.mixedAdd(r.points[o]):f===-d&&(l=l.mixedAdd(r.points[o].neg()));u=u.add(l)}return u.toP()},f.prototype._wnafMul=function(e,t){var r=4,n=e._getNAFPoints(r);r=n.wnd;for(var i=n.points,o=s(t,r,this._bitLength),f=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var h=0;c>=0&&0===o[c];c--)h++;if(c>=0&&h++,f=f.dblp(h),c<0)break;var u=o[c];a(0!==u),f="affine"===e.type?u>0?f.mixedAdd(i[u-1>>1]):f.mixedAdd(i[-u-1>>1].neg()):u>0?f.add(i[u-1>>1]):f.add(i[-u-1>>1].neg())}return"affine"===e.type?f.toP():f},f.prototype._wnafMulAdd=function(e,t,r,n,i){var a,f,c,h=this._wnafT1,u=this._wnafT2,l=this._wnafT3,d=0;for(a=0;a<n;a++){var p=(c=t[a])._getNAFPoints(e);h[a]=p.wnd,u[a]=p.points}for(a=n-1;a>=1;a-=2){var y=a-1,b=a;if(1===h[y]&&1===h[b]){var g=[t[y],null,null,t[b]];0===t[y].y.cmp(t[b].y)?(g[1]=t[y].add(t[b]),g[2]=t[y].toJ().mixedAdd(t[b].neg())):0===t[y].y.cmp(t[b].y.redNeg())?(g[1]=t[y].toJ().mixedAdd(t[b]),g[2]=t[y].add(t[b].neg())):(g[1]=t[y].toJ().mixedAdd(t[b]),g[2]=t[y].toJ().mixedAdd(t[b].neg()));var m=[-3,-1,-5,-7,0,7,5,1,3],w=o(r[y],r[b]);for(d=Math.max(w[0].length,d),l[y]=new Array(d),l[b]=new Array(d),f=0;f<d;f++){var v=0|w[0][f],_=0|w[1][f];l[y][f]=m[3*(v+1)+(_+1)],l[b][f]=0,u[y]=g}}else l[y]=s(r[y],h[y],this._bitLength),l[b]=s(r[b],h[b],this._bitLength),d=Math.max(l[y].length,d),d=Math.max(l[b].length,d)}var E=this.jpoint(null,null,null),S=this._wnafT4;for(a=d;a>=0;a--){for(var B=0;a>=0;){var M=!0;for(f=0;f<n;f++)S[f]=0|l[f][a],0!==S[f]&&(M=!1);if(!M)break;B++,a--}if(a>=0&&B++,E=E.dblp(B),a<0)break;for(f=0;f<n;f++){var A=S[f];0!==A&&(A>0?c=u[f][A-1>>1]:A<0&&(c=u[f][-A-1>>1].neg()),E="affine"===c.type?E.mixedAdd(c):E.add(c))}}for(a=0;a<n;a++)u[a]=null;return i?E:E.toP()},f.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},f.prototype.decodePoint=function(e,t){e=i.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?a(e[e.length-1]%2==0):7===e[0]&&a(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(e){return this.encode(e,!0)},c.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},c.prototype.encode=function(e,t){return i.encode(this._encode(t),e)},c.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},c.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},c.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],n=this,i=0;i<t;i+=e){for(var s=0;s<e;s++)n=n.dbl();r.push(n)}return{step:e,points:r}},c.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,n=1===r?null:this.dbl(),i=1;i<r;i++)t[i]=t[i-1].add(n);return{wnd:e,points:t}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}},6192:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},6215:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY=t.utf8ToBytes=t.concatBytes=t.randomBytes=t.ensureBytes=void 0,t.equalBytes=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},t.splitCoder=function(...e){const r=e=>"number"==typeof e?e:e.bytesLen,n=e.reduce((e,t)=>e+r(t),0);return{bytesLen:n,encode:i=>{const s=new Uint8Array(n);for(let n=0,o=0;n<e.length;n++){const a=e[n],f=r(a),c="number"==typeof a?i[n]:a.encode(i[n]);(0,t.ensureBytes)(c,f),s.set(c,o),"number"!=typeof a&&c.fill(0),o+=f}return s},decode:i=>{(0,t.ensureBytes)(i,n);const s=[];for(const t of e){const e=r(t),n=i.subarray(0,e);s.push("number"==typeof t?n:t.decode(n)),i=i.subarray(e)}return s}}},t.vecCoder=function(e,r){const n=r*e.bytesLen;return{bytesLen:n,encode:t=>{if(t.length!==r)throw new Error(`vecCoder.encode: wrong length=${t.length}. Expected: ${r}`);const i=new Uint8Array(n);for(let r=0,n=0;r<t.length;r++){const s=e.encode(t[r]);i.set(s,n),s.fill(0),n+=s.length}return i},decode:r=>{(0,t.ensureBytes)(r,n);const i=[];for(let t=0;t<r.length;t+=e.bytesLen)i.push(e.decode(r.subarray(t,t+e.bytesLen)));return i}}},t.cleanBytes=function(...e){for(const t of e)if(Array.isArray(t))for(const e of t)e.fill(0);else t.fill(0)},t.getMask=function(e){return(1<<e)-1},t.getMessage=function(e,r=t.EMPTY){if((0,t.ensureBytes)(e),(0,t.ensureBytes)(r),r.length>255)throw new Error("context should be less than 255 bytes");return(0,s.concatBytes)(new Uint8Array([0,r.length]),r,e)},t.getMessagePrehash=function(e,r,n=t.EMPTY){if((0,t.ensureBytes)(r),(0,t.ensureBytes)(n),n.length>255)throw new Error("context should be less than 255 bytes");if(!o[e])throw new Error("unknown hash: "+e);const{oid:i,hash:a}=o[e],f=a(r);return(0,s.concatBytes)(new Uint8Array([1,n.length]),n,i,f)};const n=r(4072),i=r(5391),s=r(11);Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return s.concatBytes}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return s.utf8ToBytes}}),t.ensureBytes=s.abytes,t.randomBytes=s.randomBytes,t.EMPTY=new Uint8Array(0);const o={"SHA2-256":{oid:(0,s.hexToBytes)("0609608648016503040201"),hash:n.sha256},"SHA2-384":{oid:(0,s.hexToBytes)("0609608648016503040202"),hash:n.sha384},"SHA2-512":{oid:(0,s.hexToBytes)("0609608648016503040203"),hash:n.sha512},"SHA2-224":{oid:(0,s.hexToBytes)("0609608648016503040204"),hash:n.sha224},"SHA2-512/224":{oid:(0,s.hexToBytes)("0609608648016503040205"),hash:n.sha512_224},"SHA2-512/256":{oid:(0,s.hexToBytes)("0609608648016503040206"),hash:n.sha512_256},"SHA3-224":{oid:(0,s.hexToBytes)("0609608648016503040207"),hash:i.sha3_224},"SHA3-256":{oid:(0,s.hexToBytes)("0609608648016503040208"),hash:i.sha3_256},"SHA3-384":{oid:(0,s.hexToBytes)("0609608648016503040209"),hash:i.sha3_384},"SHA3-512":{oid:(0,s.hexToBytes)("060960864801650304020A"),hash:i.sha3_512},"SHAKE-128":{oid:(0,s.hexToBytes)("060960864801650304020B"),hash:e=>(0,i.shake128)(e,{dkLen:32})},"SHAKE-256":{oid:(0,s.hexToBytes)("060960864801650304020C"),hash:e=>(0,i.shake256)(e,{dkLen:64})}}},6376:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notImplemented=t.bitMask=t.utf8ToBytes=t.randomBytes=t.isBytes=t.hexToBytes=t.concatBytes=t.bytesToUtf8=t.bytesToHex=t.anumber=t.abytes=void 0,t.abool=function(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)},t.numberToHexUnpadded=a,t.hexToNumber=f,t.bytesToNumberBE=function(e){return f((0,n.bytesToHex)(e))},t.bytesToNumberLE=function(e){return(0,n.abytes)(e),f((0,n.bytesToHex)(Uint8Array.from(e).reverse()))},t.numberToBytesBE=c,t.numberToBytesLE=function(e,t){return c(e,t).reverse()},t.numberToVarBytesBE=function(e){return(0,n.hexToBytes)(a(e))},t.ensureBytes=function(e,t,r){let i;if("string"==typeof t)try{i=(0,n.hexToBytes)(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!(0,n.isBytes)(t))throw new Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const s=i.length;if("number"==typeof r&&s!==r)throw new Error(e+" of length "+r+" expected, got "+s);return i},t.equalBytes=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},t.inRange=u,t.aInRange=function(e,t,r,n){if(!u(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)},t.bitLen=function(e){let t;for(t=0;e>s;e>>=o,t+=1);return t},t.bitGet=function(e,t){return e>>BigInt(t)&o},t.bitSet=function(e,t,r){return e|(r?o:s)<<BigInt(t)},t.createHmacDrbg=function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");const i=e=>new Uint8Array(e),s=e=>Uint8Array.of(e);let o=i(e),a=i(e),f=0;const c=()=>{o.fill(1),a.fill(0),f=0},h=(...e)=>r(a,o,...e),u=(e=i(0))=>{a=h(s(0),e),o=h(),0!==e.length&&(a=h(s(1),e),o=h())},l=()=>{if(f++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){o=h();const t=o.slice();r.push(t),e+=o.length}return(0,n.concatBytes)(...r)};return(e,t)=>{let r;for(c(),u(e);!(r=t(l()));)u();return c(),r}},t.validateObject=function(e,t,r={}){const n=(t,r,n)=>{const i=l[r];if("function"!=typeof i)throw new Error("invalid validator function");const s=e[t];if(!(n&&void 0===s||i(s,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+s)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e},t.isHash=function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)},t._validateObject=function(e,t,r={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function n(t,r,n){const i=e[t];if(n&&void 0===i)return;const s=typeof i;if(s!==r||null===i)throw new Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>n(e,t,!1)),Object.entries(r).forEach(([e,t])=>n(e,t,!0))},t.memoized=function(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}};const n=r(11);var i=r(11);Object.defineProperty(t,"abytes",{enumerable:!0,get:function(){return i.abytes}}),Object.defineProperty(t,"anumber",{enumerable:!0,get:function(){return i.anumber}}),Object.defineProperty(t,"bytesToHex",{enumerable:!0,get:function(){return i.bytesToHex}}),Object.defineProperty(t,"bytesToUtf8",{enumerable:!0,get:function(){return i.bytesToUtf8}}),Object.defineProperty(t,"concatBytes",{enumerable:!0,get:function(){return i.concatBytes}}),Object.defineProperty(t,"hexToBytes",{enumerable:!0,get:function(){return i.hexToBytes}}),Object.defineProperty(t,"isBytes",{enumerable:!0,get:function(){return i.isBytes}}),Object.defineProperty(t,"randomBytes",{enumerable:!0,get:function(){return i.randomBytes}}),Object.defineProperty(t,"utf8ToBytes",{enumerable:!0,get:function(){return i.utf8ToBytes}});const s=BigInt(0),o=BigInt(1);function a(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function f(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?s:BigInt("0x"+e)}function c(e,t){return(0,n.hexToBytes)(e.toString(16).padStart(2*t,"0"))}const h=e=>"bigint"==typeof e&&s<=e;function u(e,t,r){return h(e)&&h(t)&&h(r)&&t<=e&&e<r}t.bitMask=e=>(o<<BigInt(e))-o;const l={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||(0,n.isBytes)(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};t.notImplemented=()=>{throw new Error("not implemented")}},6404:function(e,t,r){"use strict";var n,i=r(4686).Buffer,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&s(t,e,r[i]);return o(t,e),t}),f=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{f(n.next(e))}catch(e){s(e)}}function a(e){try{f(n.throw(e))}catch(e){s(e)}}function f(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}f((n=n.apply(e,t||[])).next())})},c=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DesigncryptStream=t.SigncryptStream=void 0,t.debugSetKey=function(e){w=e},t.debugSetKeypair=function(e){v=e},t.signcrypt=function(e,t,r){return f(this,void 0,void 0,function*(){var n,s;const o=(0,p.chunkBuffer)(e,m),a=null!=w?w:(0,b.randomBytes)(32),f=null!=v?v:b.box.keyPair(),c=r.map((e,t)=>e instanceof l.SymmetricKeyRecipient?l.default.createSymmetric(e.key,e.recipient_identifier,f.publicKey,a,t):l.default.create(e,f.secretKey,a,t)),h=u.default.create(f.publicKey,a,null!==(n=null==t?void 0:t.publicKey)&&void 0!==n?n:null,c),y=[];for(const e in o){const r=o[e],n=o.length===parseInt(e)+1,i=d.default.create(h,a,null!==(s=null==t?void 0:t.secretKey)&&void 0!==s?s:null,r,BigInt(e),n);y.push(i)}return i.concat([h.encoded,i.concat(y.map(e=>e.encoded))])})},t.designcrypt=function(e,t,r){return f(this,void 0,void 0,function*(){var n,s,o,a;const f=new y.Readable;f.push(e),f.push(null);const h=[];try{for(var p,b=!0,m=c((0,g.decodeMultiStream)(f));!(n=(p=yield m.next()).done);b=!0){a=p.value,b=!1;const e=a;h.push(e)}}catch(e){s={error:e}}finally{try{b||n||!(o=m.return)||(yield o.call(m))}finally{if(s)throw s.error}}const w=h.shift(),v=u.default.decode(w,!0),_=t instanceof l.SymmetricKeyRecipient?v.decryptPayloadKeyWithSymmetricKey(t.key,t.recipient_identifier):v.decryptPayloadKeyWithCurve25519Keypair(t.secretKey);if(!_)throw new Error("keypair is not an intended recipient");const[E]=_,S=v.decryptSender(E);if(r&&(!S||!i.from(S).equals(i.from(r))))throw new Error("Sender public key doesn't match");let B=i.alloc(0);for(const e in h){const t=h[e],r=d.default.decode(t,!0),n=h.length===parseInt(e)+1;if(r.final&&!n)throw new Error("Found payload with invalid final flag, message extended?");if(!r.final&&n)throw new Error("Found payload with invalid final flag, message truncated?");B=i.concat([B,r.decrypt(v,S,E,BigInt(e))])}if(!h.length)throw new Error("No signcrypted payloads, message truncated?");return Object.assign(B,{sender_public_key:S})})};const u=h(r(8051)),l=a(r(3051)),d=h(r(5466)),p=r(568),y=r(896),b=r(4406),g=r(2655),m=1048576;let w=null,v=null;class _ extends y.Transform{constructor(e,t){var r,n;super(),this.in_buffer=i.alloc(0),this.payload_index=BigInt(0),this.i=0,this.payload_key=null!=w?w:i.from((0,b.randomBytes)(32)),this.ephemeral_keypair=null!=v?v:b.box.keyPair(),this.keypair=e;const s=t.map((e,t)=>e instanceof l.SymmetricKeyRecipient?l.default.createSymmetric(e.key,e.recipient_identifier,this.ephemeral_keypair.publicKey,this.payload_key,t):l.default.create(e,this.ephemeral_keypair.secretKey,this.payload_key,t));this.header=u.default.create(this.ephemeral_keypair.publicKey,this.payload_key,null!==(n=null===(r=this.keypair)||void 0===r?void 0:r.publicKey)&&void 0!==n?n:null,s),this.push(this.header.encoded)}_transform(e,t,r){var n,s;for(this.in_buffer=i.concat([this.in_buffer,e]);this.in_buffer.length>m;){const e=this.in_buffer.slice(0,m);this.in_buffer=this.in_buffer.slice(m);const t=d.default.create(this.header,this.payload_key,null!==(s=null===(n=this.keypair)||void 0===n?void 0:n.secretKey)&&void 0!==s?s:null,e,this.payload_index,!1);this.push(t.encoded),this.payload_index++}r()}_flush(e){for(var t,r,n,s;this.in_buffer.length>=m;){const e=this.in_buffer.slice(0,m);this.in_buffer=this.in_buffer.slice(m);const n=!this.in_buffer.length,i=d.default.create(this.header,this.payload_key,null!==(r=null===(t=this.keypair)||void 0===t?void 0:t.secretKey)&&void 0!==r?r:null,e,this.payload_index,n);this.push(i.encoded),this.payload_index++}if(this.in_buffer.length){const e=this.in_buffer;this.in_buffer=i.alloc(0);const t=!this.in_buffer.length,r=d.default.create(this.header,this.payload_key,null!==(s=null===(n=this.keypair)||void 0===n?void 0:n.secretKey)&&void 0!==s?s:null,e,this.payload_index,t);this.push(r.encoded),this.payload_index++}e()}}t.SigncryptStream=_;class E extends y.Transform{constructor(e,t){super(),this.recipient_keys=e,this.decoder=new g.Decoder,this.header_data=null,this.last_payload=null,this.payload_index=BigInt(-1),this.i=0,this.sender=null!=t?t:null}get header(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[0]}get payload_key(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[1]}get recipient(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[2]}get sender_public_key(){if(!this.header_data)throw new Error("Header hasn't been decoded yet");return this.header_data[3]}_transform(e,t,r){this.decoder.appendBuffer(e);try{let e;for(;e=this.decoder.doDecodeSync();){const t=i.from(this.decoder.bytes).slice(this.decoder.pos);this.decoder.setBuffer(t),this._handleMessage(e)}}catch(e){}r()}_handleMessage(e){if(this.header_data){if(this.payload_index++,this.last_payload){if(this.last_payload.final)throw new Error("Found payload with invalid final flag, message extended?");this.push(this.last_payload.decrypt(this.header,this.sender_public_key,this.payload_key,this.payload_index-BigInt(1)))}const t=d.default.decode(e,!0);this.last_payload=t}else{const t=u.default.decode(e,!0),r=this.recipient_keys instanceof l.SymmetricKeyRecipient?t.decryptPayloadKeyWithSymmetricKey(this.recipient_keys.key,this.recipient_keys.recipient_identifier):t.decryptPayloadKeyWithCurve25519Keypair(this.recipient_keys.secretKey);if(!r)throw new Error("keypair is not an intended recipient");const[n,s]=r,o=t.decryptSender(n);if(this.sender&&(!o||!i.from(o).equals(i.from(this.sender))))throw new Error("Sender public key doesn't match");this.header_data=[t,n,s,o]}}_flush(e){try{if(this.last_payload){if(!this.last_payload.final)throw new Error("Found payload with invalid final flag, message truncated?");this.push(this.last_payload.decrypt(this.header,this.sender_public_key,this.payload_key,this.payload_index))}if(!this.last_payload)throw new Error("No signcrypted payloads, message truncated?")}catch(t){return e(t)}e()}}t.DesigncryptStream=E},6452:e=>{e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},6552:(e,t,r)=>{var n,i=r(8558);n=r.g.process&&r.g.process.browser?"utf-8":r.g.process&&r.g.process.version?parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":"utf-8",e.exports=n},6630:(e,t,r)=>{var n=r(6192),i=r(9113),s=r(6671).Buffer,o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function f(){this.init(),this._w=a,i.call(this,64,56)}function c(e,t,r){return r^e&(t^r)}function h(e,t,r){return e&t|r&(e|t)}function u(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function l(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function d(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function p(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}n(f,i),f.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},f.prototype._update=function(e){for(var t=this._w,r=0|this._a,n=0|this._b,i=0|this._c,s=0|this._d,a=0|this._e,f=0|this._f,y=0|this._g,b=0|this._h,g=0;g<16;++g)t[g]=e.readInt32BE(4*g);for(;g<64;++g)t[g]=p(t[g-2])+t[g-7]+d(t[g-15])+t[g-16]|0;for(var m=0;m<64;++m){var w=b+l(a)+c(a,f,y)+o[m]+t[m]|0,v=u(r)+h(r,n,i)|0;b=y,y=f,f=a,a=s+w|0,s=i,i=n,n=r,r=w+v|0}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=a+this._e|0,this._f=f+this._f|0,this._g=y+this._g|0,this._h=b+this._h|0},f.prototype._hash=function(){var e=s.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=f},6671:(e,t,r)=>{var n=r(4686),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},6760:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(2655),s=r(4406),o=r(4072);class a{constructor(e,t,r){this.final=e,this.signature=t,this.data=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data}static create(e,t,r,n,i=!1){"number"==typeof n&&(n=BigInt(n));const o=this.generateSignData(e.hash,n,i,r);return new this(i,s.sign.detached(Uint8Array.from(o),Uint8Array.from(t)),r)}static generateSignData(e,t,r,i){const s=n.alloc(8);return s.writeBigUInt64BE(t),n.concat([this.PAYLOAD_SIGNATURE_PREFIX,o.sha512.create().update(e).update(s).update(r?"":"\0").update(i).digest()])}encode(){return a.encodePayload(this.final,this.signature,this.data)}static encodePayload(e,t,r){return n.from((0,i.encode)([e,t,r]))}static decode(e,t=!1){const r=t?e:(0,i.decode)(e);if(r.length<3)throw new Error("Invalid data");const[n,s,o]=r;return new this(n,s,o)}verify(e,t,r){const n=a.generateSignData(e.hash,r,this.final,this.data);if(!s.sign.detached.verify(Uint8Array.from(n),Uint8Array.from(this.signature),Uint8Array.from(t)))throw new Error("Invalid signature")}}a.PAYLOAD_SIGNATURE_PREFIX=n.from("saltpack attached signature\0"),t.default=a},6761:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PQ_COSE_KEY_PARAMS=t.PQ_COSE_KEY_TYPE=t.PQ_COSE_ALG=void 0,t.generateDilithiumKeyPair=function(e){e||(e=(0,s.randomBytes)(32));const t=n.ml_dsa65.keygen(e);return{publicKey:i.Buffer.from(t.publicKey),secretKey:i.Buffer.from(t.secretKey)}},t.signDilithium=function(e,t){return i.Buffer.from(n.ml_dsa65.sign(t,e))},t.verifyDilithium=function(e,t,r){return n.ml_dsa65.verify(r,e,t)},t.createDilithiumCoseKey=function(e){const r=new Map;return r.set(1,t.PQ_COSE_KEY_TYPE.DILITHIUM),r.set(3,t.PQ_COSE_ALG.DILITHIUM2),r.set(t.PQ_COSE_KEY_PARAMS.DILITHIUM_MODE,2),r.set(t.PQ_COSE_KEY_PARAMS.DILITHIUM_PK,e),r},t.getDilithiumKeyInfo=function(){return{publicKeySize:1952,secretKeySize:4032,signatureSize:3309}};const n=r(2404),i=r(4686),s=r(5598);t.PQ_COSE_ALG={DILITHIUM2:-46,DILITHIUM3:-47,DILITHIUM5:-48},t.PQ_COSE_KEY_TYPE={DILITHIUM:4},t.PQ_COSE_KEY_PARAMS={DILITHIUM_MODE:-100,DILITHIUM_PK:-101,DILITHIUM_SK:-102}},6807:(e,t,r)=>{"use strict";var n=r(7902),i=r(1036),s=i.assert,o=i.cachedProperty,a=i.parseBytes;function f(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(s(t.length===2*e.encodingLength,"Signature has invalid size"),t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof n&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}o(f,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),o(f,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),o(f,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),o(f,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),f.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},f.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},e.exports=f},6863:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pinEncryptInfo=void 0,t.getKeyMaterial=s,t.getKey=o,t.decrypt=async function(e,t){if(!e.encryptInfo)return e.data;try{const r=await s(t),n=await o(r,i.Buffer.from(e.encryptInfo.salt,"base64")),a=await window.crypto.subtle.decrypt({name:e.encryptInfo.DERIVED_KEY_TYPE,iv:i.Buffer.from(e.encryptInfo.iv,"base64")},n,e.data);return i.Buffer.from(a)}catch(e){return console.error(e),null}},t.encrypt=async function(e,t){if(!e)return;const r=window.crypto.getRandomValues(new Uint8Array(16)),o=window.crypto.getRandomValues(new Uint8Array(12)),a=await s(e),f=await window.crypto.subtle.deriveKey({name:n.encryptInfo.ALG,salt:r,iterations:n.encryptInfo.ITERATIONS,hash:n.encryptInfo.HASH},a,{name:n.encryptInfo.DERIVED_KEY_TYPE,length:n.encryptInfo.DERIVED_KEY_LENGTH},!0,["encrypt","decrypt"]),c=await window.crypto.subtle.encrypt({name:n.encryptInfo.DERIVED_KEY_TYPE,iv:o},f,t);return{version:1,encryptInfo:{...n.encryptInfo,iv:i.Buffer.from(o).toString("base64"),salt:i.Buffer.from(r).toString("base64")},data:i.Buffer.from(c)}};const n=r(148),i=r(4686);function s(e){const t=new TextEncoder;return window.crypto.subtle.importKey("raw",t.encode(e),n.encryptInfo.ALG,!1,["deriveBits","deriveKey"])}function o(e,t){return window.crypto.subtle.deriveKey({name:n.encryptInfo.ALG,salt:t,iterations:n.encryptInfo.ITERATIONS,hash:n.encryptInfo.HASH},e,{name:n.encryptInfo.DERIVED_KEY_TYPE,length:n.encryptInfo.DERIVED_KEY_LENGTH},!0,["encrypt","decrypt"])}t.pinEncryptInfo={ALG:"PBKDF2",ITERATIONS:1e5,DERIVED_KEY_TYPE:"AES-GCM",DERIVED_KEY_LENGTH:256,HASH:"SHA-256",SALT_LENGTH:16,IV_LENGTH:12}},6868:(e,t,r)=>{"use strict";var n,i=r(8558);function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t){var r=e.entry;for(e.entry=null;r;){var n=r.callback;t.pendingcb--,n(undefined),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=M,M.WritableState=B;var o,a={deprecate:r(1348)},f=r(9481),c=r(4686).Buffer,h=(void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){},u=r(4552),l=r(7963).getHighWaterMark,d=r(8704).F,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,b=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_STREAM_CANNOT_PIPE,m=d.ERR_STREAM_DESTROYED,w=d.ERR_STREAM_NULL_VALUES,v=d.ERR_STREAM_WRITE_AFTER_END,_=d.ERR_UNKNOWN_ENCODING,E=u.errorOrDestroy;function S(){}function B(e,t,o){n=n||r(5606),e=e||{},"boolean"!=typeof o&&(o=t instanceof n),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=l(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,s=r.writecb;if("function"!=typeof s)throw new b;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,s){--t.pendingcb,r?(i.nextTick(s,n),i.nextTick(P,e,t),e._writableState.errorEmitted=!0,E(e,n)):(s(n),e._writableState.errorEmitted=!0,E(e,n),P(e,t))}(e,r,n,t,s);else{var o=k(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||x(e,r),n?i.nextTick(I,e,r,o,s):I(e,r,o,s)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function M(e){var t=this instanceof(n=n||r(5606));if(!t&&!o.call(M,this))return new M(e);this._writableState=new B(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),f.call(this)}function A(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new m("write")):r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function I(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),P(e,t)}function x(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var a=0,f=!0;r;)i[a]=r,r.isBuf||(f=!1),r=r.next,a+=1;i.allBuffers=f,A(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,h=r.encoding,u=r.callback;if(A(e,t,!1,t.objectMode?1:c.length,c,h,u),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function k(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(e,t){e._final(function(r){t.pendingcb--,r&&E(e,r),t.prefinished=!0,e.emit("prefinish"),P(e,t)})}function P(e,t){var r=k(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(T,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}r(6192)(M,f),B.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(B.prototype,"buffer",{get:a.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(M,Symbol.hasInstance,{value:function(e){return!!o.call(this,e)||this===M&&e&&e._writableState instanceof B}})):o=function(e){return e instanceof this},M.prototype.pipe=function(){E(this,new g)},M.prototype.write=function(e,t,r){var n,s=this._writableState,o=!1,a=!s.objectMode&&(n=e,c.isBuffer(n)||n instanceof h);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=S),s.ending?function(e,t){var r=new v;E(e,r),i.nextTick(t,r)}(this,r):(a||function(e,t,r,n){var s;return null===r?s=new w:"string"==typeof r||t.objectMode||(s=new p("chunk",["string","Buffer"],r)),!s||(E(e,s),i.nextTick(n,s),!1)}(this,s,e,r))&&(s.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,r)),t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var a=t.objectMode?1:n.length;t.length+=a;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var h=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},h?h.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else A(e,t,!1,a,n,i,s);return f}(this,s,a,e,t,r)),o},M.prototype.cork=function(){this._writableState.corked++},M.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||x(this,e))},M.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(M.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(M.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),M.prototype._write=function(e,t,r){r(new y("_write()"))},M.prototype._writev=null,M.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,P(e,t),r&&(t.finished?i.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r),this},Object.defineProperty(M.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),M.prototype.destroy=u.destroy,M.prototype._undestroy=u.undestroy,M.prototype._destroy=function(e,t){t(e)}},6869:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},6899:(e,t,r)=>{"use strict";const n=r(896),{Buffer:i}=r(4686),s=new TextDecoder("utf8",{fatal:!0,ignoreBOM:!0});class o extends n.Transform{constructor(e,t,r={}){let n=null,s=null;switch(typeof e){case"object":i.isBuffer(e)?n=e:e&&(r=e);break;case"string":n=e;break;case"undefined":break;default:throw new TypeError("Invalid input")}switch(typeof t){case"object":t&&(r=t);break;case"string":s=t;break;case"undefined":break;default:throw new TypeError("Invalid inputEncoding")}if(!r||"object"!=typeof r)throw new TypeError("Invalid options");null==n&&(n=r.input),null==s&&(s=r.inputEncoding),delete r.input,delete r.inputEncoding;const o=null==r.watchPipe||r.watchPipe;delete r.watchPipe;const a=Boolean(r.readError);delete r.readError,super(r),this.readError=a,o&&this.on("pipe",e=>{const t=e._readableState.objectMode;if(this.length>0&&t!==this._readableState.objectMode)throw new Error("Do not switch objectMode in the middle of the stream");this._readableState.objectMode=t,this._writableState.objectMode=t}),null!=n&&this.end(n,s)}static isNoFilter(e){return e instanceof this}static compare(e,t){if(!(e instanceof this))throw new TypeError("Arguments must be NoFilters");return e===t?0:e.compare(t)}static concat(e,t){if(!Array.isArray(e))throw new TypeError("list argument must be an Array of NoFilters");if(0===e.length||0===t)return i.alloc(0);null==t&&(t=e.reduce((e,t)=>{if(!(t instanceof o))throw new TypeError("list argument must be an Array of NoFilters");return e+t.length},0));let r=!0,n=!0;const s=e.map(e=>{if(!(e instanceof o))throw new TypeError("list argument must be an Array of NoFilters");const t=e.slice();return i.isBuffer(t)?n=!1:r=!1,t});if(r)return i.concat(s,t);if(n)return[].concat(...s).slice(0,t);throw new Error("Concatenating mixed object and byte streams not supported")}_transform(e,t,r){this._readableState.objectMode||i.isBuffer(e)||(e=i.from(e,t)),this.push(e),r()}_bufArray(){let e=this._readableState.buffer;if(!Array.isArray(e)){let t=e.head;for(e=[];null!=t;)e.push(t.data),t=t.next}return e}read(e){const t=super.read(e);if(null!=t){if(this.emit("read",t),this.readError&&t.length<e)throw new Error(`Read ${t.length}, wanted ${e}`)}else if(this.readError)throw new Error(`No data available, wanted ${e}`);return t}readFull(e){let t=null,r=null,n=null;return new Promise((i,s)=>{this.length>=e?i(this.read(e)):this.writableFinished?s(new Error(`Stream finished before ${e} bytes were available`)):(t=t=>{this.length>=e&&i(this.read(e))},r=()=>{s(new Error(`Stream finished before ${e} bytes were available`))},n=s,this.on("readable",t),this.on("error",n),this.on("finish",r))}).finally(()=>{t&&(this.removeListener("readable",t),this.removeListener("error",n),this.removeListener("finish",r))})}promise(e){let t=!1;return new Promise((r,n)=>{this.on("finish",()=>{const n=this.read();null==e||t||(t=!0,e(null,n)),r(n)}),this.on("error",r=>{null==e||t||(t=!0,e(r)),n(r)})})}compare(e){if(!(e instanceof o))throw new TypeError("Arguments must be NoFilters");if(this===e)return 0;const t=this.slice(),r=e.slice();if(i.isBuffer(t)&&i.isBuffer(r))return t.compare(r);throw new Error("Cannot compare streams in object mode")}equals(e){return 0===this.compare(e)}slice(e,t){if(this._readableState.objectMode)return this._bufArray().slice(e,t);const r=this._bufArray();switch(r.length){case 0:return i.alloc(0);case 1:return r[0].slice(e,t);default:return i.concat(r).slice(e,t)}}get(e){return this.slice()[e]}toJSON(){const e=this.slice();return i.isBuffer(e)?e.toJSON():e}toString(e,t,r){const n=this.slice(t,r);return i.isBuffer(n)?e&&"utf8"!==e?n.toString(e):s.decode(n):JSON.stringify(n)}[Symbol.for("nodejs.util.inspect.custom")](e,t){const r=this._bufArray().map(e=>i.isBuffer(e)?t.stylize(e.toString("hex"),"string"):JSON.stringify(e)).join(", ");return`${this.constructor.name} [${r}]`}get length(){return this._readableState.length}writeBigInt(e){let t=e.toString(16);if(e<0){const r=BigInt(Math.floor(t.length/2));t=(e=(BigInt(1)<<r*BigInt(8))+e).toString(16)}return t.length%2&&(t=`0${t}`),this.push(i.from(t,"hex"))}readUBigInt(e){const t=this.read(e);return i.isBuffer(t)?BigInt(`0x${t.toString("hex")}`):null}readBigInt(e){const t=this.read(e);if(!i.isBuffer(t))return null;let r=BigInt(`0x${t.toString("hex")}`);return 128&t[0]&&(r-=BigInt(1)<<BigInt(t.length)*BigInt(8)),r}writeUInt8(e){const t=i.from([e]);return this.push(t)}writeUInt16LE(e){const t=i.alloc(2);return t.writeUInt16LE(e),this.push(t)}writeUInt16BE(e){const t=i.alloc(2);return t.writeUInt16BE(e),this.push(t)}writeUInt32LE(e){const t=i.alloc(4);return t.writeUInt32LE(e),this.push(t)}writeUInt32BE(e){const t=i.alloc(4);return t.writeUInt32BE(e),this.push(t)}writeInt8(e){const t=i.from([e]);return this.push(t)}writeInt16LE(e){const t=i.alloc(2);return t.writeUInt16LE(e),this.push(t)}writeInt16BE(e){const t=i.alloc(2);return t.writeUInt16BE(e),this.push(t)}writeInt32LE(e){const t=i.alloc(4);return t.writeUInt32LE(e),this.push(t)}writeInt32BE(e){const t=i.alloc(4);return t.writeUInt32BE(e),this.push(t)}writeFloatLE(e){const t=i.alloc(4);return t.writeFloatLE(e),this.push(t)}writeFloatBE(e){const t=i.alloc(4);return t.writeFloatBE(e),this.push(t)}writeDoubleLE(e){const t=i.alloc(8);return t.writeDoubleLE(e),this.push(t)}writeDoubleBE(e){const t=i.alloc(8);return t.writeDoubleBE(e),this.push(t)}writeBigInt64LE(e){const t=i.alloc(8);return t.writeBigInt64LE(e),this.push(t)}writeBigInt64BE(e){const t=i.alloc(8);return t.writeBigInt64BE(e),this.push(t)}writeBigUInt64LE(e){const t=i.alloc(8);return t.writeBigUInt64LE(e),this.push(t)}writeBigUInt64BE(e){const t=i.alloc(8);return t.writeBigUInt64BE(e),this.push(t)}readUInt8(){const e=this.read(1);return i.isBuffer(e)?e.readUInt8():null}readUInt16LE(){const e=this.read(2);return i.isBuffer(e)?e.readUInt16LE():null}readUInt16BE(){const e=this.read(2);return i.isBuffer(e)?e.readUInt16BE():null}readUInt32LE(){const e=this.read(4);return i.isBuffer(e)?e.readUInt32LE():null}readUInt32BE(){const e=this.read(4);return i.isBuffer(e)?e.readUInt32BE():null}readInt8(){const e=this.read(1);return i.isBuffer(e)?e.readInt8():null}readInt16LE(){const e=this.read(2);return i.isBuffer(e)?e.readInt16LE():null}readInt16BE(){const e=this.read(2);return i.isBuffer(e)?e.readInt16BE():null}readInt32LE(){const e=this.read(4);return i.isBuffer(e)?e.readInt32LE():null}readInt32BE(){const e=this.read(4);return i.isBuffer(e)?e.readInt32BE():null}readFloatLE(){const e=this.read(4);return i.isBuffer(e)?e.readFloatLE():null}readFloatBE(){const e=this.read(4);return i.isBuffer(e)?e.readFloatBE():null}readDoubleLE(){const e=this.read(8);return i.isBuffer(e)?e.readDoubleLE():null}readDoubleBE(){const e=this.read(8);return i.isBuffer(e)?e.readDoubleBE():null}readBigInt64LE(){const e=this.read(8);return i.isBuffer(e)?e.readBigInt64LE():null}readBigInt64BE(){const e=this.read(8);return i.isBuffer(e)?e.readBigInt64BE():null}readBigUInt64LE(){const e=this.read(8);return i.isBuffer(e)?e.readBigUInt64LE():null}readBigUInt64BE(){const e=this.read(8);return i.isBuffer(e)?e.readBigUInt64BE():null}}e.exports=o},6900:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7261),s=r(4686),o=n(r(4406)),a=r(2655),f=r(7466),c=n(r(8887)),h=r(6136),u=e=>(0,i.hash)("sha512",e);class l extends c.default{constructor(){super(),this.authType="DilithiumEdDSAVerificationKey2025"}static async createFromEntropy(e){const t=new l;t.entropy=e,t.capability="private",t.seed=u(e);const r=u(t.seed.slice(0,32));t.pqSigner=(0,f.generateDilithiumKeyPair)(r.slice(0,32)),t.edSigner={publicKey:s.Buffer.from(h.ed25519.getPublicKey(r.slice(32,64))),secretKey:r.slice(32,64)},t.signer={publicKey:s.Buffer.concat([t.edSigner.publicKey,t.pqSigner.publicKey]),secretKey:s.Buffer.concat([t.edSigner.secretKey,t.pqSigner.secretKey])};const n=o.default.box.keyPair.fromSecretKey(t.seed.slice(32,64));return t.cypher={publicKey:s.Buffer.from(n.publicKey),secretKey:s.Buffer.from(n.secretKey)},t}static generate(){return l.createFromEntropy((0,i.randomBytes)(32))}getSecret(){return s.Buffer.from((0,a.encode)({v:this.version,alg:"hybrid",s:this.seed}))}get id(){return s.Buffer.from((0,a.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,a.decode)(e);if("hybrid"!==t.alg)throw new Error("Not a secret for Hybrid Cryptography");const r=new l;r.version=t.v??0,r.capability="private",r.seed=s.Buffer.from(t.s);const n=u(r.seed.slice(0,32));r.pqSigner=(0,f.generateDilithiumKeyPair)(n.slice(0,32)),r.edSigner={publicKey:s.Buffer.from(h.ed25519.getPublicKey(n.slice(32,64))),secretKey:n.slice(32,64)},r.signer={publicKey:s.Buffer.concat([r.edSigner.publicKey,r.pqSigner.publicKey]),secretKey:s.Buffer.concat([r.edSigner.secretKey,r.pqSigner.secretKey])};const i=o.default.box.keyPair.fromSecretKey(r.seed.slice(32,64));return r.cypher={publicKey:s.Buffer.from(i.publicKey),secretKey:s.Buffer.from(i.secretKey)},r}static instantiate(e){const t=new l;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?s.Buffer.from(e.signer.publicKey.data):s.Buffer.from(e.signer.publicKey)},t.edSigner={publicKey:t.signer.publicKey.slice(0,32)},t.pqSigner={publicKey:t.signer.publicKey.slice(32)},t.cypher={publicKey:e.cypher.publicKey.data?s.Buffer.from(e.cypher.publicKey.data):s.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,a.decode)(e),r=new l;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.edSigner={publicKey:t.x.slice(0,32)},r.pqSigner={publicKey:t.x.slice(32)},r.cypher={publicKey:t.e},r}getSigner(){return Promise.resolve({sign:e=>{const t=h.ed25519.sign(e,this.edSigner.secretKey),r=(0,f.signDilithium)(s.Buffer.concat([e,t]),this.pqSigner.secretKey);return Promise.resolve(s.Buffer.concat([t,r]))}})}verify(e,t,r){const n=t.slice(0,64),i=t.slice(64);return!!h.ed25519.verify(n,e,this.edSigner.publicKey)&&(0,f.verifyDilithium)(s.Buffer.concat([e,n]),i,this.pqSigner.publicKey)}}t.default=l},7010:(e,t,r)=>{"use strict";var n=r(1036),i=n.assert,s=n.parseBytes,o=n.cachedProperty;function a(e,t){this.eddsa=e,this._secret=s(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=s(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},o(a,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),o(a,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),o(a,"privBytes",function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[r]&=127,n[r]|=64,n}),o(a,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),o(a,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),o(a,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),a.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return i(this._secret,"KeyPair is public only"),n.encode(this.secret(),e)},a.prototype.getPublic=function(e){return n.encode(this.pubBytes(),e)},e.exports=a},7165:function(e,t,r){"use strict";var n,i=this&&this.__classPrivateFieldSet||function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},s=this&&this.__classPrivateFieldGet||function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeWebAuthn=t.BrowserWebAuthn=void 0,t.getWebAuthnProvider=function(e){return"undefined"!=typeof window?new f:new c(e?.origin)},t.createCredentialRequest=function(e,t=!1){return a.default.createRequest(e,t)};const a=o(r(7961));class f{constructor(e="test"){this.origin=e}isAvailable(){return"undefined"!=typeof window&&void 0!==window.PublicKeyCredential}async create(e){if(!this.isAvailable())throw new Error("WebAuthn is not available in this environment");return await navigator.credentials.create({publicKey:e})}async get(e){if(!this.isAvailable())throw new Error("WebAuthn is not available in this environment");return await navigator.credentials.get({publicKey:e})}}t.BrowserWebAuthn=f;class c{constructor(e="test"){n.set(this,void 0),i(this,n,e,"f")}isAvailable(){return!0}async create(e){return await a.default.create({publicKey:e},s(this,n,"f"))}async get(e){return await a.default.get({publicKey:e},s(this,n,"f"))}}t.NodeWebAuthn=c,n=new WeakMap},7178:()=>{},7185:(e,t,r)=>{"use strict";var n=r(7902),i=r(1036).assert;function s(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=s,s.fromPublic=function(e,t,r){return t instanceof s?t:new s(e,{pub:t,pubEnc:r})},s.fromPrivate=function(e,t,r){return t instanceof s?t:new s(e,{priv:t,privEnc:r})},s.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},s.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},s.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},s.prototype._importPrivate=function(e,t){this.priv=new n(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},s.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?i(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},s.prototype.derive=function(e){return e.validate()||i(e.validate(),"public point not validated"),e.mul(this.priv).getX()},s.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},s.prototype.verify=function(e,t,r){return this.ec.verify(e,t,this,void 0,r)},s.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},7235:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DHIES=t.privateDerivePath=t.publicDerivePath=void 0;const f=r(9750),c=r(5598),h=r(4686),u=a(r(4406)),l=r(2655),d=o(r(67)),p=r(7178),y=a(r(3616)),b=d.default??d,g=e=>(0,c.hash)("sha256",e);t.publicDerivePath=(e,t)=>{let r=e;return t.startsWith("m/")&&(t=t.slice(2)),t.split("/").forEach(e=>{r="'"==e[e.length-1]?r.derive(2147483648+parseInt(e.substring(0,e.length-1))):r.derive(parseInt(e))}),r},t.privateDerivePath=(e,t)=>{let r=e;return t.startsWith("m/")&&(t=t.slice(2)),t.split("/").forEach(e=>{r="'"==e[e.length-1]?r.derive(2147483648+parseInt(e.substring(0,e.length-1))):r.derive(parseInt(e))}),r};class m{constructor(e){this.keyManager=e}async encrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot encrypt with DHIES using a public KeyManager"),null;const r=await this.keyManager.getCypher(),n="string"==typeof e?h.Buffer.from(e,"utf8"):e;try{const e=(0,c.randomBytes)(32),i=await r.diffieHellman(t),s=h.Buffer.from(u.default.scalarMult(e,i)),o=this.kdf(s,this.keyManager.cypher.publicKey,t),a=o.encryptionKey,f=o.macKey,l=(0,c.randomBytes)(24),d=h.Buffer.from(u.default.secretbox(n,l,a)),p=h.Buffer.concat([this.keyManager.cypher.publicKey,l,d]),y=this.computeMAC(f,p),b=h.Buffer.concat([l,e,d,y]);return(0,c.secureErase)(s),(0,c.secureErase)(i),(0,c.secureErase)(a),(0,c.secureErase)(f),b}catch(e){return console.error("DHIES encryption failed:",e),null}}async decrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot decrypt with DHIES using a public KeyManager"),null;try{const r=e.slice(0,24),n=e.slice(24,56),i=e.slice(e.length-32),s=e.slice(56,e.length-32),o=await this.keyManager.getCypher(),a=await o.diffieHellman(t),f=h.Buffer.from(u.default.scalarMult(n,a)),l=this.kdf(f,t,this.keyManager.cypher.publicKey),d=l.encryptionKey,p=l.macKey,y=h.Buffer.concat([t,r,s]),b=this.computeMAC(p,y);if(!this.constantTimeEqual(i,b))return console.error("DHIES: MAC verification failed"),null;const g=u.default.secretbox.open(s,r,d);if(!g)return console.error("DHIES: Decryption failed"),null;const m=h.Buffer.from(g);return(0,c.secureErase)(f),(0,c.secureErase)(d),(0,c.secureErase)(p),m}catch(e){return console.error("DHIES decryption failed:",e),null}}kdf(e,t,r){const n=h.Buffer.concat([h.Buffer.from("DHIES-KDF"),t,r]),i=(0,c.hash)("sha512",h.Buffer.concat([e,n,h.Buffer.from([1])])),s=(0,c.hash)("sha512",h.Buffer.concat([e,n,h.Buffer.from([2])]));return{encryptionKey:i.slice(0,32),macKey:s.slice(0,32)}}computeMAC(e,t){return(0,c.hash)("sha256",h.Buffer.concat([e,t]))}constantTimeEqual(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}}t.DHIES=m;class w{constructor(){this.level=1,this.version=1,this.capability="private",this.authType="Ed25519VerificationKey2020",this.encType="X25519KeyAgreementKey2019"}static async create_Id25519_fromEntropy(e,r=0){const n=new w;n.entropy=e,n.level=1,n.capability="private";const i=(s=e,(0,c.hash)("sha512",s));var s;const o=(0,t.privateDerivePath)(await b.Bip32PrivateKey.fromEntropy(i.slice(0,32)),`m/1'/0'/${r}'`);n.proofKey={publicKey:o.toBip32PublicKey().toPublicKey().toBytes(),secretKey:o.toBytes()},n.swapIndex=r,n.proof=(0,c.hash)("sha256",n.proofKey.publicKey);const a=(0,t.privateDerivePath)(o,"/0'");n.signer={publicKey:a.toBip32PublicKey().toPublicKey().toBytes(),secretKey:a.toBytes()};const f=h.Buffer.alloc(8);f.writeBigInt64LE(BigInt(r),0);const l=g(h.Buffer.concat([i.slice(32,64),f])),d=u.default.box.keyPair.fromSecretKey(l);return n.cypher={publicKey:h.Buffer.from(d.publicKey),secretKey:h.Buffer.from(d.secretKey)},n}static generate_Id25519(){return w.create_Id25519_fromEntropy((0,c.randomBytes)(32))}get id(){return 0==this.version?(e=>{const t=h.Buffer.from([132,161,118,0]),r=h.Buffer.from([161,112,197,0,e.proof?.length,...e.proof||[]]),n=h.Buffer.from([161,120,197,0,e.signer.publicKey.length,...e.signer.publicKey]),i=h.Buffer.from([161,101,197,0,e.cypher.publicKey.length,...e.cypher.publicKey]);return h.Buffer.concat([t,r,n,i])})(this):h.Buffer.from((0,l.encode)({v:this.version,p:this.proof,x:this.signer.publicKey,e:this.cypher.publicKey}))}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?h.Buffer.from((0,p.createHmac)("sha256",h.Buffer.from(e.secretKey).toString("hex")).update("VaultysID/"+t+"/end").digest()):void 0,signcrypt:async(t,r)=>(0,f.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,f.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>h.Buffer.from(u.default.scalarMult(e.secretKey,t))}}async getSigner(){const e=this.signer.secretKey;return new b.Bip32PrivateKey(e).toPrivateKey()}getSecret(){return h.Buffer.from((0,l.encode)({v:this.version,p:this.proof,x:this.signer.secretKey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,l.decode)(e),r=new w;r.version=t.v??0,r.level=2,r.capability="private",r.proof=t.p,r.signer={secretKey:t.x,publicKey:new b.Bip32PrivateKey(t.x).toBip32PublicKey().toPublicKey().toBytes()};const n=u.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:h.Buffer.from(n.publicKey),secretKey:h.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new w;return t.version=e.version??0,t.level=e.level,t.proof=e.proof.data?h.Buffer.from(e.proof.data):h.Buffer.from(e.proof),t.signer={publicKey:e.signer.publicKey.data?h.Buffer.from(e.signer.publicKey.data):h.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?h.Buffer.from(e.cypher.publicKey.data):h.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,l.decode)(e),r=new w;return r.version=t.v??0,r.level=2,r.capability="public",r.proof=t.p,r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}async sign(e){return"public"==this.capability?null:(await this.getSigner()).sign(e)}verify(e,t,r){try{return b.Bip32PublicKey.fromBytes(this.signer.publicKey).toPublicKey().verify(t,e)}catch(e){return!1}}async createSwapingCertificate(){if(1===this.level&&this.entropy){const e={newId:(await w.create_Id25519_fromEntropy(this.entropy,this.swapIndex+1)).id,proofKey:this.proofKey.publicKey,timestamp:Date.now(),signature:h.Buffer.from([])},t=h.Buffer.alloc(8);t.writeBigUInt64LE(BigInt(e.timestamp),0);const r=h.Buffer.concat([e.newId,e.proofKey,t]);return e.signature=new b.Bip32PrivateKey(this.proofKey.secretKey).toPrivateKey().sign(r),e}return null}async verifySwapingCertificate(e){if((0,c.hash)("sha256",e.proofKey).toString("hex")===this.proof?.toString("hex")){const t=h.Buffer.alloc(8);t.writeBigUInt64LE(BigInt(e.timestamp),0),w.fromId(e.newId);const r=h.Buffer.concat([e.newId,e.proofKey,t]);return b.Bip32PublicKey.fromBytes(e.proofKey).toPublicKey().verify(r,e.signature)}return!1}cleanSecureData(){this.cypher?.secretKey&&((0,c.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.signer?.secretKey&&((0,c.secureErase)(this.signer.secretKey),delete this.signer.secretKey),this.entropy&&((0,c.secureErase)(this.entropy),delete this.entropy)}async performDiffieHellman(e){if("public"===this.capability)return console.error("Cannot perform DH key exchange with a public key capability"),null;const t=await this.getCypher(),r=e.cypher.publicKey,n=await t.diffieHellman(r),i=g(n);return(0,c.secureErase)(n),i}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){const r=y.default.fromId(t);return new m(this).encrypt(e,r.cypher.publicKey)}async dhiesDecrypt(e,t){const r=y.default.fromId(t);return new m(this).decrypt(e,r.cypher.publicKey)}static async encrypt(e,t){const r=t.map(y.default.fromId).map(e=>e.cypher.publicKey);return await(0,f.encryptAndArmor)(e,null,r)}async signcrypt(e,t){const r=t.map(y.default.fromId).map(e=>e.cypher.publicKey),n=await this.getCypher();return await n.signcrypt(e,r)}async decrypt(e,t=null){const r=await this.getCypher(),n=t?y.default.fromId(t).cypher.publicKey:null;return(await r.decrypt(e,n)).toString()}getSecretHash(e){const t=h.Buffer.concat([e,h.Buffer.from("secrethash"),this.cypher.secretKey]);return(0,c.hash)("sha256",t)}}t.default=w},7261:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.secureErase=t.fromUTF8=t.fromHex=t.fromBase64=t.toUTF8=t.toHex=t.toBase64=t.secretbox=t.randomBytes=t.hmac=t.hash=t.Buffer=void 0;const a=o(r(4406)),f=r(4686);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return f.Buffer}});const c=r(4072),h=r(3835),u=e=>{const t=e.replaceAll("-","").toLowerCase();return"sha256"===t?c.sha256:"sha512"===t?c.sha512:"sha224"===t?c.sha224:c.sha256};t.randomBytes=e=>f.Buffer.from((0,a.randomBytes)(e)),t.hash=(e,t)=>f.Buffer.from(u(e).create().update(t).digest()),t.hmac=(e,t,r)=>f.Buffer.from((0,h.hmac)(u(e),t,r));const l=a.default.secretbox;t.secretbox=l,t.toBase64=e=>f.Buffer.from(e).toString("base64"),t.toHex=e=>f.Buffer.from(e).toString("hex"),t.toUTF8=e=>f.Buffer.from(e).toString("utf-8"),t.fromBase64=e=>f.Buffer.from(e,"base64"),t.fromHex=e=>f.Buffer.from(e,"hex"),t.fromUTF8=e=>f.Buffer.from(e,"utf-8"),t.secureErase=e=>{for(let t=0;t<e.length;t++)e[t]=0}},7264:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DHIES=void 0,t.getCypherPublicKeyFromId=u;const i=r(9750),s=r(5598),o=r(4686),a=n(r(4406)),f=n(r(3616)),c=r(2655);class h{constructor(e){this.keyManager=e}async encrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot encrypt with DHIES using a public KeyManager"),null;const r=await this.keyManager.getCypher(),n="string"==typeof e?o.Buffer.from(e,"utf8"):e;try{const e=(0,s.randomBytes)(32),i=await r.diffieHellman(t),f=o.Buffer.from(a.default.scalarMult(e,i)),c=this.kdf(f,this.keyManager.cypher.publicKey,t),h=c.encryptionKey,u=c.macKey,l=(0,s.randomBytes)(24),d=o.Buffer.from(a.default.secretbox(n,l,h)),p=o.Buffer.concat([this.keyManager.cypher.publicKey,l,d]),y=this.computeMAC(u,p),b=o.Buffer.concat([l,e,d,y]);return(0,s.secureErase)(f),(0,s.secureErase)(i),(0,s.secureErase)(h),(0,s.secureErase)(u),b}catch(e){return console.error("DHIES encryption failed:",e),null}}async decrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot decrypt with DHIES using a public KeyManager"),null;try{const r=e.slice(0,24),n=e.slice(24,56),i=e.slice(e.length-32),f=e.slice(56,e.length-32),c=await this.keyManager.getCypher(),h=await c.diffieHellman(t),u=o.Buffer.from(a.default.scalarMult(n,h)),l=this.kdf(u,t,this.keyManager.cypher.publicKey),d=l.encryptionKey,p=l.macKey,y=o.Buffer.concat([t,r,f]),b=this.computeMAC(p,y);if(!this.constantTimeEqual(i,b))return console.error("DHIES: MAC verification failed"),null;const g=a.default.secretbox.open(f,r,d);if(!g)return console.error("DHIES: Decryption failed"),null;const m=o.Buffer.from(g);return(0,s.secureErase)(u),(0,s.secureErase)(d),(0,s.secureErase)(p),m}catch(e){return console.error("DHIES decryption failed:",e),null}}kdf(e,t,r){const n=o.Buffer.concat([o.Buffer.from("DHIES-KDF"),t,r]),i=(0,s.hash)("sha512",o.Buffer.concat([e,n,o.Buffer.from([1])])),a=(0,s.hash)("sha512",o.Buffer.concat([e,n,o.Buffer.from([2])]));return{encryptionKey:i.slice(0,32),macKey:a.slice(0,32)}}computeMAC(e,t){return(0,s.hash)("sha256",o.Buffer.concat([e,t]))}constantTimeEqual(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}}function u(e){return(0,c.decode)(e).e}t.DHIES=h;class l extends f.default{constructor(){super(),this.version=1,this.capability="private",this.authType="",this.encType="X25519KeyAgreementKey2019"}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?(0,s.hmac)("sha256",o.Buffer.from(e.secretKey),"VaultysID/"+t+"/end"):void 0,signcrypt:async(t,r)=>(0,i.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,i.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>o.Buffer.from(a.default.scalarMult(e.secretKey,t))}}cleanSecureData(){this.cypher?.secretKey&&((0,s.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.entropy&&((0,s.secureErase)(this.entropy),delete this.entropy)}async performDiffieHellman(e){if("public"===this.capability)return console.error("Cannot perform DH key exchange with a public key capability"),null;const t=await this.getCypher(),r=e.cypher.publicKey,n=await t.diffieHellman(r),i=(o=n,(0,s.hash)("sha256",o));var o;return(0,s.secureErase)(n),i}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){return new h(this).encrypt(e,u(t))}async dhiesDecrypt(e,t){return new h(this).decrypt(e,u(t))}static async encrypt(e,t){const r=t.map(u);return await(0,i.encryptAndArmor)(e,null,r)}async signcrypt(e,t){const r=t.map(u),n=await this.getCypher();return await n.signcrypt(e,r)}async decrypt(e,t=null){const r=await this.getCypher(),n=t?u(t):null;return(await r.decrypt(e,n)).toString()}getSecretHash(e){const t=o.Buffer.concat([e,o.Buffer.from("secrethash"),this.cypher.secretKey]);return(0,s.hash)("sha256",t)}}t.default=l},7265:(e,t,r)=>{"use strict";var n=r(5402),i=r(4797),s=r(1036),o=s.assert,a=s.parseBytes,f=r(7010),c=r(6807);function h(e){if(o("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof h))return new h(e);e=i[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=n.sha512}e.exports=h,h.prototype.sign=function(e,t){e=a(e);var r=this.keyFromSecret(t),n=this.hashInt(r.messagePrefix(),e),i=this.g.mul(n),s=this.encodePoint(i),o=this.hashInt(s,r.pubBytes(),e).mul(r.priv()),f=n.add(o).umod(this.curve.n);return this.makeSignature({R:i,S:f,Rencoded:s})},h.prototype.verify=function(e,t,r){if(e=a(e),(t=this.makeSignature(t)).S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var n=this.keyFromPublic(r),i=this.hashInt(t.Rencoded(),n.pubBytes(),e),s=this.g.mul(t.S());return t.R().add(n.pub().mul(i)).eq(s)},h.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return s.intFromLE(e.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(e){return f.fromPublic(this,e)},h.prototype.keyFromSecret=function(e){return f.fromSecret(this,e)},h.prototype.makeSignature=function(e){return e instanceof c?e:new c(this,e)},h.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},h.prototype.decodePoint=function(e){var t=(e=s.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),n=!!(128&e[t]),i=s.intFromLE(r);return this.curve.pointFromY(i,n)},h.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(e){return s.intFromLE(e)},h.prototype.isPoint=function(e){return e instanceof this.pointClass}},7267:(e,t,r)=>{"use strict";var n=r(900),i=r(7984),s=r(1339),o=n.rotl32,a=n.sum32,f=n.sum32_5,c=s.ft_1,h=i.BlockHash,u=[1518500249,1859775393,2400959708,3395469782];function l(){if(!(this instanceof l))return new l;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}n.inherits(l,h),e.exports=l,l.blockSize=512,l.outSize=160,l.hmacStrength=80,l.padLength=64,l.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=o(r[n-3]^r[n-8]^r[n-14]^r[n-16],1);var i=this.h[0],s=this.h[1],h=this.h[2],l=this.h[3],d=this.h[4];for(n=0;n<r.length;n++){var p=~~(n/20),y=f(o(i,5),c(p,s,h,l),d,r[n],u[p]);d=l,l=h,h=o(s,30),s=i,i=y}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],h),this.h[3]=a(this.h[3],l),this.h[4]=a(this.h[4],d)},l.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},7268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeToCurve=t.hashToCurve=t.secp384r1=t.p384=void 0;const n=r(2355);t.p384=n.p384,t.secp384r1=n.p384,t.hashToCurve=n.p384_hasher.hashToCurve,t.encodeToCurve=n.p384_hasher.encodeToCurve},7342:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNegativeLE=void 0,t.mod=u,t.pow=function(e,t,r){return m(E(r),e,t)},t.pow2=function(e,t,r){let n=e;for(;t-- >i;)n*=n,n%=r;return n},t.invert=l,t.tonelliShanks=y,t.FpSqrt=b,t.validateField=function(e){const t=g.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"});return(0,n._validateObject)(e,t),e},t.FpPow=m,t.FpInvertBatch=w,t.FpDiv=function(e,t,r){return e.mul(t,"bigint"==typeof r?l(r,e.ORDER):e.inv(r))},t.FpLegendre=v,t.FpIsSquare=function(e,t){return 1===v(e,t)},t.nLength=_,t.Field=E,t.FpSqrtOdd=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)},t.FpSqrtEven=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r},t.hashToPrivateScalar=function(e,t,r=!1){const i=(e=(0,n.ensureBytes)("privateHash",e)).length,o=_(t).nByteLength+8;if(o<24||i<o||i>1024)throw new Error("hashToPrivateScalar: expected "+o+"-1024 bytes of input, got "+i);return u(r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e),t-s)+s},t.getFieldBytesLength=S,t.getMinHashLength=B,t.mapHashToField=function(e,t,r=!1){const i=e.length,o=S(t),a=B(t);if(i<16||i<a||i>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+i);const f=u(r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e),t-s)+s;return r?(0,n.numberToBytesLE)(f,o):(0,n.numberToBytesBE)(f,o)};const n=r(6376),i=BigInt(0),s=BigInt(1),o=BigInt(2),a=BigInt(3),f=BigInt(4),c=BigInt(5),h=BigInt(8);function u(e,t){const r=e%t;return r>=i?r:t+r}function l(e,t){if(e===i)throw new Error("invert: expected non-zero number");if(t<=i)throw new Error("invert: expected positive modulus, got "+t);let r=u(e,t),n=t,o=i,a=s,f=s,c=i;for(;r!==i;){const e=n/r,t=n%r,i=o-f*e,s=a-c*e;n=r,r=t,o=f,a=c,f=i,c=s}if(n!==s)throw new Error("invert: does not exist");return u(o,t)}function d(e,t){const r=(e.ORDER+s)/f,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function p(e,t){const r=(e.ORDER-c)/h,n=e.mul(t,o),i=e.pow(n,r),s=e.mul(t,i),a=e.mul(e.mul(s,o),i),f=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(f),t))throw new Error("Cannot find square root");return f}function y(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-s,r=0;for(;t%o===i;)t/=o,r++;let n=o;const a=E(e);for(;1===v(a,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return d;let f=a.pow(n,t);const c=(t+s)/o;return function(e,n){if(e.is0(n))return n;if(1!==v(e,n))throw new Error("Cannot find square root");let i=r,o=e.mul(e.ONE,f),a=e.pow(n,t),h=e.pow(n,c);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,r=e.sqr(a);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=s<<BigInt(i-t-1),f=e.pow(o,n);i=t,o=e.sqr(f),a=e.mul(a,o),h=e.mul(h,f)}return h}}function b(e){return e%f===a?d:e%h===c?p:y(e)}t.isNegativeLE=(e,t)=>(u(e,t)&s)===s;const g=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function m(e,t,r){if(r<i)throw new Error("invalid exponent, negatives unsupported");if(r===i)return e.ONE;if(r===s)return t;let n=e.ONE,o=t;for(;r>i;)r&s&&(n=e.mul(n,o)),o=e.sqr(o),r>>=s;return n}function w(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),s=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),s),n}function v(e,t){const r=(e.ORDER-s)/o,n=e.pow(t,r),i=e.eql(n,e.ONE),a=e.eql(n,e.ZERO),f=e.eql(n,e.neg(e.ONE));if(!i&&!a&&!f)throw new Error("invalid Legendre symbol result");return i?1:a?0:-1}function _(e,t){void 0!==t&&(0,n.anumber)(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function E(e,t,r=!1,o={}){if(e<=i)throw new Error("invalid field: expected ORDER > 0, got "+e);let a,f;if("object"==typeof t&&null!=t){if(o.sqrt||r)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(a=e.BITS),e.sqrt&&(f=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE)}else"number"==typeof t&&(a=t),o.sqrt&&(f=o.sqrt);const{nBitLength:c,nByteLength:h}=_(e,a);if(h>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let d;const p=Object.freeze({ORDER:e,isLE:r,BITS:c,BYTES:h,MASK:(0,n.bitMask)(c),ZERO:i,ONE:s,create:t=>u(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return i<=t&&t<e},is0:e=>e===i,isValidNot0:e=>!p.is0(e)&&p.isValid(e),isOdd:e=>(e&s)===s,neg:t=>u(-t,e),eql:(e,t)=>e===t,sqr:t=>u(t*t,e),add:(t,r)=>u(t+r,e),sub:(t,r)=>u(t-r,e),mul:(t,r)=>u(t*r,e),pow:(e,t)=>m(p,e,t),div:(t,r)=>u(t*l(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>l(t,e),sqrt:f||(t=>(d||(d=b(e)),d(p,t))),toBytes:e=>r?(0,n.numberToBytesLE)(e,h):(0,n.numberToBytesBE)(e,h),fromBytes:e=>{if(e.length!==h)throw new Error("Field.fromBytes: expected "+h+" bytes, got "+e.length);return r?(0,n.bytesToNumberLE)(e):(0,n.bytesToNumberBE)(e)},invertBatch:e=>w(p,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(p)}function S(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function B(e){const t=S(e);return t+Math.ceil(t/2)}},7431:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7261),s=r(5593),o=n(r(8886)),a=r(2248),f=r(4686),c=r(7466),h=n(r(8887)),u=n(r(9010)),l=f.Buffer.from("VAULTYS_SIGN","utf8");class d{constructor(e,t,r=0){this.encrypt=d.encrypt,this.type=r,this.keyManager=e,this.certificate=t}static fromId(e,t,r="hex"){let n=e;e.data&&(n=f.Buffer.from(e.data)),e instanceof Uint8Array&&(n=f.Buffer.from(e)),"string"==typeof e&&(n=f.Buffer.from(e,r));const i=n[0];if(3===i){const e=s.Fido2Manager.fromId(n.slice(1));return new d(e,t,i)}if(4===i){const e=s.Fido2PRFManager.fromId(n.slice(1));return new d(e,t,i)}if(1998===n.length){const e=s.DilithiumManager.fromId(n.slice(1));return new d(e,t,i)}if(2030===n.length){const e=s.HybridManager.fromId(n.slice(1));return new d(e,t,i)}if(77===n.length){const e=s.Ed25519Manager.fromId(n.slice(1));return new d(e,t,i)}{const e=u.default.fromId(n.slice(1));return new d(e,t,i)}}static async fromEntropy(e,t,r="ed25519"){const n=e;if("dilithium"===r){const e=await s.DilithiumManager.createFromEntropy(n);return new d(e,void 0,t)}if("dilithium_ed25519"===r){const e=await s.HybridManager.createFromEntropy(n);return new d(e,void 0,t)}{const e=await s.Ed25519Manager.createFromEntropy(n);return new d(e,void 0,t)}}static async createWebauthn(e=!0,t){const r=d.createPublicKeyCredentialCreationOptions(e),n=(0,a.getWebAuthnProvider)(),i=await n.create(r);return i?d.fido2FromAttestation(i,t):null}static async createPQC(){const e=d.createPublicKeyCredentialOptionsPQC(),t=(0,a.getWebAuthnProvider)(),r=await t.create(e);return r?d.fido2FromAttestation(r):null}static async fido2FromAttestation(e,t){if(o.default.verifyPackedAttestation(e.response,!0),!e.getClientExtensionResults().prf?.enabled||t&&!await t()){const t=await s.Fido2Manager.createFromAttestation(e);return new d(t,void 0,3)}{const t=await s.Fido2PRFManager.createFromAttestation(e);return new d(t,void 0,4)}}static async machineFromEntropy(e){return d.fromEntropy(e,0)}static async organizationFromEntropy(e){return d.fromEntropy(e,2)}static async personFromEntropy(e){return d.fromEntropy(e,1)}static fromSecret(e,t="hex"){const r=f.Buffer.from(e,t),n=r[0];if(3==n){const e=s.Fido2Manager.fromSecret(r.slice(1));return new d(e,void 0,n)}if(4==n){const e=s.Fido2PRFManager.fromSecret(r.slice(1));return new d(e,void 0,n)}if(73===r.length){const e=s.DilithiumManager.fromSecret(r.slice(1));return new d(e,void 0,n)}if(84===r.length){const e=s.HybridManager.fromSecret(r.slice(1));return new d(e,void 0,n)}{const e=s.Ed25519Manager.fromSecret(r.slice(1));return new d(e,void 0,n)}}static async generatePerson(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new d(e,void 0,1)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new d(e,void 0,1)}{const e=await s.Ed25519Manager.generate();return new d(e,void 0,1)}}static async generateOrganization(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new d(e,void 0,2)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new d(e,void 0,2)}{const e=await s.Ed25519Manager.generate();return new d(e,void 0,2)}}static async generateMachine(e="ed25519"){if("dilithium"===e){const e=await s.DilithiumManager.generate();return new d(e,void 0,0)}if("dilithium_ed25519"===e){const e=await s.HybridManager.generate();return new d(e,void 0,0)}{const e=await s.Ed25519Manager.generate();return new d(e,void 0,0)}}get relationshipCertificate(){return this.certificate}getSecret(e="hex"){return f.Buffer.concat([f.Buffer.from([this.type]),this.keyManager.getSecret()]).toString(e)}get fingerprint(){return f.Buffer.concat([f.Buffer.from([this.type]),(0,i.hash)("SHA224",this.keyManager.id)]).toString("hex").slice(0,40).toUpperCase().match(/.{1,4}/g).join(" ")}get did(){return`did:vaultys:${f.Buffer.concat([f.Buffer.from([this.type]),(0,i.hash)("SHA224",this.keyManager.id)]).toString("hex").slice(0,40)}`}get didDocument(){return{"@context":["https://www.w3.org/ns/did/v1","https://w3id.org/security/suites/ed25519-2020/v1"],id:this.did,authentication:[{id:`${this.did}#keys-1`,type:this.keyManager.authType,controller:this.did,publicKeyMultibase:"m"+f.Buffer.from(this.keyManager.signer.publicKey).toString("base64")}],keyAgreement:[{id:`${this.did}#keys-2`,type:this.keyManager.encType,controller:this.did,publicKeyMultibase:"m"+f.Buffer.from(this.keyManager.cypher.publicKey).toString("base64")}]}}get id(){return f.Buffer.concat([f.Buffer.from([this.type]),this.keyManager.id])}toVersion(e){return this.keyManager.version=e,this}get version(){return this.keyManager.version}isHardware(){return 3===this.type||4===this.type}isMachine(){return 0===this.type}isPerson(){return 1===this.type}getOTPHmac(e=36e5){const t=Math.floor((new Date).getTime()/e);return this.keyManager.getSecretHash(f.Buffer.from(`OTP-${t}`)).toString("hex")}getOTP(e="password",t=864e5){if(this.certificate){const r=Math.floor((new Date).getTime()/t),n=f.Buffer.concat([f.Buffer.from(e,"utf-8"),f.Buffer.from(this.certificate),f.Buffer.from([r])]);return(0,i.hash)("SHA256",n).toString("hex")}throw new Error("no certificate, cannot derive OTP")}async performDiffieHellman(e){return this.keyManager.performDiffieHellman(e.keyManager)}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){let r;return r="string"==typeof t?f.Buffer.from(t.slice(2),"hex"):t.slice(1),this.keyManager.dhiesEncrypt(e,r)}async dhiesDecrypt(e,t){let r;return r="string"==typeof t?f.Buffer.from(t.slice(2),"hex"):t.slice(1),this.keyManager.dhiesDecrypt(e,r)}async signChallenge_v0(e,t){"string"==typeof e&&(e=f.Buffer.from(e,"hex"));const r=(0,i.hash)("sha256",f.Buffer.concat([t,e])),n=await this.keyManager.sign(r);if(n)return n;throw new Error("Could not sign challenge")}verifyChallenge_v0(e,t,r,n){"string"==typeof e&&(e=f.Buffer.from(e,"hex")),"string"==typeof t&&(t=f.Buffer.from(t,"hex"));const s=(0,i.hash)("sha256",f.Buffer.concat([n,e]));return this.keyManager.verify(s,t,r)}async signChallenge(e){"string"==typeof e&&(e=f.Buffer.from(e,"hex"));const t=(0,i.hash)("sha256",f.Buffer.concat([l,e])),r=await this.keyManager.sign(t);if(r)return r;throw new Error("Could not sign challenge")}verifyChallenge(e,t,r){"string"==typeof e&&(e=f.Buffer.from(e,"hex")),"string"==typeof t&&(t=f.Buffer.from(t,"hex"));const n=(0,i.hash)("sha256",f.Buffer.concat([l,e]));return this.keyManager.verify(n,t,r)}async signcrypt(e,t){return this.keyManager.signcrypt(e,t.map(e=>"string"==typeof e?f.Buffer.from(e.slice(2),"hex"):e.slice(1)))}static async encrypt(e,t){return h.default.encrypt(e,t.map(e=>"string"==typeof e?f.Buffer.from(e.slice(2),"hex"):e.slice(1)))}async decrypt(e,t){let r;return t&&(r="string"==typeof t?f.Buffer.from(t.slice(2)):t.subarray(1)),this.keyManager.decrypt(e,r)}async hmac(e){return(await this.keyManager.getCypher()).hmac(e)}}d.createPublicKeyCredentialOptionsPQC=()=>{const e=/^((?!chrome|android).)*applewebkit/i.test(navigator.userAgent);return{challenge:(0,i.randomBytes)(32),rp:{name:"Vaultys ID"},user:{id:(0,i.randomBytes)(16),name:"Vaultys ID",displayName:"Vaultys Wallet ID"},attestation:e?"none":"direct",authenticatorSelection:{authenticatorAttachment:"cross-platform",residentKey:"discouraged",userVerification:"preferred"},hints:["security-key"],extensions:{prf:{eval:{first:f.Buffer.from("VaultysID salt","utf-8")}}},pubKeyCredParams:[{type:"public-key",alg:c.PQ_COSE_ALG.DILITHIUM2}]}},d.createPublicKeyCredentialCreationOptions=e=>{const t=/^((?!chrome|android).)*applewebkit/i.test(navigator.userAgent),r=e?"client-device":"security-key";return{challenge:(0,i.randomBytes)(32),rp:{name:"Vaultys ID"},user:{id:(0,i.randomBytes)(16),name:"Vaultys ID",displayName:"Vaultys Wallet ID"},attestation:t?"none":"direct",authenticatorSelection:{authenticatorAttachment:e?"platform":"cross-platform",residentKey:e?"required":"discouraged",userVerification:"preferred"},hints:[r],extensions:{prf:{eval:{first:f.Buffer.from("VaultysID salt","utf-8")}}},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-8},{type:"public-key",alg:-257}]}},t.default=d},7466:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PQ_COSE_KEY_PARAMS=t.PQ_COSE_KEY_TYPE=t.PQ_COSE_ALG=void 0,t.generateDilithiumKeyPair=function(e){e||(e=(0,s.randomBytes)(32));const t=n.ml_dsa65.keygen(e);return{publicKey:i.Buffer.from(t.publicKey),secretKey:i.Buffer.from(t.secretKey)}},t.signDilithium=function(e,t){return i.Buffer.from(n.ml_dsa65.sign(t,e))},t.verifyDilithium=function(e,t,r){return n.ml_dsa65.verify(r,e,t)},t.createDilithiumCoseKey=function(e){const r=new Map;return r.set(1,t.PQ_COSE_KEY_TYPE.DILITHIUM),r.set(3,t.PQ_COSE_ALG.DILITHIUM2),r.set(t.PQ_COSE_KEY_PARAMS.DILITHIUM_MODE,2),r.set(t.PQ_COSE_KEY_PARAMS.DILITHIUM_PK,e),r},t.getDilithiumKeyInfo=function(){return{publicKeySize:1952,secretKeySize:4032,signatureSize:3309}};const n=r(2404),i=r(4686),s=r(7261);t.PQ_COSE_ALG={DILITHIUM2:-46,DILITHIUM3:-47,DILITHIUM5:-48},t.PQ_COSE_KEY_TYPE={DILITHIUM:4},t.PQ_COSE_KEY_PARAMS={DILITHIUM_MODE:-100,DILITHIUM_PK:-101,DILITHIUM_SK:-102}},7519:(e,t,r)=>{var n=r(6192),i=r(9113),s=r(6671).Buffer,o=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function f(){this.init(),this._w=a,i.call(this,64,56)}function c(e){return e<<5|e>>>27}function h(e){return e<<30|e>>>2}function u(e,t,r,n){return 0===e?t&r|~t&n:2===e?t&r|t&n|r&n:t^r^n}n(f,i),f.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},f.prototype._update=function(e){for(var t=this._w,r=0|this._a,n=0|this._b,i=0|this._c,s=0|this._d,a=0|this._e,f=0;f<16;++f)t[f]=e.readInt32BE(4*f);for(;f<80;++f)t[f]=t[f-3]^t[f-8]^t[f-14]^t[f-16];for(var l=0;l<80;++l){var d=~~(l/20),p=c(r)+u(d,n,i,s)+a+t[l]+o[d]|0;a=s,s=i,i=h(n),n=r,r=p}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=a+this._e|0},f.prototype._hash=function(){var e=s.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=f},7603:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=r(4686),o=n(r(4406)),a=r(2655),f=r(6761),c=n(r(7264)),h=r(6136),u=e=>(0,i.hash)("sha512",e);class l extends c.default{constructor(){super(),this.authType="DilithiumEdDSAVerificationKey2025"}static async createFromEntropy(e){const t=new l;t.entropy=e,t.capability="private",t.seed=u(e);const r=u(t.seed.slice(0,32));t.pqSigner=(0,f.generateDilithiumKeyPair)(r.slice(0,32)),t.edSigner={publicKey:s.Buffer.from(h.ed25519.getPublicKey(r.slice(32,64))),secretKey:r.slice(32,64)},t.signer={publicKey:s.Buffer.concat([t.edSigner.publicKey,t.pqSigner.publicKey]),secretKey:s.Buffer.concat([t.edSigner.secretKey,t.pqSigner.secretKey])};const n=o.default.box.keyPair.fromSecretKey(t.seed.slice(32,64));return t.cypher={publicKey:s.Buffer.from(n.publicKey),secretKey:s.Buffer.from(n.secretKey)},t}static generate(){return l.createFromEntropy((0,i.randomBytes)(32))}getSecret(){return s.Buffer.from((0,a.encode)({v:this.version,alg:"hybrid",s:this.seed}))}get id(){return s.Buffer.from((0,a.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,a.decode)(e);if("hybrid"!==t.alg)throw new Error("Not a secret for Hybrid Cryptography");const r=new l;r.version=t.v??0,r.capability="private",r.seed=s.Buffer.from(t.s);const n=u(r.seed.slice(0,32));r.pqSigner=(0,f.generateDilithiumKeyPair)(n.slice(0,32)),r.edSigner={publicKey:s.Buffer.from(h.ed25519.getPublicKey(n.slice(32,64))),secretKey:n.slice(32,64)},r.signer={publicKey:s.Buffer.concat([r.edSigner.publicKey,r.pqSigner.publicKey]),secretKey:s.Buffer.concat([r.edSigner.secretKey,r.pqSigner.secretKey])};const i=o.default.box.keyPair.fromSecretKey(r.seed.slice(32,64));return r.cypher={publicKey:s.Buffer.from(i.publicKey),secretKey:s.Buffer.from(i.secretKey)},r}static instantiate(e){const t=new l;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?s.Buffer.from(e.signer.publicKey.data):s.Buffer.from(e.signer.publicKey)},t.edSigner={publicKey:t.signer.publicKey.slice(0,32)},t.pqSigner={publicKey:t.signer.publicKey.slice(32)},t.cypher={publicKey:e.cypher.publicKey.data?s.Buffer.from(e.cypher.publicKey.data):s.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,a.decode)(e),r=new l;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.edSigner={publicKey:t.x.slice(0,32)},r.pqSigner={publicKey:t.x.slice(32)},r.cypher={publicKey:t.e},r}getSigner(){return Promise.resolve({sign:e=>{const t=h.ed25519.sign(e,this.edSigner.secretKey),r=(0,f.signDilithium)(s.Buffer.concat([e,t]),this.pqSigner.secretKey);return Promise.resolve(s.Buffer.concat([t,r]))}})}verify(e,t,r){const n=t.slice(0,64),i=t.slice(64);return!!h.ed25519.verify(n,e,this.edSigner.publicKey)&&(0,f.verifyDilithium)(s.Buffer.concat([e,n]),i,this.pqSigner.publicKey)}}t.default=l},7695:(e,t,r)=>{"use strict";var n=r(1036),i=r(7902),s=r(6192),o=r(6160),a=n.assert;function f(e){o.call(this,"short",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function c(e,t,r,n){o.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(t,16),this.y=new i(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(e,t,r,n){o.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(t,16),this.y=new i(r,16),this.z=new i(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}s(f,o),e.exports=f,f.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,r;if(e.beta)t=new i(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=(t=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(e.lambda)r=new i(e.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))?r=s[0]:(r=s[1],a(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:r,basis:e.basis?e.basis.map(function(e){return{a:new i(e.a,16),b:new i(e.b,16)}}):this._getEndoBasis(r)}}},f.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:i.mont(e),r=new i(2).toRed(t).redInvm(),n=r.redNeg(),s=new i(3).toRed(t).redNeg().redSqrt().redMul(r);return[n.redAdd(s).fromRed(),n.redSub(s).fromRed()]},f.prototype._getEndoBasis=function(e){for(var t,r,n,s,o,a,f,c,h,u=this.n.ushrn(Math.floor(this.n.bitLength()/2)),l=e,d=this.n.clone(),p=new i(1),y=new i(0),b=new i(0),g=new i(1),m=0;0!==l.cmpn(0);){var w=d.div(l);c=d.sub(w.mul(l)),h=b.sub(w.mul(p));var v=g.sub(w.mul(y));if(!n&&c.cmp(u)<0)t=f.neg(),r=p,n=c.neg(),s=h;else if(n&&2===++m)break;f=c,d=l,l=c,b=p,p=h,g=y,y=v}o=c.neg(),a=h;var _=n.sqr().add(s.sqr());return o.sqr().add(a.sqr()).cmp(_)>=0&&(o=t,a=r),n.negative&&(n=n.neg(),s=s.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:n,b:s},{a:o,b:a}]},f.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],n=t[1],i=n.b.mul(e).divRound(this.n),s=r.b.neg().mul(e).divRound(this.n),o=i.mul(r.a),a=s.mul(n.a),f=i.mul(r.b),c=s.mul(n.b);return{k1:e.sub(o).sub(a),k2:f.add(c).neg()}},f.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=r.redSqrt();if(0!==n.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)},f.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,n=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return 0===r.redSqr().redISub(i).cmpn(0)},f.prototype._endoWnafMulAdd=function(e,t,r){for(var n=this._endoWnafT1,i=this._endoWnafT2,s=0;s<e.length;s++){var o=this._endoSplit(t[s]),a=e[s],f=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),f=f.neg(!0)),n[2*s]=a,n[2*s+1]=f,i[2*s]=o.k1,i[2*s+1]=o.k2}for(var c=this._wnafMulAdd(1,n,i,2*s,r),h=0;h<2*s;h++)n[h]=null,i[h]=null;return c},s(c,o.BasePoint),f.prototype.point=function(e,t,r){return new c(this,e,t,r)},f.prototype.pointFromJSON=function(e,t){return c.fromJSON(this,e,t)},c.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,n=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var n=e.point(t[0],t[1],r);if(!t[2])return n;function i(t){return e.point(t[0],t[1],r)}var s=t[2];return n.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[n].concat(s.doubles.points.map(i))},naf:s.naf&&{wnd:s.naf.wnd,points:[n].concat(s.naf.points.map(i))}},n},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,n)},c.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),n=e.redInvm(),i=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(n),s=i.redSqr().redISub(this.x.redAdd(this.x)),o=i.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,o)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(e){return e=new i(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i):this.curve._wnafMulAdd(1,n,i,2)},c.prototype.jmulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i,!0):this.curve._wnafMulAdd(1,n,i,2,!0)},c.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},c.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,n=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(n)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(n)}}}return t},c.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},s(h,o.BasePoint),f.prototype.jpoint=function(e,t,r){return new h(this,e,t,r)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(r,n)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),n=this.x.redMul(t),i=e.x.redMul(r),s=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(r.redMul(this.z)),a=n.redSub(i),f=s.redSub(o);if(0===a.cmpn(0))return 0!==f.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),h=c.redMul(a),u=n.redMul(c),l=f.redSqr().redIAdd(h).redISub(u).redISub(u),d=f.redMul(u.redISub(l)).redISub(s.redMul(h)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(l,d,p)},h.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,n=e.x.redMul(t),i=this.y,s=e.y.redMul(t).redMul(this.z),o=r.redSub(n),a=i.redSub(s);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var f=o.redSqr(),c=f.redMul(o),h=r.redMul(f),u=a.redSqr().redIAdd(c).redISub(h).redISub(h),l=a.redMul(h.redISub(u)).redISub(i.redMul(c)),d=this.z.redMul(o);return this.curve.jpoint(u,l,d)},h.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var r=this;for(t=0;t<e;t++)r=r.dbl();return r}var n=this.curve.a,i=this.curve.tinv,s=this.x,o=this.y,a=this.z,f=a.redSqr().redSqr(),c=o.redAdd(o);for(t=0;t<e;t++){var h=s.redSqr(),u=c.redSqr(),l=u.redSqr(),d=h.redAdd(h).redIAdd(h).redIAdd(n.redMul(f)),p=s.redMul(u),y=d.redSqr().redISub(p.redAdd(p)),b=p.redISub(y),g=d.redMul(b);g=g.redIAdd(g).redISub(l);var m=c.redMul(a);t+1<e&&(f=f.redMul(l)),s=y,a=m,c=g}return this.curve.jpoint(s,c.redMul(i),a)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(n).redISub(s);o=o.redIAdd(o);var a=n.redAdd(n).redIAdd(n),f=a.redSqr().redISub(o).redISub(o),c=s.redIAdd(s);c=(c=c.redIAdd(c)).redIAdd(c),e=f,t=a.redMul(o.redISub(f)).redISub(c),r=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),u=this.y.redSqr(),l=u.redSqr(),d=this.x.redAdd(u).redSqr().redISub(h).redISub(l);d=d.redIAdd(d);var p=h.redAdd(h).redIAdd(h),y=p.redSqr(),b=l.redIAdd(l);b=(b=b.redIAdd(b)).redIAdd(b),e=y.redISub(d).redISub(d),t=p.redMul(d.redISub(e)).redISub(b),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},h.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(n).redISub(s);o=o.redIAdd(o);var a=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),f=a.redSqr().redISub(o).redISub(o);e=f;var c=s.redIAdd(s);c=(c=c.redIAdd(c)).redIAdd(c),t=a.redMul(o.redISub(f)).redISub(c),r=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),u=this.y.redSqr(),l=this.x.redMul(u),d=this.x.redSub(h).redMul(this.x.redAdd(h));d=d.redAdd(d).redIAdd(d);var p=l.redIAdd(l),y=(p=p.redIAdd(p)).redAdd(p);e=d.redSqr().redISub(y),r=this.y.redAdd(this.z).redSqr().redISub(u).redISub(h);var b=u.redSqr();b=(b=(b=b.redIAdd(b)).redIAdd(b)).redIAdd(b),t=d.redMul(p.redISub(e)).redISub(b)}return this.curve.jpoint(e,t,r)},h.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,n=this.z,i=n.redSqr().redSqr(),s=t.redSqr(),o=r.redSqr(),a=s.redAdd(s).redIAdd(s).redIAdd(e.redMul(i)),f=t.redAdd(t),c=(f=f.redIAdd(f)).redMul(o),h=a.redSqr().redISub(c.redAdd(c)),u=c.redISub(h),l=o.redSqr();l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var d=a.redMul(u).redISub(l),p=r.redAdd(r).redMul(n);return this.curve.jpoint(h,d,p)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),n=t.redSqr(),i=e.redAdd(e).redIAdd(e),s=i.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(n),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(s)).redSqr(),f=n.redIAdd(n);f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var c=i.redIAdd(o).redSqr().redISub(s).redISub(a).redISub(f),h=t.redMul(c);h=(h=h.redIAdd(h)).redIAdd(h);var u=this.x.redMul(a).redISub(h);u=(u=u.redIAdd(u)).redIAdd(u);var l=this.y.redMul(c.redMul(f.redISub(c)).redISub(o.redMul(a)));l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var d=this.z.redAdd(o).redSqr().redISub(r).redISub(a);return this.curve.jpoint(u,l,d)},h.prototype.mul=function(e,t){return e=new i(e,t),this.curve._wnafMul(this,e)},h.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var n=t.redMul(this.z),i=r.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(n)).cmpn(0)},h.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var n=e.clone(),i=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),0===this.x.cmp(r))return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},7718:(e,t,r)=>{var n=r(6192),i=r(1863),s=r(9113),o=r(6671).Buffer,a=new Array(160);function f(){this.init(),this._w=a,s.call(this,128,112)}n(f,i),f.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},f.prototype._hash=function(){var e=o.allocUnsafe(48);function t(t,r,n){e.writeInt32BE(t,n),e.writeInt32BE(r,n+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=f},7734:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHA512_IV=t.SHA384_IV=t.SHA224_IV=t.SHA256_IV=t.HashMD=void 0,t.setBigUint64=i,t.Chi=function(e,t,r){return e&t^~e&r},t.Maj=function(e,t,r){return e&t^e&r^t&r};const n=r(11);function i(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),f=n?4:0,c=n?0:4;e.setUint32(t+f,o,n),e.setUint32(t+c,a,n)}class s extends n.Hash{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,n.createView)(this.buffer)}update(e){(0,n.aexists)(this),e=(0,n.toBytes)(e),(0,n.abytes)(e);const{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const t=(0,n.createView)(e);for(;i<=s-o;o+=i)this.process(t,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,n.aexists)(this),(0,n.aoutput)(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:s,isLE:o}=this;let{pos:a}=this;t[a++]=128,(0,n.clean)(this.buffer.subarray(a)),this.padOffset>s-a&&(this.process(r,0),a=0);for(let e=a;e<s;e++)t[e]=0;i(r,s-8,BigInt(8*this.length),o),this.process(r,0);const f=(0,n.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const h=c/4,u=this.get();if(h>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<h;e++)f.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=i,e.length=n,e.pos=o,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}t.HashMD=s,t.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),t.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),t.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),t.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])},7751:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1198),i=new(r(4872));t.default=class{constructor(e){this.pubKey=e}toBytes(){return this.pubKey}hash(){return n.hash28(this.pubKey)}verify(e,t){return i.keyFromPublic(this.pubKey.toString("hex")).verify(t.toString("hex"),e.toString("hex"))}}},7902:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var o;"object"==typeof e?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(4656).Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function f(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function c(e,t,r,n){for(var i=0,s=Math.min(e.length,r),o=t;o<s;o++){var a=e.charCodeAt(o)-48;i*=n,i+=a>=49?a-49+10:a>=17?a-17+10:a}return i}s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return e.cmp(t)<0?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,o,a=0;if("be"===r)for(i=e.length-1,s=0;i>=0;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(i=0,s=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this.strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,o=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=f(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=f(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;this.strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,o=s%n,a=Math.min(s,s-o)+r,f=0,h=r;h<a;h+=n)f=c(e,h,h+n,t),this.imuln(i),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(0!==o){var u=1;for(f=c(e,h,e.length,t),h=0;h<o;h++)u*=t;this.imuln(u),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},s.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],l=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],o=i*s,a=67108863&o,f=o/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var h=f>>>26,u=67108863&f,l=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=l;d++){var p=c-d|0;h+=(o=(i=0|e.words[p])*(s=0|t.words[d])+u)/67108864|0,u=67108863&o}r.words[c]=0|u,f=0|h}return 0!==f?r.words[c]=0|f:r.length--,r.strip()}s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,s=0,o=0;o<this.length;o++){var a=this.words[o],f=(16777215&(a<<i|s)).toString(16);s=a>>>24-i&16777215,(i+=2)>=26&&(i-=26,o--),r=0!==s||o!==this.length-1?h[6-f.length]+f+r:f+r}for(0!==s&&(r=s.toString(16)+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=u[e],d=l[e];r="";var p=this.clone();for(p.negative=0;!p.isZero();){var y=p.modn(d).toString(e);r=(p=p.idivn(d)).isZero()?y+r:h[c-y.length]+y+r}for(this.isZero()&&(r="0"+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(e,t){return n(void 0!==o),this.toArrayLike(o,e,t)},s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,r){var i=this.byteLength(),s=r||Math.max(1,i);n(i<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0"),this.strip();var o,a,f="le"===t,c=new e(s),h=this.clone();if(f){for(a=0;!h.isZero();a++)o=h.andln(255),h.iushrn(8),c[a]=o;for(;a<s;a++)c[a]=0}else{for(a=0;a<s-i;a++)c[a]=0;for(a=0;!h.isZero();a++)o=h.andln(255),h.iushrn(8),c[s-a-1]=o}return c},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 8191&t||(r+=13,t>>>=13),127&t||(r+=7,t>>>=7),15&t||(r+=4,t>>>=4),3&t||(r+=2,t>>>=2),1&t||r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},s.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},s.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},s.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this.strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this.strip()},s.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,o=0;o<n.length;o++)s=(t=(0|r.words[o])-(0|n.words[o])+s)>>26,this.words[o]=67108863&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=67108863&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,r){var n,i,s,o=e.words,a=t.words,f=r.words,c=0,h=0|o[0],u=8191&h,l=h>>>13,d=0|o[1],p=8191&d,y=d>>>13,b=0|o[2],g=8191&b,m=b>>>13,w=0|o[3],v=8191&w,_=w>>>13,E=0|o[4],S=8191&E,B=E>>>13,M=0|o[5],A=8191&M,I=M>>>13,x=0|o[6],k=8191&x,T=x>>>13,P=0|o[7],O=8191&P,R=P>>>13,K=0|o[8],C=8191&K,U=K>>>13,D=0|o[9],L=8191&D,N=D>>>13,H=0|a[0],F=8191&H,j=H>>>13,z=0|a[1],q=8191&z,V=z>>>13,G=0|a[2],W=8191&G,Y=G>>>13,$=0|a[3],Z=8191&$,X=$>>>13,J=0|a[4],Q=8191&J,ee=J>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],se=8191&ie,oe=ie>>>13,ae=0|a[7],fe=8191&ae,ce=ae>>>13,he=0|a[8],ue=8191&he,le=he>>>13,de=0|a[9],pe=8191&de,ye=de>>>13;r.negative=e.negative^t.negative,r.length=19;var be=(c+(n=Math.imul(u,F))|0)+((8191&(i=(i=Math.imul(u,j))+Math.imul(l,F)|0))<<13)|0;c=((s=Math.imul(l,j))+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(p,F),i=(i=Math.imul(p,j))+Math.imul(y,F)|0,s=Math.imul(y,j);var ge=(c+(n=n+Math.imul(u,q)|0)|0)+((8191&(i=(i=i+Math.imul(u,V)|0)+Math.imul(l,q)|0))<<13)|0;c=((s=s+Math.imul(l,V)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),i=(i=Math.imul(g,j))+Math.imul(m,F)|0,s=Math.imul(m,j),n=n+Math.imul(p,q)|0,i=(i=i+Math.imul(p,V)|0)+Math.imul(y,q)|0,s=s+Math.imul(y,V)|0;var me=(c+(n=n+Math.imul(u,W)|0)|0)+((8191&(i=(i=i+Math.imul(u,Y)|0)+Math.imul(l,W)|0))<<13)|0;c=((s=s+Math.imul(l,Y)|0)+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(v,F),i=(i=Math.imul(v,j))+Math.imul(_,F)|0,s=Math.imul(_,j),n=n+Math.imul(g,q)|0,i=(i=i+Math.imul(g,V)|0)+Math.imul(m,q)|0,s=s+Math.imul(m,V)|0,n=n+Math.imul(p,W)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(y,W)|0,s=s+Math.imul(y,Y)|0;var we=(c+(n=n+Math.imul(u,Z)|0)|0)+((8191&(i=(i=i+Math.imul(u,X)|0)+Math.imul(l,Z)|0))<<13)|0;c=((s=s+Math.imul(l,X)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(S,F),i=(i=Math.imul(S,j))+Math.imul(B,F)|0,s=Math.imul(B,j),n=n+Math.imul(v,q)|0,i=(i=i+Math.imul(v,V)|0)+Math.imul(_,q)|0,s=s+Math.imul(_,V)|0,n=n+Math.imul(g,W)|0,i=(i=i+Math.imul(g,Y)|0)+Math.imul(m,W)|0,s=s+Math.imul(m,Y)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,X)|0)+Math.imul(y,Z)|0,s=s+Math.imul(y,X)|0;var ve=(c+(n=n+Math.imul(u,Q)|0)|0)+((8191&(i=(i=i+Math.imul(u,ee)|0)+Math.imul(l,Q)|0))<<13)|0;c=((s=s+Math.imul(l,ee)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(A,F),i=(i=Math.imul(A,j))+Math.imul(I,F)|0,s=Math.imul(I,j),n=n+Math.imul(S,q)|0,i=(i=i+Math.imul(S,V)|0)+Math.imul(B,q)|0,s=s+Math.imul(B,V)|0,n=n+Math.imul(v,W)|0,i=(i=i+Math.imul(v,Y)|0)+Math.imul(_,W)|0,s=s+Math.imul(_,Y)|0,n=n+Math.imul(g,Z)|0,i=(i=i+Math.imul(g,X)|0)+Math.imul(m,Z)|0,s=s+Math.imul(m,X)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(y,Q)|0,s=s+Math.imul(y,ee)|0;var _e=(c+(n=n+Math.imul(u,re)|0)|0)+((8191&(i=(i=i+Math.imul(u,ne)|0)+Math.imul(l,re)|0))<<13)|0;c=((s=s+Math.imul(l,ne)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(k,F),i=(i=Math.imul(k,j))+Math.imul(T,F)|0,s=Math.imul(T,j),n=n+Math.imul(A,q)|0,i=(i=i+Math.imul(A,V)|0)+Math.imul(I,q)|0,s=s+Math.imul(I,V)|0,n=n+Math.imul(S,W)|0,i=(i=i+Math.imul(S,Y)|0)+Math.imul(B,W)|0,s=s+Math.imul(B,Y)|0,n=n+Math.imul(v,Z)|0,i=(i=i+Math.imul(v,X)|0)+Math.imul(_,Z)|0,s=s+Math.imul(_,X)|0,n=n+Math.imul(g,Q)|0,i=(i=i+Math.imul(g,ee)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(y,re)|0,s=s+Math.imul(y,ne)|0;var Ee=(c+(n=n+Math.imul(u,se)|0)|0)+((8191&(i=(i=i+Math.imul(u,oe)|0)+Math.imul(l,se)|0))<<13)|0;c=((s=s+Math.imul(l,oe)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(O,F),i=(i=Math.imul(O,j))+Math.imul(R,F)|0,s=Math.imul(R,j),n=n+Math.imul(k,q)|0,i=(i=i+Math.imul(k,V)|0)+Math.imul(T,q)|0,s=s+Math.imul(T,V)|0,n=n+Math.imul(A,W)|0,i=(i=i+Math.imul(A,Y)|0)+Math.imul(I,W)|0,s=s+Math.imul(I,Y)|0,n=n+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,X)|0)+Math.imul(B,Z)|0,s=s+Math.imul(B,X)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,ee)|0,n=n+Math.imul(g,re)|0,i=(i=i+Math.imul(g,ne)|0)+Math.imul(m,re)|0,s=s+Math.imul(m,ne)|0,n=n+Math.imul(p,se)|0,i=(i=i+Math.imul(p,oe)|0)+Math.imul(y,se)|0,s=s+Math.imul(y,oe)|0;var Se=(c+(n=n+Math.imul(u,fe)|0)|0)+((8191&(i=(i=i+Math.imul(u,ce)|0)+Math.imul(l,fe)|0))<<13)|0;c=((s=s+Math.imul(l,ce)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(C,F),i=(i=Math.imul(C,j))+Math.imul(U,F)|0,s=Math.imul(U,j),n=n+Math.imul(O,q)|0,i=(i=i+Math.imul(O,V)|0)+Math.imul(R,q)|0,s=s+Math.imul(R,V)|0,n=n+Math.imul(k,W)|0,i=(i=i+Math.imul(k,Y)|0)+Math.imul(T,W)|0,s=s+Math.imul(T,Y)|0,n=n+Math.imul(A,Z)|0,i=(i=i+Math.imul(A,X)|0)+Math.imul(I,Z)|0,s=s+Math.imul(I,X)|0,n=n+Math.imul(S,Q)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(B,Q)|0,s=s+Math.imul(B,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(_,re)|0,s=s+Math.imul(_,ne)|0,n=n+Math.imul(g,se)|0,i=(i=i+Math.imul(g,oe)|0)+Math.imul(m,se)|0,s=s+Math.imul(m,oe)|0,n=n+Math.imul(p,fe)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(y,fe)|0,s=s+Math.imul(y,ce)|0;var Be=(c+(n=n+Math.imul(u,ue)|0)|0)+((8191&(i=(i=i+Math.imul(u,le)|0)+Math.imul(l,ue)|0))<<13)|0;c=((s=s+Math.imul(l,le)|0)+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,n=Math.imul(L,F),i=(i=Math.imul(L,j))+Math.imul(N,F)|0,s=Math.imul(N,j),n=n+Math.imul(C,q)|0,i=(i=i+Math.imul(C,V)|0)+Math.imul(U,q)|0,s=s+Math.imul(U,V)|0,n=n+Math.imul(O,W)|0,i=(i=i+Math.imul(O,Y)|0)+Math.imul(R,W)|0,s=s+Math.imul(R,Y)|0,n=n+Math.imul(k,Z)|0,i=(i=i+Math.imul(k,X)|0)+Math.imul(T,Z)|0,s=s+Math.imul(T,X)|0,n=n+Math.imul(A,Q)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,ee)|0,n=n+Math.imul(S,re)|0,i=(i=i+Math.imul(S,ne)|0)+Math.imul(B,re)|0,s=s+Math.imul(B,ne)|0,n=n+Math.imul(v,se)|0,i=(i=i+Math.imul(v,oe)|0)+Math.imul(_,se)|0,s=s+Math.imul(_,oe)|0,n=n+Math.imul(g,fe)|0,i=(i=i+Math.imul(g,ce)|0)+Math.imul(m,fe)|0,s=s+Math.imul(m,ce)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,le)|0)+Math.imul(y,ue)|0,s=s+Math.imul(y,le)|0;var Me=(c+(n=n+Math.imul(u,pe)|0)|0)+((8191&(i=(i=i+Math.imul(u,ye)|0)+Math.imul(l,pe)|0))<<13)|0;c=((s=s+Math.imul(l,ye)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(L,q),i=(i=Math.imul(L,V))+Math.imul(N,q)|0,s=Math.imul(N,V),n=n+Math.imul(C,W)|0,i=(i=i+Math.imul(C,Y)|0)+Math.imul(U,W)|0,s=s+Math.imul(U,Y)|0,n=n+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,X)|0)+Math.imul(R,Z)|0,s=s+Math.imul(R,X)|0,n=n+Math.imul(k,Q)|0,i=(i=i+Math.imul(k,ee)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,ee)|0,n=n+Math.imul(A,re)|0,i=(i=i+Math.imul(A,ne)|0)+Math.imul(I,re)|0,s=s+Math.imul(I,ne)|0,n=n+Math.imul(S,se)|0,i=(i=i+Math.imul(S,oe)|0)+Math.imul(B,se)|0,s=s+Math.imul(B,oe)|0,n=n+Math.imul(v,fe)|0,i=(i=i+Math.imul(v,ce)|0)+Math.imul(_,fe)|0,s=s+Math.imul(_,ce)|0,n=n+Math.imul(g,ue)|0,i=(i=i+Math.imul(g,le)|0)+Math.imul(m,ue)|0,s=s+Math.imul(m,le)|0;var Ae=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ye)|0)+Math.imul(y,pe)|0))<<13)|0;c=((s=s+Math.imul(y,ye)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(L,W),i=(i=Math.imul(L,Y))+Math.imul(N,W)|0,s=Math.imul(N,Y),n=n+Math.imul(C,Z)|0,i=(i=i+Math.imul(C,X)|0)+Math.imul(U,Z)|0,s=s+Math.imul(U,X)|0,n=n+Math.imul(O,Q)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(R,Q)|0,s=s+Math.imul(R,ee)|0,n=n+Math.imul(k,re)|0,i=(i=i+Math.imul(k,ne)|0)+Math.imul(T,re)|0,s=s+Math.imul(T,ne)|0,n=n+Math.imul(A,se)|0,i=(i=i+Math.imul(A,oe)|0)+Math.imul(I,se)|0,s=s+Math.imul(I,oe)|0,n=n+Math.imul(S,fe)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(B,fe)|0,s=s+Math.imul(B,ce)|0,n=n+Math.imul(v,ue)|0,i=(i=i+Math.imul(v,le)|0)+Math.imul(_,ue)|0,s=s+Math.imul(_,le)|0;var Ie=(c+(n=n+Math.imul(g,pe)|0)|0)+((8191&(i=(i=i+Math.imul(g,ye)|0)+Math.imul(m,pe)|0))<<13)|0;c=((s=s+Math.imul(m,ye)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(L,Z),i=(i=Math.imul(L,X))+Math.imul(N,Z)|0,s=Math.imul(N,X),n=n+Math.imul(C,Q)|0,i=(i=i+Math.imul(C,ee)|0)+Math.imul(U,Q)|0,s=s+Math.imul(U,ee)|0,n=n+Math.imul(O,re)|0,i=(i=i+Math.imul(O,ne)|0)+Math.imul(R,re)|0,s=s+Math.imul(R,ne)|0,n=n+Math.imul(k,se)|0,i=(i=i+Math.imul(k,oe)|0)+Math.imul(T,se)|0,s=s+Math.imul(T,oe)|0,n=n+Math.imul(A,fe)|0,i=(i=i+Math.imul(A,ce)|0)+Math.imul(I,fe)|0,s=s+Math.imul(I,ce)|0,n=n+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,le)|0)+Math.imul(B,ue)|0,s=s+Math.imul(B,le)|0;var xe=(c+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ye)|0)+Math.imul(_,pe)|0))<<13)|0;c=((s=s+Math.imul(_,ye)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(L,Q),i=(i=Math.imul(L,ee))+Math.imul(N,Q)|0,s=Math.imul(N,ee),n=n+Math.imul(C,re)|0,i=(i=i+Math.imul(C,ne)|0)+Math.imul(U,re)|0,s=s+Math.imul(U,ne)|0,n=n+Math.imul(O,se)|0,i=(i=i+Math.imul(O,oe)|0)+Math.imul(R,se)|0,s=s+Math.imul(R,oe)|0,n=n+Math.imul(k,fe)|0,i=(i=i+Math.imul(k,ce)|0)+Math.imul(T,fe)|0,s=s+Math.imul(T,ce)|0,n=n+Math.imul(A,ue)|0,i=(i=i+Math.imul(A,le)|0)+Math.imul(I,ue)|0,s=s+Math.imul(I,le)|0;var ke=(c+(n=n+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,ye)|0)+Math.imul(B,pe)|0))<<13)|0;c=((s=s+Math.imul(B,ye)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(L,re),i=(i=Math.imul(L,ne))+Math.imul(N,re)|0,s=Math.imul(N,ne),n=n+Math.imul(C,se)|0,i=(i=i+Math.imul(C,oe)|0)+Math.imul(U,se)|0,s=s+Math.imul(U,oe)|0,n=n+Math.imul(O,fe)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(R,fe)|0,s=s+Math.imul(R,ce)|0,n=n+Math.imul(k,ue)|0,i=(i=i+Math.imul(k,le)|0)+Math.imul(T,ue)|0,s=s+Math.imul(T,le)|0;var Te=(c+(n=n+Math.imul(A,pe)|0)|0)+((8191&(i=(i=i+Math.imul(A,ye)|0)+Math.imul(I,pe)|0))<<13)|0;c=((s=s+Math.imul(I,ye)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(L,se),i=(i=Math.imul(L,oe))+Math.imul(N,se)|0,s=Math.imul(N,oe),n=n+Math.imul(C,fe)|0,i=(i=i+Math.imul(C,ce)|0)+Math.imul(U,fe)|0,s=s+Math.imul(U,ce)|0,n=n+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,le)|0)+Math.imul(R,ue)|0,s=s+Math.imul(R,le)|0;var Pe=(c+(n=n+Math.imul(k,pe)|0)|0)+((8191&(i=(i=i+Math.imul(k,ye)|0)+Math.imul(T,pe)|0))<<13)|0;c=((s=s+Math.imul(T,ye)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(L,fe),i=(i=Math.imul(L,ce))+Math.imul(N,fe)|0,s=Math.imul(N,ce),n=n+Math.imul(C,ue)|0,i=(i=i+Math.imul(C,le)|0)+Math.imul(U,ue)|0,s=s+Math.imul(U,le)|0;var Oe=(c+(n=n+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,ye)|0)+Math.imul(R,pe)|0))<<13)|0;c=((s=s+Math.imul(R,ye)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(L,ue),i=(i=Math.imul(L,le))+Math.imul(N,ue)|0,s=Math.imul(N,le);var Re=(c+(n=n+Math.imul(C,pe)|0)|0)+((8191&(i=(i=i+Math.imul(C,ye)|0)+Math.imul(U,pe)|0))<<13)|0;c=((s=s+Math.imul(U,ye)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863;var Ke=(c+(n=Math.imul(L,pe))|0)+((8191&(i=(i=Math.imul(L,ye))+Math.imul(N,pe)|0))<<13)|0;return c=((s=Math.imul(N,ye))+(i>>>13)|0)+(Ke>>>26)|0,Ke&=67108863,f[0]=be,f[1]=ge,f[2]=me,f[3]=we,f[4]=ve,f[5]=_e,f[6]=Ee,f[7]=Se,f[8]=Be,f[9]=Me,f[10]=Ae,f[11]=Ie,f[12]=xe,f[13]=ke,f[14]=Te,f[15]=Pe,f[16]=Oe,f[17]=Re,f[18]=Ke,0!==c&&(f[19]=c,r.length++),r};function y(e,t,r){return(new b).mulp(e,t,r)}function b(e,t){this.x=e,this.y=t}Math.imul||(p=d),s.prototype.mulTo=function(e,t){var r,n=this.length+e.length;return r=10===this.length&&10===e.length?p(this,e,t):n<63?d(this,e,t):n<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var o=i;i=0;for(var a=67108863&n,f=Math.min(s,t.length-1),c=Math.max(0,s-e.length+1);c<=f;c++){var h=s-c,u=(0|e.words[h])*(0|t.words[c]),l=67108863&u;a=67108863&(l=l+a|0),i+=(o=(o=o+(u/67108864|0)|0)+(l>>>26)|0)>>>26,o&=67108863}r.words[s]=a,n=o,o=i}return 0!==n?r.words[s]=n:r.length--,r.strip()}(this,e,t):y(this,e,t),r},b.prototype.makeRBT=function(e){for(var t=new Array(e),r=s.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},b.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},b.prototype.permute=function(e,t,r,n,i,s){for(var o=0;o<s;o++)n[o]=t[e[o]],i[o]=r[e[o]]},b.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var o=1;o<i;o<<=1)for(var a=o<<1,f=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var u=f,l=c,d=0;d<o;d++){var p=r[h+d],y=n[h+d],b=r[h+d+o],g=n[h+d+o],m=u*b-l*g;g=u*g+l*b,b=m,r[h+d]=p+b,n[h+d]=y+g,r[h+d+o]=p-b,n[h+d+o]=y-g,d!==a&&(m=f*u-c*l,l=f*l+c*u,u=m)}},b.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},b.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},b.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},b.prototype.convert13b=function(e,t,r,i){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<i;++o)r[o]=0;n(0===s),n(!(-8192&s))},b.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},b.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),f=new Array(n),c=new Array(n),h=new Array(n),u=new Array(n),l=r.words;l.length=n,this.convert13b(e.words,e.length,o,n),this.convert13b(t.words,t.length,c,n),this.transform(o,s,a,f,n,i),this.transform(c,s,h,u,n,i);for(var d=0;d<n;d++){var p=a[d]*h[d]-f[d]*u[d];f[d]=a[d]*u[d]+f[d]*h[d],a[d]=p}return this.conjugate(a,f,n),this.transform(a,f,l,s,n,i),this.conjugate(l,s,n),this.normalize13b(l,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),y(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){n("number"==typeof e),n(e<67108864);for(var t=0,r=0;r<this.length;r++){var i=(0|this.words[r])*e,s=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=s>>>26,this.words[r]=67108863&s}return 0!==t&&(this.words[r]=t,this.length++),this.length=0===e?1:this.length,this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=(e.words[n]&1<<i)>>>i}return t}(e);if(0===t.length)return new s(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},s.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,f=(0|this.words[t])-a<<r;this.words[t]=f|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},s.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,o=Math.min((e-s)/26,this.length),a=67108863^67108863>>>s<<s,f=r;if(i-=o,i=Math.max(0,i),f){for(var c=0;c<o;c++)f.words[c]=this.words[c];f.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=i);c--){var u=0|this.words[c];this.words[c]=h<<26-s|u>>>s,h=u&a}return f&&0!==h&&(f.words[f.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r||!(this.words[r]&i))},s.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var i,s,o=e.length+r;this._expand(o);var a=0;for(i=0;i<e.length;i++){s=(0|this.words[i+r])+a;var f=(0|e.words[i])*t;a=((s-=67108863&f)>>26)-(f/67108864|0),this.words[i+r]=67108863&s}for(;i<this.length-r;i++)a=(s=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&s;if(0===a)return this.strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(s=-(0|this.words[i])+a)>>26,this.words[i]=67108863&s;return this.negative=1,this.strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,o=0|i.words[i.length-1];0!=(r=26-this._countBits(o))&&(i=i.ushln(r),n.iushln(r),o=0|i.words[i.length-1]);var a,f=n.length-i.length;if("mod"!==t){(a=new s(null)).length=f+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var h=n.clone()._ishlnsubmul(i,1,f);0===h.negative&&(n=h,a&&(a.words[f]=1));for(var u=f-1;u>=0;u--){var l=67108864*(0|n.words[i.length+u])+(0|n.words[i.length+u-1]);for(l=Math.min(l/o|0,67108863),n._ishlnsubmul(i,l,u);0!==n.negative;)l--,n.negative=0,n._ishlnsubmul(i,1,u),n.isZero()||(n.negative^=1);a&&(a.words[u]=l)}return a&&a.strip(),n.strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},s.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modn(e.words[0]))}:this._wordDiv(e,t);var i,o,a},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,r=0,i=this.length-1;i>=0;i--)r=(t*r+(0|this.words[i]))%e;return r},s.prototype.idivn=function(e){n(e<=67108863);for(var t=0,r=this.length-1;r>=0;r--){var i=(0|this.words[r])+67108864*t;this.words[r]=i/e|0,t=i%e}return this.strip()},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new s(1),o=new s(0),a=new s(0),f=new s(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),u=t.clone();!t.isZero();){for(var l=0,d=1;0===(t.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(t.iushrn(l);l-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(h),o.isub(u)),i.iushrn(1),o.iushrn(1);for(var p=0,y=1;0===(r.words[0]&y)&&p<26;++p,y<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||f.isOdd())&&(a.iadd(h),f.isub(u)),a.iushrn(1),f.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),o.isub(f)):(r.isub(t),a.isub(i),f.isub(o))}return{a,b:f,gcd:r.iushln(c)}},s.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,o=new s(1),a=new s(0),f=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0===(t.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(t.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(f),o.iushrn(1);for(var u=0,l=1;0===(r.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(r.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(f),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return(i=0===t.cmpn(1)?o:a).cmpn(0)<0&&i.iadd(e),i},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return!(1&this.words[0])},s.prototype.isOdd=function(){return!(1&~this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var s=i,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return-1===this.cmpn(e)},s.prototype.lt=function(e){return-1===this.cmp(e)},s.prototype.lten=function(e){return this.cmpn(e)<=0},s.prototype.lte=function(e){return this.cmp(e)<=0},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new S(e)},s.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function m(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){m.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function v(){m.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){m.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function E(){m.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function B(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}m.prototype._tmp=function(){var e=new s(null);return e.words=new Array(Math.ceil(this.n/13)),e},m.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},m.prototype.split=function(e,t){e.iushrn(this.n,0,t)},m.prototype.imulK=function(e){return e.imul(this.k)},i(w,m),w.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=s&r,i=10;i<e.length;i++){var o=0|e.words[i];e.words[i-10]=(o&r)<<4|s>>>22,s=o}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},w.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(v,m),i(_,m),i(E,m),E.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new w;else if("p224"===e)t=new v;else if("p192"===e)t=new _;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new E}return g[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);n(!i.isZero());var a=new s(1).toRed(this),f=a.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);0!==this.pow(h,c).cmp(f);)h.redIAdd(f);for(var u=this.pow(h,i),l=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=o;0!==d.cmp(a);){for(var y=d,b=0;0!==y.cmp(a);b++)y=y.redSqr();n(b<p);var g=this.pow(u,new s(1).iushln(p-b-1));l=l.redMul(g),u=g.redSqr(),d=d.redMul(u),p=b}return l},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],o=0,a=0,f=t.bitLength()%26;for(0===f&&(f=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],h=f-1;h>=0;h--){var u=c>>h&1;i!==r[0]&&(i=this.sqr(i)),0!==u||0!==o?(o<<=1,o|=u,(4===++a||0===n&&0===h)&&(i=this.mul(i,r[o]),a=0,o=0)):a=0}f=26}return i},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new B(e)},i(B,S),B.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},B.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},B.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},B.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},B.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},7947:(e,t)=>{t.read=function(e,t,r,n,i){var s,o,a=8*i-n-1,f=(1<<a)-1,c=f>>1,h=-7,u=r?i-1:0,l=r?-1:1,d=e[t+u];for(u+=l,s=d&(1<<-h)-1,d>>=-h,h+=a;h>0;s=256*s+e[t+u],u+=l,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=n;h>0;o=256*o+e[t+u],u+=l,h-=8);if(0===s)s=1-c;else{if(s===f)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),s-=c}return(d?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var o,a,f,c=8*s-i-1,h=(1<<c)-1,u=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=h):(o=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-o))<1&&(o--,f*=2),(t+=o+u>=1?l/f:l*Math.pow(2,1-u))*f>=2&&(o++,f/=2),o+u>=h?(a=0,o=h):o+u>=1?(a=(t*f-1)*Math.pow(2,i),o+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,i),o=0));i>=8;e[r+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;e[r+d]=255&o,d+=p,o/=256,c-=8);e[r+d-p]|=128*y}},7961:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4686),s=r(5598),o=n(r(1167)),a=r(6136),f=r(1440),c=r(7268),h=r(5691),u=r(6761),l={},d=u.PQ_COSE_KEY_TYPE.DILITHIUM,p={1:f.p256,2:c.p384,3:h.p521},y={"-257":"SHA-256","-258":"SHA-384","-259":"SHA-512","-65535":"SHA-1","-39":"SHA-512","-38":"SHA-384","-37":"SHA-256","-260":"SHA-256","-261":"SHA-512","-7":"SHA-256","-36":"SHA-512",[u.PQ_COSE_ALG.DILITHIUM2.toString()]:"SHA-256"},b=(e,t)=>(0,s.hash)(e.replace("-",""),t),g=e=>{const t=e.slice(0,32),r=(e=e.slice(32)).slice(0,1);e=e.slice(1);const n=r[0],i={up:!!(1&n),uv:!!(4&n),at:!!(64&n),ed:!!(128&n),flagsInt:n},s=e.slice(0,4);e=e.slice(4);const o=s.readUInt32BE(0);let a,f,c;if(i.at){a=e.slice(0,16);const t=(e=e.slice(16)).slice(0,2);e=e.slice(2);const r=t.readUInt16BE(0);f=e.slice(0,r),c=e=e.slice(r)}return{rpIdHash:t,flagsBuf:r,flags:i,counter:o,counterBuf:s,aaguid:a,credID:f,COSEPublicKey:c}},m=(e,t,r)=>f.p256.verify(f.p256.Signature.fromDER(r).toCompactHex(),e,t),w=(e,t,r)=>a.ed25519.verify(r,e,t);class v{constructor(){this.signCount=0,this.rawId=(0,s.randomBytes)(32),this.aaguid=i.Buffer.alloc(16)}static createRequest(e,t=!1){const r={publicKey:{challenge:i.Buffer.from((0,s.randomBytes)(32).toString("base64")),rp:{name:"Vaultys ID",id:"Vaultys ID"},user:{id:i.Buffer.from("Vaultys Wallet ID","utf8"),name:"Vaultys Wallet ID",displayName:"Vaultys Wallet ID"},pubKeyCredParams:[{type:"public-key",alg:e}]}};return t&&(r.publicKey.extensions={prf:{eval:{first:(0,s.randomBytes)(32)}}}),r}static async create(e,t="test"){const r=new v,n=e.publicKey;r.options=n,r.rpId=n.rp.id||n.rp.name,r.userHandle=i.Buffer.from(n.user.id.toString(),"base64"),l[r.rawId.toString("base64")]=r;const c=n.pubKeyCredParams.some(e=>e.alg===u.PQ_COSE_ALG.DILITHIUM2);if(r.alg=c?u.PQ_COSE_ALG.DILITHIUM2:n.pubKeyCredParams[0].alg,-8===r.alg){const e=a.ed25519.utils.randomPrivateKey();r.keyPair={privateKey:e,publicKey:a.ed25519.getPublicKey(e),algorithm:"EdDSA"},r.coseKey=new Map,r.coseKey.set(1,1),r.coseKey.set(3,-8),r.coseKey.set(-1,6);const t=r.keyPair.publicKey.slice(0,32);r.coseKey.set(-2,t)}else if(-7===r.alg){const e=f.p256.utils.randomPrivateKey();r.keyPair={privateKey:e,publicKey:f.p256.getPublicKey(e,!1),algorithm:"ES256"},r.coseKey=new Map,r.coseKey.set(1,2),r.coseKey.set(3,-7),r.coseKey.set(-1,6);const t=r.keyPair.publicKey.slice(1,33),n=r.keyPair.publicKey.slice(33);r.coseKey.set(-2,t),r.coseKey.set(-3,n)}else if(r.alg===u.PQ_COSE_ALG.DILITHIUM2){const{publicKey:e,secretKey:t}=(0,u.generateDilithiumKeyPair)();r.keyPair={privateKey:t,publicKey:e,algorithm:"DILITHIUM2",isDILITHIUM:!0},r.coseKey=(0,u.createDilithiumCoseKey)(e)}const h={type:"webauthn.create",challenge:n.challenge,origin:t},d=(0,s.hash)("sha256",i.Buffer.from(r.rpId,"ascii")),p=i.Buffer.from("41","hex"),y=i.Buffer.allocUnsafe(4);y.writeUInt32BE(r.signCount,0);const b=i.Buffer.allocUnsafe(2);b.writeUInt16BE(r.rawId.length,0);const g=o.default.encode(r.coseKey),m={authData:i.Buffer.concat([d,p,y,r.aaguid,b,r.rawId,g]),fmt:"none",attStmt:{}};return{id:r.rawId.toString("base64"),rawId:r.rawId,authenticatorAttachment:null,type:"public-key",getClientExtensionResults:()=>n.extensions?.prf?.eval?.first?{prf:{enabled:!0}}:{},toJSON(){},response:{clientDataJSON:i.Buffer.from(JSON.stringify(h),"utf-8"),attestationObject:o.default.encode(m),getTransports:()=>["usb","hybrid"],getAuthenticatorData:()=>m.authData,getPublicKey:()=>g,getPublicKeyAlgorithm:()=>-7}}}static simpleVerify(e,t,r=!1){const n=o.default.decode(e,{extendedResults:!0}).value,a=(t.authenticatorData.slice(0,32),i.Buffer.from(t.authenticatorData)[32]);if(t.authenticatorData.slice(33,37),!(r?4&a:1&a))return!1;const f=(0,s.hash)("sha256",i.Buffer.from(t.clientDataJSON));let c=i.Buffer.concat([i.Buffer.from(t.authenticatorData),f]);if(-7==n.get(3)&&(c=(0,s.hash)("sha256",c)),1==n.get(1)){const e=n.get(-2);return w(c,e,i.Buffer.from(t.signature))}if(2==n.get(1)){const e=n.get(-2),r=n.get(-3),s=i.Buffer.concat([i.Buffer.from("04","hex"),e,r]);return m(c,s,i.Buffer.from(t.signature))}if(n.get(1)===d){const e=n.get(u.PQ_COSE_KEY_PARAMS.DILITHIUM_PK);return(0,u.verifyDilithium)(c,i.Buffer.from(t.signature),e)}return!1}static getCOSEPublicKey(e){const t=e.response,r=o.default.decode(t.attestationObject);return g(r.authData).COSEPublicKey}static verifyPackedAttestation(e,t=!1){return((e,t=!1)=>{const r=i.Buffer.from(e.attestationObject),n=o.default.decodeAllSync(r)[0];if("none"==n.fmt)return!1;const s=g(n.authData);if(!s.flags.up)return!1;if(t&&!s.flags.uv)return!1;const f=b("sha256",i.Buffer.from(e.clientDataJSON)),c=i.Buffer.concat([n.authData,f]),h=n.attStmt.sig;let u=!1;if(n.attStmt.ecdaaKeyId)throw new Error("ECDAA IS NOT SUPPORTED!");{const e=o.default.decodeAllSync(s.COSEPublicKey)[0],t=y[e.get(3)],r=b(t,c);if(2===e.get(1)){const t=e.get(-2),n=e.get(-3),s=i.Buffer.concat([i.Buffer.from([4]),t,n]),o=p[e.get(-1)],a=o.Signature.fromDER(h);u=o.verify(a,r,s)}else{if(1!==e.get(1))return!1;{const t=e.get(-2);u=a.ed25519.verify(h,r,t)}}}if(!u)throw new Error("Failed to verify the signature!");return!0})(e,t)}static async verify(e,t,r=!1){const n=(0,s.hash)("sha256",i.Buffer.from(t.response.clientDataJSON)),a=t.response,f=e.response;let c=i.Buffer.concat([i.Buffer.from(a.authenticatorData),n]);const h=o.default.decode(f.attestationObject),l=g(h.authData);if(!l.flags.up)return!1;if(r&&!l.flags.uv||!l.COSEPublicKey)return!1;const p=o.default.decode(l.COSEPublicKey);-7==p.get(3)&&(c=(0,s.hash)("sha256",c));const y=p.get(1);if(1===y){const e=p.get(-2);return w(c,e,i.Buffer.from(a.signature))}if(2===y){const e=p.get(-2),t=p.get(-3),r=i.Buffer.concat([i.Buffer.from("04","hex"),e,t]);return m(c,r,i.Buffer.from(a.signature))}if(y===d){const e=p.get(u.PQ_COSE_KEY_PARAMS.DILITHIUM_PK);return(0,u.verifyDilithium)(c,i.Buffer.from(a.signature),e)}return!1}static extractChallenge(e){const t=JSON.parse(e.toString()),r=t.challenge.length%4;return t.challenge.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.challenge.length+(0===r?0:4-r),"=")}static async get({publicKey:e},t="test"){if(!e.allowCredentials)throw new Error;const r=i.Buffer.from(e.allowCredentials[0].id).toString("base64"),n=l[r];n.signCount+=1;const o={type:"webauthn.get",challenge:i.Buffer.from(e.challenge).toString("base64"),origin:t},c=(0,s.hash)("sha256",(0,s.fromUTF8)(JSON.stringify(o))),h=(0,s.hash)("sha256",i.Buffer.from(n.rpId,"utf-8")),d=i.Buffer.from("05","hex"),p=i.Buffer.allocUnsafe(4);p.writeUInt32BE(n.signCount,0);const y=i.Buffer.concat([h,d,p]),g=i.Buffer.concat([y,c]);let m=new Uint8Array;return-7===n.alg?m=f.p256.sign(g,n.keyPair.privateKey,{prehash:!0}).toDERRawBytes():-8===n.alg?m=a.ed25519.sign(g,n.keyPair.privateKey):n.alg===u.PQ_COSE_ALG.DILITHIUM2&&(m=(0,u.signDilithium)(g,n.keyPair.privateKey)),{id:r,rawId:i.Buffer.from(r,"base64").buffer,type:"public-key",authenticatorAttachment:null,getClientExtensionResults:()=>e.extensions?.prf?.eval?.first?{prf:{results:{first:b("sha256",e.extensions?.prf?.eval?.first)}}}:{},toJSON(){},response:{authenticatorData:y,clientDataJSON:i.Buffer.from(JSON.stringify(o),"utf-8"),signature:m,userHandle:n.userHandle}}}}t.default=v},7963:(e,t,r)=>{"use strict";var n=r(8704).F.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var s=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new n(i?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},7981:function(e,t,r){"use strict";var n,i=r(4686).Buffer,s=r(8558),o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&o(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0});const c=r(2655),h=r(4406),u=f(r(931)),l=r(568),d=r(4072);class p extends u.default{constructor(e,t,r=!0){if(super(),!(0,l.isBufferOrUint8Array)(e)||32!==e.length)throw new TypeError("public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||32!==t.length)throw new TypeError("nonce must be a 32 byte Uint8Array");if("boolean"!=typeof r)throw new TypeError("attached must be a boolean");this.public_key=e,this.nonce=t,this.attached=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data[1]}get hash(){return this.encoded_data[0]}static create(e,t=!0){var r;return new this(e,null!==(r=this.debug_fix_nonce)&&void 0!==r?r:(0,h.randomBytes)(32),t)}encode(){return p.encodeHeader(this.public_key,this.nonce,this.attached)}static encodeHeader(e,t,r){const n=["saltpack",[2,0],r?u.MessageType.ATTACHED_SIGNING:u.MessageType.DETACHED_SIGNING,e,t],s=(0,c.encode)(n);return[d.sha512.create().update(s).digest(),i.from((0,c.encode)(s))]}static decode(e,t=!1){const[,r]=super.decode1(e,t);if(r[2]!==u.MessageType.ATTACHED_SIGNING&&r[2]!==u.MessageType.DETACHED_SIGNING)throw new Error("Invalid data");const[,,,n,i]=r;return new this(n,i,r[2]===u.MessageType.ATTACHED_SIGNING)}signDetached(e,t){if(this.attached)throw new Error("Header attached is true");const r=d.sha512.create().update(this.hash).update(e).digest(),n=i.concat([p.DETACHED_SIGNATURE_PREFIX,r]);return i.from(h.sign.detached(Uint8Array.from(n),Uint8Array.from(t)))}verifyDetached(e,t,r){if(this.attached)throw new Error("Header attached is true");const n=d.sha512.create().update(this.hash).update(t).digest(),s=i.concat([p.DETACHED_SIGNATURE_PREFIX,n]);if(!h.sign.detached.verify(Uint8Array.from(s),Uint8Array.from(e),Uint8Array.from(r)))throw new Error("Invalid signature")}}p.DETACHED_SIGNATURE_PREFIX=i.from("saltpack detached signature\0"),p.debug_fix_nonce=s.env.TEST?i.alloc(32).fill(0):null,t.default=p},7984:(e,t,r)=>{"use strict";var n=r(900),i=r(8637);function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=s,s.prototype.update=function(e,t){if(e=n.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-r,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,n=new Array(r+this.padLength);n[0]=128;for(var i=1;i<r;i++)n[i]=0;if(e<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=e>>>24&255,n[i++]=e>>>16&255,n[i++]=e>>>8&255,n[i++]=255&e}else for(n[i++]=255&e,n[i++]=e>>>8&255,n[i++]=e>>>16&255,n[i++]=e>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,s=8;s<this.padLength;s++)n[i++]=0;return n}},8039:e=>{var t=Math.pow(2,30)-1;e.exports=function(e,r){if("number"!=typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!=typeof r)throw new TypeError("Key length not a number");if(r<0||r>t||r!=r)throw new TypeError("Bad key length")}},8045:(e,t,r)=>{t.pbkdf2=r(293),t.pbkdf2Sync=r(4047)},8051:function(e,t,r){"use strict";var n,i=r(4686).Buffer,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&s(t,e,r[i]);return o(t,e),t}),f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const c=a(r(931)),h=f(r(3051)),u=r(4406),l=r(568),d=r(2655),p=r(4072),y=r(3835);class b extends c.default{constructor(e,t,r){if(super(),!(0,l.isBufferOrUint8Array)(e)||32!==e.length)throw new TypeError("public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||48!==t.length)throw new TypeError("sender_secretbox must be a 48 byte Uint8Array");this.public_key=e,this.sender_secretbox=t,this.recipients=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data[1]}get hash(){return this.encoded_data[0]}static create(e,t,r,n){if(null!==r&&(!(0,l.isBufferOrUint8Array)(r)||32!==r.length))throw new TypeError("sender_public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||32!==t.length)throw new TypeError("payload_key must be a 32 byte Uint8Array");return r||(r=i.alloc(32)),new this(e,(0,u.secretbox)(Uint8Array.from(r),Uint8Array.from(b.SENDER_KEY_SECRETBOX_NONCE),Uint8Array.from(t)),n)}encode(){return b.encodeHeader(this.public_key,this.sender_secretbox,this.recipients)}static encodeHeader(e,t,r){const n=["saltpack",[2,0],c.MessageType.SIGNCRYPTION,e,t,r.map(e=>[e.recipient_identifier,e.encrypted_payload_key])],s=(0,d.encode)(n);return[p.sha512.create().update(s).digest(),i.from((0,d.encode)(s))]}static decode(e,t=!1){const[r,n]=super.decode1(e,t);if(n[2]!==c.MessageType.SIGNCRYPTION)throw new Error("Invalid data");const[,,,i,s,o]=n;if(!(o instanceof Array))throw new Error("Invalid data");return new this(i,s,o.map((e,t)=>{if(!(e instanceof Array)||e.length<2)throw new TypeError("Invalid data");return h.default.from(e[0],e[1],t)}))}decryptPayloadKeyWithCurve25519Keypair(e){for(const t of this.recipients){const{recipient_identifier:r,shared_symmetric_key:n}=h.default.generateRecipientIdentifierForRecipient(this.public_key,e,t.recipient_index);if(!r.equals(t.recipient_identifier))continue;const i=t.decryptPayloadKey(n);if(!i)throw new Error("Invalid shared symmetric key");return[i,t]}return null}decryptPayloadKeyWithSymmetricKey(e,t){const r=(0,y.hmac)(p.sha512,h.default.HMAC_KEY_SYMMETRIC,i.concat([this.public_key,e])).slice(0,32),n=t?i.from(t):null;for(const e of this.recipients){if(n&&!n.equals(e.recipient_identifier))continue;const t=e.decryptPayloadKey(r);if(t)return[t,e]}return null}decryptSender(e){const t=u.secretbox.open(Uint8Array.from(this.sender_secretbox),Uint8Array.from(b.SENDER_KEY_SECRETBOX_NONCE),Uint8Array.from(e));if(!t)throw new Error("Failed to decrypt sender public key");return i.alloc(32).equals(t)?null:t}}b.SENDER_KEY_SECRETBOX_NONCE=i.from("saltpack_sender_key_sbox"),t.default=b},8115:e=>{function t(e){return(4294967296+e).toString(16).substring(1)}e.exports={normalizeInput:function(e){let t;if(e instanceof Uint8Array)t=e;else{if("string"!=typeof e)throw new Error("Input must be an string, Buffer or Uint8Array");t=(new TextEncoder).encode(e)}return t},toHex:function(e){return Array.prototype.map.call(e,function(e){return(e<16?"0":"")+e.toString(16)}).join("")},debugPrint:function(e,r,n){let i="\n"+e+" = ";for(let s=0;s<r.length;s+=2){if(32===n)i+=t(r[s]).toUpperCase(),i+=" ",i+=t(r[s+1]).toUpperCase();else{if(64!==n)throw new Error("Invalid size "+n);i+=t(r[s+1]).toUpperCase(),i+=t(r[s]).toUpperCase()}s%6==4?i+="\n"+new Array(e.length+4).join(" "):s<r.length-2&&(i+=" ")}console.log(i)},testSpeed:function(e,t,r){let n=(new Date).getTime();const i=new Uint8Array(t);for(let e=0;e<t;e++)i[e]=e%256;const s=(new Date).getTime();console.log("Generated random input in "+(s-n)+"ms"),n=s;for(let s=0;s<r;s++){const r=e(i),s=(new Date).getTime(),o=s-n;n=s,console.log("Hashed in "+o+"ms: "+r.substring(0,20)+"..."),console.log(Math.round(t/(1<<20)/(o/1e3)*100)/100+" MB PER SECOND")}}}},8123:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CryptoChannel=t.GameOfLifeIcon=t.KeyManager=t.IdManager=t.LocalStorage=t.convertWebWritableStreamToNodeWritable=t.convertWebReadableStreamToNodeReadable=t.StreamChannel=t.MemoryStorage=t.MemoryChannel=t.Challenger=t.VaultysId=t.Buffer=t.crypto=void 0;const f=a(r(8421));t.Challenger=f.default;const c=a(r(5766));t.IdManager=c.default;const h=a(r(5593));t.KeyManager=h.default;const u=a(r(7431));t.VaultysId=u.default;const l=r(3004);Object.defineProperty(t,"MemoryChannel",{enumerable:!0,get:function(){return l.MemoryChannel}}),Object.defineProperty(t,"StreamChannel",{enumerable:!0,get:function(){return l.StreamChannel}}),Object.defineProperty(t,"convertWebReadableStreamToNodeReadable",{enumerable:!0,get:function(){return l.convertWebReadableStreamToNodeReadable}}),Object.defineProperty(t,"convertWebWritableStreamToNodeWritable",{enumerable:!0,get:function(){return l.convertWebWritableStreamToNodeWritable}});const d=r(1366);Object.defineProperty(t,"MemoryStorage",{enumerable:!0,get:function(){return d.MemoryStorage}}),Object.defineProperty(t,"LocalStorage",{enumerable:!0,get:function(){return d.LocalStorage}});const p=a(r(664));t.GameOfLifeIcon=p.default;const y=a(r(9910));t.CryptoChannel=y.default;const b=o(r(7261));t.crypto=b;const g=b.Buffer;t.Buffer=g,void 0===Symbol.dispose&&(Symbol.dispose=Symbol("Symbol.dispose"))},8308:()=>{},8421:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(2655),s=r(7261),o=n(r(7431)),a=r(4686),f=-2,c=-1,h=(e,t)=>a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii"),a.Buffer.from([160+t.length]),a.Buffer.from(t,"ascii")]),u=(e,t)=>{const r=a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii")]);let n;return n=t.length<=65535?a.Buffer.from([197,t.length>>8&255,255&t.length]):a.Buffer.from([198,t.length>>24&255,t.length>>16&255,t.length>>8&255,255&t.length]),a.Buffer.concat([r,n,t])},l=(e,t)=>{const r=a.Buffer.concat([a.Buffer.from([160+e.length]),a.Buffer.from(e,"ascii")]);let n;if(t>=0&&t<=127)n=a.Buffer.from([t]);else if(t<0&&t>=-32)n=a.Buffer.from([t]);else if(t>0&&t<=255)n=a.Buffer.from([204,t]);else if(t>=-128&&t<=127)n=a.Buffer.from([208,t]);else if(t>0&&t<=65535)n=a.Buffer.from([205,t>>>8,t]);else if(t>=-32768&&t<=32767)n=a.Buffer.from([209,t>>>8,t]);else if(t>0&&t<=4294967295)n=a.Buffer.from([206,t>>>24,t>>>16,t>>>8,t]);else if(t>=-2147483648&&t<=2147483647)n=a.Buffer.from([210,t>>>24,t>>>16,t>>>8,t]);else if(t>0&&t<=0xffffffffffffffffn){const e=t/2**32,r=t%2**32;n=a.Buffer.from([211,e>>>24,e>>>16,e>>>8,e,r>>>24,r>>>16,r>>>8,r])}else n=a.Buffer.from([0]);return a.Buffer.concat([r,n])},d=e=>{const t=(0,i.decode)(a.Buffer.from(e)),r={state:f,error:""};t.version||(t.version=0);const n={...t,...r};try{if(n.timestamp&&n.protocol&&n.service)if(n.pk2||!n.pk1||n.sign1||n.sign2||16!==n.nonce?.length){if(!n.sign1&&32===n.nonce?.length&&n.pk1&&n.pk2&&n.sign2){n.state=1;const e=o.default.fromId(n.pk2),t=p(n);e.verifyChallenge(t,n.sign2,!0)||e.verifyChallenge_v0(t,n.sign2,!0,n.pk2)||(n.state=f,n.error="[STEP1] failed the verification of pk2")}else if(n.sign1&&32===n.nonce?.length&&n.pk1&&n.pk2&&n.sign2){n.state=2;const e=o.default.fromId(n.pk1),r=o.default.fromId(n.pk2);e.version===t.version&&r.version===t.version||(n.state=f,n.error="[COMPLETE] pk1 and pk2 are using different serialization version");const i=p(n);r.verifyChallenge(i,n.sign2,!0)||r.verifyChallenge_v0(i,n.sign2,!0,n.pk2)||(n.state=f,n.error="[COMPLETE] failed the verification of pk2"),e.verifyChallenge(i,n.sign1,!0)||e.verifyChallenge_v0(i,n.sign1,!0,n.pk1)||(n.state=f,n.error="[COMPLETE] failed the verification of pk1")}}else n.state=0;else n.state=f,n.error="[ERROR] Challenge is missing values"}catch(e){throw n.error="["+n.state+" -> ERROR] "+e,n.state=f,e}return n},p=e=>{const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,metadata:d}=e,p={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,metadata:d};return 0===t?(({version:e,protocol:t,service:r,timestamp:n,pk1:i,pk2:s,nonce:o,metadata:f})=>a.Buffer.concat([a.Buffer.from([135]),h("protocol",t),h("service",r),l("timestamp",n),u("pk1",i),u("pk2",s),u("nonce",o),a.Buffer.from([168]),a.Buffer.from("metadata","ascii"),a.Buffer.from([128])]))(p):a.Buffer.from((0,i.encode)(p))},y=(e,t,r=Date.now())=>e.timestamp>r-t&&e.timestamp<r+t;class b{constructor(e,t=6e4){this.version=0,this.state=c,this.vaultysId=o.default.fromSecret(e.getSecret()),this.liveliness=t}static async verifyCertificate(e){return 2===d(e).state}static async fromCertificate(e,t){const r=d(e);if(r.version||(r.version=0),0===r.state){const e=new b(o.default.fromId(r.pk1).toVersion(r.version),t);e.challenge=r,e.mykey=r.pk1,e.state=0}else if(1===r.state){const e=new b(o.default.fromId(r.pk2).toVersion(r.version),t);return e.challenge=r,e.mykey=r.pk2,e.hisKey=r.pk1,e.state=1,e}}async setChallenge(e){if(this.state!==c)throw this.state=f,new Error("Challenger already initialised, can't reset the state");if(this.challenge=d(e),this.version=this.challenge.version,!y(this.challenge,this.liveliness))throw this.state=f,this.challenge.error="challenge timestamp failed the liveliness at first signature",new Error(this.challenge.error);if(this.challenge.state===f)throw this.state=f,new Error(this.challenge.error);if(0===this.challenge.state){this.mykey=this.vaultysId.id,this.challenge.pk2=this.mykey,this.hisKey=this.challenge.pk1,this.challenge.nonce=a.Buffer.concat([this.challenge.nonce||new Uint8Array,(0,s.randomBytes)(16)]);const e=this.getUnsignedChallenge();if(!e)throw new Error("Error processing Challenge");this.challenge.sign2=await this.vaultysId.signChallenge(e)||void 0,this.challenge.state=this.state=1}else{if(2!==this.challenge.state)throw new Error("Challenge is from a protocol already launched, this is completely unsafe");if(this.mykey=this.vaultysId.id,!this.challenge.pk1?.equals(this.mykey)&&!this.challenge.pk1?.equals(this.mykey))throw this.state=f,new Error("Can't link the vaultys id to this challenge");this.state=2}}getContext(){return{protocol:this.challenge?.protocol,service:this.challenge?.service,metadata:this.challenge?.metadata}}createChallenge(e,t,r=0,n){if(this.version=r,this.state!=c)throw this.state=f,new Error("Challenger already initialised, can't reset the state");this.mykey=this.vaultysId.toVersion(r).id,this.challenge={version:r,protocol:e,service:t,metadata:n?{pk1:n}:{},timestamp:Date.now(),pk1:this.mykey,nonce:(0,s.randomBytes)(16),state:0},this.state=0}getCertificate(){return this.challenge&&(e=>{if(0==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,nonce:f,metadata:c}=e,h={version:t,protocol:r,service:n,timestamp:s,pk1:o,nonce:f,metadata:c},u=(0,i.encode)(h);return a.Buffer.from(u)}if(1==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign2:h,metadata:u}=e,l={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign2:h,metadata:u},d=(0,i.encode)(l);return a.Buffer.from(d)}if(2==e.state){const{version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign1:h,sign2:u,metadata:l}=e,d={version:t,protocol:r,service:n,timestamp:s,pk1:o,pk2:f,nonce:c,sign1:h,sign2:u,metadata:l},p=(0,i.encode)(d);return a.Buffer.from(p)}return null})(this.challenge)||a.Buffer.from([])}getUnsignedChallenge(){return p(this.challenge)}getContactDid(){return this.hisKey?o.default.fromId(this.hisKey).did:null}getContactId(){if(this.isComplete())return o.default.fromId(this.hisKey,this.getCertificate()||void 0);throw new Error("The challenge is not COMPLETE, it is unsafe to get the Contact ID before")}static fromString(e,t){const r=new b(e);return r.setChallenge(t),r}hasFailed(){return this.state==f}isComplete(){return 2==this.state}async init(e){if(this.state!==c)throw new Error("Can't init INITIALISED challenge");const t=d(e);if(this.version=t.version=t.version?1:0,this.vaultysId.toVersion(this.version),0===t.state){if(t.pk2?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");return this.challenge=t,this.version=t.version,this.mykey=this.challenge.pk2=this.vaultysId.id,this.hisKey=this.challenge.pk1,void(this.challenge.state=this.state=0)}if(1===t.state){if(t.pk2?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");return this.challenge=t,this.version=t.version,this.mykey=this.challenge.pk2,this.hisKey=this.challenge.pk1,void(this.state=this.challenge.state=1)}}async update(e,t){if(this.state===f)throw new Error("Can't update errorneous challenge");if(2===this.state)throw new Error("Can't update COMPLETE challenge");{const r=d(e);if(!r)throw this.state=f,new Error("Can't read the new incoming challenge");if(r.state===f)throw this.state=f,new Error(r.error);if(!y(r,this.liveliness))throw this.state=f,new Error("challenge timestamp failed the liveliness");if(this.version=r.version,this.vaultysId.toVersion(this.version),this.state===c&&0===r.state){if(r.metadata.pk2)throw this.state=f,new Error("Metadata is malformed: pk2 is already set");this.challenge=r,this.mykey=this.challenge.pk2=this.vaultysId.id,this.hisKey=this.challenge.pk1,t&&(this.challenge.metadata.pk2=t),this.challenge.nonce=a.Buffer.concat([this.challenge.nonce,(0,s.randomBytes)(16)]);const e=this.getUnsignedChallenge();return this.challenge.sign2=await this.vaultysId.signChallenge(e),void(this.challenge.state=this.state=1)}if(this.state===c&&1===r.state){if(r.pk1?.toString("base64")!==this.vaultysId.id.toString("base64"))throw this.state=f,new Error("challenge is not corresponding to the right id");const e=p(r);return r.sign1=await this.vaultysId.signChallenge(e),this.challenge=r,this.mykey=this.challenge.pk1,this.hisKey=this.challenge.pk2,void(this.state=this.challenge.state=2)}if(this.state===c&&2===r.state)return void console.log("COMPLETE case?!!");if(r.protocol!==this.challenge.protocol||r.service!==this.challenge.service)throw this.state=f,new Error(`The challenge was expecting protocol '${this.challenge.protocol}' and service '${this.challenge.service}', received '${r.protocol}' and '${r.service}'`);if(0===this.state&&1===r.state){if(!r.nonce?.subarray(0,16).equals(this.challenge.nonce.subarray(0,16)))throw this.state=f,new Error("Nonce has been tampered with");if(r.timestamp!==this.challenge?.timestamp)throw this.state=f,new Error("Timestamp has been tampered with");if(!this.mykey?.equals(r.pk1))throw this.state=f,new Error(`The challenge has been tampered with. Received pk1 = '${r.pk1}', expected pk1 = '${this.mykey}'`);const e=p(r);if(!e)throw this.state=f,new Error("Error processing Challenge");r.sign1=await this.vaultysId.signChallenge(e),this.challenge=r,this.hisKey=r.pk2,this.state=this.challenge.state=2}else{if(1!==this.state||2!==r.state){const e=`The challenge is in an expected state. Received state = '${r.state}', expected state = '${this.state+1}'`;throw this.state=f,new Error(e)}if(r.protocol!==this.challenge.protocol||r.service!==this.challenge.service)throw this.state=f,new Error(`The challenge was expecting protocol '${this.challenge.protocol}' and service '${this.challenge.service}', received '${r.protocol}' and '${r.service}'`);if(!r.nonce?.subarray(16,32).equals(this.challenge.nonce.subarray(16,32)))throw this.state=f,new Error("Nonce has been tampered with");if(r.timestamp!==this.challenge?.timestamp)throw this.state=f,new Error("Timestamp has been tampered with");if(!this.mykey.equals(r.pk2))throw this.state=f,new Error("The challenge pk2 has been tampered with");this.challenge=r,this.state=2}}}}b.deserializeCertificate=d,b.serializeCertificate_v0=({version:e,protocol:t,service:r,timestamp:n,pk1:i,pk2:s,nonce:o,sign1:f,sign2:c,metadata:d})=>a.Buffer.concat([a.Buffer.from([137]),h("protocol",t),h("service",r),l("timestamp",n),u("pk1",i),u("pk2",s),u("nonce",o),u("sign1",f),u("sign2",c),a.Buffer.from([168]),a.Buffer.from("metadata","ascii"),a.Buffer.from([128])]),b.serializeCertificate=p,t.default=b},8481:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7261),s=r(4686),o=n(r(4406)),a=r(2655),f=r(7466),c=n(r(8887));class h extends c.default{constructor(){super(),this.authType="DilithiumVerificationKey2025"}static async createFromEntropy(e){const t=new h;var r;t.entropy=e,t.capability="private",t.seed=(r=e,(0,i.hash)("sha512",r)),t.signer=(0,f.generateDilithiumKeyPair)(t.seed.slice(0,32));const n=o.default.box.keyPair.fromSecretKey(t.seed.slice(32,64));return t.cypher={publicKey:s.Buffer.from(n.publicKey),secretKey:s.Buffer.from(n.secretKey)},t}static generate(){return h.createFromEntropy((0,i.randomBytes)(32))}getSecret(){return s.Buffer.from((0,a.encode)({v:this.version,s:this.seed}))}get id(){return s.Buffer.from((0,a.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,a.decode)(e),r=new h;r.version=t.v??0,r.capability="private",r.seed=s.Buffer.from(t.s),r.signer=(0,f.generateDilithiumKeyPair)(r.seed.slice(0,32));const n=r.seed.slice(32,64),i=o.default.box.keyPair.fromSecretKey(n);return r.cypher={publicKey:s.Buffer.from(i.publicKey),secretKey:s.Buffer.from(i.secretKey)},r}static instantiate(e){const t=new h;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?s.Buffer.from(e.signer.publicKey.data):s.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?s.Buffer.from(e.cypher.publicKey.data):s.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,a.decode)(e),r=new h;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}getSigner(){return this.signer.secretKey,Promise.resolve({sign:e=>Promise.resolve((0,f.signDilithium)(e,this.signer.secretKey))})}verify(e,t,r){return(0,f.verifyDilithium)(e,t,this.signer.publicKey)}}t.default=h},8496:(e,t,r)=>{"use strict";var n=r(900),i=r(1413);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}n.inherits(s,i),e.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}},8558:e=>{var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var a,f=[],c=!1,h=-1;function u(){c&&a&&(c=!1,a.length?f=a.concat(f):h=-1,f.length&&l())}function l(){if(!c){var e=o(u);c=!0;for(var t=f.length;t;){for(a=f,f=[];++h<t;)a&&a[h].run();h=-1,t=f.length}a=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new d(e,t)),1!==f.length||c||o(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},8580:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(7261),s=n(r(1167)),o=n(r(4406)),a=r(2248),f=r(2655),c=n(r(8886)),h=r(4686),u=r(7466),l=n(r(8887)),d={usb:1,nfc:2,ble:4,internal:8,hybrid:16,"smart-card":32},p=e=>Object.keys(d).filter(t=>e&&d[t]),y=e=>{const t=s.default.decode(e).get(1);return 1===t?"Ed25519VerificationKey2020":2===t?"P256VerificationKey2020":"Unknown"},b=e=>{const t=s.default.decode(e);let r=h.Buffer.from([]);return-7==t.get(3)?r=h.Buffer.concat([h.Buffer.from("04","hex"),t.get(-2),t.get(-3)]):-8==t.get(3)?r=t.get(-2):t.get(3)==u.PQ_COSE_ALG.DILITHIUM2&&(r=t.get(-101)),{publicKey:r}};class g extends l.default{constructor(){super(),this._transports=0,this.encType="X25519KeyAgreementKey2019",this.webAuthn=(0,a.getWebAuthnProvider)()}get transports(){return p(this._transports)}static async createFromAttestation(e){const t=new g;t.ckey=c.default.getCOSEPublicKey(e),t.authType=y(t.ckey),t.fid=h.Buffer.from(e.id,"base64");const r=e.response,n=r.getTransports?r.getTransports():["usb"];t._transports=(e=>e.reduceRight((e,t)=>e+(d[t]?d[t]:0),0))(n),t.signer=b(t.ckey);const s=(0,i.randomBytes)(32),a=(f=s,(0,i.hash)("sha512",f));var f;const u=o.default.box.keyPair.fromSecretKey(a.slice(0,32));return t.cypher={publicKey:h.Buffer.from(u.publicKey),secretKey:h.Buffer.from(u.secretKey)},t.entropy=s,t}get id(){return h.Buffer.from((0,f.encode)({v:this.version,c:this.ckey,e:this.cypher.publicKey}))}getSecret(){return h.Buffer.from((0,f.encode)({v:this.version,f:this.fid,t:this._transports,c:this.ckey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,f.decode)(e),r=new g;r.version=t.v??0,r.capability="private",r.fid="string"==typeof t.f?h.Buffer.from(t.f,"base64"):t.f,r._transports=t.t?t.t:15,r.ckey=t.c,r.authType=y(r.ckey),r.signer=b(t.c);const n=o.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:h.Buffer.from(n.publicKey),secretKey:h.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new g;return t.version=e.version??0,t.fid="string"==typeof e.fid?h.Buffer.from(e.fid,"base64"):e.fid,t._transports=e.t?e.t:15,t.ckey=e.ckey.data?h.Buffer.from(e.ckey.data):h.Buffer.from(e.ckey),t.signer=b(t.ckey),t.authType=y(t.ckey),t.cypher={publicKey:e.cypher.publicKey.data?h.Buffer.from(e.cypher.publicKey.data):h.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,f.decode)(e),r=new g;return r.version=t.v??0,r.capability="public",r.fid="string"==typeof t.f?h.Buffer.from(t.f,"base64"):t.f,r.ckey=t.c,r.signer=b(t.c),r.authType=y(r.ckey),r.cypher={publicKey:t.e},r}async getSigner(){return{sign:async e=>{if(!navigator.credentials)return null;try{await(window?.CredentialUserInteractionRequest())}catch(e){}const t={challenge:(0,i.hash)("sha256",e),userVerification:"preferred",allowCredentials:[{type:"public-key",id:this.fid,transports:p(this._transports)}]},{response:r}=await this.webAuthn.get(t),n=r,s={s:h.Buffer.from(n.signature),c:h.Buffer.from(n.clientDataJSON),a:h.Buffer.from(n.authenticatorData)};return h.Buffer.from((0,f.encode)(s))}}}verify(e,t,r=!1){const n=h.Buffer.from(t),s=(0,f.decode)(n),o={signature:s.s,clientDataJSON:s.c,authenticatorData:s.a,userHandle:h.Buffer.from([]).buffer};return(0,i.hash)("sha256",e).toString("base64")===c.default.extractChallenge(o.clientDataJSON)&&c.default.simpleVerify(this.ckey,o,r)}verifyCredentials(e,t=!1){if(e.id!==this.fid.toString("base64"))return!1;const r=e.response;var n;return h.Buffer.from(r.authenticatorData.slice(0,32)).toString("hex")===(n=h.Buffer.from(e.id,"base64"),(0,i.hash)("sha256",n)).toString("hex")&&c.default.simpleVerify(this.ckey,r,t)}async createRevocationCertificate(){return null}}t.default=g},8590:(e,t,r)=>{"use strict";const{Buffer:n}=r(4686),i=r(6899),s=r(896),o=r(790),{NUMBYTES:a,SHIFT32:f,BI:c,SYMS:h}=o,u=new TextDecoder("utf8",{fatal:!0,ignoreBOM:!0});t.utf8=e=>u.decode(e),t.utf8.checksUTF8=!0,t.isBufferish=function(e){return e&&"object"==typeof e&&(n.isBuffer(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof ArrayBuffer||e instanceof DataView)},t.bufferishToBuffer=function(e){return n.isBuffer(e)?e:ArrayBuffer.isView(e)?n.from(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?n.from(e):null},t.parseCBORint=function(e,t){switch(e){case a.ONE:return t.readUInt8(0);case a.TWO:return t.readUInt16BE(0);case a.FOUR:return t.readUInt32BE(0);case a.EIGHT:{const e=t.readUInt32BE(0),r=t.readUInt32BE(4);return e>2097151?BigInt(e)*c.SHIFT32+BigInt(r):e*f+r}default:throw new Error(`Invalid additional info for int: ${e}`)}},t.writeHalf=function(e,t){const r=n.allocUnsafe(4);r.writeFloatBE(t,0);const i=r.readUInt32BE(0);if(8191&i)return!1;let s=i>>16&32768;const o=i>>23&255,a=8388607&i;if(o>=113&&o<=142)s+=(o-112<<10)+(a>>13);else{if(!(o>=103&&o<113))return!1;if(a&(1<<126-o)-1)return!1;s+=a+8388608>>126-o}return e.writeUInt16BE(s),!0},t.parseHalf=function(e){const t=128&e[0]?-1:1,r=(124&e[0])>>2,n=(3&e[0])<<8|e[1];return r?31===r?t*(n?NaN:1/0):t*2**(r-25)*(1024+n):5.960464477539063e-8*t*n},t.parseCBORfloat=function(e){switch(e.length){case 2:return t.parseHalf(e);case 4:return e.readFloatBE(0);case 8:return e.readDoubleBE(0);default:throw new Error(`Invalid float size: ${e.length}`)}},t.hex=function(e){return n.from(e.replace(/^0x/,""),"hex")},t.bin=function(e){let t=0,r=(e=e.replace(/\s/g,"")).length%8||8;const i=[];for(;r<=e.length;)i.push(parseInt(e.slice(t,r),2)),t=r,r+=8;return n.from(i)},t.arrayEqual=function(e,t){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every((e,r)=>e===t[r])},t.bufferToBigInt=function(e){return BigInt(`0x${e.toString("hex")}`)},t.cborValueToString=function(e,r=-1){switch(typeof e){case"symbol":{switch(e){case h.NULL:return"null";case h.UNDEFINED:return"undefined";case h.BREAK:return"BREAK"}if(e.description)return e.description;const t=e.toString().match(/^Symbol\((?<name>.*)\)/);return t&&t.groups.name?t.groups.name:"Symbol"}case"string":return JSON.stringify(e);case"bigint":return e.toString();case"number":{const t=Object.is(e,-0)?"-0":String(e);return r>0?`${t}_${r}`:t}case"object":{if(!e)return"null";const n=t.bufferishToBuffer(e);if(n){const e=n.toString("hex");return r===-1/0?e:`h'${e}'`}return e&&"function"==typeof e[Symbol.for("nodejs.util.inspect.custom")]?e[Symbol.for("nodejs.util.inspect.custom")]():Array.isArray(e)?"[]":"{}"}}return String(e)},t.guessEncoding=function(e,r){if("string"==typeof e)return new i(e,null==r?"hex":r);const n=t.bufferishToBuffer(e);if(n)return new i(n);if((o=e)instanceof s.Readable||["read","on","pipe"].every(e=>"function"==typeof o[e]))return e;var o;throw new Error("Unknown input type")};const l={"=":"","+":"-","/":"_"};t.base64url=function(e){return t.bufferishToBuffer(e).toString("base64").replace(/[=+/]/g,e=>l[e])},t.base64=function(e){return t.bufferishToBuffer(e).toString("base64")},t.isBigEndian=function(){const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])}},8637:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)}},8676:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(9750),s=r(5598),o=r(4686),a=n(r(4406)),f=r(2655),c=r(6136),h=n(r(7264));c.ed25519.CURVE={...c.ed25519.CURVE},c.ed25519.CURVE.adjustScalarBytes=e=>(e[0]&=248,e[31]&=63,e[31]|=64,e);class u extends h.default{constructor(){super(),this.version=1,this.capability="private",this.authType="Ed25519VerificationKey2020"}static async createFromEntropy(e){const t=new u;t.entropy=e,t.capability="private";const r=(n=e,(0,s.hash)("sha512",n));var n;t.signer={publicKey:o.Buffer.from(c.ed25519.getPublicKey(r.slice(0,32))),secretKey:r.slice(0,32)};const i=a.default.box.keyPair.fromSecretKey(r.slice(32,64));return t.cypher={publicKey:o.Buffer.from(i.publicKey),secretKey:o.Buffer.from(i.secretKey)},t}static generate(){return u.createFromEntropy((0,s.randomBytes)(32))}get id(){return o.Buffer.from((0,f.encode)({v:this.version,x:this.signer.publicKey,e:this.cypher.publicKey}))}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?(0,s.hmac)("sha256",o.Buffer.from(e.secretKey),"VaultysID/"+t+"/end"):void 0,signcrypt:async(t,r)=>(0,i.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,i.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>o.Buffer.from(a.default.scalarMult(e.secretKey,t))}}getSigner(){const e=this.signer.secretKey;return Promise.resolve({sign:t=>Promise.resolve(o.Buffer.from(c.ed25519.sign(t,e)))})}getSecret(){return o.Buffer.from((0,f.encode)({v:this.version,x:this.signer.secretKey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,f.decode)(e),r=new u;r.version=t.v??0,r.capability="private",r.signer={secretKey:t.x.slice(0,32),publicKey:o.Buffer.from(c.ed25519.getPublicKey(t.x.slice(0,32)))};const n=a.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:o.Buffer.from(n.publicKey),secretKey:o.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new u;return t.version=e.version??0,t.signer={publicKey:e.signer.publicKey.data?o.Buffer.from(e.signer.publicKey.data):o.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?o.Buffer.from(e.cypher.publicKey.data):o.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,f.decode)(e),r=new u;return r.version=t.v??0,r.capability="public",r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}verify(e,t,r){return c.ed25519.verify(t,e,this.signer.publicKey)}cleanSecureData(){this.cypher?.secretKey&&((0,s.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.signer?.secretKey&&((0,s.secureErase)(this.signer.secretKey),delete this.signer.secretKey),this.entropy&&((0,s.secureErase)(this.entropy),delete this.entropy)}}t.default=u},8704:e=>{"use strict";var t={};function r(e,r,n){n||(n=Error);var i=function(e){var t,n;function i(t,n,i){return e.call(this,function(e,t,n){return"string"==typeof r?r:r(e,t,n)}(t,n,i))||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(n);i.prototype.name=n.name,i.prototype.code=e,t[e]=i}function n(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map(function(e){return String(e)}),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(e,t,r){var i,s,o,a,f;if("string"==typeof t&&(s="not ",t.substr(0,4)===s)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-9,r)===t}(e," argument"))o="The ".concat(e," ").concat(i," ").concat(n(t,"type"));else{var c=("number"!=typeof f&&(f=0),f+1>(a=e).length||-1===a.indexOf(".",f)?"argument":"property");o='The "'.concat(e,'" ').concat(c," ").concat(i," ").concat(n(t,"type"))}return o+". Received type ".concat(typeof r)},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(e){return"The "+e+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(e){return"Cannot call "+e+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(e){return"Unknown encoding: "+e},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.F=t},8854:()=>{},8881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.montgomery=function(e){const t=(d=e,(0,n._validateObject)(d,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...d})),{P:r,type:f,adjustScalarBytes:c,powPminus2:h,randomBytes:u}=t,l="x25519"===f;var d;if(!l&&"x448"!==f)throw new Error("invalid type");const p=u||n.randomBytes,y=l?255:448,b=l?32:56,g=l?BigInt(9):BigInt(5),m=l?BigInt(121665):BigInt(39081),w=l?a**BigInt(254):a**BigInt(447),v=l?BigInt(8)*a**BigInt(251)-o:BigInt(4)*a**BigInt(445)-o,_=w+v+o,E=e=>(0,i.mod)(e,r),S=B(g);function B(e){return(0,n.numberToBytesLE)(E(e),b)}function M(e,t){const i=function(e,t){(0,n.aInRange)("u",e,s,r),(0,n.aInRange)("scalar",t,w,_);const i=t,a=e;let f=o,c=s,u=e,l=o,d=s;for(let e=BigInt(y-1);e>=s;e--){const t=i>>e&o;d^=t,({x_2:f,x_3:u}=I(d,f,u)),({x_2:c,x_3:l}=I(d,c,l)),d=t;const r=f+c,n=E(r*r),s=f-c,h=E(s*s),p=n-h,y=u+l,b=E((u-l)*r),g=E(y*s),w=b+g,v=b-g;u=E(w*w),l=E(a*E(v*v)),f=E(n*h),c=E(p*(n+E(m*p)))}({x_2:f,x_3:u}=I(d,f,u)),({x_2:c,x_3:l}=I(d,c,l));const p=h(c);return E(f*p)}(function(e){const t=(0,n.ensureBytes)("u coordinate",e,b);return l&&(t[31]&=127),E((0,n.bytesToNumberLE)(t))}(t),function(e){return(0,n.bytesToNumberLE)(c((0,n.ensureBytes)("scalar",e,b)))}(e));if(i===s)throw new Error("invalid private or public key received");return B(i)}function A(e){return M(e,S)}function I(e,t,r){const n=E(e*(t-r));return{x_2:t=E(t-n),x_3:r=E(r+n)}}return{scalarMult:M,scalarMultBase:A,getSharedSecret:(e,t)=>M(e,t),getPublicKey:e=>A(e),utils:{randomPrivateKey:()=>p(b)},GuBytes:S.slice()}};const n=r(6376),i=r(7342),s=BigInt(0),o=BigInt(1),a=BigInt(2)},8886:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4686),s=r(7261),o=n(r(1167)),a=r(6136),f=r(1440),c=r(7268),h=r(5691),u=r(7466),l={},d=u.PQ_COSE_KEY_TYPE.DILITHIUM,p={1:f.p256,2:c.p384,3:h.p521},y={"-257":"SHA-256","-258":"SHA-384","-259":"SHA-512","-65535":"SHA-1","-39":"SHA-512","-38":"SHA-384","-37":"SHA-256","-260":"SHA-256","-261":"SHA-512","-7":"SHA-256","-36":"SHA-512",[u.PQ_COSE_ALG.DILITHIUM2.toString()]:"SHA-256"},b=(e,t)=>(0,s.hash)(e.replace("-",""),t),g=e=>{const t=e.slice(0,32),r=(e=e.slice(32)).slice(0,1);e=e.slice(1);const n=r[0],i={up:!!(1&n),uv:!!(4&n),at:!!(64&n),ed:!!(128&n),flagsInt:n},s=e.slice(0,4);e=e.slice(4);const o=s.readUInt32BE(0);let a,f,c;if(i.at){a=e.slice(0,16);const t=(e=e.slice(16)).slice(0,2);e=e.slice(2);const r=t.readUInt16BE(0);f=e.slice(0,r),c=e=e.slice(r)}return{rpIdHash:t,flagsBuf:r,flags:i,counter:o,counterBuf:s,aaguid:a,credID:f,COSEPublicKey:c}},m=(e,t,r)=>f.p256.verify(f.p256.Signature.fromDER(r).toCompactHex(),e,t),w=(e,t,r)=>a.ed25519.verify(r,e,t);class v{constructor(){this.signCount=0,this.rawId=(0,s.randomBytes)(32),this.aaguid=i.Buffer.alloc(16)}static createRequest(e,t=!1){const r={publicKey:{challenge:i.Buffer.from((0,s.randomBytes)(32).toString("base64")),rp:{name:"Vaultys ID",id:"Vaultys ID"},user:{id:i.Buffer.from("Vaultys Wallet ID","utf8"),name:"Vaultys Wallet ID",displayName:"Vaultys Wallet ID"},pubKeyCredParams:[{type:"public-key",alg:e}]}};return t&&(r.publicKey.extensions={prf:{eval:{first:(0,s.randomBytes)(32)}}}),r}static async create(e,t="test"){const r=new v,n=e.publicKey;r.options=n,r.rpId=n.rp.id||n.rp.name,r.userHandle=i.Buffer.from(n.user.id.toString(),"base64"),l[r.rawId.toString("base64")]=r;const c=n.pubKeyCredParams.some(e=>e.alg===u.PQ_COSE_ALG.DILITHIUM2);if(r.alg=c?u.PQ_COSE_ALG.DILITHIUM2:n.pubKeyCredParams[0].alg,-8===r.alg){const e=a.ed25519.utils.randomPrivateKey();r.keyPair={privateKey:e,publicKey:a.ed25519.getPublicKey(e),algorithm:"EdDSA"},r.coseKey=new Map,r.coseKey.set(1,1),r.coseKey.set(3,-8),r.coseKey.set(-1,6);const t=r.keyPair.publicKey.slice(0,32);r.coseKey.set(-2,t)}else if(-7===r.alg){const e=f.p256.utils.randomPrivateKey();r.keyPair={privateKey:e,publicKey:f.p256.getPublicKey(e,!1),algorithm:"ES256"},r.coseKey=new Map,r.coseKey.set(1,2),r.coseKey.set(3,-7),r.coseKey.set(-1,6);const t=r.keyPair.publicKey.slice(1,33),n=r.keyPair.publicKey.slice(33);r.coseKey.set(-2,t),r.coseKey.set(-3,n)}else if(r.alg===u.PQ_COSE_ALG.DILITHIUM2){const{publicKey:e,secretKey:t}=(0,u.generateDilithiumKeyPair)();r.keyPair={privateKey:t,publicKey:e,algorithm:"DILITHIUM2",isDILITHIUM:!0},r.coseKey=(0,u.createDilithiumCoseKey)(e)}const h={type:"webauthn.create",challenge:n.challenge,origin:t},d=(0,s.hash)("sha256",i.Buffer.from(r.rpId,"ascii")),p=i.Buffer.from("41","hex"),y=i.Buffer.allocUnsafe(4);y.writeUInt32BE(r.signCount,0);const b=i.Buffer.allocUnsafe(2);b.writeUInt16BE(r.rawId.length,0);const g=o.default.encode(r.coseKey),m={authData:i.Buffer.concat([d,p,y,r.aaguid,b,r.rawId,g]),fmt:"none",attStmt:{}};return{id:r.rawId.toString("base64"),rawId:r.rawId,authenticatorAttachment:null,type:"public-key",getClientExtensionResults:()=>n.extensions?.prf?.eval?.first?{prf:{enabled:!0}}:{},toJSON(){},response:{clientDataJSON:i.Buffer.from(JSON.stringify(h),"utf-8"),attestationObject:o.default.encode(m),getTransports:()=>["usb","hybrid"],getAuthenticatorData:()=>m.authData,getPublicKey:()=>g,getPublicKeyAlgorithm:()=>-7}}}static simpleVerify(e,t,r=!1){const n=o.default.decode(e,{extendedResults:!0}).value,a=(t.authenticatorData.slice(0,32),i.Buffer.from(t.authenticatorData)[32]);if(t.authenticatorData.slice(33,37),!(r?4&a:1&a))return!1;const f=(0,s.hash)("sha256",i.Buffer.from(t.clientDataJSON));let c=i.Buffer.concat([i.Buffer.from(t.authenticatorData),f]);if(-7==n.get(3)&&(c=(0,s.hash)("sha256",c)),1==n.get(1)){const e=n.get(-2);return w(c,e,i.Buffer.from(t.signature))}if(2==n.get(1)){const e=n.get(-2),r=n.get(-3),s=i.Buffer.concat([i.Buffer.from("04","hex"),e,r]);return m(c,s,i.Buffer.from(t.signature))}if(n.get(1)===d){const e=n.get(u.PQ_COSE_KEY_PARAMS.DILITHIUM_PK);return(0,u.verifyDilithium)(c,i.Buffer.from(t.signature),e)}return!1}static getCOSEPublicKey(e){const t=e.response,r=o.default.decode(t.attestationObject);return g(r.authData).COSEPublicKey}static verifyPackedAttestation(e,t=!1){return((e,t=!1)=>{const r=i.Buffer.from(e.attestationObject),n=o.default.decodeAllSync(r)[0];if("none"==n.fmt)return!1;const s=g(n.authData);if(!s.flags.up)return!1;if(t&&!s.flags.uv)return!1;const f=b("sha256",i.Buffer.from(e.clientDataJSON)),c=i.Buffer.concat([n.authData,f]),h=n.attStmt.sig;let u=!1;if(n.attStmt.ecdaaKeyId)throw new Error("ECDAA IS NOT SUPPORTED!");{const e=o.default.decodeAllSync(s.COSEPublicKey)[0],t=y[e.get(3)],r=b(t,c);if(2===e.get(1)){const t=e.get(-2),n=e.get(-3),s=i.Buffer.concat([i.Buffer.from([4]),t,n]),o=p[e.get(-1)],a=o.Signature.fromDER(h);u=o.verify(a,r,s)}else{if(1!==e.get(1))return!1;{const t=e.get(-2);u=a.ed25519.verify(h,r,t)}}}if(!u)throw new Error("Failed to verify the signature!");return!0})(e,t)}static async verify(e,t,r=!1){const n=(0,s.hash)("sha256",i.Buffer.from(t.response.clientDataJSON)),a=t.response,f=e.response;let c=i.Buffer.concat([i.Buffer.from(a.authenticatorData),n]);const h=o.default.decode(f.attestationObject),l=g(h.authData);if(!l.flags.up)return!1;if(r&&!l.flags.uv||!l.COSEPublicKey)return!1;const p=o.default.decode(l.COSEPublicKey);-7==p.get(3)&&(c=(0,s.hash)("sha256",c));const y=p.get(1);if(1===y){const e=p.get(-2);return w(c,e,i.Buffer.from(a.signature))}if(2===y){const e=p.get(-2),t=p.get(-3),r=i.Buffer.concat([i.Buffer.from("04","hex"),e,t]);return m(c,r,i.Buffer.from(a.signature))}if(y===d){const e=p.get(u.PQ_COSE_KEY_PARAMS.DILITHIUM_PK);return(0,u.verifyDilithium)(c,i.Buffer.from(a.signature),e)}return!1}static extractChallenge(e){const t=JSON.parse(e.toString()),r=t.challenge.length%4;return t.challenge.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.challenge.length+(0===r?0:4-r),"=")}static async get({publicKey:e},t="test"){if(!e.allowCredentials)throw new Error;const r=i.Buffer.from(e.allowCredentials[0].id).toString("base64"),n=l[r];n.signCount+=1;const o={type:"webauthn.get",challenge:i.Buffer.from(e.challenge).toString("base64"),origin:t},c=(0,s.hash)("sha256",(0,s.fromUTF8)(JSON.stringify(o))),h=(0,s.hash)("sha256",i.Buffer.from(n.rpId,"utf-8")),d=i.Buffer.from("05","hex"),p=i.Buffer.allocUnsafe(4);p.writeUInt32BE(n.signCount,0);const y=i.Buffer.concat([h,d,p]),g=i.Buffer.concat([y,c]);let m=new Uint8Array;return-7===n.alg?m=f.p256.sign(g,n.keyPair.privateKey,{prehash:!0}).toDERRawBytes():-8===n.alg?m=a.ed25519.sign(g,n.keyPair.privateKey):n.alg===u.PQ_COSE_ALG.DILITHIUM2&&(m=(0,u.signDilithium)(g,n.keyPair.privateKey)),{id:r,rawId:i.Buffer.from(r,"base64").buffer,type:"public-key",authenticatorAttachment:null,getClientExtensionResults:()=>e.extensions?.prf?.eval?.first?{prf:{results:{first:b("sha256",e.extensions?.prf?.eval?.first)}}}:{},toJSON(){},response:{authenticatorData:y,clientDataJSON:i.Buffer.from(JSON.stringify(o),"utf-8"),signature:m,userHandle:n.userHandle}}}}t.default=v},8887:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DHIES=void 0,t.getCypherPublicKeyFromId=u;const i=r(9750),s=r(7261),o=r(4686),a=n(r(4406)),f=n(r(201)),c=r(2655);class h{constructor(e){this.keyManager=e}async encrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot encrypt with DHIES using a public KeyManager"),null;const r=await this.keyManager.getCypher(),n="string"==typeof e?o.Buffer.from(e,"utf8"):e;try{const e=(0,s.randomBytes)(32),i=await r.diffieHellman(t),f=o.Buffer.from(a.default.scalarMult(e,i)),c=this.kdf(f,this.keyManager.cypher.publicKey,t),h=c.encryptionKey,u=c.macKey,l=(0,s.randomBytes)(24),d=o.Buffer.from(a.default.secretbox(n,l,h)),p=o.Buffer.concat([this.keyManager.cypher.publicKey,l,d]),y=this.computeMAC(u,p),b=o.Buffer.concat([l,e,d,y]);return(0,s.secureErase)(f),(0,s.secureErase)(i),(0,s.secureErase)(h),(0,s.secureErase)(u),b}catch(e){return console.error("DHIES encryption failed:",e),null}}async decrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot decrypt with DHIES using a public KeyManager"),null;try{const r=e.slice(0,24),n=e.slice(24,56),i=e.slice(e.length-32),f=e.slice(56,e.length-32),c=await this.keyManager.getCypher(),h=await c.diffieHellman(t),u=o.Buffer.from(a.default.scalarMult(n,h)),l=this.kdf(u,t,this.keyManager.cypher.publicKey),d=l.encryptionKey,p=l.macKey,y=o.Buffer.concat([t,r,f]),b=this.computeMAC(p,y);if(!this.constantTimeEqual(i,b))return console.error("DHIES: MAC verification failed"),null;const g=a.default.secretbox.open(f,r,d);if(!g)return console.error("DHIES: Decryption failed"),null;const m=o.Buffer.from(g);return(0,s.secureErase)(u),(0,s.secureErase)(d),(0,s.secureErase)(p),m}catch(e){return console.error("DHIES decryption failed:",e),null}}kdf(e,t,r){const n=o.Buffer.concat([o.Buffer.from("DHIES-KDF"),t,r]),i=(0,s.hash)("sha512",o.Buffer.concat([e,n,o.Buffer.from([1])])),a=(0,s.hash)("sha512",o.Buffer.concat([e,n,o.Buffer.from([2])]));return{encryptionKey:i.slice(0,32),macKey:a.slice(0,32)}}computeMAC(e,t){return(0,s.hash)("sha256",o.Buffer.concat([e,t]))}constantTimeEqual(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}}function u(e){return(0,c.decode)(e).e}t.DHIES=h;class l extends f.default{constructor(){super(),this.version=1,this.capability="private",this.authType="",this.encType="X25519KeyAgreementKey2019"}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?(0,s.hmac)("sha256",o.Buffer.from(e.secretKey),"VaultysID/"+t+"/end"):void 0,signcrypt:async(t,r)=>(0,i.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,i.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>o.Buffer.from(a.default.scalarMult(e.secretKey,t))}}cleanSecureData(){this.cypher?.secretKey&&((0,s.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.entropy&&((0,s.secureErase)(this.entropy),delete this.entropy)}async performDiffieHellman(e){if("public"===this.capability)return console.error("Cannot perform DH key exchange with a public key capability"),null;const t=await this.getCypher(),r=e.cypher.publicKey,n=await t.diffieHellman(r),i=(o=n,(0,s.hash)("sha256",o));var o;return(0,s.secureErase)(n),i}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){return new h(this).encrypt(e,u(t))}async dhiesDecrypt(e,t){return new h(this).decrypt(e,u(t))}static async encrypt(e,t){const r=t.map(u);return await(0,i.encryptAndArmor)(e,null,r)}async signcrypt(e,t){const r=t.map(u),n=await this.getCypher();return await n.signcrypt(e,r)}async decrypt(e,t=null){const r=await this.getCypher(),n=t?u(t):null;return(await r.decrypt(e,n)).toString()}getSecretHash(e){const t=o.Buffer.concat([e,o.Buffer.from("secrethash"),this.cypher.secretKey]);return(0,s.hash)("sha256",t)}}t.default=l},8917:(e,t,r)=>{var n,i=r(8558),s=r(1661),o=r(6141);try{n=r(5826)}catch(e){}var a=function(){},f=void 0!==i&&/^v?\.0/.test(i.version),c=function(e){return"function"==typeof e},h=function(e){e()},u=function(e,t){return e.pipe(t)};e.exports=function(){var e,t=Array.prototype.slice.call(arguments),r=c(t[t.length-1]||a)&&t.pop()||a;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var i=t.map(function(u,l){var d=l<t.length-1;return function(e,t,r,i){i=s(i);var h=!1;e.on("close",function(){h=!0}),o(e,{readable:t,writable:r},function(e){if(e)return i(e);h=!0,i()});var u=!1;return function(t){if(!h&&!u)return u=!0,function(e){return!!f&&!!n&&(e instanceof(n.ReadStream||a)||e instanceof(n.WriteStream||a))&&c(e.close)}(e)?e.close(a):function(e){return e.setHeader&&c(e.abort)}(e)?e.abort():c(e.destroy)?e.destroy():void i(t||new Error("stream was destroyed"))}}(u,d,l>0,function(t){e||(e=t),t&&i.forEach(h),d||(i.forEach(h),r(e))})});return t.reduce(u)}},9010:function(e,t,r){"use strict";var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),o=0;o<r.length;o++)"default"!==r[o]&&i(t,e,r[o]);return s(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DHIES=t.privateDerivePath=t.publicDerivePath=void 0;const f=r(9750),c=r(7261),h=r(4686),u=a(r(4406)),l=r(2655),d=o(r(67)),p=r(3028),y=a(r(201)),b=d.default??d,g=e=>(0,c.hash)("sha256",e);t.publicDerivePath=(e,t)=>{let r=e;return t.startsWith("m/")&&(t=t.slice(2)),t.split("/").forEach(e=>{r="'"==e[e.length-1]?r.derive(2147483648+parseInt(e.substring(0,e.length-1))):r.derive(parseInt(e))}),r},t.privateDerivePath=(e,t)=>{let r=e;return t.startsWith("m/")&&(t=t.slice(2)),t.split("/").forEach(e=>{r="'"==e[e.length-1]?r.derive(2147483648+parseInt(e.substring(0,e.length-1))):r.derive(parseInt(e))}),r};class m{constructor(e){this.keyManager=e}async encrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot encrypt with DHIES using a public KeyManager"),null;const r=await this.keyManager.getCypher(),n="string"==typeof e?h.Buffer.from(e,"utf8"):e;try{const e=(0,c.randomBytes)(32),i=await r.diffieHellman(t),s=h.Buffer.from(u.default.scalarMult(e,i)),o=this.kdf(s,this.keyManager.cypher.publicKey,t),a=o.encryptionKey,f=o.macKey,l=(0,c.randomBytes)(24),d=h.Buffer.from(u.default.secretbox(n,l,a)),p=h.Buffer.concat([this.keyManager.cypher.publicKey,l,d]),y=this.computeMAC(f,p),b=h.Buffer.concat([l,e,d,y]);return(0,c.secureErase)(s),(0,c.secureErase)(i),(0,c.secureErase)(a),(0,c.secureErase)(f),b}catch(e){return console.error("DHIES encryption failed:",e),null}}async decrypt(e,t){if("public"===this.keyManager.capability)return console.error("Cannot decrypt with DHIES using a public KeyManager"),null;try{const r=e.slice(0,24),n=e.slice(24,56),i=e.slice(e.length-32),s=e.slice(56,e.length-32),o=await this.keyManager.getCypher(),a=await o.diffieHellman(t),f=h.Buffer.from(u.default.scalarMult(n,a)),l=this.kdf(f,t,this.keyManager.cypher.publicKey),d=l.encryptionKey,p=l.macKey,y=h.Buffer.concat([t,r,s]),b=this.computeMAC(p,y);if(!this.constantTimeEqual(i,b))return console.error("DHIES: MAC verification failed"),null;const g=u.default.secretbox.open(s,r,d);if(!g)return console.error("DHIES: Decryption failed"),null;const m=h.Buffer.from(g);return(0,c.secureErase)(f),(0,c.secureErase)(d),(0,c.secureErase)(p),m}catch(e){return console.error("DHIES decryption failed:",e),null}}kdf(e,t,r){const n=h.Buffer.concat([h.Buffer.from("DHIES-KDF"),t,r]),i=(0,c.hash)("sha512",h.Buffer.concat([e,n,h.Buffer.from([1])])),s=(0,c.hash)("sha512",h.Buffer.concat([e,n,h.Buffer.from([2])]));return{encryptionKey:i.slice(0,32),macKey:s.slice(0,32)}}computeMAC(e,t){return(0,c.hash)("sha256",h.Buffer.concat([e,t]))}constantTimeEqual(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}}t.DHIES=m;class w{constructor(){this.level=1,this.version=1,this.capability="private",this.authType="Ed25519VerificationKey2020",this.encType="X25519KeyAgreementKey2019"}static async create_Id25519_fromEntropy(e,r=0){const n=new w;n.entropy=e,n.level=1,n.capability="private";const i=(s=e,(0,c.hash)("sha512",s));var s;const o=(0,t.privateDerivePath)(await b.Bip32PrivateKey.fromEntropy(i.slice(0,32)),`m/1'/0'/${r}'`);n.proofKey={publicKey:o.toBip32PublicKey().toPublicKey().toBytes(),secretKey:o.toBytes()},n.swapIndex=r,n.proof=(0,c.hash)("sha256",n.proofKey.publicKey);const a=(0,t.privateDerivePath)(o,"/0'");n.signer={publicKey:a.toBip32PublicKey().toPublicKey().toBytes(),secretKey:a.toBytes()};const f=h.Buffer.alloc(8);f.writeBigInt64LE(BigInt(r),0);const l=g(h.Buffer.concat([i.slice(32,64),f])),d=u.default.box.keyPair.fromSecretKey(l);return n.cypher={publicKey:h.Buffer.from(d.publicKey),secretKey:h.Buffer.from(d.secretKey)},n}static generate_Id25519(){return w.create_Id25519_fromEntropy((0,c.randomBytes)(32))}get id(){return 0==this.version?(e=>{const t=h.Buffer.from([132,161,118,0]),r=h.Buffer.from([161,112,197,0,e.proof?.length,...e.proof||[]]),n=h.Buffer.from([161,120,197,0,e.signer.publicKey.length,...e.signer.publicKey]),i=h.Buffer.from([161,101,197,0,e.cypher.publicKey.length,...e.cypher.publicKey]);return h.Buffer.concat([t,r,n,i])})(this):h.Buffer.from((0,l.encode)({v:this.version,p:this.proof,x:this.signer.publicKey,e:this.cypher.publicKey}))}async getCypher(){const e=this.cypher;return{hmac:t=>e.secretKey?h.Buffer.from((0,p.createHmac)("sha256",h.Buffer.from(e.secretKey).toString("hex")).update("VaultysID/"+t+"/end").digest()):void 0,signcrypt:async(t,r)=>(0,f.encryptAndArmor)(t,e,r),decrypt:async(t,r)=>(0,f.dearmorAndDecrypt)(t,e,r),diffieHellman:async t=>h.Buffer.from(u.default.scalarMult(e.secretKey,t))}}async getSigner(){const e=this.signer.secretKey;return new b.Bip32PrivateKey(e).toPrivateKey()}getSecret(){return h.Buffer.from((0,l.encode)({v:this.version,p:this.proof,x:this.signer.secretKey,e:this.cypher.secretKey}))}static fromSecret(e){const t=(0,l.decode)(e),r=new w;r.version=t.v??0,r.level=2,r.capability="private",r.proof=t.p,r.signer={secretKey:t.x,publicKey:new b.Bip32PrivateKey(t.x).toBip32PublicKey().toPublicKey().toBytes()};const n=u.default.box.keyPair.fromSecretKey(t.e);return r.cypher={publicKey:h.Buffer.from(n.publicKey),secretKey:h.Buffer.from(n.secretKey)},r}static instantiate(e){const t=new w;return t.version=e.version??0,t.level=e.level,t.proof=e.proof.data?h.Buffer.from(e.proof.data):h.Buffer.from(e.proof),t.signer={publicKey:e.signer.publicKey.data?h.Buffer.from(e.signer.publicKey.data):h.Buffer.from(e.signer.publicKey)},t.cypher={publicKey:e.cypher.publicKey.data?h.Buffer.from(e.cypher.publicKey.data):h.Buffer.from(e.cypher.publicKey)},t}static fromId(e){const t=(0,l.decode)(e),r=new w;return r.version=t.v??0,r.level=2,r.capability="public",r.proof=t.p,r.signer={publicKey:t.x},r.cypher={publicKey:t.e},r}async sign(e){return"public"==this.capability?null:(await this.getSigner()).sign(e)}verify(e,t,r){try{return b.Bip32PublicKey.fromBytes(this.signer.publicKey).toPublicKey().verify(t,e)}catch(e){return!1}}async createSwapingCertificate(){if(1===this.level&&this.entropy){const e={newId:(await w.create_Id25519_fromEntropy(this.entropy,this.swapIndex+1)).id,proofKey:this.proofKey.publicKey,timestamp:Date.now(),signature:h.Buffer.from([])},t=h.Buffer.alloc(8);t.writeBigUInt64LE(BigInt(e.timestamp),0);const r=h.Buffer.concat([e.newId,e.proofKey,t]);return e.signature=new b.Bip32PrivateKey(this.proofKey.secretKey).toPrivateKey().sign(r),e}return null}async verifySwapingCertificate(e){if((0,c.hash)("sha256",e.proofKey).toString("hex")===this.proof?.toString("hex")){const t=h.Buffer.alloc(8);t.writeBigUInt64LE(BigInt(e.timestamp),0),w.fromId(e.newId);const r=h.Buffer.concat([e.newId,e.proofKey,t]);return b.Bip32PublicKey.fromBytes(e.proofKey).toPublicKey().verify(r,e.signature)}return!1}cleanSecureData(){this.cypher?.secretKey&&((0,c.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey),this.signer?.secretKey&&((0,c.secureErase)(this.signer.secretKey),delete this.signer.secretKey),this.entropy&&((0,c.secureErase)(this.entropy),delete this.entropy)}async performDiffieHellman(e){if("public"===this.capability)return console.error("Cannot perform DH key exchange with a public key capability"),null;const t=await this.getCypher(),r=e.cypher.publicKey,n=await t.diffieHellman(r),i=g(n);return(0,c.secureErase)(n),i}static async diffieHellman(e,t){return e.performDiffieHellman(t)}async dhiesEncrypt(e,t){const r=y.default.fromId(t);return new m(this).encrypt(e,r.cypher.publicKey)}async dhiesDecrypt(e,t){const r=y.default.fromId(t);return new m(this).decrypt(e,r.cypher.publicKey)}static async encrypt(e,t){const r=t.map(y.default.fromId).map(e=>e.cypher.publicKey);return await(0,f.encryptAndArmor)(e,null,r)}async signcrypt(e,t){const r=t.map(y.default.fromId).map(e=>e.cypher.publicKey),n=await this.getCypher();return await n.signcrypt(e,r)}async decrypt(e,t=null){const r=await this.getCypher(),n=t?y.default.fromId(t).cypher.publicKey:null;return(await r.decrypt(e,n)).toString()}getSecretHash(e){const t=h.Buffer.concat([e,h.Buffer.from("secrethash"),this.cypher.secretKey]);return(0,c.hash)("sha256",t)}}t.default=w},9031:(e,t,r)=>{var n=r(6192),i=r(6630),s=r(9113),o=r(6671).Buffer,a=new Array(64);function f(){this.init(),this._w=a,s.call(this,64,56)}n(f,i),f.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},f.prototype._hash=function(){var e=o.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=f},9035:(e,t,r)=>{"use strict";var n,i=r(8558);function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(2862),a=Symbol("lastResolve"),f=Symbol("lastReject"),c=Symbol("error"),h=Symbol("ended"),u=Symbol("lastPromise"),l=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function y(e){var t=e[a];if(null!==t){var r=e[d].read();null!==r&&(e[u]=null,e[a]=null,e[f]=null,t(p(r,!1)))}}function b(e){i.nextTick(y,e)}var g=Object.getPrototypeOf(function(){}),m=Object.setPrototypeOf((s(n={get stream(){return this[d]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[h])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise(function(t,r){i.nextTick(function(){e[c]?r(e[c]):t(p(void 0,!0))})});var r,n=this[u];if(n)r=new Promise(function(e,t){return function(r,n){e.then(function(){t[h]?r(p(void 0,!0)):t[l](r,n)},n)}}(n,this));else{var s=this[d].read();if(null!==s)return Promise.resolve(p(s,!1));r=new Promise(this[l])}return this[u]=r,r}},Symbol.asyncIterator,function(){return this}),s(n,"return",function(){var e=this;return new Promise(function(t,r){e[d].destroy(null,function(e){e?r(e):t(p(void 0,!0))})})}),n),g);e.exports=function(e){var t,r=Object.create(m,(s(t={},d,{value:e,writable:!0}),s(t,a,{value:null,writable:!0}),s(t,f,{value:null,writable:!0}),s(t,c,{value:null,writable:!0}),s(t,h,{value:e._readableState.endEmitted,writable:!0}),s(t,l,{value:function(e,t){var n=r[d].read();n?(r[u]=null,r[a]=null,r[f]=null,e(p(n,!1))):(r[a]=e,r[f]=t)},writable:!0}),t));return r[u]=null,o(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[f];return null!==t&&(r[u]=null,r[a]=null,r[f]=null,t(e)),void(r[c]=e)}var n=r[a];null!==n&&(r[u]=null,r[a]=null,r[f]=null,n(p(void 0,!0))),r[h]=!0}),e.on("readable",b.bind(null,r)),r}},9055:(e,t,r)=>{"use strict";const n=r(896),i=r(5775),s=r(8590),o=r(6899),{MT:a,SYMS:f}=r(790);class c extends n.Transform{constructor(e={}){const{separator:t="\n",stream_errors:r=!1,tags:n,max_depth:s,preferWeb:o,encoding:a,...f}=e;super({...f,readableObjectMode:!1,writableObjectMode:!1}),this.float_bytes=-1,this.separator=t,this.stream_errors=r,this.parser=new i({tags:n,max_depth:s,preferWeb:o,encoding:a}),this.parser.on("more-bytes",this._on_more.bind(this)),this.parser.on("value",this._on_value.bind(this)),this.parser.on("start",this._on_start.bind(this)),this.parser.on("stop",this._on_stop.bind(this)),this.parser.on("data",this._on_data.bind(this)),this.parser.on("error",this._on_error.bind(this))}_transform(e,t,r){this.parser.write(e,t,r)}_flush(e){this.parser._flush(t=>this.stream_errors?(t&&this._on_error(t),e()):e(t))}static diagnose(e,t={},r=null){if(null==e)throw new TypeError("input required");({options:t,cb:r}=function(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}(t,r));const{encoding:n="hex",...i}=t,a=new o,f=new c(i);let h=null;return"function"==typeof r?(f.on("end",()=>r(null,a.toString("utf8"))),f.on("error",r)):h=new Promise((e,t)=>{f.on("end",()=>e(a.toString("utf8"))),f.on("error",t)}),f.pipe(a),s.guessEncoding(e,n).pipe(f),h}_on_error(e){this.stream_errors?this.push(e.toString()):this.emit("error",e)}_on_more(e,t,r,n){e===a.SIMPLE_FLOAT&&(this.float_bytes={2:1,4:2,8:3}[t])}_fore(e,t){switch(e){case a.BYTE_STRING:case a.UTF8_STRING:case a.ARRAY:t>0&&this.push(", ");break;case a.MAP:t>0&&(t%2?this.push(": "):this.push(", "))}}_on_value(e,t,r){if(e===f.BREAK)return;this._fore(t,r);const n=this.float_bytes;this.float_bytes=-1,this.push(s.cborValueToString(e,n))}_on_start(e,t,r,n){switch(this._fore(r,n),e){case a.TAG:this.push(`${t}(`);break;case a.ARRAY:this.push("[");break;case a.MAP:this.push("{");break;case a.BYTE_STRING:case a.UTF8_STRING:this.push("(")}t===f.STREAM&&this.push("_ ")}_on_stop(e){switch(e){case a.TAG:this.push(")");break;case a.ARRAY:this.push("]");break;case a.MAP:this.push("}");break;case a.BYTE_STRING:case a.UTF8_STRING:this.push(")")}}_on_data(){this.push(this.separator)}}e.exports=c},9071:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCrypto=void 0;const n=r(1866),i=r(7165);t.NodeCrypto={webauthn:new i.NodeWebAuthn,pbkdf2:{encrypt:n.encrypt,decrypt:n.decrypt}}},9109:(e,t,r)=>{"use strict";const{MT:n,SIMPLE:i,SYMS:s}=r(790);class o{constructor(e){if("number"!=typeof e)throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(0|e)!==e)throw new Error(`value must be a small positive integer: ${e}`);this.value=e}toString(){return`simple(${this.value})`}[Symbol.for("nodejs.util.inspect.custom")](e,t){return`simple(${this.value})`}encodeCBOR(e){return e._pushInt(this.value,n.SIMPLE_FLOAT)}static isSimple(e){return e instanceof o}static decode(e,t=!0,r=!1){switch(e){case i.FALSE:return!1;case i.TRUE:return!0;case i.NULL:return t?null:s.NULL;case i.UNDEFINED:if(t)return;return s.UNDEFINED;case-1:if(!t||!r)throw new Error("Invalid BREAK");return s.BREAK;default:return new o(e)}}}e.exports=o},9113:(e,t,r)=>{var n=r(6671).Buffer;function i(e,t){this._block=n.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}i.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=n.from(e,t));for(var r=this._block,i=this._blockSize,s=e.length,o=this._len,a=0;a<s;){for(var f=o%i,c=Math.min(s-a,i-f),h=0;h<c;h++)r[f+h]=e[a+h];a+=c,(o+=c)%i===0&&this._update(r)}return this._len+=s,this},i.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=8*this._len;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var n=(4294967295&r)>>>0,i=(r-n)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var s=this._hash();return e?s.toString(e):s},i.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=i},9126:(e,t,r)=>{var n=r(8917),i=r(6192),s=r(347),o=function(e){return e.length?Array.isArray(e[0])?e[0]:Array.prototype.slice.call(e):[]},a=function(e){var t=function(){var r=o(arguments);if(!(this instanceof t))return new t(r);s.call(this,null,null,e),r.length&&this.setPipeline(r)};return i(t,s),t.prototype.setPipeline=function(){var e=o(arguments),t=this,r=!1,i=e[0],s=e[e.length-1];s=s.readable?s:null,i=i.writable?i:null;var a=function(){e[0].emit("error",new Error("stream was destroyed"))};if(this.on("close",a),this.on("prefinish",function(){r||t.cork()}),n(e,function(e){if(t.removeListener("close",a),e)return t.destroy("premature close"===e.message?null:e);r=!0,!1===t._autoDestroy&&(t._autoDestroy=!0),t.uncork()}),this.destroyed)return a();this.setWritable(i),this.setReadable(s)},t};e.exports=a({autoDestroy:!1,destroy:!1}),e.exports.obj=a({autoDestroy:!1,destroy:!1,objectMode:!0,highWaterMark:16}),e.exports.ctor=a},9273:(e,t,r)=>{var n=e.exports=function(e){e=e.toLowerCase();var t=n[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};n.sha=r(7519),n.sha1=r(2496),n.sha224=r(9031),n.sha256=r(6630),n.sha384=r(7718),n.sha512=r(1863)},9281:(e,t,r)=>{"use strict";var n=r(900),i=r(9952);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}n.inherits(s,i),e.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}},9399:e=>{var t=1/0,r=9007199254740991,n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=/^(?:0|[1-9]\d*)$/,f=parseInt,c=Object.prototype.toString,h=Math.ceil,u=Math.max;function l(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(i);++n<i;)s[n]=e[n+t];return s}function d(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=function(e,p,y){p=(y?function(e,t,n){if(!d(n))return!1;var i=typeof t;return!!("number"==i?function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}(e.length)&&!function(e){var t=d(e)?c.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(n)&&function(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||a.test(e))&&e>-1&&e%1==0&&e<t}(t,n.length):"string"==i&&t in n)&&function(e,t){return e===t||e!=e&&t!=t}(n[t],e)}(e,p,y):void 0===p)?1:u(function(e){var r=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(d(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=d(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var r=s.test(e);return r||o.test(e)?f(e.slice(2),r?2:8):i.test(e)?NaN:+e}(e))===t||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),a=r%1;return r==r?a?r-a:r:0}(p),0);var b=e?e.length:0;if(!b||p<1)return[];for(var g=0,m=0,w=Array(h(b/p));g<b;)w[m++]=l(e,g,g+=p);return w}},9463:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(5598),s=n(r(1167)),o=n(r(4406)),a=n(r(7961)),f=r(2655),c=n(r(1449)),h=r(4686),u=r(6761),l={usb:1,nfc:2,ble:4,internal:8,hybrid:16,"smart-card":32},d=e=>{const t=s.default.decode(e,{extendedResults:!0}).value.get(1);return 1===t?"Ed25519VerificationKey2020":2===t?"P256VerificationKey2020":"Unknown"},p=e=>{const t=s.default.decode(e,{extendedResults:!0}).value;let r=h.Buffer.from([]);return-7==t.get(3)?r=h.Buffer.concat([h.Buffer.from("04","hex"),t.get(-2),t.get(-3)]):-8==t.get(3)?r=t.get(-2):t.get(3)==u.PQ_COSE_ALG.DILITHIUM2&&(r=t.get(-101)),{publicKey:r}};class y extends c.default{constructor(){super(),this.prfsalt=h.Buffer.from("VaultysID salt")}static async createFromAttestation(e){const t=new y;t.ckey=a.default.getCOSEPublicKey(e),t.authType=d(t.ckey),t.fid=h.Buffer.from(e.id,"base64");const r=e.response,n=r.getTransports?r.getTransports():["usb"];return t._transports=(e=>e.reduceRight((e,t)=>e+(l[t]?l[t]:0),0))(n),t.signer=p(t.ckey),await t.getCypher(),delete t.cypher.secretKey,t}getSecret(){return h.Buffer.from((0,f.encode)({v:this.version,f:this.fid,t:this._transports,c:this.ckey,e:this.cypher.publicKey}))}static fromSecret(e){const t=(0,f.decode)(e),r=new y;return r.version=t.v??0,r.capability="private",r.fid="string"==typeof t.f?h.Buffer.from(t.f,"base64"):t.f,r._transports=t.t?t.t:15,r.ckey=t.c,r.authType=d(r.ckey),r.signer=p(t.c),r.cypher={publicKey:t.e},r}cleanSecureData(){this.cypher?.secretKey&&((0,i.secureErase)(this.cypher.secretKey),delete this.cypher.secretKey)}async getCypher(){if(!this.cypher?.secretKey){const t={challenge:h.Buffer.from([]),userVerification:"preferred",allowCredentials:[{type:"public-key",id:this.fid,transports:(e=this._transports,Object.keys(l).filter(t=>e&&l[t]))}],extensions:{prf:{eval:{first:this.prfsalt}}}},r=await this.webAuthn.get(t),{prf:n}=r.getClientExtensionResults(),i=n?.results?.first;if(!i)throw new Error("PRF failed");const s=o.default.box.keyPair.fromSecretKey(new Uint8Array(i));this.cypher={publicKey:h.Buffer.from(s.publicKey),secretKey:h.Buffer.from(s.secretKey)}}var e;return super.getCypher()}async createRevocationCertificate(){return null}}t.default=y},9481:(e,t,r)=>{e.exports=r(9784).EventEmitter},9495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserCrypto=void 0;const n=r(3170),i=r(7165);t.BrowserCrypto={webauthn:new i.BrowserWebAuthn,pbkdf2:{encrypt:n.encrypt,decrypt:n.decrypt}}},9517:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.crypto=void 0,t.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},9648:(e,t,r)=>{"use strict";e.exports=i;var n=r(4914);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(6192)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},9750:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DearmorAndDesigncryptStream=t.SigncryptAndArmorStream=t.dearmorAndDesigncrypt=t.signcryptAndArmor=t.verifyDetachedArmored=t.signDetachedAndArmor=t.DearmorAndVerifyStream=t.SignAndArmorStream=t.verifyArmored=t.signAndArmor=t.DearmorAndDecryptStream=t.EncryptAndArmorStream=t.dearmorAndDecrypt=t.encryptAndArmor=t.SymmetricKeyRecipient=t.DesigncryptStream=t.designcrypt=t.SigncryptStream=t.signcrypt=t.verifyDetached=t.signDetached=t.VerifyStream=t.verify=t.SignStream=t.sign=t.DecryptStream=t.decrypt=t.EncryptStream=t.encrypt=t.MessageType=t.DearmorStream=t.dearmor=t.ArmorStream=t.armor=void 0;var n=r(3321);Object.defineProperty(t,"armor",{enumerable:!0,get:function(){return n.armor}}),Object.defineProperty(t,"ArmorStream",{enumerable:!0,get:function(){return n.ArmorStream}}),Object.defineProperty(t,"dearmor",{enumerable:!0,get:function(){return n.dearmor}}),Object.defineProperty(t,"DearmorStream",{enumerable:!0,get:function(){return n.DearmorStream}});var i=r(931);Object.defineProperty(t,"MessageType",{enumerable:!0,get:function(){return i.MessageType}});var s=r(3990);Object.defineProperty(t,"encrypt",{enumerable:!0,get:function(){return s.encrypt}}),Object.defineProperty(t,"EncryptStream",{enumerable:!0,get:function(){return s.EncryptStream}}),Object.defineProperty(t,"decrypt",{enumerable:!0,get:function(){return s.decrypt}}),Object.defineProperty(t,"DecryptStream",{enumerable:!0,get:function(){return s.DecryptStream}});var o=r(3474);Object.defineProperty(t,"sign",{enumerable:!0,get:function(){return o.sign}}),Object.defineProperty(t,"SignStream",{enumerable:!0,get:function(){return o.SignStream}}),Object.defineProperty(t,"verify",{enumerable:!0,get:function(){return o.verify}}),Object.defineProperty(t,"VerifyStream",{enumerable:!0,get:function(){return o.VerifyStream}}),Object.defineProperty(t,"signDetached",{enumerable:!0,get:function(){return o.signDetached}}),Object.defineProperty(t,"verifyDetached",{enumerable:!0,get:function(){return o.verifyDetached}});var a=r(6404);Object.defineProperty(t,"signcrypt",{enumerable:!0,get:function(){return a.signcrypt}}),Object.defineProperty(t,"SigncryptStream",{enumerable:!0,get:function(){return a.SigncryptStream}}),Object.defineProperty(t,"designcrypt",{enumerable:!0,get:function(){return a.designcrypt}}),Object.defineProperty(t,"DesigncryptStream",{enumerable:!0,get:function(){return a.DesigncryptStream}});var f=r(3051);Object.defineProperty(t,"SymmetricKeyRecipient",{enumerable:!0,get:function(){return f.SymmetricKeyRecipient}});var c=r(9862);Object.defineProperty(t,"encryptAndArmor",{enumerable:!0,get:function(){return c.encryptAndArmor}}),Object.defineProperty(t,"dearmorAndDecrypt",{enumerable:!0,get:function(){return c.dearmorAndDecrypt}}),Object.defineProperty(t,"EncryptAndArmorStream",{enumerable:!0,get:function(){return c.EncryptAndArmorStream}}),Object.defineProperty(t,"DearmorAndDecryptStream",{enumerable:!0,get:function(){return c.DearmorAndDecryptStream}}),Object.defineProperty(t,"signAndArmor",{enumerable:!0,get:function(){return c.signAndArmor}}),Object.defineProperty(t,"verifyArmored",{enumerable:!0,get:function(){return c.verifyArmored}}),Object.defineProperty(t,"SignAndArmorStream",{enumerable:!0,get:function(){return c.SignAndArmorStream}}),Object.defineProperty(t,"DearmorAndVerifyStream",{enumerable:!0,get:function(){return c.DearmorAndVerifyStream}}),Object.defineProperty(t,"signDetachedAndArmor",{enumerable:!0,get:function(){return c.signDetachedAndArmor}}),Object.defineProperty(t,"verifyDetachedArmored",{enumerable:!0,get:function(){return c.verifyDetachedArmored}}),Object.defineProperty(t,"signcryptAndArmor",{enumerable:!0,get:function(){return c.signcryptAndArmor}}),Object.defineProperty(t,"dearmorAndDesigncrypt",{enumerable:!0,get:function(){return c.dearmorAndDesigncrypt}}),Object.defineProperty(t,"SigncryptAndArmorStream",{enumerable:!0,get:function(){return c.SigncryptAndArmorStream}}),Object.defineProperty(t,"DearmorAndDesigncryptStream",{enumerable:!0,get:function(){return c.DearmorAndDesigncryptStream}})},9780:()=>{},9784:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(r,n){function i(r){e.removeListener(t,s),n(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}y(e,t,s,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&y(e,"error",t,{once:!0})}(e,i)})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function f(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,s,o,c;if(a(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=f(e))>0&&o.length>i&&!o.warned){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=o.length,c=h,console&&console.warn&&console.warn(c)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=h.bind(n);return i.listener=r,n.wrapFn=i,i}function l(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)})}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return f(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(void 0===f)return!1;if("function"==typeof f)n(f,this,t);else{var c=f.length,h=p(f,c);for(r=0;r<c;++r)n(h[r],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,s,o;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return l(this,e,!0)},s.prototype.rawListeners=function(e){return l(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9861:(e,t,r)=>{"use strict";var n=r(1036),i=r(7902),s=r(6192),o=r(6160),a=n.assert;function f(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,o.call(this,"edwards",e),this.a=new i(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function c(e,t,r,n,s){o.BasePoint.call(this,e,"projective"),null===t&&null===r&&null===n?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(t,16),this.y=new i(r,16),this.z=n?new i(n,16):this.curve.one,this.t=s&&new i(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}s(f,o),e.exports=f,f.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},f.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},f.prototype.jpoint=function(e,t,r,n){return this.point(e,t,r,n)},f.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=this.c2.redSub(this.a.redMul(r)),s=this.one.redSub(this.c2.redMul(this.d).redMul(r)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");var f=a.fromRed().isOdd();return(t&&!f||!t&&f)&&(a=a.redNeg()),this.point(e,a)},f.prototype.pointFromY=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=r.redSub(this.c2),s=r.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(0===o.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},f.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),n=t.redMul(this.a).redAdd(r),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return 0===n.cmp(i)},s(c,o.BasePoint),f.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},f.prototype.point=function(e,t,r,n){return new c(this,e,t,r,n)},c.fromJSON=function(e,t){return new c(e,t[0],t[1],t[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},c.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var n=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),s=n.redAdd(t),o=s.redSub(r),a=n.redSub(t),f=i.redMul(o),c=s.redMul(a),h=i.redMul(a),u=o.redMul(s);return this.curve.point(f,c,u,h)},c.prototype._projDbl=function(){var e,t,r,n,i,s,o=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),f=this.y.redSqr();if(this.curve.twisted){var c=(n=this.curve._mulA(a)).redAdd(f);this.zOne?(e=o.redSub(a).redSub(f).redMul(c.redSub(this.curve.two)),t=c.redMul(n.redSub(f)),r=c.redSqr().redSub(c).redSub(c)):(i=this.z.redSqr(),s=c.redSub(i).redISub(i),e=o.redSub(a).redISub(f).redMul(s),t=c.redMul(n.redSub(f)),r=c.redMul(s))}else n=a.redAdd(f),i=this.curve._mulC(this.z).redSqr(),s=n.redSub(i).redSub(i),e=this.curve._mulC(o.redISub(n)).redMul(s),t=this.curve._mulC(n).redMul(a.redISub(f)),r=n.redMul(s);return this.curve.point(e,t,r)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),s=r.redSub(t),o=i.redSub(n),a=i.redAdd(n),f=r.redAdd(t),c=s.redMul(o),h=a.redMul(f),u=s.redMul(f),l=o.redMul(a);return this.curve.point(c,h,l,u)},c.prototype._projAdd=function(e){var t,r,n=this.z.redMul(e.z),i=n.redSqr(),s=this.x.redMul(e.x),o=this.y.redMul(e.y),a=this.curve.d.redMul(s).redMul(o),f=i.redSub(a),c=i.redAdd(a),h=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(s).redISub(o),u=n.redMul(f).redMul(h);return this.curve.twisted?(t=n.redMul(c).redMul(o.redSub(this.curve._mulA(s))),r=f.redMul(c)):(t=n.redMul(c).redMul(o.redSub(s)),r=this.curve._mulC(f).redMul(c)),this.curve.point(u,t,r)},c.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},c.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},c.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},c.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var r=e.clone(),n=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),0===this.x.cmp(t))return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add},9862:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{f(n.next(e))}catch(e){s(e)}}function a(e){try{f(n.throw(e))}catch(e){s(e)}}function f(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}f((n=n.apply(e,t||[])).next())})},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DearmorAndDesigncryptStream=t.SigncryptAndArmorStream=t.DearmorAndVerifyStream=t.SignAndArmorStream=t.DearmorAndDecryptStream=t.EncryptAndArmorStream=void 0,t.encryptAndArmor=function(e,t,r){return n(this,void 0,void 0,function*(){const n=yield(0,s.encrypt)(e,t,r);return(0,f.armor)(n,{message_type:f.MessageType.ENCRYPTED_MESSAGE})})},t.dearmorAndDecrypt=function(e,t,r){return n(this,void 0,void 0,function*(){const n=(0,f.dearmor)(e);return Object.assign(yield(0,s.decrypt)(n,t,r),{remaining:n.remaining,header_info:n.header_info})})},t.signAndArmor=function(e,t){return n(this,void 0,void 0,function*(){const r=(0,o.sign)(e,t);return(0,f.armor)(r,{message_type:f.MessageType.SIGNED_MESSAGE})})},t.verifyArmored=function(e,t){return n(this,void 0,void 0,function*(){const r=(0,f.dearmor)(e);return Object.assign(yield(0,o.verify)(r,t),{remaining:r.remaining,header_info:r.header_info})})},t.signDetachedAndArmor=function(e,t){return n(this,void 0,void 0,function*(){const r=(0,o.signDetached)(e,t);return(0,f.armor)(r,{message_type:f.MessageType.DETACHED_SIGNATURE})})},t.verifyDetachedArmored=function(e,t,r){return n(this,void 0,void 0,function*(){const n=(0,f.dearmor)(e),i=yield(0,o.verifyDetached)(n,t,r);return{remaining:n.remaining,header_info:n.header_info,public_key:i.public_key}})},t.signcryptAndArmor=function(e,t,r){return n(this,void 0,void 0,function*(){const n=yield(0,a.signcrypt)(e,t,r);return(0,f.armor)(n,{message_type:f.MessageType.ENCRYPTED_MESSAGE})})},t.dearmorAndDesigncrypt=function(e,t,r){return n(this,void 0,void 0,function*(){const n=(0,f.dearmor)(e);return Object.assign(yield(0,a.designcrypt)(n,t,r),{remaining:n.remaining,header_info:n.header_info})})};const s=r(3990),o=r(3474),a=r(6404),f=r(3321),c=i(r(9126));class h extends c.default{constructor(e,t,r){super(new s.EncryptStream(e,t),new f.ArmorStream(Object.assign({message_type:f.MessageType.ENCRYPTED_MESSAGE},r)))}}t.EncryptAndArmorStream=h;class u extends c.default{constructor(e,t,r){const n=new f.DearmorStream(r),i=new s.DecryptStream(e,t);super(n,i),this.dearmor=n,this.decrypt=i}get info(){return this.dearmor.info}get sender_public_key(){return this.decrypt.sender_public_key}}t.DearmorAndDecryptStream=u;class l extends c.default{constructor(e,t){super(new o.SignStream(e),new f.ArmorStream(Object.assign({message_type:f.MessageType.SIGNED_MESSAGE},t)))}}t.SignAndArmorStream=l;class d extends c.default{constructor(e,t){const r=new f.DearmorStream(t),n=new o.VerifyStream(e);super(r,n),this.dearmor=r,this.verify=n}get info(){return this.dearmor.info}get public_key(){return this.verify.public_key}}t.DearmorAndVerifyStream=d;class p extends c.default{constructor(e,t,r){super(new a.SigncryptStream(e,t),new f.ArmorStream(Object.assign({message_type:f.MessageType.ENCRYPTED_MESSAGE},r)))}}t.SigncryptAndArmorStream=p;class y extends c.default{constructor(e,t){const r=new f.DearmorStream(t),n=new a.DesigncryptStream(e);super(r,n),this.dearmor=r,this.decrypt=n}get info(){return this.dearmor.info}get sender_public_key(){return this.decrypt.sender_public_key}}t.DearmorAndDesigncryptStream=y},9865:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}var f=r(4686).Buffer,c=r(1220).inspect,h=c&&c.custom||"inspect";function u(e,t,r){f.prototype.copy.call(e,t,r)}e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return f.alloc(0);for(var t=f.allocUnsafe(e>>>0),r=this.head,n=0;r;)u(r.data,t,n),n+=r.data.length,r=r.next;return t}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?n+=i:n+=i.slice(0,e),0===(e-=s)){s===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=f.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0===(e-=s)){s===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(s));break}++n}return this.length-=n,t}},{key:h,value:function(e,t){return c(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},9910:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;const n=r(7261),i=r(4686);t.encrypt=(e,t)=>{const r=t,s=(0,n.randomBytes)(n.secretbox.nonceLength),o=(0,n.secretbox)(Uint8Array.from(e),s,r),a=new Uint8Array(s.length+o.length);return a.set(s),a.set(o,s.length),i.Buffer.from(a)},t.decrypt=(e,t)=>{const r=t,s=e,o=s.slice(0,n.secretbox.nonceLength),a=s.slice(n.secretbox.nonceLength,e.length),f=n.secretbox.open(a,o,r);if(!f)throw new Error("Could not decrypt message");return i.Buffer.from(f)},t.default={decrypt:t.decrypt,encrypt:t.encrypt,encryptChannel:(e,r)=>{const n={apply:(e,n,i)=>e.call(n,(0,t.encrypt)(i[0],r))},i={async apply(e,n,i){const s=await e.call(n);return(0,t.decrypt)(s,r)}};return e.send=new Proxy(e.send,n),e.receive=new Proxy(e.receive,i),e},generateKey:()=>(0,n.randomBytes)(32)}},9913:function(e,t,r){"use strict";var n,i=r(4686).Buffer,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&s(t,e,r[i]);return o(t,e),t}),f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const c=a(r(931)),h=f(r(9981)),u=r(4406),l=r(568),d=r(2655),p=r(4072);class y extends c.default{constructor(e,t,r){if(super(),!(0,l.isBufferOrUint8Array)(e)||32!==e.length)throw new TypeError("public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||48!==t.length)throw new TypeError("sender_secretbox must be a 48 byte Uint8Array");this.public_key=e,this.sender_secretbox=t,this.recipients=r}get encoded_data(){return Object.defineProperty(this,"encoded_data",{value:this.encode()}).encoded_data}get encoded(){return this.encoded_data[1]}get hash(){return this.encoded_data[0]}static create(e,t,r,n){if(!(0,l.isBufferOrUint8Array)(r)||32!==r.length)throw new TypeError("sender_public_key must be a 32 byte Uint8Array");if(!(0,l.isBufferOrUint8Array)(t)||32!==t.length)throw new TypeError("payload_key must be a 32 byte Uint8Array");return new this(e,(0,u.secretbox)(Uint8Array.from(r),Uint8Array.from(y.SENDER_KEY_SECRETBOX_NONCE),Uint8Array.from(t)),n)}encode(){return y.encodeHeader(this.public_key,this.sender_secretbox,this.recipients)}static encodeHeader(e,t,r){const n=["saltpack",[2,0],c.MessageType.ENCRYPTION,e,t,r.map(e=>[e.anonymous?null:e.public_key,e.encrypted_payload_key])],s=(0,d.encode)(n);return[i.from(p.sha512.create().update(s).digest()),i.from((0,d.encode)(s))]}static decode(e,t=!1){const[r,n]=super.decode1(e,t);if(n[2]!==c.MessageType.ENCRYPTION)throw new Error("Invalid data");const[,,,i,s,o]=n;if(!(o instanceof Array))throw new Error("Invalid data");return new this(i,s,o.map((e,t)=>{if(!(e instanceof Array)||e.length<2)throw new TypeError("Invalid data");return h.default.from(e[0],e[1],t)}))}decryptPayloadKey(e){const t=u.box.before(this.public_key,e.secretKey);for(const r of this.recipients){if(r.public_key&&!i.from(r.public_key).equals(e.publicKey))continue;const n=r.decryptPayloadKey(this.public_key,e.secretKey,t);if(n)return r.setPublicKey(e.publicKey),[n,r]}throw new Error("keypair is not an intended recipient")}decryptSender(e){const t=u.secretbox.open(Uint8Array.from(this.sender_secretbox),Uint8Array.from(y.SENDER_KEY_SECRETBOX_NONCE),Uint8Array.from(e));if(!t)throw new Error("Failed to decrypt sender public key");return t}}y.SENDER_KEY_SECRETBOX_NONCE=i.from("saltpack_sender_key_sbox"),t.default=y},9925:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(4686),s=r(1198),o=n(r(7751)),a=new(r(4872));class f{constructor(e){this.privKey=e}static fromSecretKey(e){let t=s.sha512(e);return t[0]&=248,t[31]&=63,t[31]|=64,new f(t)}toBytes(){return this.privKey}toPublicKey(){const e=a.keyFromSecret(this.privKey);return new o.default(i.Buffer.from(e.pubBytes()))}sign(e){const t=a.keyFromSecret(this.privKey).sign(e.toString("hex"));return i.Buffer.from(t.toBytes())}verify(e,t){return a.keyFromSecret(this.privKey).verify(t.toString("hex"),e.toString("hex"))}}t.default=f},9952:(e,t,r)=>{"use strict";var n=r(900),i=r(7984),s=r(8637),o=n.rotr64_hi,a=n.rotr64_lo,f=n.shr64_hi,c=n.shr64_lo,h=n.sum64,u=n.sum64_hi,l=n.sum64_lo,d=n.sum64_4_hi,p=n.sum64_4_lo,y=n.sum64_5_hi,b=n.sum64_5_lo,g=i.BlockHash,m=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function w(){if(!(this instanceof w))return new w;g.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=m,this.W=new Array(160)}function v(e,t,r,n,i){var s=e&r^~e&i;return s<0&&(s+=4294967296),s}function _(e,t,r,n,i,s){var o=t&n^~t&s;return o<0&&(o+=4294967296),o}function E(e,t,r,n,i){var s=e&r^e&i^r&i;return s<0&&(s+=4294967296),s}function S(e,t,r,n,i,s){var o=t&n^t&s^n&s;return o<0&&(o+=4294967296),o}function B(e,t){var r=o(e,t,28)^o(t,e,2)^o(t,e,7);return r<0&&(r+=4294967296),r}function M(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=4294967296),r}function A(e,t){var r=o(e,t,14)^o(e,t,18)^o(t,e,9);return r<0&&(r+=4294967296),r}function I(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=4294967296),r}function x(e,t){var r=o(e,t,1)^o(e,t,8)^f(e,t,7);return r<0&&(r+=4294967296),r}function k(e,t){var r=a(e,t,1)^a(e,t,8)^c(e,t,7);return r<0&&(r+=4294967296),r}function T(e,t){var r=o(e,t,19)^o(t,e,29)^f(e,t,6);return r<0&&(r+=4294967296),r}function P(e,t){var r=a(e,t,19)^a(t,e,29)^c(e,t,6);return r<0&&(r+=4294967296),r}n.inherits(w,g),e.exports=w,w.blockSize=1024,w.outSize=512,w.hmacStrength=192,w.padLength=128,w.prototype._prepareBlock=function(e,t){for(var r=this.W,n=0;n<32;n++)r[n]=e[t+n];for(;n<r.length;n+=2){var i=T(r[n-4],r[n-3]),s=P(r[n-4],r[n-3]),o=r[n-14],a=r[n-13],f=x(r[n-30],r[n-29]),c=k(r[n-30],r[n-29]),h=r[n-32],u=r[n-31];r[n]=d(i,s,o,a,f,c,h,u),r[n+1]=p(i,s,o,a,f,c,h,u)}},w.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,n=this.h[0],i=this.h[1],o=this.h[2],a=this.h[3],f=this.h[4],c=this.h[5],d=this.h[6],p=this.h[7],g=this.h[8],m=this.h[9],w=this.h[10],x=this.h[11],k=this.h[12],T=this.h[13],P=this.h[14],O=this.h[15];s(this.k.length===r.length);for(var R=0;R<r.length;R+=2){var K=P,C=O,U=A(g,m),D=I(g,m),L=v(g,0,w,0,k),N=_(0,m,0,x,0,T),H=this.k[R],F=this.k[R+1],j=r[R],z=r[R+1],q=y(K,C,U,D,L,N,H,F,j,z),V=b(K,C,U,D,L,N,H,F,j,z);K=B(n,i),C=M(n,i),U=E(n,0,o,0,f),D=S(0,i,0,a,0,c);var G=u(K,C,U,D),W=l(K,C,U,D);P=k,O=T,k=w,T=x,w=g,x=m,g=u(d,p,q,V),m=l(p,p,q,V),d=f,p=c,f=o,c=a,o=n,a=i,n=u(q,V,G,W),i=l(q,V,G,W)}h(this.h,0,n,i),h(this.h,2,o,a),h(this.h,4,f,c),h(this.h,6,d,p),h(this.h,8,g,m),h(this.h,10,w,x),h(this.h,12,k,T),h(this.h,14,P,O)},w.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},9981:(e,t,r)=>{"use strict";var n=r(4686).Buffer;Object.defineProperty(t,"__esModule",{value:!0});const i=r(4406),s=r(568),o=r(4072);class a{constructor(e,t,r,n=!1){if(this.mac_key=null,null!==e&&(!(0,s.isBufferOrUint8Array)(e)||32!==e.length))throw new TypeError("recipient_public_key must be a 32 byte Uint8Array");if(!(0,s.isBufferOrUint8Array)(t)||48!==t.length)throw new TypeError("payload_key_box must be a 48 byte Uint8Array");if("bigint"!=typeof r)throw new TypeError("index must be a bigint");if("boolean"!=typeof n)throw new TypeError("anonymous must be a boolean");this.public_key=e,this.encrypted_payload_key=t,this.index=r,this.recipient_index=a.generateRecipientIndex(r),this.anonymous=n}setPublicKey(e){this.public_key=e}static create(e,t,r,n,s=!1){"number"==typeof n&&(n=BigInt(n));const o=this.generateRecipientIndex(n);return new this(e,(0,i.box)(Uint8Array.from(r),Uint8Array.from(o),Uint8Array.from(e),Uint8Array.from(t)),n,s)}static from(e,t,r){return"number"==typeof r&&(r=BigInt(r)),new this(e,t,r,null===e)}static generateRecipientIndex(e){const t=n.alloc(8);return t.writeBigUInt64BE(e),n.concat([this.PAYLOAD_KEY_BOX_NONCE_PREFIX_V2,t])}decryptPayloadKey(e,t,r=null){return(r?i.box.open.after(Uint8Array.from(this.encrypted_payload_key),Uint8Array.from(this.recipient_index),Uint8Array.from(r)):i.box.open(Uint8Array.from(this.encrypted_payload_key),Uint8Array.from(this.recipient_index),Uint8Array.from(e),Uint8Array.from(t)))||null}generateMacKeyForSender(e,t,r,s=null){if(!s&&this.public_key&&(s=this.public_key),!s)throw new Error("Generating MAC key requires the recipient's public key");const a=n.alloc(8);a.writeBigUInt64BE(this.index);const f=n.concat([e.slice(0,16),a]);f[15]&=254;const c=(0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(f),Uint8Array.from(s),Uint8Array.from(r));f[15]|=1;const h=(0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(f),Uint8Array.from(s),Uint8Array.from(t)),u=o.sha512.create().update(c.slice(-32)).update(h.slice(-32)).digest().slice(0,32);return this.mac_key=u,n.from(u)}generateMacKeyForRecipient(e,t,r,s){const a=n.alloc(8);a.writeBigUInt64BE(this.index);const f=n.concat([e.slice(0,16),a]);f[15]&=254;const c=(0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(f),Uint8Array.from(r),Uint8Array.from(s));f[15]|=1;const h=(0,i.box)(Uint8Array.from(n.alloc(32).fill("\0")),Uint8Array.from(f),Uint8Array.from(t),Uint8Array.from(s)),u=o.sha512.create().update(c.slice(-32)).update(h.slice(-32)).digest().slice(0,32);return this.mac_key=u,n.from(u)}}a.PAYLOAD_KEY_BOX_NONCE_PREFIX_V2=n.from("saltpack_recipsb"),t.default=a},9995:(e,t,r)=>{"use strict";const n=r(896),i=r(8590),s=r(5775),o=r(6899),{MT:a,NUMBYTES:f,SYMS:c}=r(790),{Buffer:h}=r(4686);function u(e){return e>1?"s":""}class l extends n.Transform{constructor(e={}){const{depth:t=1,max_depth:r=10,no_summary:n=!1,tags:i={},preferWeb:a,encoding:f,...c}=e;super({...c,readableObjectMode:!1,writableObjectMode:!1}),this.depth=t,this.max_depth=r,this.all=new o,i[24]||(i[24]=this._tag_24.bind(this)),this.parser=new s({tags:i,max_depth:r,preferWeb:a,encoding:f}),this.parser.on("value",this._on_value.bind(this)),this.parser.on("start",this._on_start.bind(this)),this.parser.on("start-string",this._on_start_string.bind(this)),this.parser.on("stop",this._on_stop.bind(this)),this.parser.on("more-bytes",this._on_more.bind(this)),this.parser.on("error",this._on_error.bind(this)),n||this.parser.on("data",this._on_data.bind(this)),this.parser.bs.on("read",this._on_read.bind(this))}_tag_24(e){const t=new l({depth:this.depth+1,no_summary:!0});t.on("data",e=>this.push(e)),t.on("error",e=>this.emit("error",e)),t.end(e)}_transform(e,t,r){this.parser.write(e,t,r)}_flush(e){return this.parser._flush(e)}static comment(e,t={},r=null){if(null==e)throw new Error("input required");({options:t,cb:r}=function(e,t){switch(typeof e){case"function":return{options:{},cb:e};case"string":return{options:{encoding:e},cb:t};case"number":return{options:{max_depth:e},cb:t};case"object":return{options:e||{},cb:t};default:throw new TypeError("Unknown option type")}}(t,r));const n=new o,{encoding:s="hex",...a}=t,f=new l(a);let c=null;return"function"==typeof r?(f.on("end",()=>{r(null,n.toString("utf8"))}),f.on("error",r)):c=new Promise((e,t)=>{f.on("end",()=>{e(n.toString("utf8"))}),f.on("error",t)}),f.pipe(n),i.guessEncoding(e,s).pipe(f),c}_on_error(e){this.push("ERROR: "),this.push(e.toString()),this.push("\n")}_on_read(e){this.all.write(e);const t=e.toString("hex");this.push(new Array(this.depth+1).join("  ")),this.push(t);let r=2*(this.max_depth-this.depth)-t.length;r<1&&(r=1),this.push(new Array(r+1).join(" ")),this.push("-- ")}_on_more(e,t,r,n){let i="";switch(this.depth++,e){case a.POS_INT:i="Positive number,";break;case a.NEG_INT:i="Negative number,";break;case a.ARRAY:i="Array, length";break;case a.MAP:i="Map, count";break;case a.BYTE_STRING:i="Bytes, length";break;case a.UTF8_STRING:i="String, length";break;case a.SIMPLE_FLOAT:i=1===t?"Simple value,":"Float,"}this.push(`${i} next ${t} byte${u(t)}\n`)}_on_start_string(e,t,r,n){let i="";switch(this.depth++,e){case a.BYTE_STRING:i=`Bytes, length: ${t}`;break;case a.UTF8_STRING:i=`String, length: ${t.toString()}`}this.push(`${i}\n`)}_on_start(e,t,r,n){switch(this.depth++,r){case a.ARRAY:this.push(`[${n}], `);break;case a.MAP:n%2?this.push(`{Val:${Math.floor(n/2)}}, `):this.push(`{Key:${Math.floor(n/2)}}, `)}switch(e){case a.TAG:this.push(`Tag #${t}`),24===t&&this.push(" Encoded CBOR data item");break;case a.ARRAY:t===c.STREAM?this.push("Array (streaming)"):this.push(`Array, ${t} item${u(t)}`);break;case a.MAP:t===c.STREAM?this.push("Map (streaming)"):this.push(`Map, ${t} pair${u(t)}`);break;case a.BYTE_STRING:this.push("Bytes (streaming)");break;case a.UTF8_STRING:this.push("String (streaming)")}this.push("\n")}_on_stop(e){this.depth--}_on_value(e,t,r,n){if(e!==c.BREAK)switch(t){case a.ARRAY:this.push(`[${r}], `);break;case a.MAP:r%2?this.push(`{Val:${Math.floor(r/2)}}, `):this.push(`{Key:${Math.floor(r/2)}}, `)}const s=i.cborValueToString(e,-1/0);switch("string"==typeof e||h.isBuffer(e)?(e.length>0&&(this.push(s),this.push("\n")),this.depth--):(this.push(s),this.push("\n")),n){case f.ONE:case f.TWO:case f.FOUR:case f.EIGHT:this.depth--}}_on_data(){this.push("0x"),this.push(this.all.read().toString("hex")),this.push("\n")}}e.exports=l}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r(3274)})());
//# sourceMappingURL=vaultysid.min.js.map